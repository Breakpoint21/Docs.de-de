---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/processing-unhandled-exceptions-cs
title: Verarbeitung von nicht behandelten Ausnahmen (c#) | Microsoft Docs
author: rick-anderson
description: "Tritt ein Laufzeitfehler auf eine Webanwendung in der Produktion ist es wichtig, einen Entwickler benachrichtigt, damit den Fehler protokolliert werden, damit er an einen la diagnostiziert werden möglicherweise..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 06/09/2009
ms.topic: article
ms.assetid: 5bc1afd5-2484-4528-b158-ab218ba150e8
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/processing-unhandled-exceptions-cs
msc.type: authoredcontent
ms.openlocfilehash: 7be257faa350476bef9f6d372ea4f140fff8d136
ms.sourcegitcommit: a510f38930abc84c4b302029d019a34dfe76823b
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/30/2018
---
<a name="processing-unhandled-exceptions-c"></a><span data-ttu-id="c1eab-103">Verarbeitung von nicht behandelten Ausnahmen (c#)</span><span class="sxs-lookup"><span data-stu-id="c1eab-103">Processing Unhandled Exceptions (C#)</span></span>
====================
<span data-ttu-id="c1eab-104">durch [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="c1eab-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="c1eab-105">[Herunterladen von Code](http://download.microsoft.com/download/1/0/C/10CC829F-A808-4302-97D3-59989B8F9C01/ASPNET_Hosting_Tutorial_12_CS.zip) oder [PDF herunterladen](http://download.microsoft.com/download/5/C/5/5C57DB8C-5DEA-4B3A-92CA-4405544D313B/aspnet_tutorial12_ErrorHandling_cs.pdf)</span><span class="sxs-lookup"><span data-stu-id="c1eab-105">[Download Code](http://download.microsoft.com/download/1/0/C/10CC829F-A808-4302-97D3-59989B8F9C01/ASPNET_Hosting_Tutorial_12_CS.zip) or [Download PDF](http://download.microsoft.com/download/5/C/5/5C57DB8C-5DEA-4B3A-92CA-4405544D313B/aspnet_tutorial12_ErrorHandling_cs.pdf)</span></span>

> <span data-ttu-id="c1eab-106">Tritt ein Laufzeitfehler auf eine Webanwendung in der Produktion ist es wichtig, einen Entwickler benachrichtigt, damit den Fehler protokolliert werden, damit er zu einem späteren Zeitpunkt zeitlich diagnostiziert werden kann.</span><span class="sxs-lookup"><span data-stu-id="c1eab-106">When a runtime error occurs on a web application in production it is important to notify a developer and to log the error so that it may be diagnosed at a later point in time.</span></span> <span data-ttu-id="c1eab-107">Dieses Lernprogramm bietet einen Überblick darüber, wie ASP.NET Laufzeitfehler verarbeitet und untersucht eine Möglichkeit, benutzerdefinierten Code, wenn eine nicht behandelte Ausnahme Blasen bis zu die ASP.NET-Laufzeit ausgeführt haben.</span><span class="sxs-lookup"><span data-stu-id="c1eab-107">This tutorial provides an overview of how ASP.NET processes runtime errors and looks at one way to have custom code execute whenever an unhandled exception bubbles up to the ASP.NET runtime.</span></span>


## <a name="introduction"></a><span data-ttu-id="c1eab-108">Einführung</span><span class="sxs-lookup"><span data-stu-id="c1eab-108">Introduction</span></span>

<span data-ttu-id="c1eab-109">Tritt eine nicht behandelte Ausnahme in einer ASP.NET-Anwendung, übergeben Sie bis zu die ASP.NET-Laufzeit, wodurch ausgelöst wird die `Error` Ereignis und die entsprechenden Fehlerseite angezeigt.</span><span class="sxs-lookup"><span data-stu-id="c1eab-109">When an unhandled exception occurs in an ASP.NET application, it bubbles up to the ASP.NET runtime, which raises the `Error` event and displays the appropriate error page.</span></span> <span data-ttu-id="c1eab-110">Es gibt drei verschiedene Typen von Fehlerseiten: die Common Language Runtime Fehler gelben Bildschirm des Tod (YSOD); die Ausnahmedetails YSOD; und benutzerdefinierte Fehlerseiten.</span><span class="sxs-lookup"><span data-stu-id="c1eab-110">There are three different types of error pages: the Runtime Error Yellow Screen of Death (YSOD); the Exception Details YSOD; and custom error pages.</span></span> <span data-ttu-id="c1eab-111">In der [vorherigen Lernprogramm](displaying-a-custom-error-page-cs.md) wir konfiguriert, dass die Anwendung eine benutzerdefinierte Fehlerseite für Remotebenutzer und die Ausnahme Details YSOD für Besucher lokal verwenden.</span><span class="sxs-lookup"><span data-stu-id="c1eab-111">In the [preceding tutorial](displaying-a-custom-error-page-cs.md) we configured the application to use a custom error page for remote users and the Exception Details YSOD for users visiting locally.</span></span>

<span data-ttu-id="c1eab-112">Mithilfe einer Human benutzerfreundliche benutzerdefinierte Fehlerseite, die das Aussehen und Verhalten des Standorts entspricht wird auf den Standardwert Runtime Fehler YSOD bevorzugt, aber nur ein Teil einer umfassenden Lösung für die Fehlerbehandlung wird eine benutzerdefinierte Fehlerseite anzeigen.</span><span class="sxs-lookup"><span data-stu-id="c1eab-112">Using a human-friendly custom error page that matches the look and feel of the site is preferred to the default Runtime Error YSOD, but displaying a custom error page is only one part of a comprehensive error handling solution.</span></span> <span data-ttu-id="c1eab-113">Tritt ein Fehler in einer Anwendung in der Produktion, ist es wichtig, dass die Entwickler des Fehlers benachrichtigt werden, damit sie die Ursache der Ausnahme entdecken können und die Adresse.</span><span class="sxs-lookup"><span data-stu-id="c1eab-113">When an error occurs in an application in production, it is important that the developers are notified of the error so that they can unearth the cause of the exception and address it.</span></span> <span data-ttu-id="c1eab-114">Darüber hinaus sollte Details der Fehler protokolliert werden, damit der Fehler überprüft und zu einem späteren Zeitpunkt zeitlich diagnostiziert werden kann.</span><span class="sxs-lookup"><span data-stu-id="c1eab-114">Furthermore, the error's details should be logged so that the error can be examined and diagnosed at a later point in time.</span></span>

<span data-ttu-id="c1eab-115">Dieses Lernprogramm zeigt die Details einer nicht behandelten Ausnahme Zugriff auf, damit sie protokolliert werden können und ein Entwickler benachrichtigt.</span><span class="sxs-lookup"><span data-stu-id="c1eab-115">This tutorial shows how to access the details of an unhandled exception so that they can be logged and a developer notified.</span></span> <span data-ttu-id="c1eab-116">Die zwei Lernprogramme, die nach dieser untersuchen Fehler protokollierungsbibliotheken, die nach einem gewissen Grad Konfiguration automatisch benachrichtigen Entwickler von Laufzeitfehler und ihre Details zu melden.</span><span class="sxs-lookup"><span data-stu-id="c1eab-116">The two tutorials following this one explore error logging libraries that, after a bit of configuration, will automatically notify developers of runtime errors and log their details.</span></span>

> [!NOTE]
> <span data-ttu-id="c1eab-117">Die Informationen in diesem Lernprogramm untersucht ist besonders hilfreich, wenn nicht behandelte Ausnahmen in eine eindeutige oder angepasste Weise verarbeitet werden muss.</span><span class="sxs-lookup"><span data-stu-id="c1eab-117">The information examined in this tutorial is most useful if you need to process unhandled exceptions in some unique or customized manner.</span></span> <span data-ttu-id="c1eab-118">In Fällen, in denen nur müssen Sie die Ausnahme protokollieren und einen Entwickler zu benachrichtigen, ist die Verwendung von einer Fehler Protokollierung der Bibliothek die beste Wahl.</span><span class="sxs-lookup"><span data-stu-id="c1eab-118">In cases where you only need to log the exception and notify a developer, using an error logging library is the way to go.</span></span> <span data-ttu-id="c1eab-119">Die nächsten beiden Lernprogramme enthalten eine Übersicht über zwei solcher Bibliotheken.</span><span class="sxs-lookup"><span data-stu-id="c1eab-119">The next two tutorials provide an overview of two such libraries.</span></span>


## <a name="executing-code-when-theerrorevent-is-raised"></a><span data-ttu-id="c1eab-120">Ausführen von Code, wenn die`Error`Ereignis wird ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="c1eab-120">Executing Code When The`Error`Event Is Raised</span></span>

<span data-ttu-id="c1eab-121">Ereignisse stellen ein Objekt einen Mechanismus für die signalisieren, dass etwas Interessantes aufgetreten ist und ein weiteres Objekt für die Ausführung von Code in der Antwort bereit.</span><span class="sxs-lookup"><span data-stu-id="c1eab-121">Events provide an object a mechanism for signaling that something interesting has occurred, and for another object to execute code in response.</span></span> <span data-ttu-id="c1eab-122">Als ASP.NET-Entwickler sind Sie daran gewöhnt, dem Aspekt im Hinblick auf Ereignisse.</span><span class="sxs-lookup"><span data-stu-id="c1eab-122">As an ASP.NET developer you are accustomed to thinking in terms of events.</span></span> <span data-ttu-id="c1eab-123">Wenn Sie Code ausführen, wenn der Besucher einer bestimmten klickt möchten, erstellen Sie einen Ereignishandler für der Schaltfläche `Click` Ereignis, und fügen Sie Ihrem Code vorhanden.</span><span class="sxs-lookup"><span data-stu-id="c1eab-123">If you want to run some code when the visitor clicks a particular Button, you create an event handler for that Button's `Click` event and put your code there.</span></span> <span data-ttu-id="c1eab-124">Davon ausgehend, dass die ASP.NET-Laufzeit löst die [ `Error` Ereignis](https://msdn.microsoft.com/library/system.web.httpapplication.error.aspx) immer eine nicht behandelte Ausnahme auftritt, daraus folgt, dass der Code für die Protokollierung der Fehler-Details in einem Ereignishandler gehen würde.</span><span class="sxs-lookup"><span data-stu-id="c1eab-124">Given that the ASP.NET runtime raises its [`Error` event](https://msdn.microsoft.com/library/system.web.httpapplication.error.aspx) whenever an unhandled exception occurs, it follows that the code for logging the error's details would go in an event handler.</span></span> <span data-ttu-id="c1eab-125">Aber wie erstellen Sie einen Ereignishandler für das `Error` Ereignis?</span><span class="sxs-lookup"><span data-stu-id="c1eab-125">But how do you create an event handler for the `Error` event?</span></span>

<span data-ttu-id="c1eab-126">Die `Error` Ereignis ist eines der vielen Ereignisse in der [ `HttpApplication` Klasse](https://msdn.microsoft.com/library/system.web.httpapplication.aspx) , die in bestimmten Phasen in der HTTP-Pipeline während der Lebensdauer einer Anforderung ausgelöst werden.</span><span class="sxs-lookup"><span data-stu-id="c1eab-126">The `Error` event is one of many events in the [`HttpApplication` class](https://msdn.microsoft.com/library/system.web.httpapplication.aspx) that are raised at certain stages in the HTTP pipeline during the lifetime of a request.</span></span> <span data-ttu-id="c1eab-127">Z. B. die `HttpApplication` Klasse [ `BeginRequest` Ereignis](https://msdn.microsoft.com/library/system.web.httpapplication.beginrequest.aspx) wird zu Beginn jeder Anforderung ausgelöst, dessen [ `AuthenticateRequest` Ereignis](https://msdn.microsoft.com/library/system.web.httpapplication.authenticaterequest.aspx) wird ausgelöst, wenn ein Sicherheitsmodul des anforderers ermittelt wurde.</span><span class="sxs-lookup"><span data-stu-id="c1eab-127">For example, the `HttpApplication` class's [`BeginRequest` event](https://msdn.microsoft.com/library/system.web.httpapplication.beginrequest.aspx) is raised at the start of every request; its [`AuthenticateRequest` event](https://msdn.microsoft.com/library/system.web.httpapplication.authenticaterequest.aspx) is raised when a security module has identified the requestor.</span></span> <span data-ttu-id="c1eab-128">Diese `HttpApplication` Ereignisse der Entwickler der Seite bieten eine Möglichkeit, benutzerdefinierten Logik zu verschiedenen Zeitpunkten während der Lebensdauer einer Anforderung ausführen.</span><span class="sxs-lookup"><span data-stu-id="c1eab-128">These `HttpApplication` events give the page developer a means to execute custom logic at the various points in the lifetime of a request.</span></span>

<span data-ttu-id="c1eab-129">Ereignishandler für das `HttpApplication` Ereignisse platziert werden können, in eine spezielle Datei namens `Global.asax`.</span><span class="sxs-lookup"><span data-stu-id="c1eab-129">Event handlers for the `HttpApplication` events can be placed in a special file named `Global.asax`.</span></span> <span data-ttu-id="c1eab-130">Um diese Datei in Ihre Website zu erstellen, fügen Sie ein neues Element in das Stammverzeichnis der Website mithilfe der Globale Anwendungsklasse-Vorlage mit dem Namen `Global.asax`.</span><span class="sxs-lookup"><span data-stu-id="c1eab-130">To create this file in your website, add a new item to the root of your website using the Global Application Class template with the name `Global.asax`.</span></span>

[![](processing-unhandled-exceptions-cs/_static/image2.png)](processing-unhandled-exceptions-cs/_static/image1.png)

<span data-ttu-id="c1eab-131">**Abbildung 1**: Hinzufügen `Global.asax` für Ihre Webanwendung</span><span class="sxs-lookup"><span data-stu-id="c1eab-131">**Figure 1**: Add `Global.asax` To Your Web Application</span></span>  
<span data-ttu-id="c1eab-132">([Klicken Sie hier, um das Bild in voller Größe angezeigt](processing-unhandled-exceptions-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="c1eab-132">([Click to view full-size image](processing-unhandled-exceptions-cs/_static/image3.png))</span></span>

<span data-ttu-id="c1eab-133">Die Struktur und Inhalt der `Global.asax` von Visual Studio erstellte Datei unterscheiden sich geringfügig abhängig, ob Sie eine Web Application Project (WAP) oder die Website-Projekt (WSP) verwenden.</span><span class="sxs-lookup"><span data-stu-id="c1eab-133">The contents and structure of the `Global.asax` file created by Visual Studio differ slightly based on whether you are using a Web Application Project (WAP) or Web Site Project (WSP).</span></span> <span data-ttu-id="c1eab-134">Mit einem WAP der `Global.asax` wird als zwei separate Dateien - implementiert `Global.asax` und `Global.asax.cs`.</span><span class="sxs-lookup"><span data-stu-id="c1eab-134">With a WAP, the `Global.asax` is implemented as two separate files - `Global.asax` and `Global.asax.cs`.</span></span> <span data-ttu-id="c1eab-135">Die `Global.asax` -Datei enthält keine aber ein `@Application` -Direktive, verweist der `.cs` Datei; das Ereignis Handler von Interesse, in definiert sind der `Global.asax.cs` Datei.</span><span class="sxs-lookup"><span data-stu-id="c1eab-135">The `Global.asax` file contains nothing but an `@Application` directive that references the `.cs` file; the event handlers of interest are defined in the `Global.asax.cs` file.</span></span> <span data-ttu-id="c1eab-136">Für WSPs, nur eine einzige Datei erstellt wird, `Global.asax`, und die Ereignishandler werden definiert, einem `<script runat="server">` Block.</span><span class="sxs-lookup"><span data-stu-id="c1eab-136">For WSPs, only a single file is created, `Global.asax`, and the event handlers are defined in a `<script runat="server">` block.</span></span>

<span data-ttu-id="c1eab-137">Die `Global.asax` in einem drahtlosen Zugriffspunkt globale anwendungsklassenvorlage Visual Studio erstellte Datei beinhaltet Ereignishandler, die mit dem Namen `Application_BeginRequest`, `Application_AuthenticateRequest`, und `Application_Error`, wobei es sich um Ereignishandler für die `HttpApplication` Ereignisse `BeginRequest`, `AuthenticateRequest`, und `Error`zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="c1eab-137">The `Global.asax` file created in a WAP by Visual Studio's Global Application Class template includes event handlers named `Application_BeginRequest`, `Application_AuthenticateRequest`, and `Application_Error`, which are event handlers for the `HttpApplication` events `BeginRequest`, `AuthenticateRequest`, and `Error`, respectively.</span></span> <span data-ttu-id="c1eab-138">Es gibt auch Ereignishandler mit dem Namen `Application_Start`, `Session_Start`, `Application_End`, und `Session_End`, welche Ereignishandler, die ausgelöst werden, wenn die Webanwendung startet, wenn eine neue Sitzung gestartet wird, wird am Ende die Anwendung sind, und wenn eine Sitzung beendet wird, bzw.</span><span class="sxs-lookup"><span data-stu-id="c1eab-138">There are also event handlers named `Application_Start`, `Session_Start`, `Application_End`, and `Session_End`, which are event handlers that fire when the web application starts, when a new session starts, when the application ends, and when a session ends, respectively.</span></span> <span data-ttu-id="c1eab-139">Die `Global.asax` Datei in eine WSP von Visual Studio erstellt wurden, enthält nur die `Application_Error`, `Application_Start`, `Session_Start`, `Application_End`, und `Session_End` -Ereignishandler.</span><span class="sxs-lookup"><span data-stu-id="c1eab-139">The `Global.asax` file created in a WSP by Visual Studio contains just the `Application_Error`, `Application_Start`, `Session_Start`, `Application_End`, and `Session_End` event handlers.</span></span>

> [!NOTE]
> <span data-ttu-id="c1eab-140">Wenn Sie die ASP.NET-Anwendung bereitstellen, müssen Sie kopieren die `Global.asax` Datei in der produktionsumgebung.</span><span class="sxs-lookup"><span data-stu-id="c1eab-140">When deploying the ASP.NET application you need to copy the `Global.asax` file to the production environment.</span></span> <span data-ttu-id="c1eab-141">Die `Global.asax.cs` -Datei, die in der WAP erstellt wird, muss nicht in die Produktion kopiert werden, da dieser Code in der Assembly des Projekts kompiliert wird.</span><span class="sxs-lookup"><span data-stu-id="c1eab-141">The `Global.asax.cs` file, which is created in the WAP, does not need to be copied to production because this code is compiled into the project's assembly.</span></span>


<span data-ttu-id="c1eab-142">Die Ereignishandler, die durch Visual Studio Globale Anwendungsklasse Vorlage erstellt wurden, sind nicht vollständig.</span><span class="sxs-lookup"><span data-stu-id="c1eab-142">The event handlers created by Visual Studio's Global Application Class template are not exhaustive.</span></span> <span data-ttu-id="c1eab-143">Sie können einen Ereignishandler hinzufügen, für eine beliebige `HttpApplication` Ereignis durch Benennen des ereignishandlers `Application_EventName`.</span><span class="sxs-lookup"><span data-stu-id="c1eab-143">You can add an event handler for any `HttpApplication` event by naming the event handler `Application_EventName`.</span></span> <span data-ttu-id="c1eab-144">Beispielsweise können Sie den folgenden Code hinzu Hinzufügen der `Global.asax` Datei so erstellen einen Ereignishandler für das [ `AuthorizeRequest` Ereignis](https://msdn.microsoft.com/library/system.web.httpapplication.authorizerequest.aspx):</span><span class="sxs-lookup"><span data-stu-id="c1eab-144">For example, you could add the following code to the `Global.asax` file to create an event handler for the [`AuthorizeRequest` event](https://msdn.microsoft.com/library/system.web.httpapplication.authorizerequest.aspx):</span></span>

[!code-vb[Main](processing-unhandled-exceptions-cs/samples/sample1.vb)]

<span data-ttu-id="c1eab-145">Entsprechend können Sie alle Ereignishandler, die durch die Globale Anwendungsklasse-Vorlage erstellt entfernen, die nicht benötigt werden.</span><span class="sxs-lookup"><span data-stu-id="c1eab-145">Likewise, you can remove any event handlers created by the Global Application Class template that are not needed.</span></span> <span data-ttu-id="c1eab-146">Für dieses Lernprogramm benötigen wir nur einen Ereignishandler für das `Error` Ereignis; gerne So entfernen Sie die anderen Ereignishandler aus der `Global.asax` Datei.</span><span class="sxs-lookup"><span data-stu-id="c1eab-146">For this tutorial we only require an event handler for the `Error` event; feel free to remove the other event handlers from the `Global.asax` file.</span></span>

> [!NOTE]
> <span data-ttu-id="c1eab-147">*HTTP-Module* bieten eine weitere Möglichkeit zum Definieren von Ereignishandlern für `HttpApplication` Ereignisse.</span><span class="sxs-lookup"><span data-stu-id="c1eab-147">*HTTP Modules* offer another way to define event handlers for `HttpApplication` events.</span></span> <span data-ttu-id="c1eab-148">HTTP-Module werden in einer separaten Klassenbibliothek erstellt, als eine Klassendatei, die direkt in das Webanwendungsprojekt platziert oder ausgelagert werden kann.</span><span class="sxs-lookup"><span data-stu-id="c1eab-148">HTTP Modules are created as a class file that can be placed directly within the web application project or separated out into a separate class library.</span></span> <span data-ttu-id="c1eab-149">Da sie in einer Klassenbibliothek ausgelagert werden können, bieten HTTP-Module flexibler und wiederverwendbare Modell zum Erstellen `HttpApplication` -Ereignishandler.</span><span class="sxs-lookup"><span data-stu-id="c1eab-149">Because they can be separated out into a class library, HTTP Modules offer a more flexible and reusable model for creating `HttpApplication` event handlers.</span></span> <span data-ttu-id="c1eab-150">Während der `Global.asax` Datei bezieht sich auf die Webanwendung, in dem er sich befindet, können HTTP-Module in Assemblys, die an diesem Punkt vom HTTP-Modul zu einer Website hinzufügen so einfach ist wie das Löschen der Assemblys in kompiliert werden die `Bin` Ordner und die Registrierung der Modul `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="c1eab-150">Whereas the `Global.asax` file is specific to the web application where it resides, HTTP Modules can be compiled into assemblies, at which point adding the HTTP Module to a website is as simple as dropping the assembly in the `Bin` folder and registering the Module in `Web.config`.</span></span> <span data-ttu-id="c1eab-151">Dieses Lernprogramms sieht nicht zur Erstellung und Verwendung von HTTP-Module, aber die zwei fehlerprotokollierung-Bibliotheken, die in den folgenden zwei Lernprogrammen verwendet werden wie HTTP-Modul implementiert.</span><span class="sxs-lookup"><span data-stu-id="c1eab-151">This tutorial does not look at creating and using HTTP Modules, but the two error logging libraries used in the following two tutorials are implemented as HTTP Modules.</span></span> <span data-ttu-id="c1eab-152">Weitere Hintergrundinformationen zu den Vorteilen der HTTP-Modulen finden Sie unter [mithilfe von HTTP-Module und -Handler austauschbare ASP.NET Komponenten erstellen](https://msdn.microsoft.com/library/aa479332.aspx).</span><span class="sxs-lookup"><span data-stu-id="c1eab-152">For more background on the benefits of HTTP Modules refer to [Using HTTP Modules and Handlers to Create Pluggable ASP.NET Components](https://msdn.microsoft.com/library/aa479332.aspx).</span></span>


## <a name="retrieving-information-about-the-unhandled-exception"></a><span data-ttu-id="c1eab-153">Abrufen von Informationen über die nicht behandelte Ausnahme</span><span class="sxs-lookup"><span data-stu-id="c1eab-153">Retrieving Information About the Unhandled Exception</span></span>

<span data-ttu-id="c1eab-154">An diesem Punkt haben wir eine Datei "Global.asax" mit einer `Application_Error` -Ereignishandler.</span><span class="sxs-lookup"><span data-stu-id="c1eab-154">At this point we have a Global.asax file with an `Application_Error` event handler.</span></span> <span data-ttu-id="c1eab-155">Bei der Ausführung dieser Ereignishandler müssen wir benachrichtigen ein Entwickler des Fehlers, und melden Sie sich die Details.</span><span class="sxs-lookup"><span data-stu-id="c1eab-155">When this event handler executes we need to notify a developer of the error and log its details.</span></span> <span data-ttu-id="c1eab-156">Für diese Aufgaben müssen Sie zuerst die Details der Ausnahme zu bestimmen, die ausgelöst wurde.</span><span class="sxs-lookup"><span data-stu-id="c1eab-156">To accomplish these tasks we first need to determine the details of the exception that was raised.</span></span> <span data-ttu-id="c1eab-157">Verwenden Sie des Serverobjekts [ `GetLastError` Methode](https://msdn.microsoft.com/library/system.web.httpserverutility.getlasterror.aspx) beim Abrufen der Details der nicht behandelten Ausnahme, die aufgrund der `Error` Ereignis ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="c1eab-157">Use the Server object's [`GetLastError` method](https://msdn.microsoft.com/library/system.web.httpserverutility.getlasterror.aspx) to retrieve details of the unhandled exception that caused the `Error` event to fire.</span></span>

[!code-csharp[Main](processing-unhandled-exceptions-cs/samples/sample2.cs)]

<span data-ttu-id="c1eab-158">Die `GetLastError` Methode gibt ein Objekt vom Typ `Exception`, dies ist der Basistyp für alle Ausnahmen in .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="c1eab-158">The `GetLastError` method returns an object of type `Exception`, which is the base type for all exceptions in the .NET Framework.</span></span> <span data-ttu-id="c1eab-159">Der obige Code bin ich jedoch das Ausnahmeobjekt zurückgegebenes Umwandlung `GetLastError` in ein `HttpException` Objekt.</span><span class="sxs-lookup"><span data-stu-id="c1eab-159">However, in the code above I am casting the Exception object returned by `GetLastError` into an `HttpException` object.</span></span> <span data-ttu-id="c1eab-160">Wenn die `Error` Ereignis wird ausgelöst wird, da bei der Verarbeitung einer Ressource ASP.NET eine Ausnahme ausgelöst wurde, und klicken Sie dann die ausgelöste Ausnahme umschlossen ist ein `HttpException`.</span><span class="sxs-lookup"><span data-stu-id="c1eab-160">If the `Error` event is being fired because an exception was thrown during the processing of an ASP.NET resource then the exception that was thrown is wrapped within an `HttpException`.</span></span> <span data-ttu-id="c1eab-161">Um die eigentliche Ausnahme abzurufen, die die Verwendung der Fehler Ereignis unmittelbar vorausging der `InnerException` Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="c1eab-161">To get the actual exception that precipitated the Error event use the `InnerException` property.</span></span> <span data-ttu-id="c1eab-162">Wenn die `Error` Ereignis ausgelöst wurde aufgrund einer Ausnahme HTTP-basierte z. B. eine Anforderung für eine nicht existierende-Seite, ein `HttpException` ausgelöst wird, aber sie verfügt nicht über eine interne Ausnahme.</span><span class="sxs-lookup"><span data-stu-id="c1eab-162">If the `Error` event was raised because of an HTTP-based exception, such as a request for a non-existent page, an `HttpException` is thrown, but it does not have an inner exception.</span></span>

<span data-ttu-id="c1eab-163">Der folgende code verwendet die `GetLastErrormessage` zum Abrufen von Informationen über die Ausnahme, die ausgelöst der `Error` Ereignis, das Speichern von der `HttpException` in einer Variablen namens `lastErrorWrapper`.</span><span class="sxs-lookup"><span data-stu-id="c1eab-163">The following code uses the `GetLastErrormessage` to retrieve information about the exception that triggered the `Error` event, storing the `HttpException` in a variable named `lastErrorWrapper`.</span></span> <span data-ttu-id="c1eab-164">Es speichert der Typ, die Meldung und die stapelüberwachung der ursprünglichen Ausnahme in drei Zeichenfolgenvariablen, die überprüft wird, wenn die `lastErrorWrapper` die eigentliche Ausnahme, die ausgelöst wird die `Error` Ereignis (im Fall von HTTP-basierte Ausnahmen) oder wenn sie lediglich eine Wrapper für eine Ausnahme, die beim Verarbeiten der Anforderung ausgelöst wurde.</span><span class="sxs-lookup"><span data-stu-id="c1eab-164">It then stores the type, message, and stack trace of the originating exception in three string variables, checking to see if the `lastErrorWrapper` is the actual exception that triggered the `Error` event (in the case of HTTP-based exceptions) or if it's merely a wrapper for an exception that was thrown while processing the request.</span></span>

[!code-csharp[Main](processing-unhandled-exceptions-cs/samples/sample3.cs)]

<span data-ttu-id="c1eab-165">An diesem Punkt haben Sie die Informationen, dass Sie Code schreiben, die die Details der Ausnahme in einer Datenbanktabelle protokolliert werden müssen.</span><span class="sxs-lookup"><span data-stu-id="c1eab-165">At this point you have all the information you need to write code that will log the exception's details to a database table.</span></span> <span data-ttu-id="c1eab-166">Sie können eine Datenbanktabelle mit Spalten aller relevanten - Typ, der Nachricht, die stapelüberwachung und usw. - sowie andere nützliche Informationen, z. B. die URL der angeforderten Seite und den Namen des aktuell angemeldeten Benutzers die Fehlerdetails erstellen.</span><span class="sxs-lookup"><span data-stu-id="c1eab-166">You could create a database table with columns for each of the error details of interest - the type, the message, the stack trace, and so on - along with other useful pieces of information, such as the URL of the requested page and the name of the currently logged on user.</span></span> <span data-ttu-id="c1eab-167">In der `Application_Error` Ereignishandler anschließend eine Verbindung mit der Datenbank herstellen und einen Datensatz in die Tabelle eingefügt.</span><span class="sxs-lookup"><span data-stu-id="c1eab-167">In the `Application_Error` event handler you would then connect to the database and insert a record into the table.</span></span> <span data-ttu-id="c1eab-168">Ebenso können Sie Code, damit ein Entwickler des Fehlers per e-Mail benachrichtigt werden, hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="c1eab-168">Likewise, you could add code to alert a developer of the error via email.</span></span>

<span data-ttu-id="c1eab-169">Der Fehler protokollierungsbibliotheken, die in den nächsten beiden Lernprogramme untersucht bieten solche Funktionen ausgegeben, daher keine Notwendigkeit besteht, diese Fehler protokollieren und die Benachrichtigung selbst erstellen.</span><span class="sxs-lookup"><span data-stu-id="c1eab-169">The error logging libraries examined in the next two tutorials provide such functionality out of the box, so there's no need to build this error logging and notification yourself.</span></span> <span data-ttu-id="c1eab-170">Allerdings an, die veranschaulichen die `Error` Ereignis ausgelöst wird und dass die `Application_Error` -Ereignishandler kann verwendet werden, melden Sie sich Details zum Systemfehler und einen Entwickler zu benachrichtigen, fügen Sie Code, der einen Entwickler benachrichtigt, wenn ein Fehler auftritt.</span><span class="sxs-lookup"><span data-stu-id="c1eab-170">However, to illustrate that the `Error` event is being raised and that the `Application_Error` event handler can be used to log error details and notify a developer, let's add code that notifies a developer when an error occurs.</span></span>

## <a name="notifying-a-developer-when-an-unhandled-exception-occurs"></a><span data-ttu-id="c1eab-171">Einen Entwickler benachrichtigen, wenn eine nicht behandelte Ausnahme auftritt.</span><span class="sxs-lookup"><span data-stu-id="c1eab-171">Notifying a Developer When an Unhandled Exception Occurs</span></span>

<span data-ttu-id="c1eab-172">Tritt eine nicht behandelte Ausnahme in der produktionsumgebung ist es wichtig, um das Entwicklungsteam informieren und sie können den Fehler zu bewerten und bestimmen, welche Aktionen ausgeführt werden müssen.</span><span class="sxs-lookup"><span data-stu-id="c1eab-172">When an unhandled exception occurs in the production environment it is important to alert the development team so that they can assess the error and determine what actions need to be taken.</span></span> <span data-ttu-id="c1eab-173">Beispielsweise ist ein Fehler in Verbindung mit der Datenbank aufweist, müssen Sie nach double überprüfen Sie Ihre Verbindungszeichenfolge und, öffnen Sie ein Support-Ticket ggf. mit Ihrem Webhosting.</span><span class="sxs-lookup"><span data-stu-id="c1eab-173">For example, if there is an error in connecting to the database then you'll need to double check your connection string and, perhaps, open a support ticket with your web hosting company.</span></span> <span data-ttu-id="c1eab-174">Wenn die Ausnahme aufgrund einer Programmierfehler aufgetreten ist, kein zusätzlicher Code oder Validierungslogik müssen möglicherweise hinzugefügt werden, um solche Fehler in Zukunft zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="c1eab-174">If the exception occurred because of a programming error, additional code or validation logic may need to be added to prevent such errors in the future.</span></span>

<span data-ttu-id="c1eab-175">Die .NET Framework-Klassen der [ `System.Net.Mail` Namespace](https://msdn.microsoft.com/library/system.net.mail.aspx) können sie einfach eine e-Mail zu senden.</span><span class="sxs-lookup"><span data-stu-id="c1eab-175">The .NET Framework classes in the [`System.Net.Mail` namespace](https://msdn.microsoft.com/library/system.net.mail.aspx) make it easy to send an email.</span></span> <span data-ttu-id="c1eab-176">Die [ `MailMessage` Klasse](https://msdn.microsoft.com/library/system.net.mail.mailmessage.aspx) stellt eine e-Mail-Nachricht und verfügt über Eigenschaften, z. B. `To`, `From`, `Subject`, `Body`, und `Attachments`.</span><span class="sxs-lookup"><span data-stu-id="c1eab-176">The [`MailMessage` class](https://msdn.microsoft.com/library/system.net.mail.mailmessage.aspx) represents an email message and has properties like `To`, `From`, `Subject`, `Body`, and `Attachments`.</span></span> <span data-ttu-id="c1eab-177">Die `SmtpClass` dient zum Senden einer `MailMessage` -Objekt mit einem angegebenen SMTP-Server, die SMTP-servereinstellungen können programmgesteuert oder deklarativ in angegeben werden die [ `<system.net>` Element](https://msdn.microsoft.com/library/6484zdc1.aspx) in der `Web.config file`.</span><span class="sxs-lookup"><span data-stu-id="c1eab-177">The `SmtpClass` is used to send a `MailMessage` object using a specified SMTP server; the SMTP server settings can be specified programmatically or declaratively in the [`<system.net>` element](https://msdn.microsoft.com/library/6484zdc1.aspx) in the `Web.config file`.</span></span> <span data-ttu-id="c1eab-178">Weitere Informationen zum Senden von e-Mail Nachrichten in einer ASP.NET-Anwendung sehen Sie sich meine Artikel [Senden von E-Mails in ASP.NET](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx), und die [System.Net.Mail FAQ](http://systemnetmail.com/).</span><span class="sxs-lookup"><span data-stu-id="c1eab-178">For more information on sending email messages in an ASP.NET application check out my article, [Sending Email in ASP.NET](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx), and the [System.Net.Mail FAQ](http://systemnetmail.com/).</span></span>

> [!NOTE]
> <span data-ttu-id="c1eab-179">Die `<system.net>` Element enthält die SMTP-servereinstellungen verwendet, durch die `SmtpClient` -Klasse beim Senden einer e-Mail.</span><span class="sxs-lookup"><span data-stu-id="c1eab-179">The `<system.net>` element contains the SMTP server settings used by the `SmtpClient` class when sending an email.</span></span> <span data-ttu-id="c1eab-180">Ihrem Webhosting wahrscheinlich verfügt über einen SMTP-Server, den Sie zum Senden von e-Mails von Ihrer Anwendung verwenden können.</span><span class="sxs-lookup"><span data-stu-id="c1eab-180">Your web hosting company likely has an SMTP server that you can use to send email from your application.</span></span> <span data-ttu-id="c1eab-181">Wenden Sie sich an Ihre Webhost-Unterstützung im Abschnitt Informationen auf den SMTP-Server-Einstellungen, die Sie in der Webanwendung verwenden soll.</span><span class="sxs-lookup"><span data-stu-id="c1eab-181">Consult your web host's support section for information on the SMTP server settings you should use in your web application.</span></span>


<span data-ttu-id="c1eab-182">Fügen Sie folgenden Code, der `Application_Error` -Ereignishandler, um einem Entwickler eine e-Mail zu senden, wenn ein Fehler auftritt:</span><span class="sxs-lookup"><span data-stu-id="c1eab-182">Add the following code to the `Application_Error` event handler to send a developer an email when an error occurs:</span></span>

[!code-csharp[Main](processing-unhandled-exceptions-cs/samples/sample4.cs)]

<span data-ttu-id="c1eab-183">Während der obige Code ziemlich umfassend ist, erstellt es der Großteil den HTML-Code, der angezeigt wird in der e-Mail, die dem Entwickler gesendet.</span><span class="sxs-lookup"><span data-stu-id="c1eab-183">While the above code is quite lengthy, the bulk of it creates the HTML that appears in the email sent to the developer.</span></span> <span data-ttu-id="c1eab-184">Der Code durch Verweisen auf startet die `HttpException` zurückgegebenes der `GetLastError` Methode (`lastErrorWrapper`).</span><span class="sxs-lookup"><span data-stu-id="c1eab-184">The code starts by referencing the `HttpException` returned by the `GetLastError` method (`lastErrorWrapper`).</span></span> <span data-ttu-id="c1eab-185">Die eigentliche Ausnahme, die von der Anforderung ausgelöst wurde, wird über abgerufen `lastErrorWrapper.InnerException` und der Variablen zugewiesen `lastError`.</span><span class="sxs-lookup"><span data-stu-id="c1eab-185">The actual exception that was raised by the request is retrieved via `lastErrorWrapper.InnerException` and is assigned to the variable `lastError`.</span></span> <span data-ttu-id="c1eab-186">Der Typ, die Nachricht und den Stack Ablaufverfolgungsinformationen entnommen `lastError` und in drei Zeichenfolgenvariablen gespeichert.</span><span class="sxs-lookup"><span data-stu-id="c1eab-186">The type, message, and stack trace information is retrieved from `lastError` and stored in three string variables.</span></span>

<span data-ttu-id="c1eab-187">Als Nächstes wird ein `MailMessage` Objekt mit dem Namen `mm` wird erstellt.</span><span class="sxs-lookup"><span data-stu-id="c1eab-187">Next, a `MailMessage` object named `mm` is created.</span></span> <span data-ttu-id="c1eab-188">E-Mail-Text ist HTML-formatierte und zeigt die URL der angeforderten Seite, den Namen der derzeit angemeldete Benutzer und Informationen zur Ausnahme (Typ, Nachrichten und stapelüberwachung).</span><span class="sxs-lookup"><span data-stu-id="c1eab-188">The email body is HTML formatted and displays the URL of the requested page, the name of the currently logged on user, and information about the exception (the type, message, and stack trace).</span></span> <span data-ttu-id="c1eab-189">Eine der Coolbar Aufgaben zu den `HttpException` Klasse ist, dass Sie den HTML-Code verwendet, um die Ausnahme Details gelben Bildschirm des Tod (YSOD) zu erstellen, indem generieren können die [GetHtmlErrorMessage-Methode](https://msdn.microsoft.com/library/system.web.httpexception.gethtmlerrormessage.aspx).</span><span class="sxs-lookup"><span data-stu-id="c1eab-189">One of the cool things about the `HttpException` class is that you can generate the HTML used to create the Exception Details Yellow Screen of Death (YSOD) by calling the [GetHtmlErrorMessage method](https://msdn.microsoft.com/library/system.web.httpexception.gethtmlerrormessage.aspx).</span></span> <span data-ttu-id="c1eab-190">Diese Methode wird hier verwendet, die Ausnahme Details YSOD Markup abrufen und an die e-Mail als Anlage hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="c1eab-190">This method is used here to retrieve the Exception Details YSOD markup and add it to the email as an attachment.</span></span> <span data-ttu-id="c1eab-191">Vorsicht: Wenn die Ausnahme, die ausgelöst der `Error` Ereignis ist ein HTTP-basierte Ausnahmefehler (z. B. eine Anforderung für eine nicht existierende-Seite) und dann die `GetHtmlErrorMessage` Methode zurück `null`.</span><span class="sxs-lookup"><span data-stu-id="c1eab-191">One word of caution: if the exception that triggered the `Error` event was an HTTP-based exception (such as a request for a non-existent page) then the `GetHtmlErrorMessage` method will return `null`.</span></span>

<span data-ttu-id="c1eab-192">Der letzte Schritt ist zum Senden der `MailMessage`.</span><span class="sxs-lookup"><span data-stu-id="c1eab-192">The final step is to send the `MailMessage`.</span></span> <span data-ttu-id="c1eab-193">Dies erfolgt durch Erstellen eines neuen `SmtpClient` -Methode und der Aufruf der `Send` Methode.</span><span class="sxs-lookup"><span data-stu-id="c1eab-193">This is done by creating a new `SmtpClient` method and calling its `Send` method.</span></span>

> [!NOTE]
> <span data-ttu-id="c1eab-194">Bevor Sie diesen Code in der Webanwendung verwenden soll so ändern Sie die Werte in der `ToAddress` und `FromAddress` Konstanten aus support@example.com zu Ihrem e-Mail-Adresse der e-Mail-Fehler-Benachrichtigung gesendet werden soll, um und stammen aus.</span><span class="sxs-lookup"><span data-stu-id="c1eab-194">Before using this code in your web application you'll want to change the values in the `ToAddress` and `FromAddress` constants from support@example.com to whatever email address the error notification email should be sent to and originate from.</span></span> <span data-ttu-id="c1eab-195">Sie müssen auch an SMTP-servereinstellungen in der `<system.net>` im Abschnitt `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="c1eab-195">You'll also need to specify SMTP server settings in the `<system.net>` section in `Web.config`.</span></span> <span data-ttu-id="c1eab-196">Wenden Sie sich an Ihre Webhostinganbieter aus, um zu bestimmen, die SMTP-servereinstellungen zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="c1eab-196">Consult your web host provider to determine the SMTP server settings to use.</span></span>


<span data-ttu-id="c1eab-197">Mit diesem Code werden jedes Mal, wenn ein Fehler vorliegt wird der Entwickler eine e-Mail-Nachricht gesendet, die den Fehler zusammengefasst und enthält die YSOD.</span><span class="sxs-lookup"><span data-stu-id="c1eab-197">With this code in place anytime there's an error the developer is sent an email message that summarizes the error and includes the YSOD.</span></span> <span data-ttu-id="c1eab-198">In dem vorherigen Lernprogramm veranschaulicht wir einen Laufzeitfehler durch Genre.aspx besuchen, und übergeben ein ungültiges `ID` Wert über die Abfragezeichenfolge, z. B. `Genre.aspx?ID=foo`.</span><span class="sxs-lookup"><span data-stu-id="c1eab-198">In the preceding tutorial we demonstrated a runtime error by visiting Genre.aspx and passing in an invalid `ID` value through the querystring, like `Genre.aspx?ID=foo`.</span></span> <span data-ttu-id="c1eab-199">Besuchen die Seite mit den `Global.asax` Datei direkt erzeugt die gleiche benutzererfahrung, wie im vorherigen Lernprogramm - in der Entwicklungsumgebung auch Ausnahme Details gelben Bildschirm des Tod, weiterhin müssen während in der produktionsumgebung Sie müssen finden Sie die benutzerdefinierte Fehlerseite aus.</span><span class="sxs-lookup"><span data-stu-id="c1eab-199">Visiting the page with the `Global.asax` file in place produces the same user experience as in the preceding tutorial - in the development environment you'll continue to see the Exception Details Yellow Screen of Death, while in the production environment you'll see the custom error page.</span></span> <span data-ttu-id="c1eab-200">Zusätzlich zu diesen bereits bestehendem Verhalten wird der Entwickler eine e-Mail gesendet.</span><span class="sxs-lookup"><span data-stu-id="c1eab-200">In addition to this existing behavior, the developer is sent an email.</span></span>

<span data-ttu-id="c1eab-201">**Abbildung 2** zeigt die e-Mail empfangen, wenn das Unternehmen besuchende `Genre.aspx?ID=foo`.</span><span class="sxs-lookup"><span data-stu-id="c1eab-201">**Figure 2** shows the email received when visiting `Genre.aspx?ID=foo`.</span></span> <span data-ttu-id="c1eab-202">E-Mail-Text werden zusammengefasst, die Ausnahmeinformationen, während die `YSOD.htm` Anlage zeigt den Inhalt, der in der Ausnahme Details YSOD angezeigt wird (finden Sie unter **Abbildung 3**).</span><span class="sxs-lookup"><span data-stu-id="c1eab-202">The email body summarizes the exception information, while the `YSOD.htm` attachment displays the content that is shown in the Exception Details YSOD (see **Figure 3**).</span></span>

[![](processing-unhandled-exceptions-cs/_static/image5.png)](processing-unhandled-exceptions-cs/_static/image4.png)

<span data-ttu-id="c1eab-203">**Abbildung 2**: der Entwickler wird eine e-Mail-Benachrichtigung gesendet, wenn eine nicht behandelte Ausnahme aufgetreten ist</span><span class="sxs-lookup"><span data-stu-id="c1eab-203">**Figure 2**: The Developer Is Sent An Email Notification Whenever There's An Unhandled Exception</span></span>  
<span data-ttu-id="c1eab-204">([Klicken Sie hier, um das Bild in voller Größe angezeigt](processing-unhandled-exceptions-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="c1eab-204">([Click to view full-size image](processing-unhandled-exceptions-cs/_static/image6.png))</span></span>

[![](processing-unhandled-exceptions-cs/_static/image8.png)](processing-unhandled-exceptions-cs/_static/image7.png)

<span data-ttu-id="c1eab-205">**Abbildung 3**: die e-Mail-Benachrichtigung enthält die Details der Ausnahme YSOD als Anlage</span><span class="sxs-lookup"><span data-stu-id="c1eab-205">**Figure 3**: The Email Notification Includes the Exception Details YSOD As An Attachment</span></span>  
<span data-ttu-id="c1eab-206">([Klicken Sie hier, um das Bild in voller Größe angezeigt](processing-unhandled-exceptions-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="c1eab-206">([Click to view full-size image](processing-unhandled-exceptions-cs/_static/image9.png))</span></span>

## <a name="what-about-using-the-custom-error-page"></a><span data-ttu-id="c1eab-207">Was können Sie verwenden die benutzerdefinierte Fehlerseite?</span><span class="sxs-lookup"><span data-stu-id="c1eab-207">What About Using the Custom Error Page?</span></span>

<span data-ttu-id="c1eab-208">Dieses Lernprogramm wurde gezeigt, wie `Global.asax` und `Application_Error` Ereignishandler zum Ausführen von Code, wenn eine nicht behandelte Ausnahme auftritt.</span><span class="sxs-lookup"><span data-stu-id="c1eab-208">This tutorial showed how to use `Global.asax` and the `Application_Error` event handler to execute code when an unhandled exception occurs.</span></span> <span data-ttu-id="c1eab-209">Insbesondere können wurde dieser Ereignishandler verwendet, um ein Entwickler einen Fehler zu informieren; Wir waren, um auch melden Sie sich die Fehlerdetails in einer Datenbank zu erweitern.</span><span class="sxs-lookup"><span data-stu-id="c1eab-209">Specifically, we used this event handler to notify a developer of an error; we could extend it to also log the error details in a database.</span></span> <span data-ttu-id="c1eab-210">Das Vorhandensein der `Application_Error` Ereignishandler wirkt sich nicht auf die Erfahrung des Endbenutzers.</span><span class="sxs-lookup"><span data-stu-id="c1eab-210">The presence of the `Application_Error` event handler does not affect the end user's experience.</span></span> <span data-ttu-id="c1eab-211">Sie sehen immer noch die konfigurierten Fehlerseite, es sich um den Fehler Details YSOD, YSOD der Common Language Runtime-Fehler oder die benutzerdefinierte Fehlerseite sein.</span><span class="sxs-lookup"><span data-stu-id="c1eab-211">They still see the configured error page, be it the Error Details YSOD, the Runtime Error YSOD, or the custom error page.</span></span>

<span data-ttu-id="c1eab-212">Es ist natürlich weiß, ob die `Global.asax` Datei und `Application_Error` Ereignis ist erforderlich, wenn Sie eine benutzerdefinierte Fehlerseite verwenden.</span><span class="sxs-lookup"><span data-stu-id="c1eab-212">It's natural to wonder whether the `Global.asax` file and `Application_Error` event is necessary when using a custom error page.</span></span> <span data-ttu-id="c1eab-213">Wenn ein Fehler auftritt, wird die benutzerdefinierte Fehlerseite für den Benutzer angezeigt also Warum kann nicht wir platzieren Sie den Code vom Entwickler zu benachrichtigen und protokollieren die Fehlerdetails in die CodeBehind-Klasse, der die benutzerdefinierte Fehlerseite?</span><span class="sxs-lookup"><span data-stu-id="c1eab-213">When an error occurs the user is shown the custom error page so why can't we put the code to notify the developer and log the error details into the code-behind class of the custom error page?</span></span> <span data-ttu-id="c1eab-214">Während Sie die benutzerdefinierte Fehlerseite Code-Behind-Klasse sicherlich Code hinzufügen können Sie keinen Zugriff auf die Details der Ausnahme, die ausgelöst der `Error` Ereignis aus, wenn das Verfahren verwenden wir im vorherigen Lernprogramm untersucht.</span><span class="sxs-lookup"><span data-stu-id="c1eab-214">While you can certainly add code to the custom error page's code-behind class you do not have access to the details of the exception that triggered the `Error` event when using the technique we explored in the preceding tutorial.</span></span> <span data-ttu-id="c1eab-215">Aufrufen der `GetLastError` über die benutzerdefinierte Fehlerseite Methodenrückgabe `Nothing`.</span><span class="sxs-lookup"><span data-stu-id="c1eab-215">Calling the `GetLastError` method from the custom error page returns `Nothing`.</span></span>

<span data-ttu-id="c1eab-216">Der Grund für dieses Verhalten ist, da die benutzerdefinierte Fehlerseite über eine Umleitung erreicht ist.</span><span class="sxs-lookup"><span data-stu-id="c1eab-216">The reason for this behavior is because the custom error page is reached via a redirect.</span></span> <span data-ttu-id="c1eab-217">Löst aus, wenn eine nicht behandelte Ausnahme der ASP.NET-Laufzeit die Engine ASP.NET erreicht ihre `Error` Ereignis (das ausgeführt wird die `Application_Error` Ereignishandler) und dann *leitet* der Benutzer die benutzerdefinierte Fehlerseite durch Ausgeben einer `Response.Redirect(customErrorPageUrl)`.</span><span class="sxs-lookup"><span data-stu-id="c1eab-217">When an unhandled exception reaches the ASP.NET runtime the ASP.NET engine raises its `Error` event (which executes the `Application_Error` event handler) and then *redirects* the user to the custom error page by issuing a `Response.Redirect(customErrorPageUrl)`.</span></span> <span data-ttu-id="c1eab-218">Die `Response.Redirect` Methode sendet eine Antwort an den Client mit einem HTTP 302-Statuscode angewiesen wird, den Browser, um eine neue URL, d. h. die benutzerdefinierte Fehlerseite anfordern.</span><span class="sxs-lookup"><span data-stu-id="c1eab-218">The `Response.Redirect` method sends a response to the client with an HTTP 302 status code, instructing the browser to request a new URL, namely the custom error page.</span></span> <span data-ttu-id="c1eab-219">Der Browser fordert dann automatisch diese neue Seite.</span><span class="sxs-lookup"><span data-stu-id="c1eab-219">The browser then automatically requests this new page.</span></span> <span data-ttu-id="c1eab-220">Sie können feststellen, dass die benutzerdefinierte Fehlerseite separat angefordert wurde, auf der Seite, in dem der Fehler aufgetreten, da sich der Adressleiste des Browsers auf der Seite benutzerdefinierte Fehler-URL ändert (siehe **Abbildung 4**).</span><span class="sxs-lookup"><span data-stu-id="c1eab-220">You can tell that the custom error page was requested separately from the page where the error originated because the browser's Address bar changes to the custom error page URL (see **Figure 4**).</span></span>

[![](processing-unhandled-exceptions-cs/_static/image11.png)](processing-unhandled-exceptions-cs/_static/image10.png)

<span data-ttu-id="c1eab-221">**Abbildung 4**: Wenn ein Fehler auftritt, der Browser ruft umgeleitet, um die URL der benutzerdefinierten Fehler angezeigt</span><span class="sxs-lookup"><span data-stu-id="c1eab-221">**Figure 4**: When an Error Occurs the Browser Gets Redirected to the Custom Error Page URL</span></span>  
<span data-ttu-id="c1eab-222">([Klicken Sie hier, um das Bild in voller Größe angezeigt](processing-unhandled-exceptions-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="c1eab-222">([Click to view full-size image](processing-unhandled-exceptions-cs/_static/image12.png))</span></span>

<span data-ttu-id="c1eab-223">Im Endeffekt ist, antwortet der Server mit HTTP 302-Umleitung endet mit die Anforderung, in die nicht behandelte Ausnahme aufgetreten ist.</span><span class="sxs-lookup"><span data-stu-id="c1eab-223">The net effect is that the request where the unhandled exception occurred ends when the server responds with the HTTP 302 redirect.</span></span> <span data-ttu-id="c1eab-224">Die nachfolgende Anforderung an die benutzerdefinierte Fehlerseite ist eine völlig neue Anforderung. zu diesem Zeitpunkt ASP.NET Datenbankmodul hat die Fehlerinformationen verworfen und darüber hinaus hat keine Möglichkeit, die neue Anforderung für die benutzerdefinierte Fehlerseite die nicht behandelte Ausnahme in der vorherigen Anforderung zugeordnet werden soll.</span><span class="sxs-lookup"><span data-stu-id="c1eab-224">The subsequent request to the custom error page is a brand new request; by this point the ASP.NET engine has discarded the error information and, moreover, has no way to associate the unhandled exception in the previous request with the new request for the custom error page.</span></span> <span data-ttu-id="c1eab-225">Deswegen `GetLastError` gibt `null` beim Aufrufen durch die benutzerdefinierte Fehlerseite.</span><span class="sxs-lookup"><span data-stu-id="c1eab-225">This is why `GetLastError` returns `null` when called from the custom error page.</span></span>

<span data-ttu-id="c1eab-226">Allerdings ist es möglich, dass die benutzerdefinierte Fehlerseite ausgeführt, während der gleichen Anforderung, die den Fehler verursacht hat.</span><span class="sxs-lookup"><span data-stu-id="c1eab-226">However, it is possible to have the custom error page executed during the same request that caused the error.</span></span> <span data-ttu-id="c1eab-227">Die [ `Server.Transfer(url)` ](https://msdn.microsoft.com/library/system.web.httpserverutility.transfer.aspx) Methode übergibt die Ausführung an der angegebenen URL und innerhalb der gleichen Anforderung verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="c1eab-227">The [`Server.Transfer(url)`](https://msdn.microsoft.com/library/system.web.httpserverutility.transfer.aspx) method transfers execution to the specified URL and processes it within the same request.</span></span> <span data-ttu-id="c1eab-228">Konnte, verschieben Sie den Code in der `Application_Error` -Ereignishandler, um die benutzerdefinierte Fehlerseite CodeBehind-Klasse, und Ersetzen Sie dabei in `Global.asax` durch den folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="c1eab-228">You could move the code in the `Application_Error` event handler to the custom error page's code-behind class, replacing it in `Global.asax` with the following code:</span></span>

[!code-csharp[Main](processing-unhandled-exceptions-cs/samples/sample5.cs)]

<span data-ttu-id="c1eab-229">Wenn nun eine nicht behandelte Ausnahme auftritt der `Application_Error` Ereignishandler überträgt die Steuerung an die entsprechende benutzerdefinierte Fehlerseite basierend auf den HTTP-Statuscode.</span><span class="sxs-lookup"><span data-stu-id="c1eab-229">Now when an unhandled exception occurs the `Application_Error` event handler transfers control to the appropriate custom error page based on the HTTP status code.</span></span> <span data-ttu-id="c1eab-230">Da die Steuerung wurde, hat die benutzerdefinierte Fehlerseite Zugriff auf die Informationen nicht behandelte Ausnahme über `Server.GetLastError` können Entwickler den Fehler benachrichtigen und melden Sie sich die Details.</span><span class="sxs-lookup"><span data-stu-id="c1eab-230">Because control was transferred, the custom error page has access to the unhandled exception information via `Server.GetLastError` and can notify a developer of the error and log its details.</span></span> <span data-ttu-id="c1eab-231">Die `Server.Transfer` Aufruf beendet das Modul für ASP.NET aus Weiterleiten des Benutzers an die benutzerdefinierte Fehlerseite.</span><span class="sxs-lookup"><span data-stu-id="c1eab-231">The `Server.Transfer` call stops the ASP.NET engine from redirecting the user to the custom error page.</span></span> <span data-ttu-id="c1eab-232">Stattdessen wird die benutzerdefinierte Fehlerseite Inhalt als Antwort auf der Seite "zurückgegeben, die den Fehler generiert hat.</span><span class="sxs-lookup"><span data-stu-id="c1eab-232">Instead, the custom error page's content is returned as the response to the page that generated the error.</span></span>

## <a name="summary"></a><span data-ttu-id="c1eab-233">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="c1eab-233">Summary</span></span>

<span data-ttu-id="c1eab-234">Tritt eine nicht behandelte Ausnahme in eine ASP.NET-Webanwendung löst die ASP.NET-Laufzeit die `Error` Ereignis und die konfigurierten Fehlerseite angezeigt.</span><span class="sxs-lookup"><span data-stu-id="c1eab-234">When an unhandled exception occurs in an ASP.NET web application the ASP.NET runtime raises the `Error` event and displays the configured error page.</span></span> <span data-ttu-id="c1eab-235">Es kann den Entwickler den Fehler benachrichtigen. Melden Sie sich die Details, oder auf andere Weise verarbeitet werden, indem Sie einen Ereignishandler für das Error-Ereignis erstellen.</span><span class="sxs-lookup"><span data-stu-id="c1eab-235">We can notify the developer of the error, log its details, or process it in some other fashion, by creating an event handler for the Error event.</span></span> <span data-ttu-id="c1eab-236">Es gibt zwei Möglichkeiten, erstellen Sie einen Ereignishandler für `HttpApplication` Ereignisse wie `Error`: in der `Global.asax` Datei oder aus einem HTTP-Modul.</span><span class="sxs-lookup"><span data-stu-id="c1eab-236">There are two ways to create an event handler for `HttpApplication` events like `Error`: in the `Global.asax` file or from an HTTP Module.</span></span> <span data-ttu-id="c1eab-237">Dieses Lernprogramm wurde gezeigt, wie zum Erstellen einer `Error` -Ereignishandler in der `Global.asax` -Datei, die Entwicklern einen Fehler mithilfe einer e-Mail-Nachricht benachrichtigt.</span><span class="sxs-lookup"><span data-stu-id="c1eab-237">This tutorial showed how to create an `Error` event handler in the `Global.asax` file that notifies developers of an error by means of an email message.</span></span>

<span data-ttu-id="c1eab-238">Erstellen einer `Error` -Ereignishandler ist nützlich, wenn nicht behandelte Ausnahmen in eine eindeutige oder angepasste Weise verarbeitet werden muss.</span><span class="sxs-lookup"><span data-stu-id="c1eab-238">Creating an `Error` event handler is useful if you need to process unhandled exceptions in some unique or customized manner.</span></span> <span data-ttu-id="c1eab-239">Allerdings Erstellung Ihres eigenen `Error` -Ereignishandler protokolliert die Ausnahme oder einen Entwickler zu benachrichtigen ist nicht die effizienteste Nutzung Ihrer Zeit in Anspruch, da es bereits vorhanden sind kostenlos und einfach zu verwendende Fehler protokollierungsbibliotheken, die von Setup in wenigen Minuten werden können.</span><span class="sxs-lookup"><span data-stu-id="c1eab-239">However, creating your own `Error` event handler to log the exception or to notify a developer is not the most efficient use of your time as there already exist free and easy to use error logging libraries that can be setup in a matter of minutes.</span></span> <span data-ttu-id="c1eab-240">Die nächsten beiden Lernprogramme untersuchen zwei diese Bibliotheken.</span><span class="sxs-lookup"><span data-stu-id="c1eab-240">The next two tutorials examine two such libraries.</span></span>

<span data-ttu-id="c1eab-241">Viel Spaß beim Programmieren!</span><span class="sxs-lookup"><span data-stu-id="c1eab-241">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="c1eab-242">Weiterführende Themen</span><span class="sxs-lookup"><span data-stu-id="c1eab-242">Further Reading</span></span>

<span data-ttu-id="c1eab-243">Weitere Informationen zu den Themen in diesem Lernprogramm erläutert finden Sie in den folgenden Ressourcen:</span><span class="sxs-lookup"><span data-stu-id="c1eab-243">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="c1eab-244">ASP.NET HTTP-Module und HTTP-Handler (Übersicht)</span><span class="sxs-lookup"><span data-stu-id="c1eab-244">ASP.NET HTTP Modules and HTTP Handlers Overview</span></span>](https://support.microsoft.com/kb/307985)
- [<span data-ttu-id="c1eab-245">Ordnungsgemäß reagieren auf nicht behandelte Ausnahmen - Verarbeitung von nicht behandelten Ausnahmen</span><span class="sxs-lookup"><span data-stu-id="c1eab-245">Gracefully Responding to Unhandled Exceptions - Processing Unhandled Exceptions</span></span>](http://aspnet.4guysfromrolla.com/articles/091306-1.aspx)
- [<span data-ttu-id="c1eab-246">`HttpApplication`Klasse und das Anwendungsobjekt ASP.NET</span><span class="sxs-lookup"><span data-stu-id="c1eab-246">`HttpApplication` Class and the ASP.NET Application Object</span></span>](http://www.eggheadcafe.com/articles/20030211.asp)
- [<span data-ttu-id="c1eab-247">HTTP-Handler und HTTP-Module in ASP.NET</span><span class="sxs-lookup"><span data-stu-id="c1eab-247">HTTP Handlers and HTTP Modules in ASP.NET</span></span>](http://www.15seconds.com/Issue/020417.htm)
- [<span data-ttu-id="c1eab-248">Senden von E-Mail in ASP.NET</span><span class="sxs-lookup"><span data-stu-id="c1eab-248">Sending Email in ASP.NET</span></span>](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx)
- [<span data-ttu-id="c1eab-249">Grundlegendes zu den `Global.asax` Datei</span><span class="sxs-lookup"><span data-stu-id="c1eab-249">Understanding the `Global.asax` File</span></span>](http://aspalliance.com/1114_Understanding_the_Globalasax_file.all)
- [<span data-ttu-id="c1eab-250">Mithilfe von HTTP-Module und Handler austauschbare ASP.NET Komponenten erstellen</span><span class="sxs-lookup"><span data-stu-id="c1eab-250">Using HTTP Modules and Handlers to Create Pluggable ASP.NET Components</span></span>](https://msdn.microsoft.com/library/aa479332.aspx)
- [<span data-ttu-id="c1eab-251">Arbeiten mit ASP.NET `Global.asax` Datei</span><span class="sxs-lookup"><span data-stu-id="c1eab-251">Working with the ASP.NET `Global.asax` File</span></span>](http://articles.techrepublic.com.com/5100-10878_11-5771721.html)
- [<span data-ttu-id="c1eab-252">Arbeiten mit `HttpApplication` Instanzen</span><span class="sxs-lookup"><span data-stu-id="c1eab-252">Working with `HttpApplication` Instances</span></span>](https://msdn.microsoft.com/library/a0xez8f2.aspx)

>[!div class="step-by-step"]
<span data-ttu-id="c1eab-253">[Zurück](displaying-a-custom-error-page-cs.md)
[Weiter](logging-error-details-with-asp-net-health-monitoring-cs.md)</span><span class="sxs-lookup"><span data-stu-id="c1eab-253">[Previous](displaying-a-custom-error-page-cs.md)
[Next](logging-error-details-with-asp-net-health-monitoring-cs.md)</span></span>
