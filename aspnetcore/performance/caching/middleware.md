---
title: Antwort zwischenspeichern Middleware in ASP.NET Core
author: guardrex
description: Informationen Sie zum Konfigurieren und Verwenden von Antwort zwischenspeichern Middleware in ASP.NET Core-apps.
ms.author: riande
manager: wpickett
ms.date: 08/22/2017
ms.topic: article
ms.prod: asp.net-core
uid: performance/caching/middleware
ms.openlocfilehash: f3312d0c333b47169c71891eea79f03be0abcfa3
ms.sourcegitcommit: 216dfac27542f10a79274a9ce60dc449e888ed20
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/29/2017
---
# <a name="response-caching-middleware-in-aspnet-core"></a><span data-ttu-id="99638-103">Antwort zwischenspeichern Middleware in ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="99638-103">Response Caching Middleware in ASP.NET Core</span></span>

<span data-ttu-id="99638-104">Durch [Luke Latham](https://github.com/guardrex) und [John Luo](https://github.com/JunTaoLuo)</span><span class="sxs-lookup"><span data-stu-id="99638-104">By [Luke Latham](https://github.com/guardrex) and [John Luo](https://github.com/JunTaoLuo)</span></span>

<span data-ttu-id="99638-105">[Anzeigen oder Herunterladen von Beispielcode](https://github.com/aspnet/Docs/tree/master/aspnetcore/performance/caching/middleware/samples) ([Vorgehensweise zum Herunterladen](xref:tutorials/index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="99638-105">[View or download sample code](https://github.com/aspnet/Docs/tree/master/aspnetcore/performance/caching/middleware/samples) ([how to download](xref:tutorials/index#how-to-download-a-sample))</span></span>

<span data-ttu-id="99638-106">Dieses Dokument enthält ausführliche Informationen zum Konfigurieren der Antwort zwischenspeichern Middleware in ASP.NET Core-apps.</span><span class="sxs-lookup"><span data-stu-id="99638-106">This document provides details on how to configure the Response Caching Middleware in ASP.NET Core apps.</span></span> <span data-ttu-id="99638-107">Die Middleware wird bestimmt, wenn Antworten zwischengespeichert sind, speichert Antworten und fungiert Antworten aus dem Cache.</span><span class="sxs-lookup"><span data-stu-id="99638-107">The middleware determines when responses are cacheable, stores responses, and serves responses from cache.</span></span> <span data-ttu-id="99638-108">Eine Einführung in die HTTP-caching und die `ResponseCache` -Attribut angegeben wird, finden Sie unter [Zwischenspeichern von Antworten](response.md).</span><span class="sxs-lookup"><span data-stu-id="99638-108">For an introduction to HTTP caching and the `ResponseCache` attribute, see [Response Caching](response.md).</span></span>

## <a name="package"></a><span data-ttu-id="99638-109">Package</span><span class="sxs-lookup"><span data-stu-id="99638-109">Package</span></span>
<span data-ttu-id="99638-110">Um die Middleware in einem Projekt einzuschließen, fügen Sie einen Verweis auf die [ `Microsoft.AspNetCore.ResponseCaching` ](https://www.nuget.org/packages/Microsoft.AspNetCore.ResponseCaching/) Verpacken, oder verwenden Sie die [ `Microsoft.AspNetCore.All` ](https://www.nuget.org/packages/Microsoft.AspNetCore.All/) Paket.</span><span class="sxs-lookup"><span data-stu-id="99638-110">To include the middleware in a project, add a reference to the [`Microsoft.AspNetCore.ResponseCaching`](https://www.nuget.org/packages/Microsoft.AspNetCore.ResponseCaching/) package or use the [`Microsoft.AspNetCore.All`](https://www.nuget.org/packages/Microsoft.AspNetCore.All/) package.</span></span>

## <a name="configuration"></a><span data-ttu-id="99638-111">Konfiguration</span><span class="sxs-lookup"><span data-stu-id="99638-111">Configuration</span></span>
<span data-ttu-id="99638-112">In `ConfigureServices`, die Auflistung die Middleware hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="99638-112">In `ConfigureServices`, add the middleware to the service collection.</span></span>

# <a name="aspnet-core-2xtabaspnetcore2x"></a>[<span data-ttu-id="99638-113">ASP.NET Core 2.x</span><span class="sxs-lookup"><span data-stu-id="99638-113">ASP.NET Core 2.x</span></span>](#tab/aspnetcore2x)

[!code-csharp[Main](middleware/samples/2.x/Program.cs?name=snippet1&highlight=4)]

# <a name="aspnet-core-1xtabaspnetcore1x"></a>[<span data-ttu-id="99638-114">ASP.NET Core 1.x</span><span class="sxs-lookup"><span data-stu-id="99638-114">ASP.NET Core 1.x</span></span>](#tab/aspnetcore1x)

[!code-csharp[Main](middleware/samples/1.x/Startup.cs?name=snippet1&highlight=3)]

---

<span data-ttu-id="99638-115">Die app so konfigurieren, verwenden Sie die Middleware mit der `UseResponseCaching` Erweiterungsmethode, die die Middleware die Anforderungsverarbeitungspipeline hinzufügt.</span><span class="sxs-lookup"><span data-stu-id="99638-115">Configure the app to use the middleware with the `UseResponseCaching` extension method, which adds the middleware to the request processing pipeline.</span></span> <span data-ttu-id="99638-116">Die Beispiel-app Fügt eine [ `Cache-Control` ](https://tools.ietf.org/html/rfc7234#section-5.2) Header in die Antwort, die zwischengespeichert werden Antworten für bis zu 10 Sekunden zwischengespeichert.</span><span class="sxs-lookup"><span data-stu-id="99638-116">The sample app adds a [`Cache-Control`](https://tools.ietf.org/html/rfc7234#section-5.2) header to the response that caches cacheable responses for up to 10 seconds.</span></span> <span data-ttu-id="99638-117">Das Beispiel sendet ein [ `Vary` ](https://tools.ietf.org/html/rfc7231#section-7.1.4) Header so konfigurieren Sie die Middleware zum Verarbeiten einer zwischengespeicherten Antwort nur, wenn die [ `Accept-Encoding` ](https://tools.ietf.org/html/rfc7231#section-5.3.4) -Header der nachfolgenden Anforderungen entspricht, die der ursprünglichen Anforderung.</span><span class="sxs-lookup"><span data-stu-id="99638-117">The sample sends a [`Vary`](https://tools.ietf.org/html/rfc7231#section-7.1.4) header to configure the middleware to serve a cached response only if the [`Accept-Encoding`](https://tools.ietf.org/html/rfc7231#section-5.3.4) header of subsequent requests matches that of the original request.</span></span>

# <a name="aspnet-core-2xtabaspnetcore2x"></a>[<span data-ttu-id="99638-118">ASP.NET Core 2.x</span><span class="sxs-lookup"><span data-stu-id="99638-118">ASP.NET Core 2.x</span></span>](#tab/aspnetcore2x)

[!code-csharp[Main](middleware/samples/2.x/Program.cs?name=snippet1&highlight=8)]

# <a name="aspnet-core-1xtabaspnetcore1x"></a>[<span data-ttu-id="99638-119">ASP.NET Core 1.x</span><span class="sxs-lookup"><span data-stu-id="99638-119">ASP.NET Core 1.x</span></span>](#tab/aspnetcore1x)

[!code-csharp[Main](middleware/samples/1.x/Startup.cs?name=snippet2&highlight=3)]

---

<span data-ttu-id="99638-120">Die Antwort zwischenspeichern Middleware werden lediglich die Reaktionen 200 (OK).</span><span class="sxs-lookup"><span data-stu-id="99638-120">The Response Caching Middleware only caches 200 (OK) server responses.</span></span> <span data-ttu-id="99638-121">Andere Antworten, einschließlich [Fehlerseiten](xref:fundamentals/error-handling), werden von der Middleware ignoriert.</span><span class="sxs-lookup"><span data-stu-id="99638-121">Any other responses, including [error pages](xref:fundamentals/error-handling), are ignored by the middleware.</span></span>

> [!WARNING]
> <span data-ttu-id="99638-122">Mit Inhalt für authentifizierte Clients Antworten müssen nicht zwischengespeichert werden kann, um zu verhindern, dass die Middleware aus speichern und diese Antworten bedient markiert werden.</span><span class="sxs-lookup"><span data-stu-id="99638-122">Responses containing content for authenticated clients must be marked as not cacheable to prevent the middleware from storing and serving those responses.</span></span> <span data-ttu-id="99638-123">Finden Sie unter [Bedingungen für das caching](#conditions-for-caching) ausführliche Informationen wie die Middleware bestimmt, ob eine Antwort zwischengespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="99638-123">See [Conditions for caching](#conditions-for-caching) for details on how the middleware determines if a response is cacheable.</span></span>

## <a name="options"></a><span data-ttu-id="99638-124">Optionen</span><span class="sxs-lookup"><span data-stu-id="99638-124">Options</span></span>
<span data-ttu-id="99638-125">Die Middleware bietet drei Optionen zum Steuern des Zwischenspeichern von Antworten.</span><span class="sxs-lookup"><span data-stu-id="99638-125">The middleware offers three options for controlling response caching.</span></span>

| <span data-ttu-id="99638-126">Option</span><span class="sxs-lookup"><span data-stu-id="99638-126">Option</span></span>                | <span data-ttu-id="99638-127">Standardwert</span><span class="sxs-lookup"><span data-stu-id="99638-127">Default Value</span></span> |
| --------------------- | ------------- |
| <span data-ttu-id="99638-128">UseCaseSensitivePaths</span><span class="sxs-lookup"><span data-stu-id="99638-128">UseCaseSensitivePaths</span></span> | <span data-ttu-id="99638-129">Bestimmt, ob die Groß-/Kleinschreibung Pfade Antworten zwischengespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="99638-129">Determines if responses are cached on case-sensitive paths.</span></span></p><p><span data-ttu-id="99638-130">Der Standardwert ist `false`.</span><span class="sxs-lookup"><span data-stu-id="99638-130">The default value is `false`.</span></span> |
| <span data-ttu-id="99638-131">MaximumBodySize</span><span class="sxs-lookup"><span data-stu-id="99638-131">MaximumBodySize</span></span>       | <span data-ttu-id="99638-132">Die größte zwischenspeicherbaren Größe des Antworttexts in Bytes.</span><span class="sxs-lookup"><span data-stu-id="99638-132">The largest cacheable size for the response body in bytes.</span></span></p><span data-ttu-id="99638-133">Der Standardwert ist `64 * 1024 * 1024` (64 MB).</span><span class="sxs-lookup"><span data-stu-id="99638-133">The default value is `64 * 1024 * 1024` (64 MB).</span></span> |
| <span data-ttu-id="99638-134">SizeLimit</span><span class="sxs-lookup"><span data-stu-id="99638-134">SizeLimit</span></span>             | <span data-ttu-id="99638-135">Die maximale Größe für die Antwort-Cache-Middleware in Bytes.</span><span class="sxs-lookup"><span data-stu-id="99638-135">The size limit for the response cache middleware in bytes.</span></span> <span data-ttu-id="99638-136">Der Standardwert ist `100 * 1024 * 1024` (100 MB).</span><span class="sxs-lookup"><span data-stu-id="99638-136">The default value is `100 * 1024 * 1024` (100 MB).</span></span> |

<span data-ttu-id="99638-137">Das folgende Beispiel konfiguriert die Middleware zum Zwischenspeichern von Antworten kleiner als oder gleich 1024 Bytes, die über die Groß-/Kleinschreibung Pfade, speichern die Antworten auf `/page1` und `/Page1` getrennt.</span><span class="sxs-lookup"><span data-stu-id="99638-137">The following example configures the middleware to cache responses smaller than or equal to 1,024 bytes using case-sensitive paths, storing the responses to `/page1` and `/Page1` separately.</span></span>

```csharp
services.AddResponseCaching(options =>
{
    options.UseCaseSensitivePaths = true;
    options.MaximumBodySize = 1024;
});
```

## <a name="varybyquerykeys"></a><span data-ttu-id="99638-138">VaryByQueryKeys</span><span class="sxs-lookup"><span data-stu-id="99638-138">VaryByQueryKeys</span></span>
<span data-ttu-id="99638-139">Bei Verwendung von MVC die `ResponseCache` Attribut gibt an, die Parameter zum Festlegen der entsprechenden Header für das Zwischenspeichern von Antworten erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="99638-139">When using MVC, the `ResponseCache` attribute specifies the parameters necessary for setting appropriate headers for response caching.</span></span> <span data-ttu-id="99638-140">Der einzige Parameter der der `ResponseCache` -Attribut, das die Middleware zwingend erforderlich ist `VaryByQueryKeys`, nicht dem tatsächlichen HTTP-Header entsprechen.</span><span class="sxs-lookup"><span data-stu-id="99638-140">The only parameter of the `ResponseCache` attribute that strictly requires the middleware is `VaryByQueryKeys`, which doesn't correspond to an actual HTTP header.</span></span> <span data-ttu-id="99638-141">Weitere Informationen finden Sie unter [ResponseCache Attribut](response.md#responsecache-attribute).</span><span class="sxs-lookup"><span data-stu-id="99638-141">For more information, see [ResponseCache Attribute](response.md#responsecache-attribute).</span></span>

<span data-ttu-id="99638-142">Wenn kein MVC, können Sie verändern, Zwischenspeichern von Antworten mit der `VaryByQueryKeys` Funktion.</span><span class="sxs-lookup"><span data-stu-id="99638-142">When not using MVC, you can vary response caching with the `VaryByQueryKeys` feature.</span></span> <span data-ttu-id="99638-143">Verwenden der `ResponseCachingFeature` direkt aus der `IFeatureCollection` von der `HttpContext`:</span><span class="sxs-lookup"><span data-stu-id="99638-143">Use the `ResponseCachingFeature` directly from the `IFeatureCollection` of the `HttpContext`:</span></span>

```csharp
var responseCachingFeature = context.HttpContext.Features.Get<IResponseCachingFeature>();
if (responseCachingFeature != null)
{
    responseCachingFeature.VaryByQueryKeys = new[] { "MyKey" };
}
```

## <a name="http-headers-used-by-response-caching-middleware"></a><span data-ttu-id="99638-144">HTTP-Header von Antwort zwischenspeichern Middleware verwendet</span><span class="sxs-lookup"><span data-stu-id="99638-144">HTTP headers used by Response Caching Middleware</span></span>
<span data-ttu-id="99638-145">Antwort von der Middleware Zwischenspeichern wird über HTTP-Header konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="99638-145">Response caching by the middleware is configured via HTTP headers.</span></span> <span data-ttu-id="99638-146">Die entsprechenden relevanten Header sind unten aufgeführt, mit Notizen auf deren caching Einfluss auf.</span><span class="sxs-lookup"><span data-stu-id="99638-146">The relevant headers are listed below with notes on how they affect caching.</span></span>

| <span data-ttu-id="99638-147">Header</span><span class="sxs-lookup"><span data-stu-id="99638-147">Header</span></span> | <span data-ttu-id="99638-148">Details</span><span class="sxs-lookup"><span data-stu-id="99638-148">Details</span></span> |
| ------ | ------- |
| <span data-ttu-id="99638-149">Autorisierung</span><span class="sxs-lookup"><span data-stu-id="99638-149">Authorization</span></span> | <span data-ttu-id="99638-150">Die Antwort wird nicht zwischengespeichert, wenn der Header vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="99638-150">The response isn't cached if the header exists.</span></span> |
| <span data-ttu-id="99638-151">Cache-Control</span><span class="sxs-lookup"><span data-stu-id="99638-151">Cache-Control</span></span> | <span data-ttu-id="99638-152">Die Middleware berücksichtigt nur Zwischenspeichern von Antworten mit markiert die `public` Cache-Anweisung.</span><span class="sxs-lookup"><span data-stu-id="99638-152">The middleware only considers caching responses marked with the `public` cache directive.</span></span> <span data-ttu-id="99638-153">Sie können steuern, caching mit den folgenden Parametern:</span><span class="sxs-lookup"><span data-stu-id="99638-153">You can control caching with the following parameters:</span></span><ul><li><span data-ttu-id="99638-154">Max-age</span><span class="sxs-lookup"><span data-stu-id="99638-154">max-age</span></span></li><li><span data-ttu-id="99638-155">Max-veraltet &#8224;</span><span class="sxs-lookup"><span data-stu-id="99638-155">max-stale&#8224;</span></span></li><li><span data-ttu-id="99638-156">Min-frisch</span><span class="sxs-lookup"><span data-stu-id="99638-156">min-fresh</span></span></li><li><span data-ttu-id="99638-157">Must-revalidate-Anweisung</span><span class="sxs-lookup"><span data-stu-id="99638-157">must-revalidate</span></span></li><li><span data-ttu-id="99638-158">ohne-cache</span><span class="sxs-lookup"><span data-stu-id="99638-158">no-cache</span></span></li><li><span data-ttu-id="99638-159">ohne-Speicher</span><span class="sxs-lookup"><span data-stu-id="99638-159">no-store</span></span></li><li><span data-ttu-id="99638-160">nur-If-Cache</span><span class="sxs-lookup"><span data-stu-id="99638-160">only-if-cached</span></span></li><li><span data-ttu-id="99638-161">private</span><span class="sxs-lookup"><span data-stu-id="99638-161">private</span></span></li><li><span data-ttu-id="99638-162">public</span><span class="sxs-lookup"><span data-stu-id="99638-162">public</span></span></li><li><span data-ttu-id="99638-163">s-maxage</span><span class="sxs-lookup"><span data-stu-id="99638-163">s-maxage</span></span></li><li><span data-ttu-id="99638-164">Proxy-Revalidate &#8225;</span><span class="sxs-lookup"><span data-stu-id="99638-164">proxy-revalidate&#8225;</span></span></li></ul><span data-ttu-id="99638-165">&#8224; Wenn keine Beschränkung auf angegeben wird `max-stale`, die Middleware führt keine Aktion.</span><span class="sxs-lookup"><span data-stu-id="99638-165">&#8224;If no limit is specified to `max-stale`, the middleware takes no action.</span></span><br><span data-ttu-id="99638-166">&#8225; `proxy-revalidate` hat dieselbe Wirkung wie das `must-revalidate`.</span><span class="sxs-lookup"><span data-stu-id="99638-166">&#8225;`proxy-revalidate` has the same effect as `must-revalidate`.</span></span><br><br><span data-ttu-id="99638-167">Weitere Informationen finden Sie unter [RFC 7231: Cache-Control-Request-Direktiven](https://tools.ietf.org/html/rfc7234#section-5.2.1).</span><span class="sxs-lookup"><span data-stu-id="99638-167">For more information, see [RFC 7231: Request Cache-Control Directives](https://tools.ietf.org/html/rfc7234#section-5.2.1).</span></span> |
| <span data-ttu-id="99638-168">Pragma</span><span class="sxs-lookup"><span data-stu-id="99638-168">Pragma</span></span> | <span data-ttu-id="99638-169">Ein `Pragma: no-cache` Header in der Anforderung erzeugt dieselbe Wirkung wie das `Cache-Control: no-cache`.</span><span class="sxs-lookup"><span data-stu-id="99638-169">A `Pragma: no-cache` header in the request produces the same effect as `Cache-Control: no-cache`.</span></span> <span data-ttu-id="99638-170">Dieser Header wird überschrieben, indem die relevanten Direktiven in der `Cache-Control` -Header, falls vorhanden.</span><span class="sxs-lookup"><span data-stu-id="99638-170">This header is overridden by the relevant directives in the `Cache-Control` header, if present.</span></span> <span data-ttu-id="99638-171">Für die Abwärtskompatibilität mit HTTP/1.0 berücksichtigt.</span><span class="sxs-lookup"><span data-stu-id="99638-171">Considered for backward compatibility with HTTP/1.0.</span></span> |
| <span data-ttu-id="99638-172">Set-Cookie</span><span class="sxs-lookup"><span data-stu-id="99638-172">Set-Cookie</span></span> | <span data-ttu-id="99638-173">Die Antwort wird nicht zwischengespeichert, wenn der Header vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="99638-173">The response isn't cached if the header exists.</span></span> |
| <span data-ttu-id="99638-174">variieren</span><span class="sxs-lookup"><span data-stu-id="99638-174">Vary</span></span> | <span data-ttu-id="99638-175">Die `Vary` Header variiert die zwischengespeicherte Antwort von einer anderen Spaltenüberschrift verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="99638-175">The `Vary` header is used to vary the cached response by another header.</span></span> <span data-ttu-id="99638-176">Sie können z. B. Antworten zwischenspeichern, codieren Sie dazu die `Vary: Accept-Encoding` -Header, der Antworten für Anforderungen mit Headern zwischenspeichert `Accept-Encoding: gzip` und `Accept-Encoding: text/plain` getrennt.</span><span class="sxs-lookup"><span data-stu-id="99638-176">For example, you can cache responses by encoding by including the `Vary: Accept-Encoding` header, which caches responses for requests with headers `Accept-Encoding: gzip` and `Accept-Encoding: text/plain` separately.</span></span> <span data-ttu-id="99638-177">Eine Antwort mit dem Headerwert `*` wird nie gespeichert.</span><span class="sxs-lookup"><span data-stu-id="99638-177">A response with a header value of `*` is never stored.</span></span> |
| <span data-ttu-id="99638-178">Läuft ab</span><span class="sxs-lookup"><span data-stu-id="99638-178">Expires</span></span> | <span data-ttu-id="99638-179">Eine veraltete von dieser Header als Antwort wird nicht gespeichert oder abgerufen werden, es sei denn, die von anderen überschreiben `Cache-Control` Header.</span><span class="sxs-lookup"><span data-stu-id="99638-179">A response deemed stale by this header isn't stored or retrieved unless overridden by other `Cache-Control` headers.</span></span> |
| <span data-ttu-id="99638-180">If-None-Match</span><span class="sxs-lookup"><span data-stu-id="99638-180">If-None-Match</span></span> | <span data-ttu-id="99638-181">Die vollständige Antwort wird aus dem Cache bedient, wenn der Wert ist keine `*` und die `ETag` der Antwort entspricht nicht der Werte bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="99638-181">The full response is served from cache if the value isn't `*` and the `ETag` of the response doesn't match any of the values provided.</span></span> <span data-ttu-id="99638-182">Andernfalls wird eine 304 (nicht geändert) Antwort verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="99638-182">Otherwise, a 304 (Not Modified) response is served.</span></span> |
| <span data-ttu-id="99638-183">If-Modified-Since</span><span class="sxs-lookup"><span data-stu-id="99638-183">If-Modified-Since</span></span> | <span data-ttu-id="99638-184">Wenn die `If-None-Match` Header nicht vorhanden ist, wird eine vollständige Antwort aus dem Cache bedient, wenn die zwischengespeicherte Antwortdatum neuer als der angegebene Wert ist.</span><span class="sxs-lookup"><span data-stu-id="99638-184">If the `If-None-Match` header isn't present, a full response is served from cache if the cached response date is newer than the value provided.</span></span> <span data-ttu-id="99638-185">Andernfalls wird eine 304 (nicht geändert) Antwort verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="99638-185">Otherwise, a 304 (Not Modified) response is served.</span></span> |
| <span data-ttu-id="99638-186">Datum</span><span class="sxs-lookup"><span data-stu-id="99638-186">Date</span></span> | <span data-ttu-id="99638-187">Wenn aus dem Cache bedient die `Date` Header von der Middleware festgelegt ist, wenn diese Option wurde nicht in der ursprünglichen Antwort angegeben.</span><span class="sxs-lookup"><span data-stu-id="99638-187">When serving from cache, the `Date` header is set by the middleware if it wasn't provided on the original response.</span></span> |
| <span data-ttu-id="99638-188">Content-Length</span><span class="sxs-lookup"><span data-stu-id="99638-188">Content-Length</span></span> | <span data-ttu-id="99638-189">Wenn aus dem Cache bedient die `Content-Length` Header von der Middleware festgelegt ist, wenn diese Option wurde nicht in der ursprünglichen Antwort angegeben.</span><span class="sxs-lookup"><span data-stu-id="99638-189">When serving from cache, the `Content-Length` header is set by the middleware if it wasn't provided on the original response.</span></span> |
| <span data-ttu-id="99638-190">ALTER</span><span class="sxs-lookup"><span data-stu-id="99638-190">Age</span></span> | <span data-ttu-id="99638-191">Die `Age` Header in der ursprünglichen Antwort gesendet wird ignoriert.</span><span class="sxs-lookup"><span data-stu-id="99638-191">The `Age` header sent in the original response is ignored.</span></span> <span data-ttu-id="99638-192">Die Middleware berechnet einen neuen Wert an, wenn eine zwischengespeicherte Antwort bedient.</span><span class="sxs-lookup"><span data-stu-id="99638-192">The middleware computes a new value when serving a cached response.</span></span> |

## <a name="caching-respects-request-cache-control-directives"></a><span data-ttu-id="99638-193">Zwischenspeichern respektiert Anforderung Cache-Control-Direktiven</span><span class="sxs-lookup"><span data-stu-id="99638-193">Caching respects request Cache-Control directives</span></span>

<span data-ttu-id="99638-194">Die Middleware respektiert die Regeln für die [Zwischenspeichern von HTTP 1.1-Spezifikation](https://tools.ietf.org/html/rfc7234#section-5.2).</span><span class="sxs-lookup"><span data-stu-id="99638-194">The middleware respects the rules of the [HTTP 1.1 Caching specification](https://tools.ietf.org/html/rfc7234#section-5.2).</span></span> <span data-ttu-id="99638-195">Die Regeln erfordern einen Cache für eine gültige berücksichtigt `Cache-Control` vom Client gesendeten Header.</span><span class="sxs-lookup"><span data-stu-id="99638-195">The rules require a cache to honor a valid `Cache-Control` header sent by the client.</span></span> <span data-ttu-id="99638-196">Unter der Spezifikation stellen ein Client kann Anforderungen mit einem `no-cache` Headerwert "und" Force einen Server aus, um eine neue Antwort für jede Anforderung zu generieren.</span><span class="sxs-lookup"><span data-stu-id="99638-196">Under the specification, a client can make requests with a `no-cache` header value and force a server to generate a new response for every request.</span></span> <span data-ttu-id="99638-197">Aktuell besteht keine entwicklersteuerung dieses Verhalten beim Zwischenspeichern, wenn die Middleware zu verwenden, da die Middleware die offizielle caching-Spezifikation entspricht.</span><span class="sxs-lookup"><span data-stu-id="99638-197">Currently, there's no developer control over this caching behavior when using the middleware because the middleware adheres to the official caching specification.</span></span>

<span data-ttu-id="99638-198">[Zukünftiger Verbesserungen der Middleware](https://github.com/aspnet/ResponseCaching/issues/96) gestattet, konfigurieren die Middleware zum Zwischenspeichern von Szenarios, in dem die Anforderung `Cache-Control` Header ignoriert werden sollen, wenn Sie entscheiden, zu eine zwischengespeicherte Antwort dienen.</span><span class="sxs-lookup"><span data-stu-id="99638-198">[Future enhancements to the middleware](https://github.com/aspnet/ResponseCaching/issues/96) will permit configuring the middleware for caching scenarios where the request `Cache-Control` header should be ignored when deciding to serve a cached response.</span></span> <span data-ttu-id="99638-199">Wenn Sie mehr Kontrolle über das Verhalten beim Zwischenspeichern seek, untersuchen Sie andere caching-Funktionen von ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="99638-199">If you seek more control over caching behavior, explore other caching features of ASP.NET Core.</span></span> <span data-ttu-id="99638-200">Informationen hierzu finden Sie in den folgenden Themen:</span><span class="sxs-lookup"><span data-stu-id="99638-200">See the following topics:</span></span>

* [<span data-ttu-id="99638-201">Im Arbeitsspeicher Zwischenspeichern</span><span class="sxs-lookup"><span data-stu-id="99638-201">In-memory caching</span></span>](xref:performance/caching/memory)
* [<span data-ttu-id="99638-202">Arbeiten mit einem verteilten cache</span><span class="sxs-lookup"><span data-stu-id="99638-202">Working with a distributed cache</span></span>](xref:performance/caching/distributed)
* [<span data-ttu-id="99638-203">Cache-Tag-Hilfsprogramm im Kern der ASP.NET MVC</span><span class="sxs-lookup"><span data-stu-id="99638-203">Cache Tag Helper in ASP.NET Core MVC</span></span>](xref:mvc/views/tag-helpers/builtin-th/cache-tag-helper)
* [<span data-ttu-id="99638-204">Verteilter Cache-Tag-Hilfsprogramm</span><span class="sxs-lookup"><span data-stu-id="99638-204">Distributed Cache Tag Helper</span></span>](xref:mvc/views/tag-helpers/builtin-th/distributed-cache-tag-helper)

## <a name="troubleshooting"></a><span data-ttu-id="99638-205">Problembehandlung</span><span class="sxs-lookup"><span data-stu-id="99638-205">Troubleshooting</span></span>
<span data-ttu-id="99638-206">Das Verhalten beim Zwischenspeichern ist nicht wie erwartet, stellen Sie sicher, dass Antworten zwischengespeichert werden und kann durch Prüfen der eingehenden Anforderungsheader und ausgehenden Header der Antwort aus dem Cache bedient werden.</span><span class="sxs-lookup"><span data-stu-id="99638-206">If caching behavior isn't as you expect, confirm that responses are cacheable and capable of being served from the cache by examining the request's incoming headers and the response's outgoing headers.</span></span> <span data-ttu-id="99638-207">Aktivieren der [Protokollierung](xref:fundamentals/logging/index) hilft beim Debuggen.</span><span class="sxs-lookup"><span data-stu-id="99638-207">Enabling [logging](xref:fundamentals/logging/index) can help when debugging.</span></span> <span data-ttu-id="99638-208">Die Middleware-Protokolle, die caching-Verhalten und wenn eine Antwort aus dem Cache abgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="99638-208">The middleware logs caching behavior and when a response is retrieved from cache.</span></span>

<span data-ttu-id="99638-209">Beim Testen und Problembehandlung für das Verhalten beim Zwischenspeichern, möglicherweise einen Browser Anforderungsheader festzulegen, die caching auf unerwünschten Weise beeinflussen.</span><span class="sxs-lookup"><span data-stu-id="99638-209">When testing and troubleshooting caching behavior, a browser may set request headers that affect caching in undesirable ways.</span></span> <span data-ttu-id="99638-210">Beispielsweise kann ein Browser festgelegt die `Cache-Control` Header `no-cache` Wenn Sie die Seite aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="99638-210">For example, a browser may set the `Cache-Control` header to `no-cache` when you refresh the page.</span></span> <span data-ttu-id="99638-211">Die folgenden Tools können explizit Anforderungsheader festlegen und Testen des Zwischenspeicherns, als bevorzugt eingestuft werden:</span><span class="sxs-lookup"><span data-stu-id="99638-211">The following tools can explicitly set request headers, and are preferred for testing caching:</span></span>

* [<span data-ttu-id="99638-212">Fiddler</span><span class="sxs-lookup"><span data-stu-id="99638-212">Fiddler</span></span>](http://www.telerik.com/fiddler)
* [<span data-ttu-id="99638-213">Firebug</span><span class="sxs-lookup"><span data-stu-id="99638-213">Firebug</span></span>](http://getfirebug.com/)
* [<span data-ttu-id="99638-214">Postman</span><span class="sxs-lookup"><span data-stu-id="99638-214">Postman</span></span>](https://www.getpostman.com/)

### <a name="conditions-for-caching"></a><span data-ttu-id="99638-215">Bedingungen für das caching</span><span class="sxs-lookup"><span data-stu-id="99638-215">Conditions for caching</span></span>
* <span data-ttu-id="99638-216">Die Anforderung muss eine 200 (OK)-Antwort vom Server führen.</span><span class="sxs-lookup"><span data-stu-id="99638-216">The request must result in a 200 (OK) response from the server.</span></span>
* <span data-ttu-id="99638-217">Die Anforderungsmethode muss GET oder HEAD.</span><span class="sxs-lookup"><span data-stu-id="99638-217">The request method must be GET or HEAD.</span></span>
* <span data-ttu-id="99638-218">Terminaldienste-Middleware, z. B. Middleware für statische Dateien, muss die Antwort vor der Antwort zwischenspeichern Middleware nicht verarbeitet werden.</span><span class="sxs-lookup"><span data-stu-id="99638-218">Terminal middleware, such as Static File Middleware, must not process the response prior to the Response Caching Middleware.</span></span>
* <span data-ttu-id="99638-219">Die `Authorization` Header darf nicht vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="99638-219">The `Authorization` header must not be present.</span></span>
* <span data-ttu-id="99638-220">`Cache-Control`Headerparameter müssen gültig sein, und die Antwort muss markiert sein `public` und nicht gekennzeichnet `private`.</span><span class="sxs-lookup"><span data-stu-id="99638-220">`Cache-Control` header parameters must be valid, and the response must be marked `public` and not marked `private`.</span></span>
* <span data-ttu-id="99638-221">Die `Pragma: no-cache` Header-Wert darf nicht vorhanden sein wenn die `Cache-Control` Header nicht vorhanden ist, als die `Cache-Control` Header überschreibt die `Pragma` Header, wenn vorhanden.</span><span class="sxs-lookup"><span data-stu-id="99638-221">The `Pragma: no-cache` header/value must not be present if the `Cache-Control` header isn't present, as the `Cache-Control` header overrides the `Pragma` header when present.</span></span>
* <span data-ttu-id="99638-222">Die `Set-Cookie` Header darf nicht vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="99638-222">The `Set-Cookie` header must not be present.</span></span>
* <span data-ttu-id="99638-223">`Vary`Headerparameter müssen gültig und nicht gleich sein `*`.</span><span class="sxs-lookup"><span data-stu-id="99638-223">`Vary` header parameters must be valid and not equal to `*`.</span></span>
* <span data-ttu-id="99638-224">Die `Content-Length` Headerwert (falls festgelegt) müssen die Größe des Antworttexts übereinstimmen.</span><span class="sxs-lookup"><span data-stu-id="99638-224">The `Content-Length` header value (if set) must match the size of the response body.</span></span>
* <span data-ttu-id="99638-225">Die [IHttpSendFileFeature](/aspnet/core/api/microsoft.aspnetcore.http.features.ihttpsendfilefeature) wird nicht verwendet.</span><span class="sxs-lookup"><span data-stu-id="99638-225">The [IHttpSendFileFeature](/aspnet/core/api/microsoft.aspnetcore.http.features.ihttpsendfilefeature) isn't used.</span></span>
* <span data-ttu-id="99638-226">Die Antwort muss entsprechend den Angaben von veralteten der `Expires` Header und die `max-age` und `s-maxage` cache-Anweisungen.</span><span class="sxs-lookup"><span data-stu-id="99638-226">The response must not be stale as specified by the `Expires` header and the `max-age` and `s-maxage` cache directives.</span></span>
* <span data-ttu-id="99638-227">Antwortpufferung ist erfolgreich, und die Größe der Antwort ist kleiner als die konfigurierte oder default `SizeLimit`.</span><span class="sxs-lookup"><span data-stu-id="99638-227">Response buffering is successful, and the size of the response is smaller than the configured or default `SizeLimit`.</span></span>
* <span data-ttu-id="99638-228">Muss die Antwort zwischengespeichert werden gemäß der [RFC 7234](https://tools.ietf.org/html/rfc7234) Spezifikationen.</span><span class="sxs-lookup"><span data-stu-id="99638-228">The response must be cacheable according to the [RFC 7234](https://tools.ietf.org/html/rfc7234) specifications.</span></span> <span data-ttu-id="99638-229">Z. B. die `no-store` Richtlinie darf nicht in der Anforderung oder Antwort Headerfelder vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="99638-229">For example, the `no-store` directive must not exist in request or response header fields.</span></span> <span data-ttu-id="99638-230">Finden Sie unter *Abschnitt 3: Speichern von Antworten in Caches* von [RFC 7234](https://tools.ietf.org/html/rfc7234) Details.</span><span class="sxs-lookup"><span data-stu-id="99638-230">See *Section 3: Storing Responses in Caches* of [RFC 7234](https://tools.ietf.org/html/rfc7234) for details.</span></span>

> [!NOTE]
> <span data-ttu-id="99638-231">Das Antiforgery System zum Generieren von sicheren Token, um zu verhindern, dass Cross-Site Request Fälschung Websiteübergreifender Angriffen legt die `Cache-Control` und `Pragma` Headern zum `no-cache` so, dass Antworten zwischengespeichert werden nicht.</span><span class="sxs-lookup"><span data-stu-id="99638-231">The Antiforgery system for generating secure tokens to prevent Cross-Site Request Forgery (CSRF) attacks sets the `Cache-Control` and `Pragma` headers to `no-cache` so that responses aren't cached.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="99638-232">Zusätzliche Ressourcen</span><span class="sxs-lookup"><span data-stu-id="99638-232">Additional resources</span></span>

* [<span data-ttu-id="99638-233">Application Startup (Starten von Anwendungen)</span><span class="sxs-lookup"><span data-stu-id="99638-233">Application Startup</span></span>](xref:fundamentals/startup)
* [<span data-ttu-id="99638-234">Middleware</span><span class="sxs-lookup"><span data-stu-id="99638-234">Middleware</span></span>](xref:fundamentals/middleware)
* [<span data-ttu-id="99638-235">Im Arbeitsspeicher Zwischenspeichern</span><span class="sxs-lookup"><span data-stu-id="99638-235">In-memory caching</span></span>](xref:performance/caching/memory)
* [<span data-ttu-id="99638-236">Arbeiten mit einem verteilten cache</span><span class="sxs-lookup"><span data-stu-id="99638-236">Working with a distributed cache</span></span>](xref:performance/caching/distributed)
* [<span data-ttu-id="99638-237">Erkennen von Änderungen mit Token ändern</span><span class="sxs-lookup"><span data-stu-id="99638-237">Detect changes with change tokens</span></span>](xref:fundamentals/primitives/change-tokens)
* [<span data-ttu-id="99638-238">Zwischenspeichern von Antworten</span><span class="sxs-lookup"><span data-stu-id="99638-238">Response caching</span></span>](xref:performance/caching/response)
* [<span data-ttu-id="99638-239">Cache-Tag-Hilfsprogramm</span><span class="sxs-lookup"><span data-stu-id="99638-239">Cache Tag Helper</span></span>](xref:mvc/views/tag-helpers/builtin-th/cache-tag-helper)
* [<span data-ttu-id="99638-240">Verteilter Cache-Tag-Hilfsprogramm</span><span class="sxs-lookup"><span data-stu-id="99638-240">Distributed Cache Tag Helper</span></span>](xref:mvc/views/tag-helpers/builtin-th/distributed-cache-tag-helper)
