---
uid: web-forms/overview/data-access/paging-and-sorting/creating-a-customized-sorting-user-interface-vb
title: "Erstellen einer benutzerdefinierten Sortierung Benutzeroberfläche (VB) | Microsoft Docs"
author: rick-anderson
description: "Beim Anzeigen einer langen Liste von Daten sortiert werden, es kann sehr hilfreich sein, gruppieren Sie verknüpfte Daten durch die Einführung von Trennzeichen für Zeilen. In diesem Lernprogramm sehen wir wie Anmelde..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 08/15/2006
ms.topic: article
ms.assetid: f3897a74-cc6a-4032-8f68-465f155e296a
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting/creating-a-customized-sorting-user-interface-vb
msc.type: authoredcontent
ms.openlocfilehash: c9d6229c88e4fd67f384a5ec459ed661f32f0a50
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/10/2017
---
<a name="creating-a-customized-sorting-user-interface-vb"></a><span data-ttu-id="1e3b0-104">Erstellen einer benutzerdefinierten Sortierung Benutzeroberfläche (VB)</span><span class="sxs-lookup"><span data-stu-id="1e3b0-104">Creating a Customized Sorting User Interface (VB)</span></span>
====================
<span data-ttu-id="1e3b0-105">durch [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="1e3b0-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="1e3b0-106">[Beispiel-App herunterladen](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_27_VB.exe) oder [PDF herunterladen](creating-a-customized-sorting-user-interface-vb/_static/datatutorial27vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="1e3b0-106">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_27_VB.exe) or [Download PDF](creating-a-customized-sorting-user-interface-vb/_static/datatutorial27vb1.pdf)</span></span>

> <span data-ttu-id="1e3b0-107">Beim Anzeigen einer langen Liste von Daten sortiert werden, es kann sehr hilfreich sein, gruppieren Sie verknüpfte Daten durch die Einführung von Trennzeichen für Zeilen.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-107">When displaying a long list of sorted data, it can be very helpful to group related data by introducing separator rows.</span></span> <span data-ttu-id="1e3b0-108">In diesem Lernprogramm sehen wir, wie solche eine Sortierung Benutzeroberfläche erstellen.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-108">In this tutorial we'll see how to create such a sorting user interface.</span></span>


## <a name="introduction"></a><span data-ttu-id="1e3b0-109">Einführung</span><span class="sxs-lookup"><span data-stu-id="1e3b0-109">Introduction</span></span>

<span data-ttu-id="1e3b0-110">Wenn eine lange Liste von anzeigen sortierte Daten vorhanden sind nur wenige unterschiedliche Werte in der sortierten Spalte an, ein Endbenutzer möglicherweise als schwer zu ersehen, genau die Differenz Grenzen eintreten.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-110">When displaying a long list of sorted data where there are only a handful of different values in the sorted column, an end user might find it hard to discern where, exactly, the difference boundaries occur.</span></span> <span data-ttu-id="1e3b0-111">Es gibt z. B. 81 Produkte in der Datenbank, jedoch nur neun verschiedenen Kategorie-Optionen (acht eindeutigen Kategorien sowie die `NULL` Option).</span><span class="sxs-lookup"><span data-stu-id="1e3b0-111">For example, there are 81 products in the database, but only nine different category choices (eight unique categories plus the `NULL` option).</span></span> <span data-ttu-id="1e3b0-112">Betrachten Sie den Fall eines Benutzers interessiert ist, untersuchen die Produkte, die unter der Kategorie "Seafood" liegen.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-112">Consider the case of a user who is interested in examining the products that fall under the Seafood category.</span></span> <span data-ttu-id="1e3b0-113">Von einer Seite mit einer Liste *alle* der Produkte in einer einzelnen GridView, kann der Benutzer entscheiden, ihre sinnvollsten ist, um die Ergebnisse nach Kategorie sortiert werden, die zusammen gruppiert werden sämtliche Produkte Seafood zusammen.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-113">From a page that lists *all* of the products in a single GridView, the user might decide her best bet is to sort the results by category, which will group together all of the Seafood products together.</span></span> <span data-ttu-id="1e3b0-114">Nach dem Sortieren nach Kategorie, benötigt der Benutzer klicken Sie dann durch die Liste Rückerstattungsrichtlinie gesucht, in denen die Produkte Seafood gruppiert beginnen und enden.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-114">After sorting by category, the user then needs to hunt through the list, looking for where the Seafood-grouped products start and end.</span></span> <span data-ttu-id="1e3b0-115">Da die Ergebnisse in alphabetischer Reihenfolge geordnet sind der Kategorienamen der Seafood Produkte zu finden, ist nicht schwierig, aber noch müssen eng Scannen der Liste der Elemente im Raster.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-115">Since the results are ordered alphabetically by the category name finding the Seafood products is not difficult, but it still requires closely scanning the list of items in the grid.</span></span>

<span data-ttu-id="1e3b0-116">Damit können die Grenzen zwischen sortierte Gruppen markieren, nutzen viele Websites eine Benutzeroberfläche, die ein Trennzeichen zwischen den solche Gruppen hinzufügt.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-116">To help highlight the boundaries between sorted groups, many websites employ a user interface that adds a separator between such groups.</span></span> <span data-ttu-id="1e3b0-117">Trennzeichen, wie die in Abbildung 1 gezeigten ermöglicht einem Benutzer schneller finden eine bestimmte Gruppe und die Grenzen zu identifizieren, als auch ermitteln, welche unterschiedlichen Gruppen in den Daten vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-117">Separators like the ones shown in Figure 1 enables a user to more quickly find a particular group and identify its boundaries, as well as ascertain what distinct groups exist in the data.</span></span>


<span data-ttu-id="1e3b0-118">[![Jede Kategoriegruppe ist eindeutig identifiziert.](creating-a-customized-sorting-user-interface-vb/_static/image2.png)](creating-a-customized-sorting-user-interface-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="1e3b0-118">[![Each Category Group is Clearly Identified](creating-a-customized-sorting-user-interface-vb/_static/image2.png)](creating-a-customized-sorting-user-interface-vb/_static/image1.png)</span></span>

<span data-ttu-id="1e3b0-119">**Abbildung 1**: Jede Kategoriegruppe ist eindeutig identifiziert ([klicken Sie hier, um das Bild in voller Größe angezeigt](creating-a-customized-sorting-user-interface-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="1e3b0-119">**Figure 1**: Each Category Group is Clearly Identified ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image3.png))</span></span>


<span data-ttu-id="1e3b0-120">In diesem Lernprogramm sehen wir, wie solche eine Sortierung Benutzeroberfläche erstellen.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-120">In this tutorial we'll see how to create such a sorting user interface.</span></span>

## <a name="step-1-creating-a-standard-sortable-gridview"></a><span data-ttu-id="1e3b0-121">Schritt 1: Erstellen einer standardmäßigen, sortierbaren GridView</span><span class="sxs-lookup"><span data-stu-id="1e3b0-121">Step 1: Creating a Standard, Sortable GridView</span></span>

<span data-ttu-id="1e3b0-122">Bevor untersucht, wie die GridView, um die erweiterte Sortierung Schnittstelle bereitzustellen zu erweitern, können Sie die s-standard, sortierbare GridView zuerst zu erstellen, der die Produkte aufgeführt sind.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-122">Before we explore how to augment the GridView to provide the enhanced sorting interface, let s first create a standard, sortable GridView that lists the products.</span></span> <span data-ttu-id="1e3b0-123">Öffnen Sie zunächst die `CustomSortingUI.aspx` auf der Seite der `PagingAndSorting` Ordner.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-123">Start by opening the `CustomSortingUI.aspx` page in the `PagingAndSorting` folder.</span></span> <span data-ttu-id="1e3b0-124">Die Seite eine GridView hinzugefügt haben, legen Sie seine `ID` Eigenschaft `ProductList`, und binden es an eine neue ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-124">Add a GridView to the page, set its `ID` property to `ProductList`, and bind it to a new ObjectDataSource.</span></span> <span data-ttu-id="1e3b0-125">Konfigurieren der ObjectDataSource verwenden die `ProductsBLL` Klasse s `GetProducts()` Methode zum Auswählen von Datensätzen.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-125">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method for selecting records.</span></span>

<span data-ttu-id="1e3b0-126">Als Nächstes die GridView so konfigurieren, dass sie nur enthält die `ProductName`, `CategoryName`, `SupplierName`, und `UnitPrice` BoundFields und CheckBoxField nicht mehr unterstützt.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-126">Next, configure the GridView such that it only contains the `ProductName`, `CategoryName`, `SupplierName`, and `UnitPrice` BoundFields and the Discontinued CheckBoxField.</span></span> <span data-ttu-id="1e3b0-127">Konfigurieren Sie abschließend die GridView zur Unterstützung von Sortierung durch Aktivieren des Kontrollkästchens Sortieren aktivieren, in das Smarttag für GridView s (oder durch Festlegen seiner `AllowSorting` Eigenschaft `true`).</span><span class="sxs-lookup"><span data-stu-id="1e3b0-127">Finally, configure the GridView to support sorting by checking the Enable Sorting checkbox in the GridView s smart tag (or by setting its `AllowSorting` property to `true`).</span></span> <span data-ttu-id="1e3b0-128">Nach dem Herstellen dieser Ergänzungen für das `CustomSortingUI.aspx` Seite deklarative Markup sollte etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="1e3b0-128">After making these additions to the `CustomSortingUI.aspx` page, the declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](creating-a-customized-sorting-user-interface-vb/samples/sample1.aspx)]

<span data-ttu-id="1e3b0-129">Nehmen Sie einen Moment Zeit, um unseren Fortschritt bisher in einem Browser anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-129">Take a moment to view our progress thus far in a browser.</span></span> <span data-ttu-id="1e3b0-130">Abbildung 2 zeigt sortierbare GridView aus, wenn die Daten nach Kategorie in alphabetischer Reihenfolge sortiert werden.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-130">Figure 2 shows the sortable GridView when its data is sorted by category in alphabetical order.</span></span>


<span data-ttu-id="1e3b0-131">[![Der sortierbare GridView s werden Daten nach Kategorie sortiert.](creating-a-customized-sorting-user-interface-vb/_static/image5.png)](creating-a-customized-sorting-user-interface-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="1e3b0-131">[![The Sortable GridView s Data is Ordered by Category](creating-a-customized-sorting-user-interface-vb/_static/image5.png)](creating-a-customized-sorting-user-interface-vb/_static/image4.png)</span></span>

<span data-ttu-id="1e3b0-132">**Abbildung 2**: der sortierbare GridView s Daten werden nach Kategorie geordnet ([klicken Sie hier, um das Bild in voller Größe angezeigt](creating-a-customized-sorting-user-interface-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="1e3b0-132">**Figure 2**: The Sortable GridView s Data is Ordered by Category ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image6.png))</span></span>


## <a name="step-2-exploring-techniques-for-adding-the-separator-rows"></a><span data-ttu-id="1e3b0-133">Schritt 2: Untersuchen von Techniken für das Hinzufügen von Trennzeichen für Zeilen</span><span class="sxs-lookup"><span data-stu-id="1e3b0-133">Step 2: Exploring Techniques for Adding the Separator Rows</span></span>

<span data-ttu-id="1e3b0-134">Mit der generischen, sortierbar GridView abgeschlossen übrig bleibt die Trennzeichen für Zeilen in der GridView vor jeder eindeutige sortierten Gruppe hinzufügen können.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-134">With the generic, sortable GridView complete, all that remains is to be able to add the separator rows in the GridView before each unique sorted group.</span></span> <span data-ttu-id="1e3b0-135">Doch wie können solche Zeilen injiziert in die GridView?</span><span class="sxs-lookup"><span data-stu-id="1e3b0-135">But how can such rows be injected into the GridView?</span></span> <span data-ttu-id="1e3b0-136">Im Wesentlichen benötigen wir zum iterieren durch die GridView s Zeilen ermittelt, auf die Unterschiede zwischen den Werten in der sortierten Spalte erfolgen, und fügen Sie der entsprechenden Trenndatei Zeile hinzu.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-136">Essentially, we need to iterate through the GridView s rows, determine where the differences occur between the values in the sorted column, and then add the appropriate separator row.</span></span> <span data-ttu-id="1e3b0-137">Bei der Betrachtung der Informationen zu diesem Problem scheint es natürlich, dass die Lösung an einer beliebigen Stelle in der GridView s liegt `RowDataBound` -Ereignishandler.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-137">When thinking about this problem, it seems natural that the solution lies somewhere in the GridView s `RowDataBound` event handler.</span></span> <span data-ttu-id="1e3b0-138">Wie in erläutert die [benutzerdefinierte Formatierung basierend auf Daten](../custom-formatting/custom-formatting-based-upon-data-vb.md) Lernprogramm diesen Ereignishandler wird häufig verwendet, wenn anhand von Daten aus der Zeile s auf Zeilenebene Formatierung anwenden.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-138">As we discussed in the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-vb.md) tutorial, this event handler is commonly used when applying row-level formatting based on the row s data.</span></span> <span data-ttu-id="1e3b0-139">Allerdings die `RowDataBound` -Ereignishandler ist nicht die Lösung, wie Zeilen an die GridView programmgesteuert aus diesem Ereignishandler hinzugefügt werden können.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-139">However, the `RowDataBound` event handler is not the solution here, as rows cannot be added to the GridView programmatically from this event handler.</span></span> <span data-ttu-id="1e3b0-140">Die GridView s `Rows` -Auflistung, in der Tat kann nur gelesen werden.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-140">The GridView s `Rows` collection, in fact, is read-only.</span></span>

<span data-ttu-id="1e3b0-141">Zum Hinzufügen von zusätzlicher Zeilen an die GridView haben wir drei Auswahlmöglichkeiten angezeigt:</span><span class="sxs-lookup"><span data-stu-id="1e3b0-141">To add additional rows to the GridView we have three choices:</span></span>

- <span data-ttu-id="1e3b0-142">Fügen Sie diese Metadaten Trennzeichen für Zeilen hinzu, auf die tatsächlichen Daten, die an die GridView gebunden ist</span><span class="sxs-lookup"><span data-stu-id="1e3b0-142">Add these metadata separator rows to the actual data that is bound to the GridView</span></span>
- <span data-ttu-id="1e3b0-143">Nachdem Sie auf die Daten die GridView gebunden wurde, hinzufügen, zusätzliche `TableRow` Datensammlung steuern, Instanzen mit dem GridView-s</span><span class="sxs-lookup"><span data-stu-id="1e3b0-143">After the GridView has been bound to the data, add additional `TableRow` instances to the GridView s control collection</span></span>
- <span data-ttu-id="1e3b0-144">Erstellen Sie ein benutzerdefiniertes Steuerelement, das erweitert des GridView-Steuerelements und überschreibt die Methoden, die verantwortlich für das Erstellen des GridView-s-Struktur</span><span class="sxs-lookup"><span data-stu-id="1e3b0-144">Create a custom server control that extends the GridView control and overrides those methods responsible for constructing the GridView s structure</span></span>

<span data-ttu-id="1e3b0-145">Erstellen eines benutzerdefinierten Steuerelements wäre der beste Ansatz, wenn diese Funktionalität auf viele Webseiten oder über mehrere Websites erforderlich war.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-145">Creating a custom server control would be the best approach if this functionality was needed on many web pages or across several websites.</span></span> <span data-ttu-id="1e3b0-146">Allerdings würde es relativ viel Code und eine gründliche Untersuchung in die Tiefen die interne Funktionsweise des GridView-s gelten.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-146">However, it would entail quite a bit of code and a thorough exploration into the depths of the GridView s internal workings.</span></span> <span data-ttu-id="1e3b0-147">Aus diesem Grund müssen wir die Option für dieses Lernprogramm nicht berücksichtigt.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-147">Therefore, we'll not consider that option for this tutorial.</span></span>

<span data-ttu-id="1e3b0-148">Hinzufügen von Trennzeichen für Zeilen auf die tatsächlichen Daten, die anderen beiden Optionen für an die GridView gebunden, und Bearbeiten von GridView s steuerelementauflistung nach seiner gebunden – für potenzielle Angriffe durch das Problem anders an, und eine Erläuterung bedürfen.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-148">The other two options adding separator rows to the actual data being bound to the GridView and manipulating the GridView s control collection after its been bound - attack the problem differently and merit a discussion.</span></span>

## <a name="adding-rows-to-the-data-bound-to-the-gridview"></a><span data-ttu-id="1e3b0-149">Hinzufügen von Zeilen auf die Daten an die GridView gebunden</span><span class="sxs-lookup"><span data-stu-id="1e3b0-149">Adding Rows to the Data Bound to the GridView</span></span>

<span data-ttu-id="1e3b0-150">Wenn die GridView mit einer Datenquelle gebunden ist, erstellt eine `GridViewRow` für jeden Datensatz von der Datenquelle zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-150">When the GridView is bound to a data source, it creates a `GridViewRow` for each record returned by the data source.</span></span> <span data-ttu-id="1e3b0-151">Daher können wir die erforderlichen Trennzeichen Zeilen einfügen, durch Trennzeichen Datensätze an die Datenquelle hinzufügen, bevor es an die GridView gebunden.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-151">Therefore, we can inject the needed separator rows by adding separator records to the data source before binding it to the GridView.</span></span> <span data-ttu-id="1e3b0-152">Abbildung 3 veranschaulicht dieses Konzept.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-152">Figure 3 illustrates this concept.</span></span>


![Ein Verfahren umfasst das Hinzufügen von Trennzeichen für Zeilen mit der Datenquelle](creating-a-customized-sorting-user-interface-vb/_static/image7.png)

<span data-ttu-id="1e3b0-154">**Abbildung 3**: ein Verfahren umfasst das Hinzufügen von Trennzeichen für Zeilen mit der Datenquelle</span><span class="sxs-lookup"><span data-stu-id="1e3b0-154">**Figure 3**: One Technique Involves Adding Separator Rows to the Data Source</span></span>


<span data-ttu-id="1e3b0-155">Ich verwenden Begriff Trennzeichen Datensätze in Anführungszeichen, da es keine spezielle Trennzeichen Datensatz; Stattdessen müssen wir aus irgendeinem Grund ein flag, die ein bestimmter Datensatz in der Datenquelle als Trennzeichen anstelle einer normalen Datenzeile dient.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-155">I use the term separator records in quotes because there is no special separator record; rather, we must somehow flag that a particular record in the data source serves as a separator rather than a normal data row.</span></span> <span data-ttu-id="1e3b0-156">Für diesen Beispielen, wir re-Bindung eine `ProductsDataTable` Instanz an die GridView, die besteht `ProductRows`.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-156">For our examples, we re binding a `ProductsDataTable` instance to the GridView, which is composed of `ProductRows`.</span></span> <span data-ttu-id="1e3b0-157">Wir möglicherweise einen Datensatz als eine Trennzeichenzeile kennzeichnen, durch Festlegen seiner `CategoryID` Eigenschaft `-1` (da dieser Wert nicht definiert t normalerweise vorhanden).</span><span class="sxs-lookup"><span data-stu-id="1e3b0-157">We might flag a record as a separator row by setting its `CategoryID` property to `-1` (since such a value couldn t exist normally).</span></span>

<span data-ttu-id="1e3b0-158">Um dieses Verfahren nutzen zu können, müssen wir d die folgenden Schritte ausführen:</span><span class="sxs-lookup"><span data-stu-id="1e3b0-158">To utilize this technique we d need to perform the following steps:</span></span>

1. <span data-ttu-id="1e3b0-159">Programmgesteuertes Abrufen von Daten an die GridView gebunden (eine `ProductsDataTable` Instanz)</span><span class="sxs-lookup"><span data-stu-id="1e3b0-159">Programmatically retrieve the data to bind to the GridView (a `ProductsDataTable` instance)</span></span>
2. <span data-ttu-id="1e3b0-160">Sortieren Sie die Daten basierend auf den GridView s `SortExpression` und `SortDirection` Eigenschaften</span><span class="sxs-lookup"><span data-stu-id="1e3b0-160">Sort the data based on the GridView s `SortExpression` and `SortDirection` properties</span></span>
3. <span data-ttu-id="1e3b0-161">Durchlaufen der `ProductsRows` in der `ProductsDataTable`, suchen, in denen die Unterschiede in der sortierten Spalte liegen</span><span class="sxs-lookup"><span data-stu-id="1e3b0-161">Iterate through the `ProductsRows` in the `ProductsDataTable`, looking for where the differences in the sorted column lie</span></span>
4. <span data-ttu-id="1e3b0-162">An jede Gruppengrenze einfügen ein Datensatzes Trennzeichen `ProductsRow` Instanz in die Datentabelle, eine, die s `CategoryID` festgelegt `-1` (oder die Bezeichnung erfassungsebene wurde, um einen Datensatz als Trennzeichen Datensatz markieren)</span><span class="sxs-lookup"><span data-stu-id="1e3b0-162">At each group boundary, inject a separator record `ProductsRow` instance into the DataTable, one that has it s `CategoryID` set to `-1` (or whatever designation was decided upon to mark a record as a separator record )</span></span>
5. <span data-ttu-id="1e3b0-163">Nach dem Räumen der Trennzeichen für Zeilen, binden Sie die Daten an die GridView programmgesteuert</span><span class="sxs-lookup"><span data-stu-id="1e3b0-163">After injecting the separator rows, programmatically bind the data to the GridView</span></span>

<span data-ttu-id="1e3b0-164">Zusätzlich zu den fünf Schritte d müssen ebenfalls einen Ereignishandler für GridView s bereitstellen `RowDataBound` Ereignis.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-164">In addition to these five steps, we d also need to provide an event handler for the GridView s `RowDataBound` event.</span></span> <span data-ttu-id="1e3b0-165">Hier prüfen wir d jeweils `DataRow` und zu bestimmen, ob es ein Trennzeichen wurde eine Zeile, deren `CategoryID` Einstellung wurde `-1`.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-165">Here, we d check each `DataRow` and determine if it was a separator row, one whose `CategoryID` setting was `-1`.</span></span> <span data-ttu-id="1e3b0-166">Wenn dies der Fall ist, möchten wir d wahrscheinlich die Formatierung oder den in den Zellen angezeigten Text anpassen.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-166">If so, we d probably want to adjust its formatting or the text displayed in the cell(s).</span></span>

<span data-ttu-id="1e3b0-167">Mithilfe dieser Technik für etwas mehr als die oben beschriebenen Räumen Grenzen für die Sortierung erforderlich werden, da Sie auch einen Ereignishandler für GridView s bereitstellen müssen `Sorting` Ereignis und Beibehalten von verfolgen die `SortExpression` und `SortDirection` Werte.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-167">Using this technique for injecting the sorting group boundaries requires a bit more work than outlined above, as you need to also provide an event handler for the GridView s `Sorting` event and keep track of the `SortExpression` and `SortDirection` values.</span></span>

## <a name="manipulating-the-gridview-s-control-collection-after-it-s-been-databound"></a><span data-ttu-id="1e3b0-168">Bearbeiten die GridView-s-Datensammlung dahinter steuern s datengebundenen wurde</span><span class="sxs-lookup"><span data-stu-id="1e3b0-168">Manipulating the GridView s Control Collection After It s Been Databound</span></span>

<span data-ttu-id="1e3b0-169">Anstatt die Daten vor dem binden es an die GridView-messaging, können wir die Trennzeichen für Zeilen hinzufügen *nach* die Daten an die GridView gebunden wurde.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-169">Rather than messaging the data before binding it to the GridView, we can add the separator rows *after* the data has been bound to the GridView.</span></span> <span data-ttu-id="1e3b0-170">Der Prozess der Datenbindung builds Serversteuerelementhierarchie der GridView s, die in Wirklichkeit ist einfach eine `Table` Instanz besteht aus einer Auflistung von Zeilen, von denen jede aus einer Auflistung von Zellen besteht.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-170">The process of data binding builds up the GridView s control hierarchy, which in reality is simply a `Table` instance composed of a collection of rows, each of which is composed of a collection of cells.</span></span> <span data-ttu-id="1e3b0-171">Insbesondere steuerelementauflistung GridView s enthält eine `Table` Objekt auf der Stammebene einer `GridViewRow` (abgeleitet aus der `TableRow` Klasse) für jeden Datensatz in der `DataSource` an die GridView gebunden und eine `TableCell` Objekt in jeder `GridViewRow` Instanz für jedes Datenfeld in der `DataSource`.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-171">Specifically, the GridView s control collection contains a `Table` object at its root, a `GridViewRow` (which is derived from the `TableRow` class) for each record in the `DataSource` bound to the GridView, and a `TableCell` object in each `GridViewRow` instance for each data field in the `DataSource`.</span></span>

<span data-ttu-id="1e3b0-172">Um Zeilen der Trennzeichen zwischen den einzelnen Sortierung Gruppen hinzuzufügen, können wir diese Steuerelementhierarchie direkt bearbeiten, nachdem es erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-172">To add separator rows between each sorting group, we can directly manipulate this control hierarchy once it has been created.</span></span> <span data-ttu-id="1e3b0-173">Wir können sicher sein, dass die Hierarchie der GridView-s-Steuerelemente zum letzten Mal nach der Zeit erstellt wurde, die die Seite gerendert wird.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-173">We can be confident that the GridView s control hierarchy has been created for the last time by the time the page is being rendered.</span></span> <span data-ttu-id="1e3b0-174">Dieser Ansatz daher überschreibt die `Page` Klasse s `Render` Methode, die an diesem Punkt die Steuerelementhierarchie GridView s endgültigen aktualisiert wird, um die erforderlichen Trennzeichen Zeilen enthalten.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-174">Therefore, this approach overrides the `Page` class s `Render` method, at which point the GridView s final control hierarchy is updated to include the needed separator rows.</span></span> <span data-ttu-id="1e3b0-175">Abbildung 4 zeigt diesen Vorgang.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-175">Figure 4 illustrates this process.</span></span>


<span data-ttu-id="1e3b0-176">[![Eine alternative Methode bearbeitet die Hierarchie der GridView-s-Steuerelemente](creating-a-customized-sorting-user-interface-vb/_static/image9.png)](creating-a-customized-sorting-user-interface-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="1e3b0-176">[![An Alternate Technique Manipulates the GridView s Control Hierarchy](creating-a-customized-sorting-user-interface-vb/_static/image9.png)](creating-a-customized-sorting-user-interface-vb/_static/image8.png)</span></span>

<span data-ttu-id="1e3b0-177">**Abbildung 4**: eine alternative Methode bearbeitet die GridView s Steuerelementhierarchie ([klicken Sie hier, um das Bild in voller Größe angezeigt](creating-a-customized-sorting-user-interface-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="1e3b0-177">**Figure 4**: An Alternate Technique Manipulates the GridView s Control Hierarchy ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image10.png))</span></span>


<span data-ttu-id="1e3b0-178">Für dieses Lernprogramm verwenden wir dieser zweite Ansatz, um die Sortierung benutzerfreundlichkeit anpassen.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-178">For this tutorial, we'll use this latter approach to customize the sorting user experience.</span></span>

> [!NOTE]
> <span data-ttu-id="1e3b0-179">Der Code ich m darstellen, in diesem Lernprogramm basiert auf dem Beispiel in [Teemu Keiski](http://aspadvice.com/blogs/joteke/default.aspx) s Blogeintrag [Wiedergabe eine Bit mit GridView sortieren Gruppierung](http://aspadvice.com/blogs/joteke/archive/2006/02/11/15130.aspx).</span><span class="sxs-lookup"><span data-stu-id="1e3b0-179">The code I m presenting in this tutorial is based on the example provided in [Teemu Keiski](http://aspadvice.com/blogs/joteke/default.aspx) s blog entry, [Playing a Bit with GridView Sort Grouping](http://aspadvice.com/blogs/joteke/archive/2006/02/11/15130.aspx).</span></span>


## <a name="step-3-adding-the-separator-rows-to-the-gridview-s-control-hierarchy"></a><span data-ttu-id="1e3b0-180">Schritt 3: Hinzufügen der Trennzeichen Zeilen an die GridView s Steuerelementhierarchie</span><span class="sxs-lookup"><span data-stu-id="1e3b0-180">Step 3: Adding the Separator Rows to the GridView s Control Hierarchy</span></span>

<span data-ttu-id="1e3b0-181">Da möchten wir nur die Trennzeichen für Zeilen an die GridView s Steuerelementhierarchie hinzufügen, nachdem seine Steuerelementhierarchie erstellt und zum letzten Mal auf dieser Seite finden Sie unter erstellt wurde, möchten wir diese Ergänzung am Ende des Lebenszyklus der Seite, aber vor der tatsächlichen GridView c ausführen uerelement Hierarchie ist in HTML gerendert wurde.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-181">Since we only want to add the separator rows to the GridView s control hierarchy after its control hierarchy has been created and created for the last time on that page visit, we want to perform this addition at the end of the page lifecycle, but before the actual GridView control hierarchy has been rendered into HTML.</span></span> <span data-ttu-id="1e3b0-182">Der neueste mögliche Punkt, an dem wir dies erreichen, ist die `Page` Klasse s `Render` Ereignis, das wir in unserer Code-Behind-Klasse, die mithilfe der folgenden Methodensignatur überschreiben können:</span><span class="sxs-lookup"><span data-stu-id="1e3b0-182">The latest possible point at which we can accomplish this is the `Page` class s `Render` event, which we can override in our code-behind class using the following method signature:</span></span>


[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample2.vb)]

<span data-ttu-id="1e3b0-183">Wenn die `Page` Klasse s ursprünglichen `Render` Methode wird aufgerufen, `base.Render(writer)` jedes der Steuerelemente auf der Seite gerendert wird, generiert das Markup, das basierend auf ihrer Hierarchie.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-183">When the `Page` class s original `Render` method is invoked `base.Render(writer)` each of the controls in the page will be rendered, generating the markup based on their control hierarchy.</span></span> <span data-ttu-id="1e3b0-184">Daher ist es unabdinglich, wir beide nennen `base.Render(writer)`, damit die Seite gerendert wird, und wir die GridView s manipulieren steuern Hierarchie vor dem Aufruf `base.Render(writer)`, sodass die GridView-s-Steuerelementhierarchie davor die Trennzeichen für Zeilen hinzugefügt wurden s wurde gerendert.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-184">Therefore it is imperative that we both call `base.Render(writer)`, so that the page is rendered, and that we manipulate the GridView s control hierarchy prior to calling `base.Render(writer)`, so that the separator rows have been added to the GridView s control hierarchy before it s been rendered.</span></span>

<span data-ttu-id="1e3b0-185">Zum Einfügen der Gruppenheader sortieren müssen wir sicherstellen, dass der Benutzer angefordert hat, dass die Daten sortiert werden.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-185">To inject the sort group headers we first need to ensure that the user has requested that the data be sorted.</span></span> <span data-ttu-id="1e3b0-186">Standardmäßig den GridView-s-Inhalt nicht sortiert sind und daher wir Verschlüsselungskennwort t muss jede Gruppe sortieren Header eingeben.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-186">By default, the GridView s contents are not sorted, and therefore we don t need to enter any group sorting headers.</span></span>

> [!NOTE]
> <span data-ttu-id="1e3b0-187">Wenn Sie möchten die GridView nach einer bestimmten Spalte sortiert werden, wenn die Seite erstmals geladen wird, rufen Sie die GridView s `Sort` Methode ersten Besuch der Seite "(aber nicht bei nachfolgenden Postbacks).</span><span class="sxs-lookup"><span data-stu-id="1e3b0-187">If you want the GridView to be sorted by a particular column when the page is first loaded, call the GridView s `Sort` method on the first page visit (but not on subsequent postbacks).</span></span> <span data-ttu-id="1e3b0-188">Um dies zu erreichen, fügen Sie diesen Aufruf in der `Page_Load` Ereignishandler innerhalb einer `if (!Page.IsPostBack)` bedingte.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-188">To accomplish this, add this call in the `Page_Load` event handler within an `if (!Page.IsPostBack)` conditional.</span></span> <span data-ttu-id="1e3b0-189">Verweisen auf die [Paging und Sortieren von Berichtsdaten](paging-and-sorting-report-data-vb.md) Tutorial Informationen Weitere Informationen über die `Sort` Methode.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-189">Refer back to the [Paging and Sorting Report Data](paging-and-sorting-report-data-vb.md) tutorial information for more on the `Sort` method.</span></span>


<span data-ttu-id="1e3b0-190">Vorausgesetzt, dass die Daten sortiert wurden, unsere nächste Aufgabe besteht, um zu bestimmen, welche Spalte die Daten sortiert wurde, und klicken Sie dann auf die Unterschiede in der betreffenden Spalte s sucht Zeilen zu durchsuchen Werte.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-190">Assuming that the data has been sorted, our next task is to determine what column the data was sorted by and then to scan the rows looking for differences in that column s values.</span></span> <span data-ttu-id="1e3b0-191">Der folgende Code stellt sicher, dass die Daten sortiert wurden, und sucht nach der Spalte, nach der die Daten sortiert wurden:</span><span class="sxs-lookup"><span data-stu-id="1e3b0-191">The following code ensures that the data has been sorted and finds the column by which the data has been sorted:</span></span>


[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample3.vb)]

<span data-ttu-id="1e3b0-192">Verfügt die GridView noch werden sortiert, die GridView s `SortExpression` wurde-Eigenschaft wird nicht festgelegt.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-192">If the GridView has yet to be sorted, the GridView s `SortExpression` property will not have been set.</span></span> <span data-ttu-id="1e3b0-193">Daher möchten wir nur die Trennzeichen für Zeilen hinzufügen, wenn diese Eigenschaft einen Wert hat.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-193">Therefore, we only want to add the separator rows if this property has some value.</span></span> <span data-ttu-id="1e3b0-194">Wenn dies der Fall ist, müssen wir als Nächstes den Index der Spalte zu bestimmen, mit dem die Daten sortiert wurde.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-194">If it does, we next need to determine the index of the column by which the data was sorted.</span></span> <span data-ttu-id="1e3b0-195">Dies wird erreicht, indem die GridView s durchlaufen `Columns` Auflistung, die Suche nach der Spalte, deren `SortExpression` Eigenschaft entspricht der GridView s `SortExpression` Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-195">This is accomplished by looping through the GridView s `Columns` collection, searching for the column whose `SortExpression` property equals the GridView s `SortExpression` property.</span></span> <span data-ttu-id="1e3b0-196">Zusätzlich zu den Spaltenindex s nehmen wir auch die `HeaderText` -Eigenschaft, die verwendet wird, wenn die Trennzeichen für Zeilen anzeigen.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-196">In addition to the column s index, we also grab the `HeaderText` property, which is used when displaying the separator rows.</span></span>

<span data-ttu-id="1e3b0-197">Mit dem Index der Spalte, nach der die Daten sortiert werden, besteht der letzte Schritt die Datenzeilen GridView instanzenauflistung.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-197">With the index of the column by which the data is sorted, the final step is to enumerate the rows of the GridView.</span></span> <span data-ttu-id="1e3b0-198">Wir möchten für jede Zeile zu bestimmen, ob der Wert des s sortierte Spalte aus der vorherigen Zeile s sortiert Spalte s-Wert unterscheidet sich.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-198">For each row we need to determine whether the sorted column s value differs from the previous row s sorted column s value.</span></span> <span data-ttu-id="1e3b0-199">Wenn wir also eine neue einfügen müssen `GridViewRow` Instanz in der Hierarchie.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-199">If so, we need to inject a new `GridViewRow` instance into the control hierarchy.</span></span> <span data-ttu-id="1e3b0-200">Dies erfolgt durch den folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="1e3b0-200">This is accomplished with the following code:</span></span>


[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample4.vb)]

<span data-ttu-id="1e3b0-201">Dieser Code beginnt durch Programmgesteuertes Verweisen auf die `Table` Objekt auf der Stammebene des GridView-s-Steuerelementhierarchie gefunden, und erstellen Sie eine Zeichenfolgenvariable mit dem Namen `lastValue`.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-201">This code starts by programmatically referencing the `Table` object found at the root of the GridView s control hierarchy and creating a string variable named `lastValue`.</span></span> <span data-ttu-id="1e3b0-202">`lastValue`Dient zum Vergleichen des aktuellen Zeile s sortiert Spaltenwert mit der vorherigen s-Zeilenwert.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-202">`lastValue` is used to compare the current row s sorted column value with the previous row s value.</span></span> <span data-ttu-id="1e3b0-203">Anschließend wird die GridView-s `Rows` Auflistung aufgezählt, und für jede Zeile befindet sich der Wert für die sortierte Spalte in der `currentValue` Variable.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-203">Next, the GridView s `Rows` collection is enumerated and for each row the value of the sorted column is stored in the `currentValue` variable.</span></span>

> [!NOTE]
> <span data-ttu-id="1e3b0-204">Um zu bestimmen, den Wert der Spalte sortiert s bestimmten Zeile, die ich verwende der Zelle s `Text` Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-204">To determine the value of the particular row s sorted column I use the cell s `Text` property.</span></span> <span data-ttu-id="1e3b0-205">Es funktioniert gut für BoundFields, aber funktioniert nicht wie gewünscht für von TemplateFields, CheckBoxFields, und so weiter.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-205">This works well for BoundFields, but will not work as desired for TemplateFields, CheckBoxFields, and so on.</span></span> <span data-ttu-id="1e3b0-206">Sehen wir uns wie alternative GridView-Felder in Kürze zu berücksichtigen.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-206">We'll look at how to account for alternate GridView fields shortly.</span></span>


<span data-ttu-id="1e3b0-207">Die `currentValue` und `lastValue` Variablen dann verglichen werden.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-207">The `currentValue` and `lastValue` variables are then compared.</span></span> <span data-ttu-id="1e3b0-208">Wenn Unterschiede festgestellt werden, müssen wir Steuerelementhierarchie eine Trennzeichenzeile neue hinzu.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-208">If they differ we need to add a new separator row to the control hierarchy.</span></span> <span data-ttu-id="1e3b0-209">Dies erfolgt durch den Index des zu bestimmen die `GridViewRow` in der `Table` s-Objekt `Rows` -Auflistung, Erstellen neuer `GridViewRow` und `TableCell` Instanzen und dem anschließenden Hinzufügen der `TableCell` und `GridViewRow` auf die Steuerelementhierarchie.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-209">This is accomplished by determining the index of the `GridViewRow` in the `Table` object s `Rows` collection, creating new `GridViewRow` and `TableCell` instances, and then adding the `TableCell` and `GridViewRow` to the control hierarchy.</span></span>

<span data-ttu-id="1e3b0-210">Beachten Sie, dass das Trennzeichen s, die einzelne Zeile `TableCell` ist so formatiert, dass es die gesamte Breite des GridView umfasst mit formatiert wird die `SortHeaderRowStyle` CSS-Klasse, und seine `Text` z. B., dass sie sowohl die Sortiergruppe zeigt Eigenschaftenname (z. B. die Kategorie "") und der Gruppe-s-Wert (z. B. Getränke).</span><span class="sxs-lookup"><span data-stu-id="1e3b0-210">Note that the separator row s lone `TableCell` is formatted such that it spans the entire width of the GridView, is formatted using the `SortHeaderRowStyle` CSS class, and has its `Text` property such that it shows both the sort group name (such as Category ) and the group s value (such as Beverages ).</span></span> <span data-ttu-id="1e3b0-211">Schließlich `lastValue` wird aktualisiert, um den Wert des `currentValue`.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-211">Finally, `lastValue` is updated to the value of `currentValue`.</span></span>

<span data-ttu-id="1e3b0-212">Die CSS-Klasse, die zum Formatieren der Sortierung Gruppenkopfzeile `SortHeaderRowStyle` muss angegeben werden, in der `Styles.css` Datei.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-212">The CSS class used to format the sorting group header row `SortHeaderRowStyle` needs to be specified in the `Styles.css` file.</span></span> <span data-ttu-id="1e3b0-213">Verwenden Sie beliebige formateinstellungen anzusprechen gerne; Die folgenden verwendet:</span><span class="sxs-lookup"><span data-stu-id="1e3b0-213">Feel free to use whatever style settings appeal to you; I used the following:</span></span>


[!code-css[Main](creating-a-customized-sorting-user-interface-vb/samples/sample5.css)]

<span data-ttu-id="1e3b0-214">Mit dem aktuellen Code fügt die Sortierung Schnittstelle sortieren Gruppenkopfzeilen beim Sortieren nach jeder BoundField (siehe Abbildung 5, die einen Screenshot beim Sortieren von Lieferant zeigt).</span><span class="sxs-lookup"><span data-stu-id="1e3b0-214">With the current code, the sorting interface adds sort group headers when sorting by any BoundField (see Figure 5, which shows a screenshot when sorting by supplier).</span></span> <span data-ttu-id="1e3b0-215">Allerdings sind beim Sortieren von jedem anderen Feldtyp (z. B. eine CheckBoxField oder TemplateField) der Sortierung Gruppenheader kein Ausgabeziel (siehe Abbildung 6) gefunden werden.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-215">However, when sorting by any other field type (such as a CheckBoxField or TemplateField), the sort group headers are nowhere to be found (see Figure 6).</span></span>


<span data-ttu-id="1e3b0-216">[![Die Sortierung Schnittstelle enthält sortieren Gruppenkopfzeilen, beim Sortieren nach BoundFields](creating-a-customized-sorting-user-interface-vb/_static/image12.png)](creating-a-customized-sorting-user-interface-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="1e3b0-216">[![The Sorting Interface Includes Sort Group Headers When Sorting by BoundFields](creating-a-customized-sorting-user-interface-vb/_static/image12.png)](creating-a-customized-sorting-user-interface-vb/_static/image11.png)</span></span>

<span data-ttu-id="1e3b0-217">**Abbildung 5**: der Sortierung Schnittstelle enthält sortieren Gruppe Header beim Sortieren nach BoundFields ([klicken Sie hier, um das Bild in voller Größe angezeigt](creating-a-customized-sorting-user-interface-vb/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="1e3b0-217">**Figure 5**: The Sorting Interface Includes Sort Group Headers When Sorting by BoundFields ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image13.png))</span></span>


<span data-ttu-id="1e3b0-218">[![Der Sort-Gruppenheader sind fehlende beim Sortieren einer CheckBoxField](creating-a-customized-sorting-user-interface-vb/_static/image15.png)](creating-a-customized-sorting-user-interface-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="1e3b0-218">[![The Sort Group Headers are Missing When Sorting a CheckBoxField](creating-a-customized-sorting-user-interface-vb/_static/image15.png)](creating-a-customized-sorting-user-interface-vb/_static/image14.png)</span></span>

<span data-ttu-id="1e3b0-219">**Abbildung 6**: Sortieren der Kopfzeilen werden fehlende beim Sortieren einer CheckBoxField ([klicken Sie hier, um das Bild in voller Größe angezeigt](creating-a-customized-sorting-user-interface-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="1e3b0-219">**Figure 6**: The Sort Group Headers are Missing When Sorting a CheckBoxField ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image16.png))</span></span>


<span data-ttu-id="1e3b0-220">Der Grund, die beim Sortieren nach einer CheckBoxField fehlen der Gruppenheader Sortieren ist, da der Code derzeit nur verwendet die `TableCell` s `Text` Eigenschaft zum Bestimmen des Werts, der die sortierte Spalte für jede Zeile.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-220">The reason the sort group headers are missing when sorting by a CheckBoxField is because the code currently uses just the `TableCell` s `Text` property to determine the value of the sorted column for each row.</span></span> <span data-ttu-id="1e3b0-221">Für CheckBoxFields die `TableCell` s `Text` Eigenschaft ist eine leere Zeichenfolge; stattdessen der Wert ist verfügbar, durch ein Kontrollkästchen-Websteuerelement, die innerhalb der `TableCell` s `Controls` Auflistung.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-221">For CheckBoxFields, the `TableCell` s `Text` property is an empty string; instead, the value is available through a CheckBox Web control that resides within the `TableCell` s `Controls` collection.</span></span>

<span data-ttu-id="1e3b0-222">Um Feldtypen als BoundFields behandeln zu können, müssen wir den Code zu erweitern, in dem die `currentValue` Variable zugewiesen wird überprüft, ob ein Kontrollkästchen in der `TableCell` s `Controls` Auflistung.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-222">To handle field types other than BoundFields, we need to augment the code where the `currentValue` variable is assigned to check for the existence of a CheckBox in the `TableCell` s `Controls` collection.</span></span> <span data-ttu-id="1e3b0-223">Anstatt `currentValue = gvr.Cells(sortColumnIndex).Text`, ersetzen Sie diesen Code durch Folgendes:</span><span class="sxs-lookup"><span data-stu-id="1e3b0-223">Instead of using `currentValue = gvr.Cells(sortColumnIndex).Text`, replace this code with the following:</span></span>


[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample6.vb)]

<span data-ttu-id="1e3b0-224">Dieser Code überprüft die sortierte Spalte `TableCell` für die aktuelle Zeile zu ermitteln, ob alle Steuerelemente in der `Controls` Auflistung.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-224">This code examines the sorted column `TableCell` for the current row to determine if there are any controls in the `Controls` collection.</span></span> <span data-ttu-id="1e3b0-225">Wenn Sie vorhanden sind, und das erste Steuerelement ein Kontrollkästchen der `currentValue` Variable wird festgelegt, auf Ja oder Nein, je nach den Kontrollkästchen s `Checked` Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-225">If there are, and the first control is a CheckBox, the `currentValue` variable is set to Yes or No, depending on the CheckBox s `Checked` property.</span></span> <span data-ttu-id="1e3b0-226">Der Wert stammt, andernfalls aus den `TableCell` s `Text` Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-226">Otherwise, the value is taken from the `TableCell` s `Text` property.</span></span> <span data-ttu-id="1e3b0-227">Diese Logik kann zum Behandeln der Sortierung für alle von TemplateFields, die in der GridView vorhanden sind, kann repliziert werden.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-227">This logic can be replicated to handle sorting for any TemplateFields that may exist in the GridView.</span></span>

<span data-ttu-id="1e3b0-228">Durch die oben aufgeführten Code hinzufügen jetzt der Gruppenheader Sortierreihenfolge beim Sortieren nach CheckBoxField nicht mehr unterstützte vorhanden sind (siehe Abbildung 7).</span><span class="sxs-lookup"><span data-stu-id="1e3b0-228">With the above code addition, the sort group headers are now present when sorting by the Discontinued CheckBoxField (see Figure 7).</span></span>


<span data-ttu-id="1e3b0-229">[![Der Sort-Gruppenheader sind jetzt vorhanden beim Sortieren einer CheckBoxField](creating-a-customized-sorting-user-interface-vb/_static/image18.png)](creating-a-customized-sorting-user-interface-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="1e3b0-229">[![The Sort Group Headers are Now Present When Sorting a CheckBoxField](creating-a-customized-sorting-user-interface-vb/_static/image18.png)](creating-a-customized-sorting-user-interface-vb/_static/image17.png)</span></span>

<span data-ttu-id="1e3b0-230">**Abbildung 7**: Sortieren der Kopfzeilen werden jetzt vorhanden beim Sortieren einer CheckBoxField ([klicken Sie hier, um das Bild in voller Größe angezeigt](creating-a-customized-sorting-user-interface-vb/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="1e3b0-230">**Figure 7**: The Sort Group Headers are Now Present When Sorting a CheckBoxField ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image19.png))</span></span>


> [!NOTE]
> <span data-ttu-id="1e3b0-231">Wenn Sie über Produkte mit `NULL` Datenbank Werte für die `CategoryID`, `SupplierID`, oder `UnitPrice` Felder, diese Werte als leere Zeichenfolgen in die GridView angezeigt werden, wird standardmäßig, d. h. Trennzeichen Zeilentext s für diese Produkte mit `NULL`Werte liest z. B. Kategorie: (d. h. es s kein Name nach Kategorie: like mit Kategorie: Getränke).</span><span class="sxs-lookup"><span data-stu-id="1e3b0-231">If you have products with `NULL` database values for the `CategoryID`, `SupplierID`, or `UnitPrice` fields, those values will appear as empty strings in the GridView by default, meaning the separator row s text for those products with `NULL` values will read like Category: (that is, there s no name after Category: like with Category: Beverages ).</span></span> <span data-ttu-id="1e3b0-232">Wenn ein Wert, der hier angezeigt werden soll, können Sie entweder die BoundFields festlegen [ `NullDisplayText` Eigenschaft](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.boundfield.nulldisplaytext.aspx) auf den Text angezeigt werden soll, oder Sie können eine bedingte Anweisung in der Render-Methode hinzufügen, beim Zuweisen der `currentValue` für den Separator Zeile s `Text` Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-232">If you want a value displayed here you can either set the BoundFields [`NullDisplayText` property](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.boundfield.nulldisplaytext.aspx) to the text you want displayed or you can add a conditional statement in the Render method when assigning the `currentValue` to the separator row s `Text` property.</span></span>


## <a name="summary"></a><span data-ttu-id="1e3b0-233">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="1e3b0-233">Summary</span></span>

<span data-ttu-id="1e3b0-234">Die GridView umfasst viele integrierten Optionen zum Anpassen der Benutzeroberfläche der Sortierung nicht.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-234">The GridView does not include many built-in options for customizing the sorting interface.</span></span> <span data-ttu-id="1e3b0-235">Allerdings mit einem gewissen Grad Code auf niedriger Ebene es s möglich GridView s Steuerelementhierarchie zum Erstellen einer stärker angepassten Benutzeroberfläche zu optimieren.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-235">However, with a bit of low-level code, it s possible to tweak the GridView s control hierarchy to create a more customized interface.</span></span> <span data-ttu-id="1e3b0-236">In diesem Lernprogramm wurde es erläutert, wie eine Sortierung Trennzeichen Gruppenzeile für einen sortierbaren GridView hinzufügen, die unterschiedlichen Gruppen und diesen Gruppen Grenzen leichter identifiziert werden.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-236">In this tutorial we saw how to add a sort group separator row for a sortable GridView, which more easily identifies the distinct groups and those groups boundaries.</span></span> <span data-ttu-id="1e3b0-237">Weitere Beispiele für benutzerdefinierte Sortierung Schnittstellen Auschecken [Scott Guthrie](https://weblogs.asp.net/scottgu/) s [einige ASP.NET 2.0 GridView sortieren Tipps und Tricks](https://weblogs.asp.net/scottgu/archive/2006/02/11/437995.aspx) Blogeintrag.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-237">For additional examples of customized sorting interfaces, check out [Scott Guthrie](https://weblogs.asp.net/scottgu/) s [A Few ASP.NET 2.0 GridView Sorting Tips and Tricks](https://weblogs.asp.net/scottgu/archive/2006/02/11/437995.aspx) blog entry.</span></span>

<span data-ttu-id="1e3b0-238">Viel Spaß beim Programmieren!</span><span class="sxs-lookup"><span data-stu-id="1e3b0-238">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="1e3b0-239">Informationen zum Autor</span><span class="sxs-lookup"><span data-stu-id="1e3b0-239">About the Author</span></span>

<span data-ttu-id="1e3b0-240">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor von sieben ASP/ASP.NET-Büchern und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), Microsoft Web-Technologien seit 1998 arbeitet.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-240">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="1e3b0-241">Scott fungiert als ein unabhängiger Berater, Trainer und Writer.</span><span class="sxs-lookup"><span data-stu-id="1e3b0-241">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="1e3b0-242">Sein neueste Buch wird [ *Sams Schulen selbst ASP.NET 2.0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="1e3b0-242">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="1e3b0-243">Er die erreicht werden kann, zur [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) oder über seinen Blog die finden Sie unter [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="1e3b0-243">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

>[!div class="step-by-step"]
[<span data-ttu-id="1e3b0-244">Zurück</span><span class="sxs-lookup"><span data-stu-id="1e3b0-244">Previous</span></span>](sorting-custom-paged-data-vb.md)
