---
uid: mvc/overview/older-versions-1/contact-manager/iteration-5-create-unit-tests-cs
title: 'Iteration #5 – erstellen Sie Komponententests erneut (c#) | Microsoft Docs'
author: microsoft
description: In der fünften Iteration stellen wir unsere Anwendung einfacher zu verwalten und ändern, indem Sie Komponententests hinzufügen. Wir unsere Daten Modellklassen modellieren und Erstellen von Komponententests für o...
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/20/2009
ms.topic: article
ms.assetid: 28ad8f80-b8a5-444e-b478-8b15a846060c
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/older-versions-1/contact-manager/iteration-5-create-unit-tests-cs
msc.type: authoredcontent
ms.openlocfilehash: 7a61b5791a40088df9d27f7b1bd37df1831ef22b
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/06/2018
ms.locfileid: "30875577"
---
<a name="iteration-5--create-unit-tests-c"></a><span data-ttu-id="6245b-104">Iteration #5: Generieren von Komponententests (c#)</span><span class="sxs-lookup"><span data-stu-id="6245b-104">Iteration #5 – Create unit tests (C#)</span></span>
====================
<span data-ttu-id="6245b-105">durch [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="6245b-105">by [Microsoft](https://github.com/microsoft)</span></span>

[<span data-ttu-id="6245b-106">Herunterladen von Code</span><span class="sxs-lookup"><span data-stu-id="6245b-106">Download Code</span></span>](iteration-5-create-unit-tests-cs/_static/contactmanager_5_cs1.zip)

> <span data-ttu-id="6245b-107">In der fünften Iteration stellen wir unsere Anwendung einfacher zu verwalten und ändern, indem Sie Komponententests hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="6245b-107">In the fifth iteration, we make our application easier to maintain and modify by adding unit tests.</span></span> <span data-ttu-id="6245b-108">Wir unsere Daten Modellklassen modellieren und erstellen Sie Komponententests für unsere Controller und die Validierungslogik.</span><span class="sxs-lookup"><span data-stu-id="6245b-108">We mock our data model classes and build unit tests for our controllers and validation logic.</span></span>


## <a name="building-a-contact-management-aspnet-mvc-application-c"></a><span data-ttu-id="6245b-109">Erstellen einer ASP.NET MVC-Anwendung Kontaktverwaltung (c#)</span><span class="sxs-lookup"><span data-stu-id="6245b-109">Building a Contact Management ASP.NET MVC Application (C#)</span></span>

<span data-ttu-id="6245b-110">In dieser Reihe von Lernprogrammen erstellen wir eine vollständige Contact Management-Anwendung von Grund auf Fertig stellen.</span><span class="sxs-lookup"><span data-stu-id="6245b-110">In this series of tutorials, we build an entire Contact Management application from start to finish.</span></span> <span data-ttu-id="6245b-111">Die Kontakt-Manager-Anwendung können Sie zum Speichern von Kontaktinformationen - Namen, Telefonnummern und e-Mail-Adressen - eine Liste der Personen.</span><span class="sxs-lookup"><span data-stu-id="6245b-111">The Contact Manager application enables you to store contact information - names, phone numbers and email addresses - for a list of people.</span></span>

<span data-ttu-id="6245b-112">Erstellen der Anwendung über mehrere Iterationen.</span><span class="sxs-lookup"><span data-stu-id="6245b-112">We build the application over multiple iterations.</span></span> <span data-ttu-id="6245b-113">Bei jeder Iteration verbessern wir allmählich die Anwendung.</span><span class="sxs-lookup"><span data-stu-id="6245b-113">With each iteration, we gradually improve the application.</span></span> <span data-ttu-id="6245b-114">Das Ziel dieses Ansatzes für mehrere Iteration ist, um den Grund für jede Änderung verstehen können.</span><span class="sxs-lookup"><span data-stu-id="6245b-114">The goal of this multiple iteration approach is to enable you to understand the reason for each change.</span></span>

- <span data-ttu-id="6245b-115">Iteration #1 – Erstellen der Anwendung.</span><span class="sxs-lookup"><span data-stu-id="6245b-115">Iteration #1 - Create the application.</span></span> <span data-ttu-id="6245b-116">In der ersten Iteration erstellen wir die Kontakt-Manager in der einfachsten möglich.</span><span class="sxs-lookup"><span data-stu-id="6245b-116">In the first iteration, we create the Contact Manager in the simplest way possible.</span></span> <span data-ttu-id="6245b-117">Wir fügen die Unterstützung für die grundlegenden Datenbankvorgängen: erstellen, lesen, aktualisieren und löschen (CRUD).</span><span class="sxs-lookup"><span data-stu-id="6245b-117">We add support for basic database operations: Create, Read, Update, and Delete (CRUD).</span></span>

- <span data-ttu-id="6245b-118">Iteration #2 – Stellen Sie die Anwendung gut aussehen.</span><span class="sxs-lookup"><span data-stu-id="6245b-118">Iteration #2 - Make the application look nice.</span></span> <span data-ttu-id="6245b-119">In dieser Iteration haben wir die Darstellung der Anwendung verbessern, indem Ändern der Standard-Gestaltungsvorlage für ASP.NET MVC-Ansicht und cascading Stylesheet.</span><span class="sxs-lookup"><span data-stu-id="6245b-119">In this iteration, we improve the appearance of the application by modifying the default ASP.NET MVC view master page and cascading style sheet.</span></span>

- <span data-ttu-id="6245b-120">Iteration #3 - formularvalidierung hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="6245b-120">Iteration #3 - Add form validation.</span></span> <span data-ttu-id="6245b-121">In der dritten Iteration fügen wir grundlegende formularvalidierung hinzu.</span><span class="sxs-lookup"><span data-stu-id="6245b-121">In the third iteration, we add basic form validation.</span></span> <span data-ttu-id="6245b-122">Es wird verhindert, dass Personen senden eines Formulars ohne erforderlichen Felder des Formulars abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="6245b-122">We prevent people from submitting a form without completing required form fields.</span></span> <span data-ttu-id="6245b-123">Wir überprüfen e-Mail-Adressen und Telefonnummern.</span><span class="sxs-lookup"><span data-stu-id="6245b-123">We also validate email addresses and phone numbers.</span></span>

- <span data-ttu-id="6245b-124">Iteration #4 – Stellen Sie die Anwendung, die lose miteinander verbunden.</span><span class="sxs-lookup"><span data-stu-id="6245b-124">Iteration #4 - Make the application loosely coupled.</span></span> <span data-ttu-id="6245b-125">In dieser dritten Iteration nutzen wir mehrere Software-Entwurfsmuster, damit sie leichter zu verwalten und ändern die Kontakt-Manager-Anwendung.</span><span class="sxs-lookup"><span data-stu-id="6245b-125">In this third iteration, we take advantage of several software design patterns to make it easier to maintain and modify the Contact Manager application.</span></span> <span data-ttu-id="6245b-126">Beispielsweise gestalten wir unsere Anwendung in das Repository und die Abhängigkeitsinjektion-Muster verwenden.</span><span class="sxs-lookup"><span data-stu-id="6245b-126">For example, we refactor our application to use the Repository pattern and the Dependency Injection pattern.</span></span>

- <span data-ttu-id="6245b-127">Iteration #5: Erstellen von Komponententests.</span><span class="sxs-lookup"><span data-stu-id="6245b-127">Iteration #5 - Create unit tests.</span></span> <span data-ttu-id="6245b-128">In der fünften Iteration stellen wir unsere Anwendung einfacher zu verwalten und ändern, indem Sie Komponententests hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="6245b-128">In the fifth iteration, we make our application easier to maintain and modify by adding unit tests.</span></span> <span data-ttu-id="6245b-129">Wir unsere Daten Modellklassen modellieren und erstellen Sie Komponententests für unsere Controller und die Validierungslogik.</span><span class="sxs-lookup"><span data-stu-id="6245b-129">We mock our data model classes and build unit tests for our controllers and validation logic.</span></span>

- <span data-ttu-id="6245b-130">Iteration #6 – verwenden Sie eine testgesteuerte Entwicklung.</span><span class="sxs-lookup"><span data-stu-id="6245b-130">Iteration #6 - Use test-driven development.</span></span> <span data-ttu-id="6245b-131">In dieser Iteration sechste wir neue Funktionalität Hinzufügen der Anwendung durch Schreiben von Komponententests zuerst und Code für die Komponententests schreiben.</span><span class="sxs-lookup"><span data-stu-id="6245b-131">In this sixth iteration, we add new functionality to our application by writing unit tests first and writing code against the unit tests.</span></span> <span data-ttu-id="6245b-132">In dieser Iteration fügen wir Kontakt Gruppen hinzu.</span><span class="sxs-lookup"><span data-stu-id="6245b-132">In this iteration, we add contact groups.</span></span>

- <span data-ttu-id="6245b-133">Iteration #7 - Ajax-Funktionen hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="6245b-133">Iteration #7 - Add Ajax functionality.</span></span> <span data-ttu-id="6245b-134">In der siebten Iteration werden die Reaktionsfähigkeit und die Leistung der Anwendung durch Hinzufügen von Unterstützung für Ajax verbessern.</span><span class="sxs-lookup"><span data-stu-id="6245b-134">In the seventh iteration, we improve the responsiveness and performance of our application by adding support for Ajax.</span></span>


## <a name="this-iteration"></a><span data-ttu-id="6245b-135">Diese Iteration</span><span class="sxs-lookup"><span data-stu-id="6245b-135">This Iteration</span></span>

<span data-ttu-id="6245b-136">In vorherigen Iterationen der Kontakt-Manager-Anwendung umgestaltet wir die Anwendung mehr lose miteinander verbunden werden.</span><span class="sxs-lookup"><span data-stu-id="6245b-136">In the previous iteration of the Contact Manager application, we refactored the application to be more loosely coupled.</span></span> <span data-ttu-id="6245b-137">Wir getrennt die Anwendung in unterschiedliche Controller-Dienst und Repository Ebenen.</span><span class="sxs-lookup"><span data-stu-id="6245b-137">We separated the application into distinct controller, service, and repository layers.</span></span> <span data-ttu-id="6245b-138">Jede Ebene die Interaktion mit der Ebene darunter über Schnittstellen.</span><span class="sxs-lookup"><span data-stu-id="6245b-138">Each layer interacts with the layer beneath it through interfaces.</span></span>

<span data-ttu-id="6245b-139">Wir haben umgestaltet, die Anwendung, damit die Anwendung leichter verwalten und ändern.</span><span class="sxs-lookup"><span data-stu-id="6245b-139">We refactored the application to make the application easier to maintain and modify.</span></span> <span data-ttu-id="6245b-140">Z. B. wenn wir eine neue datenzugriffstechnologie verwenden müssen, können wir einfach die Repository-Ebene ändern, ohne durch berühren der Controller oder die Dienstebene.</span><span class="sxs-lookup"><span data-stu-id="6245b-140">For example, if we need to use a new data access technology, we can simply change the repository layer without touching the controller or service layer.</span></span> <span data-ttu-id="6245b-141">Die Kontakt-Manager lose gekoppelt, machen wir Ve versucht die Anwendung stabiler zu ändern.</span><span class="sxs-lookup"><span data-stu-id="6245b-141">By making the Contact Manager loosely coupled, we ve made the application more resilient to change.</span></span>

<span data-ttu-id="6245b-142">Aber was geschieht, wenn wir ein neues Feature für die Kontakt-Manager-Anwendung hinzufügen müssen?</span><span class="sxs-lookup"><span data-stu-id="6245b-142">But, what happens when we need to add a new feature to the Contact Manager application?</span></span> <span data-ttu-id="6245b-143">Oder, was geschieht, wenn es einen Fehler beheben?</span><span class="sxs-lookup"><span data-stu-id="6245b-143">Or, what happens when we fix a bug?</span></span> <span data-ttu-id="6245b-144">Ein Wahrheitswert sad, aber auch bewährte beim Schreiben von Code ist, wenn Sie Code, die Sie erstellen, das Risiko von neuen Fehlern berühren.</span><span class="sxs-lookup"><span data-stu-id="6245b-144">A sad, but well proven, truth of writing code is that whenever you touch code you create the risk of introducing new bugs.</span></span>

<span data-ttu-id="6245b-145">Z. B. Fragen ein Tag, Ihre Vorgesetzte Sie sich, ein neues Feature in der Contact-Manager hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="6245b-145">For example, one fine day, your manager might ask you to add a new feature to the Contact Manager.</span></span> <span data-ttu-id="6245b-146">Sie möchte die Unterstützung für Kontaktgruppen hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="6245b-146">She wants you to add support for Contact Groups.</span></span> <span data-ttu-id="6245b-147">Möchte Ihnen das Aktivieren von Benutzern, ihre Kontakte in Gruppen wie z. B. Freunde, Geschäfts- und So weiter zu organisieren.</span><span class="sxs-lookup"><span data-stu-id="6245b-147">She wants you to enable users to organize their contacts into groups such as Friends, Business, and so on.</span></span>

<span data-ttu-id="6245b-148">Um dieses neue Feature zu implementieren, müssen Sie alle drei Ebenen der Kontakt-Manager-Anwendung zu ändern.</span><span class="sxs-lookup"><span data-stu-id="6245b-148">In order to implement this new feature, you'll need to modify all three layers of the Contact Manager application.</span></span> <span data-ttu-id="6245b-149">Sie müssen die Domänencontroller, die Dienstebene und das Repository neue Funktionalität hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="6245b-149">You'll need to add new functionality to the controllers, the service layer, and the repository.</span></span> <span data-ttu-id="6245b-150">Sobald Sie das Ändern von Code beginnen, besteht das Risiko, wichtige Funktionen, die vor dem gearbeitet hat.</span><span class="sxs-lookup"><span data-stu-id="6245b-150">As soon as you start modifying code, you risk breaking functionality that worked before.</span></span>

<span data-ttu-id="6245b-151">Umgestaltung unsere Anwendung in verschiedenen Ebenen, wie in vorherigen Iterationen ist gut.</span><span class="sxs-lookup"><span data-stu-id="6245b-151">Refactoring our application into separate layers, as we did in the previous iteration, was a good thing.</span></span> <span data-ttu-id="6245b-152">Da wir ganze Ebenen ändern, ohne den Rest der Anwendung können war gut.</span><span class="sxs-lookup"><span data-stu-id="6245b-152">It was a good thing because it enables us to make changes to entire layers without touching the rest of the application.</span></span> <span data-ttu-id="6245b-153">Wenn Sie den Code innerhalb einer Ebene leichter verwalten und ändern möchten, müssen Sie jedoch Komponententests für den Code zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="6245b-153">However, if you want to make the code within a layer easier to maintain and modify, you need to create unit tests for the code.</span></span>

<span data-ttu-id="6245b-154">Sie verwenden einer Einheit Test zu Test eine einzelne Einheit von Code.</span><span class="sxs-lookup"><span data-stu-id="6245b-154">You use a unit test to test an individual unit of code.</span></span> <span data-ttu-id="6245b-155">Diese Einheiten des Codes sind kleiner als der gesamte Anwendungsebenen.</span><span class="sxs-lookup"><span data-stu-id="6245b-155">These units of code are smaller than entire application layers.</span></span> <span data-ttu-id="6245b-156">Normalerweise verwenden Sie einen Komponententest um zu überprüfen, ob eine bestimmte Methode im Code auf die Weise verhält, die Sie erwarten.</span><span class="sxs-lookup"><span data-stu-id="6245b-156">Typically, you use a unit test to verify whether a particular method in your code behaves in the way that you expect.</span></span> <span data-ttu-id="6245b-157">Beispielsweise würden Sie einen Komponententest für die CreateContact()-Methode, die von der ContactManagerService-Klasse verfügbar gemacht werden erstellen.</span><span class="sxs-lookup"><span data-stu-id="6245b-157">For example, you would create a unit test for the CreateContact() method exposed by the ContactManagerService class.</span></span>

<span data-ttu-id="6245b-158">Komponententests für eine Anwendung Arbeit einfach wie ein Sicherheitsnetz.</span><span class="sxs-lookup"><span data-stu-id="6245b-158">The unit tests for an application work just like a safety net.</span></span> <span data-ttu-id="6245b-159">Wenn Sie Code in einer Anwendung ändern, können Sie einen Satz von Komponententests zu überprüfen, ob die Änderung die vorhandene Funktionalität unterbricht ausführen.</span><span class="sxs-lookup"><span data-stu-id="6245b-159">Whenever you modify code in an application, you can run a set of unit tests to check whether the modification breaks existing functionality.</span></span> <span data-ttu-id="6245b-160">Komponententests Lesbarkeit Ihres Codes sicher ist, ändern.</span><span class="sxs-lookup"><span data-stu-id="6245b-160">Unit tests make your code safe to modify.</span></span> <span data-ttu-id="6245b-161">Komponententests stellen alle des Codes in Ihrer Anwendung stabiler zu ändern.</span><span class="sxs-lookup"><span data-stu-id="6245b-161">Unit tests make all of the code in your application more resilient to change.</span></span>

<span data-ttu-id="6245b-162">In dieser Iteration werden Komponententests für unsere Kontakt-Manager-Anwendung hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="6245b-162">In this iteration, we add unit tests to our Contact Manager application.</span></span> <span data-ttu-id="6245b-163">Auf diese Weise können in der nächsten Iteration wir Kontakt zu Gruppen unsere Anwendung hinzufügen ohne wichtige vorhandenen Funktionen kümmern zu müssen.</span><span class="sxs-lookup"><span data-stu-id="6245b-163">That way, in the next iteration, we can add Contact Groups to our application without worrying about breaking existing functionality.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="6245b-164">Es gibt eine Vielzahl von Komponententest-Frameworks wie NUnit, xUnit.net und MbUnit.</span><span class="sxs-lookup"><span data-stu-id="6245b-164">There are a variety of unit testing frameworks including NUnit, xUnit.net, and MbUnit.</span></span> <span data-ttu-id="6245b-165">In diesem Lernprogramm verwenden wir die UnitTest-Framework mit Visual Studio enthalten.</span><span class="sxs-lookup"><span data-stu-id="6245b-165">In this tutorial, we use the unit testing framework included with Visual Studio.</span></span> <span data-ttu-id="6245b-166">Allerdings können Sie genauso einfach eines dieser Alternativen Frameworks verwenden.</span><span class="sxs-lookup"><span data-stu-id="6245b-166">However, you could just as easily use one of these alternative frameworks.</span></span>


## <a name="what-gets-tested"></a><span data-ttu-id="6245b-167">Was ruft getestet</span><span class="sxs-lookup"><span data-stu-id="6245b-167">What Gets Tested</span></span>

<span data-ttu-id="6245b-168">In der Idealerweise würden alle des Codes durch Komponententests abgedeckt werden.</span><span class="sxs-lookup"><span data-stu-id="6245b-168">In the perfect world, all of your code would be covered by unit tests.</span></span> <span data-ttu-id="6245b-169">In der idealerweise müssten Sie die perfekte Sicherheitsnetz.</span><span class="sxs-lookup"><span data-stu-id="6245b-169">In the perfect world, you would have the perfect safety net.</span></span> <span data-ttu-id="6245b-170">Sie können wäre kann jede Codezeile in der Anwendung ändern, und wissen sofort, durch die Komponententests ausführen, ob die Änderung die vorhandene Funktionalität unterbrochen wurde.</span><span class="sxs-lookup"><span data-stu-id="6245b-170">You would be able to modify any line of code in your application and know instantly, by executing your unit tests, whether the change broke existing functionality.</span></span>

<span data-ttu-id="6245b-171">Allerdings Verschlüsselungskennwort wir idealerweise live t.</span><span class="sxs-lookup"><span data-stu-id="6245b-171">However, we don t live in a perfect world.</span></span> <span data-ttu-id="6245b-172">In der Praxis beim Schreiben von Komponententests konzentrieren Sie sich zum Schreiben von Tests für Ihre Geschäftslogik (z. B. Validierungslogik).</span><span class="sxs-lookup"><span data-stu-id="6245b-172">In practice, when writing unit tests, you concentrate on writing tests for your business logic (for example, validation logic).</span></span> <span data-ttu-id="6245b-173">Insbesondere Sie *nicht* Schreiben von Komponententests für Ihre Daten Logik oder Ihre ansichtslogik zugreifen.</span><span class="sxs-lookup"><span data-stu-id="6245b-173">In particular, you *do not* write unit tests for your data access logic or your view logic.</span></span>

<span data-ttu-id="6245b-174">Um nützlich zu sein, müssen sehr schnelle Ausführen von Komponententests.</span><span class="sxs-lookup"><span data-stu-id="6245b-174">To be useful, unit tests must execute very quickly.</span></span> <span data-ttu-id="6245b-175">Sie können problemlos Hunderte (oder sogar Tausende) von Komponententests für eine Anwendung kumuliert werden.</span><span class="sxs-lookup"><span data-stu-id="6245b-175">You easily can accumulate hundreds (or even thousands) of unit tests for an application.</span></span> <span data-ttu-id="6245b-176">Wenn die Komponententests ausführen dauert müssen Sie vermeiden, ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="6245b-176">If the unit tests take a long time to run then you'll avoid executing them.</span></span> <span data-ttu-id="6245b-177">Ausführung lang andauernder Komponententests sind also für den Tag zu Tag codierungszwecke nutzlos.</span><span class="sxs-lookup"><span data-stu-id="6245b-177">In other words, long running unit tests are useless for day to day coding purposes.</span></span>

<span data-ttu-id="6245b-178">Aus diesem Grund Sie in der Regel nicht Komponententests für Code schreiben, die mit einer Datenbank interagiert.</span><span class="sxs-lookup"><span data-stu-id="6245b-178">For this reason, you typically do not write unit tests for code that interacts with a database.</span></span> <span data-ttu-id="6245b-179">Hunderte von Komponententests für eine live-Datenbank ausgeführt wird, würde zu langsam sein.</span><span class="sxs-lookup"><span data-stu-id="6245b-179">Running hundreds of unit tests against a live database would be too slow.</span></span> <span data-ttu-id="6245b-180">Stattdessen modellieren die Datenbank und Code schreiben, der die simulierten Datenbank interagiert (erörtert, simulieren eine Datenbank, die weiter unten).</span><span class="sxs-lookup"><span data-stu-id="6245b-180">Instead, you mock your database and write code that interacts with the mock database (we discuss mocking a database below).</span></span>

<span data-ttu-id="6245b-181">Eine ähnliche Grund sind in der Regel Komponententests für Sichten nicht geschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="6245b-181">For a similar reason, you typically do not write unit tests for views.</span></span> <span data-ttu-id="6245b-182">Um eine Ansicht zu testen, müssen Sie einen Webserver zu starten.</span><span class="sxs-lookup"><span data-stu-id="6245b-182">In order to test a view, you must spin up a web server.</span></span> <span data-ttu-id="6245b-183">Da Spinvorgänge Einrichten eines Webservers prozessspezifisch relativ langsam ist, wird das Erstellen von Komponententests für Ihre Ansichten nicht empfohlen.</span><span class="sxs-lookup"><span data-stu-id="6245b-183">Because spinning up a web server is a relatively slow process, creating unit tests for your views is not recommended.</span></span>

<span data-ttu-id="6245b-184">Wenn Ihre Sicht komplexe Logik enthält dann sollten Sie die Logik in Hilfsmethoden verschoben.</span><span class="sxs-lookup"><span data-stu-id="6245b-184">If your view contains complicated logic then you should consider moving the logic into Helper methods.</span></span> <span data-ttu-id="6245b-185">Sie können Komponententests für Hilfsmethoden schreiben, die ohne sich um einen Webserver ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="6245b-185">You can write unit tests for Helper methods that execute without spinning up a web server.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="6245b-186">Beim Schreiben von für Datenzugriffslogik Tests oder ansichtslogik nicht empfehlenswert, ist wenn Komponententests schreiben, können diese Tests sehr nützlich sein, beim Erstellen von funktionalen oder Integration testet.</span><span class="sxs-lookup"><span data-stu-id="6245b-186">While writing tests for data access logic or view logic is not a good idea when writing unit tests, these tests can be very valuable when building functional or integration tests.</span></span>


> [!NOTE] 
> 
> <span data-ttu-id="6245b-187">ASP.NET MVC ist das Web Forms-Ansichtsmodul.</span><span class="sxs-lookup"><span data-stu-id="6245b-187">ASP.NET MVC is the Web Forms View Engine.</span></span> <span data-ttu-id="6245b-188">Während der Web Forms-Ansichtsmodul auf einem Webserver abhängig ist, möglicherweise andere Ansichtsmodule nicht.</span><span class="sxs-lookup"><span data-stu-id="6245b-188">While the Web Forms View Engine is dependent on a web server, other view engines might not be.</span></span>


## <a name="using-a-mock-object-framework"></a><span data-ttu-id="6245b-189">Mithilfe eines simulierten-Objekt</span><span class="sxs-lookup"><span data-stu-id="6245b-189">Using a Mock Object Framework</span></span>

<span data-ttu-id="6245b-190">Wenn Sie Komponententests erstellen, müssen Sie fast immer ein Objekt modellieren Framework nutzen.</span><span class="sxs-lookup"><span data-stu-id="6245b-190">When building unit tests, you almost always need to take advantage of a Mock Object framework.</span></span> <span data-ttu-id="6245b-191">Ein Objekt modellieren-Framework können Sie Mocks und Stubs für die Klassen in Ihrer Anwendung zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="6245b-191">A Mock Object framework enables you to create mocks and stubs for the classes in your application.</span></span>

<span data-ttu-id="6245b-192">Ein Objekt modellieren-Framework können Sie z. B. um eine Pseudoversion des Repository-Klasse zu generieren.</span><span class="sxs-lookup"><span data-stu-id="6245b-192">For example, you can use a Mock Object framework to generate a mock version of your repository class.</span></span> <span data-ttu-id="6245b-193">Auf diese Weise können Sie das pseudorepository-Klasse anstelle der tatsächlichen Repository-Klasse in Ihren Komponententests verwenden.</span><span class="sxs-lookup"><span data-stu-id="6245b-193">That way, you can use the mock repository class instead of the real repository class in your unit tests.</span></span> <span data-ttu-id="6245b-194">Das pseudorepository mit können Sie die Ausführung von Datenbankcode beim Ausführen eines Komponententests zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="6245b-194">Using the mock repository enables you to avoid executing database code when executing a unit test.</span></span>

<span data-ttu-id="6245b-195">Visual Studio enthält ein Objekt modellieren Framework keine.</span><span class="sxs-lookup"><span data-stu-id="6245b-195">Visual Studio does not include a Mock Object framework.</span></span> <span data-ttu-id="6245b-196">Es gibt jedoch mehrere kommerzielle und open-Source-Objekt modellieren-Frameworks für .NET Framework verfügbar:</span><span class="sxs-lookup"><span data-stu-id="6245b-196">However, there are several commercial and open source Mock Object frameworks available for the .NET framework:</span></span>

1. <span data-ttu-id="6245b-197">Moq - dieses Framework wird unter der open-Source-BSD-Lizenz verfügbar.</span><span class="sxs-lookup"><span data-stu-id="6245b-197">Moq - This framework is available under the open source BSD license.</span></span> <span data-ttu-id="6245b-198">Download von Moq [ https://code.google.com/p/moq/ ](https://code.google.com/p/moq/).</span><span class="sxs-lookup"><span data-stu-id="6245b-198">You can download Moq from [https://code.google.com/p/moq/](https://code.google.com/p/moq/).</span></span>
2. <span data-ttu-id="6245b-199">Rhino Mocks – dieses Framework finden Sie unter der open-Source-BSD-Lizenz.</span><span class="sxs-lookup"><span data-stu-id="6245b-199">Rhino Mocks - This framework is available under the open source BSD license.</span></span> <span data-ttu-id="6245b-200">Download Rhino Mocks aus [ http://ayende.com/projects/rhino-mocks.aspx ](http://ayende.com/projects/rhino-mocks.aspx).</span><span class="sxs-lookup"><span data-stu-id="6245b-200">You can download Rhino Mocks from [http://ayende.com/projects/rhino-mocks.aspx](http://ayende.com/projects/rhino-mocks.aspx).</span></span>
3. <span data-ttu-id="6245b-201">Typemock Isolator - ist dies ein kommerziellen Framework.</span><span class="sxs-lookup"><span data-stu-id="6245b-201">Typemock Isolator - This is a commercial framework.</span></span> <span data-ttu-id="6245b-202">Sie können eine Testversion von herunterladen [ http://www.typemock.com/ ](http://www.typemock.com/).</span><span class="sxs-lookup"><span data-stu-id="6245b-202">You can download a trial version from [http://www.typemock.com/](http://www.typemock.com/).</span></span>

<span data-ttu-id="6245b-203">In diesem Lernprogramm möchte ich Moq verwenden.</span><span class="sxs-lookup"><span data-stu-id="6245b-203">In this tutorial, I decided to use Moq.</span></span> <span data-ttu-id="6245b-204">Allerdings können Sie genauso einfach verwenden Rhino Mocks oder Typemock Isolator das Mock Erstellen von Objekten für die Kontakt-Manager-Anwendung.</span><span class="sxs-lookup"><span data-stu-id="6245b-204">However, you could just as easily use Rhino Mocks or Typemock Isolator to create the Mock objects for the Contact Manager application.</span></span>

<span data-ttu-id="6245b-205">Bevor Sie Moq verwenden können, müssen Sie die folgenden Schritte ausführen:</span><span class="sxs-lookup"><span data-stu-id="6245b-205">Before you can use Moq, you need to complete the following steps:</span></span>

1. <span data-ttu-id="6245b-206">sein.</span><span class="sxs-lookup"><span data-stu-id="6245b-206">.</span></span>
2. <span data-ttu-id="6245b-207">Bevor Sie den Download entpacken, stellen Sie sicher, dass Sie mit der rechten Maustaste in der das, und klicken Sie auf die Schaltfläche "mit der Bezeichnung" **zum Aufheben der Sperre** (siehe Abbildung 1).</span><span class="sxs-lookup"><span data-stu-id="6245b-207">Before you unzip the download, make sure that you right-click the file and click the button labeled **Unblock** (see Figure 1).</span></span>
3. <span data-ttu-id="6245b-208">Entpacken Sie das herunterladen.</span><span class="sxs-lookup"><span data-stu-id="6245b-208">Unzip the download.</span></span>
4. <span data-ttu-id="6245b-209">Fügen Sie einen Verweis auf die Assembly Moq über Rechtsklick auf den Ordner "Verweise" im Projekt ContactManager.Tests und Auswahl **Verweis hinzufügen**.</span><span class="sxs-lookup"><span data-stu-id="6245b-209">Add a reference to the Moq assembly by right-clicking the References folder in the ContactManager.Tests project and selecting **Add Reference**.</span></span> <span data-ttu-id="6245b-210">Navigieren Sie unter der Registerkarte "Durchsuchen" zu dem Ordner, in dem Sie Moq entzippt, und wählen Sie die Assembly Moq.dll.</span><span class="sxs-lookup"><span data-stu-id="6245b-210">Under the Browse tab, browse to the folder where you unzipped Moq and select the Moq.dll assembly.</span></span> <span data-ttu-id="6245b-211">Klicken Sie auf die **OK** Schaltfläche.</span><span class="sxs-lookup"><span data-stu-id="6245b-211">Click the **OK** button.</span></span>
5. <span data-ttu-id="6245b-212">Nachdem Sie diese Schritte abgeschlossen haben, sollte der Ordner "Verweise", wie in Abbildung 2 aussehen.</span><span class="sxs-lookup"><span data-stu-id="6245b-212">After you complete these steps, your References folder should look like Figure 2.</span></span>


<span data-ttu-id="6245b-213">[![Das Aufheben der Blockierung Moq](iteration-5-create-unit-tests-cs/_static/image1.jpg)](iteration-5-create-unit-tests-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="6245b-213">[![Unblocking Moq](iteration-5-create-unit-tests-cs/_static/image1.jpg)](iteration-5-create-unit-tests-cs/_static/image1.png)</span></span>

<span data-ttu-id="6245b-214">**Abbildung 01**: das Aufheben der Blockierung Moq ([klicken Sie hier, um das Bild in voller Größe angezeigt](iteration-5-create-unit-tests-cs/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="6245b-214">**Figure 01**: Unblocking Moq([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image2.png))</span></span>


<span data-ttu-id="6245b-215">[![Nach dem Hinzufügen der Moq Verweise](iteration-5-create-unit-tests-cs/_static/image2.jpg)](iteration-5-create-unit-tests-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="6245b-215">[![References after adding Moq](iteration-5-create-unit-tests-cs/_static/image2.jpg)](iteration-5-create-unit-tests-cs/_static/image3.png)</span></span>

<span data-ttu-id="6245b-216">**Abbildung 02**: Verweise nach dem Hinzufügen der Moq ([klicken Sie hier, um das Bild in voller Größe angezeigt](iteration-5-create-unit-tests-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="6245b-216">**Figure 02**: References after adding Moq([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image4.png))</span></span>


## <a name="creating-unit-tests-for-the-service-layer"></a><span data-ttu-id="6245b-217">Erstellen von Komponententests für die Dienstebene</span><span class="sxs-lookup"><span data-stu-id="6245b-217">Creating Unit Tests for the Service Layer</span></span>

<span data-ttu-id="6245b-218">Lassen Sie s starten, indem Sie eine Reihe von Komponententests für unsere Kontakt-Manager-s-Dienst-Anwendungsebene erstellen.</span><span class="sxs-lookup"><span data-stu-id="6245b-218">Let s start by creating a set of unit tests for our Contact Manager application s service layer.</span></span> <span data-ttu-id="6245b-219">Wir verwenden diese Tests Überprüfungslogik zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="6245b-219">We'll use these tests to verify our validation logic.</span></span>

<span data-ttu-id="6245b-220">Erstellen Sie einen neuen Ordner namens Modelle im Projekt ContactManager.Tests.</span><span class="sxs-lookup"><span data-stu-id="6245b-220">Create a new folder named Models in the ContactManager.Tests project.</span></span> <span data-ttu-id="6245b-221">Als Nächstes mit der rechten Maustaste in den Ordner Models, und wählen Sie **hinzufügen, neue Test**.</span><span class="sxs-lookup"><span data-stu-id="6245b-221">Next, right-click the Models folder and select **Add, New Test**.</span></span> <span data-ttu-id="6245b-222">Die **neuen Test hinzufügen** Dialogfeld wie in Abbildung 3 wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="6245b-222">The **Add New Test** dialog shown in Figure 3 appears.</span></span> <span data-ttu-id="6245b-223">Wählen Sie die **Komponententest** Vorlage und Ihren neuen Test ContactManagerServiceTest.cs nennen.</span><span class="sxs-lookup"><span data-stu-id="6245b-223">Select the **Unit Test** template and name your new test ContactManagerServiceTest.cs.</span></span> <span data-ttu-id="6245b-224">Klicken Sie auf die **OK** Schaltfläche, um Ihren neuen Test zu Ihrem Testprojekt hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="6245b-224">Click the **OK** button to add your new test to your Test Project.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="6245b-225">Im Allgemeinen möchten Sie die Ordnerstruktur des Projekts Test in der Ordnerstruktur des ASP.NET MVC-Projekts entsprechen.</span><span class="sxs-lookup"><span data-stu-id="6245b-225">In general, you want the folder structure of your Test Project to match the folder structure of your ASP.NET MVC project.</span></span> <span data-ttu-id="6245b-226">Z. B. Controller Tests in einen Ordner Controller, Modell-Tests in einem Ordner Modelle platzieren und so weiter.</span><span class="sxs-lookup"><span data-stu-id="6245b-226">For example, you place controller tests in a Controllers folder, model tests in a Models folder, and so on.</span></span>


<span data-ttu-id="6245b-227">[![Models\ContactManagerServiceTest.cs](iteration-5-create-unit-tests-cs/_static/image3.jpg)](iteration-5-create-unit-tests-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="6245b-227">[![Models\ContactManagerServiceTest.cs](iteration-5-create-unit-tests-cs/_static/image3.jpg)](iteration-5-create-unit-tests-cs/_static/image5.png)</span></span>

<span data-ttu-id="6245b-228">**Abbildung 03**: Models\ContactManagerServiceTest.cs ([klicken Sie hier, um das Bild in voller Größe angezeigt](iteration-5-create-unit-tests-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="6245b-228">**Figure 03**: Models\ContactManagerServiceTest.cs([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image6.png))</span></span>


<span data-ttu-id="6245b-229">Zu Beginn möchten wir testen die CreateContact()-Methode, die von der ContactManagerService-Klasse verfügbar gemacht werden.</span><span class="sxs-lookup"><span data-stu-id="6245b-229">Initially, we want to test the CreateContact() method exposed by the ContactManagerService class.</span></span> <span data-ttu-id="6245b-230">Wir erstellen die folgenden fünf Tests:</span><span class="sxs-lookup"><span data-stu-id="6245b-230">We'll create the following five tests:</span></span>

- <span data-ttu-id="6245b-231">CreateContact() - Tests, CreateContact() gibt den Wert "true" zurück, wenn ein gültiger Kontakt an die Methode übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="6245b-231">CreateContact() - Tests that CreateContact() returns the value true when a valid Contact is passed to the method.</span></span>
- <span data-ttu-id="6245b-232">CreateContactRequiredFirstName() - Tests, dass eine Fehlermeldung Modellstatus, wenn ein Kontakt mit einem fehlenden Vornamen hinzugefügt wird an die CreateContact()-Methode übergeben.</span><span class="sxs-lookup"><span data-stu-id="6245b-232">CreateContactRequiredFirstName() - Tests that an error message is added to model state when a Contact with a missing first name is passed to the CreateContact() method.</span></span>
- <span data-ttu-id="6245b-233">CreateContactRequredLastName() - Tests, dass eine Fehlermeldung Modellstatus, wenn ein Kontakt mit einem fehlenden Nachname hinzugefügt wird an die CreateContact()-Methode übergeben.</span><span class="sxs-lookup"><span data-stu-id="6245b-233">CreateContactRequredLastName() - Tests that an error message is added to model state when a Contact with a missing last name is passed to the CreateContact() method.</span></span>
- <span data-ttu-id="6245b-234">CreateContactInvalidPhone() - Tests, dass eine Fehlermeldung Modellstatus, wenn eine Verbindung mit einer ungültigen Telefonnummer hinzugefügt wird an die CreateContact()-Methode übergeben.</span><span class="sxs-lookup"><span data-stu-id="6245b-234">CreateContactInvalidPhone() - Tests that an error message is added to model state when a Contact with an invalid phone number is passed to the CreateContact() method.</span></span>
- <span data-ttu-id="6245b-235">CreateContactInvalidEmail() - Tests, dass eine Fehlermeldung Modellstatus, wenn eine Verbindung mit der eine ungültige e-Mail-Adresse hinzugefügt wird an die CreateContact()-Methode übergeben...</span><span class="sxs-lookup"><span data-stu-id="6245b-235">CreateContactInvalidEmail() - Tests that an error message is added to model state when a Contact with an invalid email address is passed to the CreateContact() method..</span></span>

<span data-ttu-id="6245b-236">Der erste Test prüft, dass ein gültiger Kontakt keine tritt ein Validierungsfehler generiert.</span><span class="sxs-lookup"><span data-stu-id="6245b-236">The first test verifies that a valid Contact does not generate a validation error.</span></span> <span data-ttu-id="6245b-237">Überprüfen Sie jede der Validierungsregeln, die verbleibenden Tests.</span><span class="sxs-lookup"><span data-stu-id="6245b-237">The remaining tests check each of the validation rules.</span></span>

<span data-ttu-id="6245b-238">Der Code für diese Tests ist im Codebeispiel 1 enthalten.</span><span class="sxs-lookup"><span data-stu-id="6245b-238">The code for these tests is contained in Listing 1.</span></span>

<span data-ttu-id="6245b-239">**1 – Models\ContactManagerServiceTest.cs auflisten**</span><span class="sxs-lookup"><span data-stu-id="6245b-239">**Listing 1 - Models\ContactManagerServiceTest.cs**</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample1.cs)]


<span data-ttu-id="6245b-240">Da wir die Kontakt-Klasse in Codebeispiel 1 verwenden, müssen wir unsere Testprojekt einen Verweis zu Microsoft Entity Framework hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="6245b-240">Because we use the Contact class in Listing 1, we need to add a reference to the Microsoft Entity Framework to our Test project.</span></span> <span data-ttu-id="6245b-241">Fügen Sie einen Verweis auf die Assembly System.Data.Entity.</span><span class="sxs-lookup"><span data-stu-id="6245b-241">Add a reference to the System.Data.Entity assembly.</span></span>


<span data-ttu-id="6245b-242">Auflisten von 1 enthält eine Methode namens Initialize(), die mit dem [TestInitialize]-Attribut ergänzt wird.</span><span class="sxs-lookup"><span data-stu-id="6245b-242">Listing 1 contains a method named Initialize() that is decorated with the [TestInitialize] attribute.</span></span> <span data-ttu-id="6245b-243">Diese Methode wird automatisch aufgerufen, bevor Komponententests ausgeführt wird (es wird 5-Mal rechts vor jedem der Komponententests bezeichnet).</span><span class="sxs-lookup"><span data-stu-id="6245b-243">This method is called automatically before each of the unit tests is run (it is called 5 times right before each of the unit tests).</span></span> <span data-ttu-id="6245b-244">Die Initialize()-Methode erstellt eine simulierte Repository mit der folgenden Codezeile:</span><span class="sxs-lookup"><span data-stu-id="6245b-244">The Initialize() method creates a mock repository with the following line of code:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample2.cs)]

<span data-ttu-id="6245b-245">Diese Codezeile verwendet das Framework Moq, um eine simulierte Repository von der Schnittstelle IContactManagerRepository zu generieren.</span><span class="sxs-lookup"><span data-stu-id="6245b-245">This line of code uses the Moq framework to generate a mock repository from the IContactManagerRepository interface.</span></span> <span data-ttu-id="6245b-246">Das simulierte Repository wird anstelle der tatsächlichen EntityContactManagerRepository verwendet, um zu vermeiden, Zugriff auf die Datenbank aus, wenn jeder Komponententest ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="6245b-246">The mock repository is used instead of the actual EntityContactManagerRepository to avoid accessing the database when each unit test is run.</span></span> <span data-ttu-id="6245b-247">Das simulierte Repository implementiert die Methoden der Schnittstelle IContactManagerRepository, jedoch Methoden Stefan t eigentlich nichts.</span><span class="sxs-lookup"><span data-stu-id="6245b-247">The mock repository implements the methods of the IContactManagerRepository interface, but the methods don t actually do anything.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="6245b-248">Wenn Sie das Moq-Framework verwenden, besteht ein Unterschied zwischen \_MockRepository und \_mockRepository.Object.</span><span class="sxs-lookup"><span data-stu-id="6245b-248">When using the Moq framework, there is a distinction between \_mockRepository and \_mockRepository.Object.</span></span> <span data-ttu-id="6245b-249">Der erste Wert bezieht sich auf das Mock&lt;IContactManagerRepository&gt; Klasse enthält Methoden zur Angabe, wie sich das pseudorepository verhält.</span><span class="sxs-lookup"><span data-stu-id="6245b-249">The former refers to the Mock&lt;IContactManagerRepository&gt; class that contains methods for specifying how the mock repository will behave.</span></span> <span data-ttu-id="6245b-250">Der zweite Wert bezieht sich auf die tatsächlichen pseudorepository, das der IContactManagerRepository-Schnittstelle implementiert.</span><span class="sxs-lookup"><span data-stu-id="6245b-250">The latter refers to the actual mock repository that implements the IContactManagerRepository interface.</span></span>


<span data-ttu-id="6245b-251">Das simulierte Repository wird in die Initialize()-Methode verwendet beim Erstellen einer Instanz der Klasse ContactManagerService.</span><span class="sxs-lookup"><span data-stu-id="6245b-251">The mock repository is used in the Initialize() method when creating an instance of the ContactManagerService class.</span></span> <span data-ttu-id="6245b-252">Alle für die einzelnen Komponententests, diese Instanz der Klasse ContactManagerService verwenden.</span><span class="sxs-lookup"><span data-stu-id="6245b-252">All of the individual unit tests use this instance of the ContactManagerService class.</span></span>

<span data-ttu-id="6245b-253">Auflisten von 1 enthält fünf Methoden, die jeweils von den Komponententests entsprechen.</span><span class="sxs-lookup"><span data-stu-id="6245b-253">Listing 1 contains five methods that correspond to each of the unit tests.</span></span> <span data-ttu-id="6245b-254">Jede dieser Methoden wird mit dem [TestMethod]-Attribut ergänzt.</span><span class="sxs-lookup"><span data-stu-id="6245b-254">Each of these methods is decorated with the [TestMethod] attribute.</span></span> <span data-ttu-id="6245b-255">Wenn Sie die Komponententests ausführen, wird jede Methode, die dieses Attribut hat aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="6245b-255">When you run the unit tests, any method that has this attribute is called.</span></span> <span data-ttu-id="6245b-256">Das heißt, ist jede Methode, die mit dem [TestMethod]-Attribut ergänzt wird ein Komponententest.</span><span class="sxs-lookup"><span data-stu-id="6245b-256">In other words, any method that is decorated with the [TestMethod] attribute is a unit test.</span></span>

<span data-ttu-id="6245b-257">Der erste Komponententest, mit dem Namen CreateContact(), stellt sicher, dass der Wert "true" beim Aufrufen von CreateContact() zurückgegeben werden, wenn eine gültige Instanz der Klasse wenden Sie sich an die Methode übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="6245b-257">The first unit test, named CreateContact(), verifies that calling CreateContact() returns the value true when a valid instance of the Contact class is passed to the method.</span></span> <span data-ttu-id="6245b-258">Der Test erstellt eine Instanz der Klasse wenden Sie sich an, ruft die Methode CreateContact() und stellt sicher, dass CreateContact() gibt den Wert "true" zurück.</span><span class="sxs-lookup"><span data-stu-id="6245b-258">The test creates an instance of the Contact class, calls the CreateContact() method, and verifies that CreateContact() returns the value true.</span></span>

<span data-ttu-id="6245b-259">Die verbleibenden Tests stellen Sie sicher, dass beim Aufrufen der CreateContact()-Methode mit einer ungültigen wenden Sie sich an die Methode "false" zurückgegeben, und die erwarteten Überprüfungsfehlermeldung Modellzustand hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="6245b-259">The remaining tests verify that when the CreateContact() method is called with an invalid Contact then the method returns false and the expected validation error message is added to model state.</span></span> <span data-ttu-id="6245b-260">Der Test CreateContactRequiredFirstName() erstellt z. B. eine Instanz der Klasse wenden Sie sich an mit einer leeren Zeichenfolge für die zugehörige Eigenschaft FirstName an.</span><span class="sxs-lookup"><span data-stu-id="6245b-260">For example, the CreateContactRequiredFirstName() test creates an instance of the Contact class with an empty string for its FirstName property.</span></span> <span data-ttu-id="6245b-261">Als Nächstes wird die CreateContact()-Methode mit dem ungültigen Kontakt aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="6245b-261">Next, the CreateContact() method is called with the invalid Contact.</span></span> <span data-ttu-id="6245b-262">Der Test abschließend vergewissert sich, dass CreateContact() "false" zurückgibt und Modellstatus auf der erwartete Überprüfungsfehlermeldung enthält "Vorname ist erforderlich."</span><span class="sxs-lookup"><span data-stu-id="6245b-262">Finally, the test verifies that CreateContact() returns false and that model state contains the expected validation error message "First name is required."</span></span>

<span data-ttu-id="6245b-263">Sie können die Komponententests in Codebeispiel 1 ausführen, indem Sie im Menü die Option **Test führen Sie alle Tests in der Projektmappe (STRG + R, A)**.</span><span class="sxs-lookup"><span data-stu-id="6245b-263">You can run the unit tests in Listing 1 by selecting the menu option **Test, Run, All Tests in Solution (CTRL+R, A)**.</span></span> <span data-ttu-id="6245b-264">Die Ergebnisse der Tests werden im Fenster Testergebnisse angezeigt (siehe Abbildung 4).</span><span class="sxs-lookup"><span data-stu-id="6245b-264">The results of the tests are displayed in the Test Results window (see Figure 4).</span></span>


<span data-ttu-id="6245b-265">[![Testergebnisse](iteration-5-create-unit-tests-cs/_static/image4.jpg)](iteration-5-create-unit-tests-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="6245b-265">[![Test Results](iteration-5-create-unit-tests-cs/_static/image4.jpg)](iteration-5-create-unit-tests-cs/_static/image7.png)</span></span>

<span data-ttu-id="6245b-266">**Abbildung 04**: Testergebnisse ([klicken Sie hier, um das Bild in voller Größe angezeigt](iteration-5-create-unit-tests-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="6245b-266">**Figure 04**: Test Results ([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image8.png))</span></span>


## <a name="creating-unit-tests-for-controllers"></a><span data-ttu-id="6245b-267">Erstellen von Komponententests für Domänencontroller</span><span class="sxs-lookup"><span data-stu-id="6245b-267">Creating Unit Tests for Controllers</span></span>

<span data-ttu-id="6245b-268">ASP.NETMVC Anwendung kontrollieren des Flusses Eingreifen des Benutzers.</span><span class="sxs-lookup"><span data-stu-id="6245b-268">ASP.NETMVC application control the flow of user interaction.</span></span> <span data-ttu-id="6245b-269">Beim Testen eines Controllers möchten Sie testen, ob der Controller die richtigen Aktion Ergebnis und die Ansicht Daten zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="6245b-269">When testing a controller, you want to test whether the controller returns the right action result and view data.</span></span> <span data-ttu-id="6245b-270">Möglicherweise möchten Sie auch überprüfen, ob ein Controller mit Modellklassen in der erwarteten Weise interagiert.</span><span class="sxs-lookup"><span data-stu-id="6245b-270">You also might want to test whether a controller interacts with model classes in the manner expected.</span></span>

<span data-ttu-id="6245b-271">Auflisten von 2 enthält beispielsweise zwei Komponententests für den Kontakt Controller Create()--Methode.</span><span class="sxs-lookup"><span data-stu-id="6245b-271">For example, Listing 2 contains two unit tests for the Contact controller Create() method.</span></span> <span data-ttu-id="6245b-272">Der erste Komponententest stellt sicher, dass wenn ein gültiger Kontakt an die Create()--Methode übergeben wird, und klicken Sie dann die Create()--Methode, die Index-Aktion umleitet.</span><span class="sxs-lookup"><span data-stu-id="6245b-272">The first unit test verifies that when a valid Contact is passed to the Create() method then the Create() method redirects to the Index action.</span></span> <span data-ttu-id="6245b-273">Das heißt, sollten wenn einen gültigen Kontakt zu übergeben, die Create()--Methode eine RedirectToRouteResult zurück, die Index-Aktion darstellt.</span><span class="sxs-lookup"><span data-stu-id="6245b-273">In other words, when passed a valid Contact, the Create() method should return a RedirectToRouteResult that represents the Index action.</span></span>

<span data-ttu-id="6245b-274">Wir raten t ContactManager-Dienstebene zu testen, wenn wir die Controller-Ebene testen möchten.</span><span class="sxs-lookup"><span data-stu-id="6245b-274">We don t want to test the ContactManager service layer when we are testing the controller layer.</span></span> <span data-ttu-id="6245b-275">Daher modellieren wir die Dienstschicht mit den folgenden Code in die Initialize-Methode:</span><span class="sxs-lookup"><span data-stu-id="6245b-275">Therefore, we mock the service layer with the following code in the Initialize method:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample3.cs)]

<span data-ttu-id="6245b-276">In den Komponententest CreateValidContact() modellieren wir das Verhalten von aufrufenden die Dienstebene CreateContact()-Methode, mit der folgenden Codezeile:</span><span class="sxs-lookup"><span data-stu-id="6245b-276">In the CreateValidContact() unit test, we mock the behavior of calling the service layer CreateContact() method with the following line of code:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample4.cs)]

<span data-ttu-id="6245b-277">Diese Codezeile führt dazu, dass den simulierten ContactManager-Dienst den Wert "true" zurückgeben, wenn seine CreateContact()-Methode aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="6245b-277">This line of code causes the mock ContactManager service to return the value true when its CreateContact() method is called.</span></span> <span data-ttu-id="6245b-278">Durch simulieren die Dienstebene, können das Verhalten des unser Controller testen, ohne Ausführen von Code in der Dienstebene.</span><span class="sxs-lookup"><span data-stu-id="6245b-278">By mocking the service layer, we can test the behavior of our controller without needing to execute any code in the service layer.</span></span>

<span data-ttu-id="6245b-279">Im zweite Komponententest wird überprüft, ob die Create()--Aktion die Erstellungsansicht zurück, wenn Sie ein ungültiger Kontakt an die Methode übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="6245b-279">The second unit test verifies that the Create() action returns the Create view when an invalid contact is passed to the method.</span></span> <span data-ttu-id="6245b-280">Wir führen die Dienstebene CreateContact()-Methode, um den Wert "false", mit der folgenden Zeile des Codes zurückgeben:</span><span class="sxs-lookup"><span data-stu-id="6245b-280">We cause the service layer CreateContact() method to return the value false with the following line of code:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample5.cs)]

<span data-ttu-id="6245b-281">Wenn die Methode Create()-verhält sich wie erwartet sollte er die Erstellungsansicht zurückgeben, wenn die Dienstebene der Wert "false" zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="6245b-281">If the Create() method behaves as we expect then it should return the Create view when the service layer returns the value false.</span></span> <span data-ttu-id="6245b-282">Auf diese Weise kann der Controller die Überprüfungsfehlermeldungen in die Erstellungsansicht und der Benutzer hat die Möglichkeit, diese ungültigen Kontakteigenschaften korrigieren.</span><span class="sxs-lookup"><span data-stu-id="6245b-282">That way, the controller can display the validation error messages in the Create view and the user has a chance to correct that invalid Contact properties.</span></span>


<span data-ttu-id="6245b-283">Wenn Sie Komponententests für Ihre Domänencontroller erstellen möchten, müssen Sie explizite Sichtnamen aus Ihrer Controlleraktionen zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="6245b-283">If you plan to build unit tests for your controllers then you need to return explicit view names from your controller actions.</span></span> <span data-ttu-id="6245b-284">Beispielsweise geben eine Ansicht wie folgt zurück:</span><span class="sxs-lookup"><span data-stu-id="6245b-284">For example, do not return a view like this:</span></span>

<span data-ttu-id="6245b-285">View() wird zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="6245b-285">return View();</span></span>

<span data-ttu-id="6245b-286">Geben Sie die Sicht wie folgt:</span><span class="sxs-lookup"><span data-stu-id="6245b-286">Instead, return the view like this:</span></span>

<span data-ttu-id="6245b-287">View("Create") wird zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="6245b-287">return View("Create");</span></span>

<span data-ttu-id="6245b-288">Wenn Sie nicht explizit sind bei der Rückgabe einer Sicht werden für die ViewResult.ViewName-Eigenschaft eine leere Zeichenfolge zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="6245b-288">If you are not explicit when returning a view then the ViewResult.ViewName property returns an empty string.</span></span>


<span data-ttu-id="6245b-289">**Auflisten von 2 – Controllers\ContactControllerTest.cs**</span><span class="sxs-lookup"><span data-stu-id="6245b-289">**Listing 2 - Controllers\ContactControllerTest.cs**</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample6.cs)]

## <a name="summary"></a><span data-ttu-id="6245b-290">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="6245b-290">Summary</span></span>

<span data-ttu-id="6245b-291">In dieser Iteration wurde Komponententests für unsere Kontakt-Manager-Anwendung erstellt.</span><span class="sxs-lookup"><span data-stu-id="6245b-291">In this iteration, we created unit tests for our Contact Manager application.</span></span> <span data-ttu-id="6245b-292">Wir können diese Komponententests ausführen, um sicherzustellen, dass die Anwendung weiterhin auf die Weise verhält sich, das wir voraussichtlich jederzeit.</span><span class="sxs-lookup"><span data-stu-id="6245b-292">We can run these unit tests at any time to verify that our application still behaves in the manner that we expect.</span></span> <span data-ttu-id="6245b-293">Die Komponententests fungieren als Sicherheitsnetz für unsere Anwendung aktivieren uns so ändern Sie die Anwendung in der Zukunft sicher.</span><span class="sxs-lookup"><span data-stu-id="6245b-293">The unit tests act as a safety net for our application enabling us to safely modify our application in the future.</span></span>

<span data-ttu-id="6245b-294">Wir erstellt zwei Sätze von Komponententests.</span><span class="sxs-lookup"><span data-stu-id="6245b-294">We created two sets of unit tests.</span></span> <span data-ttu-id="6245b-295">Zunächst haben wir Überprüfungslogik durch das Erstellen von Komponententests für unsere Dienstschicht getestet.</span><span class="sxs-lookup"><span data-stu-id="6245b-295">First, we tested our validation logic by creating unit tests for our service layer.</span></span> <span data-ttu-id="6245b-296">Als Nächstes haben wir unsere datenflusskontrolllogik durch das Erstellen von Komponententests für unsere Controller-Ebene getestet.</span><span class="sxs-lookup"><span data-stu-id="6245b-296">Next, we tested our flow control logic by creating unit tests for our controller layer.</span></span> <span data-ttu-id="6245b-297">Beim Testen unserer Dienstschicht isoliert wir unsere Tests für unsere Dienstschicht aus unserem Repository-Ebene durch unsere Repository-Ebene zu simulieren.</span><span class="sxs-lookup"><span data-stu-id="6245b-297">When testing our service layer, we isolated our tests for our service layer from our repository layer by mocking our repository layer.</span></span> <span data-ttu-id="6245b-298">Beim Testen der Controller-Ebene isoliert wir unsere Tests für unsere Controller Ebene durch die Dienstebene imitieren.</span><span class="sxs-lookup"><span data-stu-id="6245b-298">When testing the controller layer, we isolated our tests for our controller layer by mocking the service layer.</span></span>

<span data-ttu-id="6245b-299">In der nächsten Iteration ändern wir die Kontakt-Manager-Anwendung, sodass er Kontaktgruppen unterstützt.</span><span class="sxs-lookup"><span data-stu-id="6245b-299">In the next iteration, we modify the Contact Manager application so that it supports Contact Groups.</span></span> <span data-ttu-id="6245b-300">Diese neue Funktionalität fügen wir in unserer-Anwendung mit einer Software-Entwurfsprozess testorientierte Entwicklung aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="6245b-300">We'll add this new functionality to our application using a software design process called test-driven development.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="6245b-301">[Zurück](iteration-4-make-the-application-loosely-coupled-cs.md)
> [Weiter](iteration-6-use-test-driven-development-cs.md)</span><span class="sxs-lookup"><span data-stu-id="6245b-301">[Previous](iteration-4-make-the-application-loosely-coupled-cs.md)
[Next](iteration-6-use-test-driven-development-cs.md)</span></span>
