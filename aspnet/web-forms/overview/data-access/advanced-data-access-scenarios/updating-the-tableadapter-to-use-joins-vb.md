---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-vb
title: Aktualisieren des TableAdapters zu verwendenden verknüpft (VB) | Microsoft Docs
author: rick-anderson
description: Bei der Arbeit mit einer Datenbank ist es üblich, Anforderungsdaten verwendet werden, die über mehrere Tabellen verteilt werden. Zum Abrufen von Daten aus zwei verschiedenen Tabellen können wir entweder...
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/18/2007
ms.topic: article
ms.assetid: e624a3e0-061b-4efc-8b0e-5877f9ff6714
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-vb
msc.type: authoredcontent
ms.openlocfilehash: 91d700f3de02dc78692e933644e221e2ac8175a1
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/06/2018
---
<a name="updating-the-tableadapter-to-use-joins-vb"></a><span data-ttu-id="58713-104">Aktualisieren des TableAdapters zu verwendenden verknüpft (VB)</span><span class="sxs-lookup"><span data-stu-id="58713-104">Updating the TableAdapter to Use JOINs (VB)</span></span>
====================
<span data-ttu-id="58713-105">durch [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="58713-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="58713-106">[Herunterladen von Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_VB.zip) oder [PDF herunterladen](updating-the-tableadapter-to-use-joins-vb/_static/datatutorial69vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="58713-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_VB.zip) or [Download PDF](updating-the-tableadapter-to-use-joins-vb/_static/datatutorial69vb1.pdf)</span></span>

> <span data-ttu-id="58713-107">Bei der Arbeit mit einer Datenbank ist es üblich, Anforderungsdaten verwendet werden, die über mehrere Tabellen verteilt werden.</span><span class="sxs-lookup"><span data-stu-id="58713-107">When working with a database it is common to request data that is spread across multiple tables.</span></span> <span data-ttu-id="58713-108">Zum Abrufen von Daten aus zwei verschiedenen Tabellen können wir eine korrelierte Unterabfrage oder ein JOIN-Vorgang.</span><span class="sxs-lookup"><span data-stu-id="58713-108">To retrieve data from two different tables we can use either a correlated subquery or a JOIN operation.</span></span> <span data-ttu-id="58713-109">In diesem Lernprogramm Vergleichen wir korrelierte Unterabfragen und die JOIN-Syntax vor dem Blick auf einen TableAdapter erstellen, die einen JOIN in der Hauptabfrage enthält.</span><span class="sxs-lookup"><span data-stu-id="58713-109">In this tutorial we compare correlated subqueries and the JOIN syntax before looking at how to create a TableAdapter that includes a JOIN in its main query.</span></span>


## <a name="introduction"></a><span data-ttu-id="58713-110">Einführung</span><span class="sxs-lookup"><span data-stu-id="58713-110">Introduction</span></span>

<span data-ttu-id="58713-111">Bei relationalen Datenbanken werden die Daten, die wir bei der Arbeit mit Interesse sind oft auf mehrere Tabellen verteilt.</span><span class="sxs-lookup"><span data-stu-id="58713-111">With relational databases the data we are interested in working with is often spread across multiple tables.</span></span> <span data-ttu-id="58713-112">Z. B. beim Anzeigen von Produktinformationen wir wahrscheinlich so Listen Sie jede entsprechende s Produktkategorie und s Lieferantennamen.</span><span class="sxs-lookup"><span data-stu-id="58713-112">For example, when displaying product information we likely want to list each product s corresponding category and supplier s names.</span></span> <span data-ttu-id="58713-113">Die `Products` Tabelle hat `CategoryID` und `SupplierID` Werte, aber die tatsächlichen Namen der Kategorie und Lieferanten befinden sich in der `Categories` und `Suppliers` Tabellen.</span><span class="sxs-lookup"><span data-stu-id="58713-113">The `Products` table has `CategoryID` and `SupplierID` values, but the actual category and supplier names are in the `Categories` and `Suppliers` tables, respectively.</span></span>

<span data-ttu-id="58713-114">Abrufen von Informationen aus einer anderen, verwandten Tabelle können wir entweder *korrelierte Unterabfragen* oder `JOIN` *s*.</span><span class="sxs-lookup"><span data-stu-id="58713-114">To retrieve information from another, related table, we can either use *correlated subqueries* or `JOIN`*s*.</span></span> <span data-ttu-id="58713-115">Eine korrelierte Unterabfrage ist eine geschachtelte `SELECT` Abfrage, die Spalten in der äußeren Abfrage verweist.</span><span class="sxs-lookup"><span data-stu-id="58713-115">A correlated subquery is a nested `SELECT` query that references columns in the outer query.</span></span> <span data-ttu-id="58713-116">Beispielsweise ist in der [erstellen eine Datenzugriffsschicht](../introduction/creating-a-data-access-layer-vb.md) Lernprogramm wir zwei korrelierte Unterabfragen in verwendet der `ProductsTableAdapter` Hauptabfrage s, den Namen der Kategorie und Lieferanten für jedes Produkt zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="58713-116">For example, in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md) tutorial we used two correlated subqueries in the `ProductsTableAdapter` s main query to return the category and supplier names for each product.</span></span> <span data-ttu-id="58713-117">Ein `JOIN` ist eine SQL-Konstrukt, das verknüpfte Zeilen aus zwei verschiedenen Tabellen zusammengeführt.</span><span class="sxs-lookup"><span data-stu-id="58713-117">A `JOIN` is a SQL construct that merges related rows from two different tables.</span></span> <span data-ttu-id="58713-118">Es verwendet ein `JOIN` in der [Abfragen von Daten mit SqlDataSource-Steuerelement](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb.md) Lernprogramm aus, um Informationen zu Auftragskategorien neben jedem Produkt anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="58713-118">We used a `JOIN` in the [Querying Data with the SqlDataSource Control](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb.md) tutorial to display category information alongside each product.</span></span>

<span data-ttu-id="58713-119">Der Grund, wir haben verbunden, von der Verwendung `JOIN` s mit TableAdapters ist aufgrund von Einschränkungen bezüglich der TableAdapter-s-Assistent automatisch entsprechende generiert `INSERT`, `UPDATE`, und `DELETE` Anweisungen.</span><span class="sxs-lookup"><span data-stu-id="58713-119">The reason we have abstained from using `JOIN` s with the TableAdapters is because of limitations in the TableAdapter s wizard to auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="58713-120">Genauer gesagt, wenn die Hauptabfrage des TableAdapter s enthält `JOIN` s, TableAdapter kann keine automatischen Erstellen von der Ad-hoc-SQL-Anweisungen oder gespeicherte Prozeduren für die `InsertCommand`, `UpdateCommand`, und `DeleteCommand` Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="58713-120">More specifically, if the TableAdapter s main query contains any `JOIN` s, the TableAdapter cannot auto-create the ad-hoc SQL statements or stored procedures for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span>

<span data-ttu-id="58713-121">In diesem Lernprogramm, wir kurz vergleichen wird und Kontrast korrelierte Unterabfragen und `JOIN` s vor untersuchen wie einen TableAdapter erstellen, enthält `JOIN` s in der Hauptabfrage.</span><span class="sxs-lookup"><span data-stu-id="58713-121">In this tutorial we will briefly compare and contrast correlated subqueries and `JOIN` s before exploring how to create a TableAdapter that includes `JOIN` s in its main query.</span></span>

## <a name="comparing-and-contrasting-correlated-subqueries-andjoin-s"></a><span data-ttu-id="58713-122">Vergleichen und gegenüberstellen korrelierte Unterabfragen und`JOIN` s</span><span class="sxs-lookup"><span data-stu-id="58713-122">Comparing and Contrasting Correlated Subqueries and`JOIN` s</span></span>

<span data-ttu-id="58713-123">Bedenken Sie, dass die `ProductsTableAdapter` in im ersten Lernprogramm erstellt die `Northwind` DataSet korrelierte Unterabfragen s entsprechende Kategorie und Lieferanten Produktnamen wieder zurückbekommen verwendet.</span><span class="sxs-lookup"><span data-stu-id="58713-123">Recall that the `ProductsTableAdapter` created in the first tutorial in the `Northwind` DataSet uses correlated subqueries to bring back each product s corresponding category and supplier name.</span></span> <span data-ttu-id="58713-124">Die `ProductsTableAdapter` s Hauptabfrage wird unten gezeigt.</span><span class="sxs-lookup"><span data-stu-id="58713-124">The `ProductsTableAdapter` s main query is shown below.</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample1.sql)]

<span data-ttu-id="58713-125">Die beiden korrelierte Unterabfragen - `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` und `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` -sind `SELECT` Abfragen, die einen einzelnen Wert pro Produkt als eine zusätzliche Spalte in der äußeren zurückgeben `SELECT` Anweisung s Spaltenliste.</span><span class="sxs-lookup"><span data-stu-id="58713-125">The two correlated subqueries - `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` and `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` - are `SELECT` queries that return a single value per product as an additional column in the outer `SELECT` statement s column list.</span></span>

<span data-ttu-id="58713-126">Alternativ können Sie eine `JOIN` können verwendet werden, um jede s Supplier "und" Kategorie Produktname zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="58713-126">Alternatively, a `JOIN` can be used to return each product s supplier and category name.</span></span> <span data-ttu-id="58713-127">Die folgende Abfrage gibt dieselbe Ausgabe wie oben, verwendet jedoch `JOIN` s anstelle von Unterabfragen:</span><span class="sxs-lookup"><span data-stu-id="58713-127">The following query returns the same output as the above one, but uses `JOIN` s in place of subqueries:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample2.sql)]

<span data-ttu-id="58713-128">Ein `JOIN` Datensätze aus einer Tabelle mit Datensätzen aus einer anderen Tabelle basierend auf bestimmte Kriterien.</span><span class="sxs-lookup"><span data-stu-id="58713-128">A `JOIN` merges the records from one table with records from another table based on some criteria.</span></span> <span data-ttu-id="58713-129">In der obigen Abfrage, z. B. die `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` weist SQL Server jedes Zusammenführen Produktdatensatz, der Kategorie aufzeichnen, deren `CategoryID` Wert entspricht das Produkt s `CategoryID` Wert.</span><span class="sxs-lookup"><span data-stu-id="58713-129">In the above query, for example, the `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` instructs SQL Server to merge each product record with the category record whose `CategoryID` value matches the product s `CategoryID` value.</span></span> <span data-ttu-id="58713-130">Zusammengeführte Ergebnis erlaubt es uns, mit der entsprechenden Kategoriefelder für jedes Produkt arbeiten (z. B. `CategoryName`).</span><span class="sxs-lookup"><span data-stu-id="58713-130">The merged result allows us to work with the corresponding category fields for each product (such as `CategoryName`).</span></span>

> [!NOTE]
> <span data-ttu-id="58713-131">`JOIN` s werden häufig verwendet, bei der Abfrage von Daten aus relationalen Datenbanken.</span><span class="sxs-lookup"><span data-stu-id="58713-131">`JOIN` s are commonly used when querying data from relational databases.</span></span> <span data-ttu-id="58713-132">Wenn Sie neu der `JOIN` Syntax oder müssen auf ihre Nutzung etwas auffrischen d sollten die [SQL Join Lernprogramm](http://www.w3schools.com/sql/sql_join.asp) am [W3 Schulen](http://www.w3schools.com/).</span><span class="sxs-lookup"><span data-stu-id="58713-132">If you are new to the `JOIN` syntax or need to brush up a bit on its usage, I d recommend the [SQL Join tutorial](http://www.w3schools.com/sql/sql_join.asp) at [W3 Schools](http://www.w3schools.com/).</span></span> <span data-ttu-id="58713-133">Auch Folgendes zu lesen sind die [ `JOIN` Grundlagen](https://msdn.microsoft.com/library/ms191517.aspx) und [Unterabfrage Grundlagen](https://msdn.microsoft.com/library/ms189575.aspx) Abschnitte der [SQL-Onlinedokumentation](https://msdn.microsoft.com/library/ms130214.aspx).</span><span class="sxs-lookup"><span data-stu-id="58713-133">Also worth reading are the [`JOIN` Fundamentals](https://msdn.microsoft.com/library/ms191517.aspx) and [Subquery Fundamentals](https://msdn.microsoft.com/library/ms189575.aspx) sections of the [SQL Books Online](https://msdn.microsoft.com/library/ms130214.aspx).</span></span>


<span data-ttu-id="58713-134">Da `JOIN` s und korrelierte Unterabfragen können beide werden verwendet, um verwandte Daten aus anderen Tabellen abzurufen, für die meisten Entwickler bleiben ihre Köpfe beträchtliche und Fragen Sie sich, welchen Ansatz verwenden.</span><span class="sxs-lookup"><span data-stu-id="58713-134">Since `JOIN` s and correlated subqueries can both be used to retrieve related data from other tables, many developers are left scratching their heads and wondering which approach to use.</span></span> <span data-ttu-id="58713-135">Alle SQL-Experten ich Ve gesprochen um ungefähr die gleiche Aufgabe gesagt haben, dass die It t verfügt über eine Rolle spielen performance-wise wie SQL Server ungefähr identische Ausführungspläne erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="58713-135">All of the SQL gurus I ve talked to have said roughly the same thing, that it doesn t really matter performance-wise as SQL Server will produce roughly identical execution plans.</span></span> <span data-ttu-id="58713-136">Ihre Ratschläge ist dann das Verfahren verwenden, dem Sie und Ihr Team am häufigsten mit vertraut sind.</span><span class="sxs-lookup"><span data-stu-id="58713-136">Their advice, then, is to use the technique that you and your team are most comfortable with.</span></span> <span data-ttu-id="58713-137">Sie verdient Beachten Sie, dass diese Experten nach diesen Rat imparting sofort ihre Einstellung express `JOIN` s über korrelierte Unterabfragen.</span><span class="sxs-lookup"><span data-stu-id="58713-137">It merits noting that after imparting this advice these experts immediately express their preference of `JOIN` s over correlated subqueries.</span></span>

<span data-ttu-id="58713-138">Beim Erstellen eine Datenzugriffsschicht typisierter DataSets mithilfe der Tools besser geeignet verwenden Unterabfragen.</span><span class="sxs-lookup"><span data-stu-id="58713-138">When building a Data Access Layer using Typed DataSets, the tools work better when using subqueries.</span></span> <span data-ttu-id="58713-139">Insbesondere die TableAdapter-s-Assistent nicht automatisch generiert entsprechende `INSERT`, `UPDATE`, und `DELETE` Anweisungen, wenn die Hauptabfrage enthält `JOIN` s, aber generiert automatisch diese Anweisungen beim korrelierte Unterabfragen werden verwendet.</span><span class="sxs-lookup"><span data-stu-id="58713-139">In particular, the TableAdapter s wizard will not auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements if the main query contains any `JOIN` s, but will auto-generate these statements when correlated subqueries are used.</span></span>

<span data-ttu-id="58713-140">Um diese Schwierigkeit zu untersuchen, erstellen Sie einen temporären typisierte DataSet in den `~/App_Code/DAL` Ordner.</span><span class="sxs-lookup"><span data-stu-id="58713-140">To explore this shortcoming, create a temporary Typed DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="58713-141">Bei den TableAdapter-Konfigurations-Assistenten wählen, Ad-hoc-SQL-Anweisungen verwenden, und geben den folgenden `SELECT` Abfrage (siehe Abbildung 1):</span><span class="sxs-lookup"><span data-stu-id="58713-141">During the TableAdapter Configuration wizard, choose to use ad-hoc SQL statements and enter the following `SELECT` query (see Figure 1):</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample3.sql)]


<span data-ttu-id="58713-142">[![Geben Sie eine Hauptspeicherpool für Abfragen, die JOINs enthält.](updating-the-tableadapter-to-use-joins-vb/_static/image2.png)](updating-the-tableadapter-to-use-joins-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="58713-142">[![Enter a Main Query that Contains JOINs](updating-the-tableadapter-to-use-joins-vb/_static/image2.png)](updating-the-tableadapter-to-use-joins-vb/_static/image1.png)</span></span>

<span data-ttu-id="58713-143">**Abbildung 1**: Geben Sie eine Main-Abfrage, der enthält `JOIN` s ([klicken Sie hier, um das Bild in voller Größe angezeigt](updating-the-tableadapter-to-use-joins-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="58713-143">**Figure 1**: Enter a Main Query that Contains `JOIN` s ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image3.png))</span></span>


<span data-ttu-id="58713-144">Standardmäßig Erstellen der TableAdapter automatisch `INSERT`, `UPDATE`, und `DELETE` Anweisungen anhand der Hauptabfrage.</span><span class="sxs-lookup"><span data-stu-id="58713-144">By default, the TableAdapter will automatically create `INSERT`, `UPDATE`, and `DELETE` statements based on the main query.</span></span> <span data-ttu-id="58713-145">Wenn Sie auf die Schaltfläche "Erweitert" klicken, sehen Sie, dass dieses Feature aktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="58713-145">If you click the Advanced button you can see that this feature is enabled.</span></span> <span data-ttu-id="58713-146">Trotz dieser Einstellung wird der TableAdapter nicht möglich, erstellen die `INSERT`, `UPDATE`, und `DELETE` Anweisungen, da die Hauptabfrage enthält eine `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="58713-146">Despite this setting, the TableAdapter will not be able to create the `INSERT`, `UPDATE`, and `DELETE` statements because the main query contains a `JOIN`.</span></span>


![Geben Sie eine Hauptspeicherpool für Abfragen, die JOINs enthält.](updating-the-tableadapter-to-use-joins-vb/_static/image4.png)

<span data-ttu-id="58713-148">**Abbildung 2**: Geben Sie eine Hauptspeicherpool für Abfragen, die enthält `JOIN` s</span><span class="sxs-lookup"><span data-stu-id="58713-148">**Figure 2**: Enter a Main Query that Contains `JOIN` s</span></span>


<span data-ttu-id="58713-149">Klicken Sie auf ' Fertig stellen ', um den Assistenten abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="58713-149">Click Finish to complete the wizard.</span></span> <span data-ttu-id="58713-150">An diesem Punkt wird die DataSet-s-Designer einen einzelnen TableAdapter mit einer DataTable mit Spalten enthalten, für jede die zurückgegebenen Felder in der `SELECT` Abfrage s Spaltenliste.</span><span class="sxs-lookup"><span data-stu-id="58713-150">At this point your DataSet s Designer will include a single TableAdapter with a DataTable with columns for each of the fields returned in the `SELECT` query s column list.</span></span> <span data-ttu-id="58713-151">Dies schließt die `CategoryName` und `SupplierName`, wie in Abbildung 3 dargestellt.</span><span class="sxs-lookup"><span data-stu-id="58713-151">This includes the `CategoryName` and `SupplierName`, as Figure 3 shows.</span></span>


![DataTable enthält eine Spalte für jedes Feld in der Spaltenliste zurückgegeben](updating-the-tableadapter-to-use-joins-vb/_static/image5.png)

<span data-ttu-id="58713-153">**Abbildung 3**: DataTable enthält eine Spalte für jedes Feld in der Spaltenliste zurückgegeben</span><span class="sxs-lookup"><span data-stu-id="58713-153">**Figure 3**: The DataTable Includes a Column for Each Field Returned in the Column List</span></span>


<span data-ttu-id="58713-154">Während der DataTable die entsprechenden Spalten verfügt, wird der TableAdapter verfügt nicht über Werte für die `InsertCommand`, `UpdateCommand`, und `DeleteCommand` Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="58713-154">While the DataTable has the appropriate columns, the TableAdapter lacks values for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="58713-155">Um dies zu bestätigen, klicken Sie auf den TableAdapter im Designer, und wechseln Sie dann auf Eigenschaftenfenster.</span><span class="sxs-lookup"><span data-stu-id="58713-155">To confirm this, click on the TableAdapter in the Designer and then go to the Properties window.</span></span> <span data-ttu-id="58713-156">Es wird angezeigt, die die `InsertCommand`, `UpdateCommand`, und `DeleteCommand` Eigenschaften werden festgelegt (keine).</span><span class="sxs-lookup"><span data-stu-id="58713-156">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are set to (None) .</span></span>


<span data-ttu-id="58713-157">[![Die InsertCommand, UpdateCommand und DeleteCommand Eigenschaften werden auf (keine) festgelegt.](updating-the-tableadapter-to-use-joins-vb/_static/image7.png)](updating-the-tableadapter-to-use-joins-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="58713-157">[![The InsertCommand, UpdateCommand, and DeleteCommand Properties are Set to (None)](updating-the-tableadapter-to-use-joins-vb/_static/image7.png)](updating-the-tableadapter-to-use-joins-vb/_static/image6.png)</span></span>

<span data-ttu-id="58713-158">**Abbildung 4**: die `InsertCommand`, `UpdateCommand`, und `DeleteCommand` Eigenschaften werden festgelegt (None) ([klicken Sie hier, um das Bild in voller Größe angezeigt](updating-the-tableadapter-to-use-joins-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="58713-158">**Figure 4**: The `InsertCommand`, `UpdateCommand`, and `DeleteCommand` Properties are Set to (None) ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image8.png))</span></span>


<span data-ttu-id="58713-159">Zur Umgehung dieser Schwierigkeit, wir können manuell Geben Sie den SQL-Anweisungen und Parameter für die `InsertCommand`, `UpdateCommand`, und `DeleteCommand` Eigenschaften über das Eigenschaftenfenster.</span><span class="sxs-lookup"><span data-stu-id="58713-159">To work around this shortcoming, we can manually provide the SQL statements and parameters for the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties via the Properties window.</span></span> <span data-ttu-id="58713-160">Es können auch beginnen, durch Konfigurieren der TableAdapter Hauptabfrage s zum *nicht* enthalten `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="58713-160">Alternatively, we could start by configuring the TableAdapter s main query to *not* include any `JOIN` s.</span></span> <span data-ttu-id="58713-161">Dadurch kann die `INSERT`, `UPDATE`, und `DELETE` Anweisungen, die automatisch für uns generiert werden.</span><span class="sxs-lookup"><span data-stu-id="58713-161">This will allow the `INSERT`, `UPDATE`, and `DELETE` statements to be auto-generated for us.</span></span> <span data-ttu-id="58713-162">Nach Abschluss des Assistenten an, wir konnten dann manuell aktualisieren die TableAdapter `SelectCommand` über das Eigenschaftenfenster so, dass die It umfasst die `JOIN` Syntax.</span><span class="sxs-lookup"><span data-stu-id="58713-162">After completing the wizard, we could then manually update the TableAdapter s `SelectCommand` from the Properties window so that it includes the `JOIN` syntax.</span></span>

<span data-ttu-id="58713-163">Dieser Ansatz funktioniert, zwar es ist sehr jedoch fehleranfällig, wenn Ad-hoc-SQL-Abfragen verwenden, da jedes Mal, wenn die Hauptabfrage des TableAdapter s neu konfiguriert, über den Assistenten, die automatisch generierte `INSERT`, `UPDATE`, und `DELETE` Anweisungen neu erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="58713-163">While this approach works, it is very brittle when using ad-hoc SQL queries because any time the TableAdapter s main query is re-configured through the wizard, the auto-generated `INSERT`, `UPDATE`, and `DELETE` statements are recreated.</span></span> <span data-ttu-id="58713-164">Das bedeutet, dass alle wir später vorgenommenen Anpassungen verloren gehen würden wir mit der rechten Maustaste auf den TableAdapter konfigurieren aus dem Kontextmenü auswählen und den Assistenten erneut abgeschlossen.</span><span class="sxs-lookup"><span data-stu-id="58713-164">That means all of the customizations we later made would be lost if we right-clicked on the TableAdapter, chose Configure from the context menu, and completed the wizard again.</span></span>

<span data-ttu-id="58713-165">Die unzulänglichen der automatisch generierten TableAdapter-Zuordnungsvorgänge `INSERT`, `UPDATE`, und `DELETE` Anweisungen ist, Glücklicherweise auf Ad-hoc-SQL-Anweisungen beschränkt.</span><span class="sxs-lookup"><span data-stu-id="58713-165">The brittleness of the TableAdapter s auto-generated `INSERT`, `UPDATE`, and `DELETE` statements is, fortunately, limited to ad-hoc SQL statements.</span></span> <span data-ttu-id="58713-166">Wenn der TableAdapter gespeicherte Prozeduren verwendet wird, können Sie Anpassen der `SelectCommand`, `InsertCommand`, `UpdateCommand`, oder `DeleteCommand` gespeicherte Prozeduren und führen Sie den TableAdapter-Konfigurations-Assistenten erneut aus, ohne jedoch, dass die gespeicherten Prozeduren werden geändert.</span><span class="sxs-lookup"><span data-stu-id="58713-166">If your TableAdapter uses stored procedures, you can customize the `SelectCommand`, `InsertCommand`, `UpdateCommand`, or `DeleteCommand` stored procedures and re-run the TableAdapter Configuration wizard without having to fear that the stored procedures will be modified.</span></span>

<span data-ttu-id="58713-167">Über den nächsten verwendet mehrere Schritte, die wir erstellt einen TableAdapter, die zu Beginn einer hauptspeicherpool für Abfragen, die alle lässt `JOIN` s, damit die entsprechenden einfügen, aktualisieren und Löschen gespeicherter Prozeduren automatisch generiert werden.</span><span class="sxs-lookup"><span data-stu-id="58713-167">Over the next several steps we will create a TableAdapter that, initially, uses a main query that omits any `JOIN` s so that the corresponding insert, update, and delete stored procedures will be auto-generated.</span></span> <span data-ttu-id="58713-168">Wir aktualisieren Sie dann die `SelectCommand` so verwendet, die eine `JOIN` , zusätzliche Spalten aus verknüpften Tabellen zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="58713-168">We will then update the `SelectCommand` so that uses a `JOIN` that returns additional columns from related tables.</span></span> <span data-ttu-id="58713-169">Schließlich wir erstellen Sie eine entsprechende Business Logic Layer-Klasse und veranschaulicht die Verwendung des TableAdapters in eine ASP.NET-Webseite.</span><span class="sxs-lookup"><span data-stu-id="58713-169">Finally, we'll create a corresponding Business Logic Layer class and demonstrate using the TableAdapter in an ASP.NET web page.</span></span>

## <a name="step-1-creating-the-tableadapter-using-a-simplified-main-query"></a><span data-ttu-id="58713-170">Schritt 1: Erstellen der TableAdapter eine vereinfachte Hauptspeicherpool für Abfragen mit</span><span class="sxs-lookup"><span data-stu-id="58713-170">Step 1: Creating the TableAdapter Using a Simplified Main Query</span></span>

<span data-ttu-id="58713-171">Für dieses Lernprogramm fügen wir ein TableAdapter und stark typisierte DataTable für die `Employees` -Tabelle in der `NorthwindWithSprocs` DataSet.</span><span class="sxs-lookup"><span data-stu-id="58713-171">For this tutorial we will add a TableAdapter and strongly-typed DataTable for the `Employees` table in the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="58713-172">Die `Employees` Tabelle enthält eine `ReportsTo` angegebenen Feld der `EmployeeID` des Mitarbeiters s-Managers.</span><span class="sxs-lookup"><span data-stu-id="58713-172">The `Employees` table contains a `ReportsTo` field that specified the `EmployeeID` of the employee s manager.</span></span> <span data-ttu-id="58713-173">Beispielsweise Mitarbeiter Anne Dodsworth hat eine `ReportTo` Abstand von 5, also die `EmployeeID` von Steven Buchanan.</span><span class="sxs-lookup"><span data-stu-id="58713-173">For example, employee Anne Dodsworth has a `ReportTo` value of 5, which is the `EmployeeID` of Steven Buchanan.</span></span> <span data-ttu-id="58713-174">Folglich berichtet Anne Stefan, ihrem Manager.</span><span class="sxs-lookup"><span data-stu-id="58713-174">Consequently, Anne reports to Steven, her manager.</span></span> <span data-ttu-id="58713-175">Zusammen mit jeder Mitarbeiter s reporting `ReportsTo` Wert, es kann auch der Name des Vorgesetzten abrufen möchten.</span><span class="sxs-lookup"><span data-stu-id="58713-175">Along with reporting each employee s `ReportsTo` value, we might also want to retrieve the name of their manager.</span></span> <span data-ttu-id="58713-176">Dies geschieht mithilfe einer `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="58713-176">This can be accomplished using a `JOIN`.</span></span> <span data-ttu-id="58713-177">Während mit einer `JOIN` beim anfänglich Erstellung des TableAdapter, der Assistent generiert automatisch die entsprechenden Insert schließt, Update- und delete-Funktionen.</span><span class="sxs-lookup"><span data-stu-id="58713-177">But using a `JOIN` when initially creating the TableAdapter precludes the wizard from automatically generating the corresponding insert, update, and delete capabilities.</span></span> <span data-ttu-id="58713-178">Daher beginnen wir mit dem Erstellen eines TableAdapters, deren Hauptabfrage keine enthält `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="58713-178">Therefore, we will start by creating a TableAdapter whose main query does not contain any `JOIN` s.</span></span> <span data-ttu-id="58713-179">Klicken Sie dann in Schritt2 haben wir aktualisieren die Hauptabfrage gespeicherte Prozedur zum Abrufen der Managername s über eine `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="58713-179">Then, in Step 2, we will update the main query stored procedure to retrieve the manager s name via a `JOIN`.</span></span>

<span data-ttu-id="58713-180">Öffnen Sie zunächst die `NorthwindWithSprocs` DataSet in den `~/App_Code/DAL` Ordner.</span><span class="sxs-lookup"><span data-stu-id="58713-180">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="58713-181">Mit der rechten Maustaste auf den Designer, wählen Sie im Kontextmenü die Option "hinzufügen", und wählen Sie das Menüelement TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="58713-181">Right-click on the Designer, select the Add option from the context menu, and pick the TableAdapter menu item.</span></span> <span data-ttu-id="58713-182">Hierdurch wird der TableAdapter-Konfigurations-Assistent gestartet.</span><span class="sxs-lookup"><span data-stu-id="58713-182">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="58713-183">Wie Abbildung 5 zeigt, müssen Sie den Assistenten neue gespeicherte Prozeduren erstellen, und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="58713-183">As Figure 5 depicts, have the wizard create new stored procedures and click Next.</span></span> <span data-ttu-id="58713-184">Für aufzufrischen zum Erstellen neuer Prozeduren aus dem TableAdapter-s-Assistenten gespeichert wird, wenden Sie sich an den [Erstellen neuer gespeicherter Prozeduren für die typisierte DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) Lernprogramm.</span><span class="sxs-lookup"><span data-stu-id="58713-184">For a refresher on creating new stored procedures from the TableAdapter s wizard, consult the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span>


<span data-ttu-id="58713-185">[![Wählen Sie die neuen gespeicherten Prozeduren Option für das Erstellen](updating-the-tableadapter-to-use-joins-vb/_static/image10.png)](updating-the-tableadapter-to-use-joins-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="58713-185">[![Select the Create new stored procedures Option](updating-the-tableadapter-to-use-joins-vb/_static/image10.png)](updating-the-tableadapter-to-use-joins-vb/_static/image9.png)</span></span>

<span data-ttu-id="58713-186">**Abbildung 5**: Wählen Sie das Erstellen neuer Procedures (Option) gespeichert ([klicken Sie hier, um das Bild in voller Größe angezeigt](updating-the-tableadapter-to-use-joins-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="58713-186">**Figure 5**: Select the Create new stored procedures Option ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image11.png))</span></span>


<span data-ttu-id="58713-187">Verwenden Sie die folgende `SELECT` -Anweisung für die Hauptabfrage des TableAdapter s:</span><span class="sxs-lookup"><span data-stu-id="58713-187">Use the following `SELECT` statement for the TableAdapter s main query:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample4.sql)]

<span data-ttu-id="58713-188">Da diese Abfrage nicht einschließt `JOIN` s, der TableAdapter-Assistenten erstellt automatisch gespeicherte Prozeduren mit den entsprechenden `INSERT`, `UPDATE`, und `DELETE` Anweisungen als auch eine gespeicherte Prozedur für den Hauptknoten ausführen Abfrage.</span><span class="sxs-lookup"><span data-stu-id="58713-188">Since this query does not include any `JOIN` s, the TableAdapter wizard will automatically create stored procedures with corresponding `INSERT`, `UPDATE`, and `DELETE` statements, as well as a stored procedure for executing the main query.</span></span>

<span data-ttu-id="58713-189">Der folgende Schritt kann Wir nennen Sie die TableAdapter s gespeicherten Prozeduren.</span><span class="sxs-lookup"><span data-stu-id="58713-189">The following step allows us to name the TableAdapter s stored procedures.</span></span> <span data-ttu-id="58713-190">Verwenden Sie die Namen `Employees_Select`, `Employees_Insert`, `Employees_Update`, und `Employees_Delete`, wie in Abbildung 6 veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="58713-190">Use the names `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`, as shown in Figure 6.</span></span>


<span data-ttu-id="58713-191">[![Name der TableAdapter s gespeicherten Prozeduren](updating-the-tableadapter-to-use-joins-vb/_static/image13.png)](updating-the-tableadapter-to-use-joins-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="58713-191">[![Name the TableAdapter s Stored Procedures](updating-the-tableadapter-to-use-joins-vb/_static/image13.png)](updating-the-tableadapter-to-use-joins-vb/_static/image12.png)</span></span>

<span data-ttu-id="58713-192">**Abbildung 6**: Benennen der TableAdapter s Stored Procedures ([klicken Sie hier, um das Bild in voller Größe angezeigt](updating-the-tableadapter-to-use-joins-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="58713-192">**Figure 6**: Name the TableAdapter s Stored Procedures ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image14.png))</span></span>


<span data-ttu-id="58713-193">Der letzte Schritt werden Sie aufgefordert, benennen Sie die TableAdapter-s-Methoden.</span><span class="sxs-lookup"><span data-stu-id="58713-193">The final step prompts us to name the TableAdapter s methods.</span></span> <span data-ttu-id="58713-194">Verwendung `Fill` und `GetEmployees` als den Methodennamen.</span><span class="sxs-lookup"><span data-stu-id="58713-194">Use `Fill` and `GetEmployees` as the method names.</span></span> <span data-ttu-id="58713-195">Achten Sie auch darauf, um die Methoden erstellen, um Updates direkt an die Datenbank (GenerateDBDirectMethods) das Kontrollkästchen aktiviert senden zu lassen.</span><span class="sxs-lookup"><span data-stu-id="58713-195">Also be sure to leave the Create methods to send updates directly to the database (GenerateDBDirectMethods) checkbox checked.</span></span>


<span data-ttu-id="58713-196">[![Name der TableAdapter s Methoden ausfüllen und GetEmployees](updating-the-tableadapter-to-use-joins-vb/_static/image16.png)](updating-the-tableadapter-to-use-joins-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="58713-196">[![Name the TableAdapter s Methods Fill and GetEmployees](updating-the-tableadapter-to-use-joins-vb/_static/image16.png)](updating-the-tableadapter-to-use-joins-vb/_static/image15.png)</span></span>

<span data-ttu-id="58713-197">**Abbildung 7**: Benennen Sie die TableAdapter-Methoden `Fill` und `GetEmployees` ([klicken Sie hier, um das Bild in voller Größe angezeigt](updating-the-tableadapter-to-use-joins-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="58713-197">**Figure 7**: Name the TableAdapter s Methods `Fill` and `GetEmployees` ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image17.png))</span></span>


<span data-ttu-id="58713-198">Nehmen Sie nach Abschluss des Assistenten einen Moment Zeit, um die gespeicherten Prozeduren in der Datenbank zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="58713-198">After completing the wizard, take a moment to examine the stored procedures in the database.</span></span> <span data-ttu-id="58713-199">Sehen Sie vier neue: `Employees_Select`, `Employees_Insert`, `Employees_Update`, und `Employees_Delete`.</span><span class="sxs-lookup"><span data-stu-id="58713-199">You should see four new ones: `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`.</span></span> <span data-ttu-id="58713-200">Überprüfen Sie als Nächstes die `EmployeesDataTable` und `EmployeesTableAdapter` gerade erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="58713-200">Next, inspect the `EmployeesDataTable` and `EmployeesTableAdapter` just created.</span></span> <span data-ttu-id="58713-201">DataTable enthält eine Spalte für jedes Feld, das von der Hauptabfrage zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="58713-201">The DataTable contains a column for each field returned by the main query.</span></span> <span data-ttu-id="58713-202">Klicken Sie auf den TableAdapter, und fahren Sie dann auf Eigenschaftenfenster.</span><span class="sxs-lookup"><span data-stu-id="58713-202">Click on the TableAdapter and then go to the Properties window.</span></span> <span data-ttu-id="58713-203">Es wird angezeigt, die die `InsertCommand`, `UpdateCommand`, und `DeleteCommand` Eigenschaften sind ordnungsgemäß so konfiguriert, dass die entsprechenden gespeicherten Prozeduren aufrufen.</span><span class="sxs-lookup"><span data-stu-id="58713-203">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are correctly configured to call the corresponding stored procedures.</span></span>


<span data-ttu-id="58713-204">[![TableAdapter enthält INSERT-, Update- und Löschen von Funktionen](updating-the-tableadapter-to-use-joins-vb/_static/image19.png)](updating-the-tableadapter-to-use-joins-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="58713-204">[![The TableAdapter Includes Insert, Update, and Delete Capabilities](updating-the-tableadapter-to-use-joins-vb/_static/image19.png)](updating-the-tableadapter-to-use-joins-vb/_static/image18.png)</span></span>

<span data-ttu-id="58713-205">**Abbildung 8**: der TableAdapter Insert enthält, aktualisieren und löschen Funktionen ([klicken Sie hier, um das Bild in voller Größe angezeigt](updating-the-tableadapter-to-use-joins-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="58713-205">**Figure 8**: The TableAdapter Includes Insert, Update, and Delete Capabilities ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image20.png))</span></span>


<span data-ttu-id="58713-206">Nach dem Einfügen, aktualisieren und Löschen von gespeicherten Prozeduren, die automatisch erstellt und die `InsertCommand`, `UpdateCommand`, und `DeleteCommand` Eigenschaften ordnungsgemäß konfiguriert, wir können zum Anpassen der `SelectCommand` s gespeicherte Prozedur, um zusätzliche zurückzugeben Informationen zu jedem Mitarbeiter s-Manager.</span><span class="sxs-lookup"><span data-stu-id="58713-206">With the insert, update, and delete stored procedures automatically created and the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties correctly configured, we are ready to customize the `SelectCommand` s stored procedure to return additional information about each employee s manager.</span></span> <span data-ttu-id="58713-207">Insbesondere müssen wir aktualisieren die `Employees_Select` gespeicherte Prozedur mit einer `JOIN` und die s-Manager zurückkehren, `FirstName` und `LastName` Werte.</span><span class="sxs-lookup"><span data-stu-id="58713-207">Specifically, we need to update the `Employees_Select` stored procedure to use a `JOIN` and return the manager s `FirstName` and `LastName` values.</span></span> <span data-ttu-id="58713-208">Nachdem die gespeicherte Prozedur aktualisiert wurde, müssen wir die DataTable zu aktualisieren, sodass sie diese zusätzlichen Spalten enthält.</span><span class="sxs-lookup"><span data-stu-id="58713-208">After the stored procedure has been updated, we will need to update the DataTable so that it includes these additional columns.</span></span> <span data-ttu-id="58713-209">Wir werden diese beiden Aufgaben in den Schritten 2 und 3 konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="58713-209">We'll tackle these two tasks in Steps 2 and 3.</span></span>

## <a name="step-2-customizing-the-stored-procedure-to-include-ajoin"></a><span data-ttu-id="58713-210">Schritt 2: Anpassen der gespeicherten Prozedur enthalten ein`JOIN`</span><span class="sxs-lookup"><span data-stu-id="58713-210">Step 2: Customizing the Stored Procedure to Include a`JOIN`</span></span>

<span data-ttu-id="58713-211">Starten, indem Sie im Server-Explorer, Drilldowns in den Ordner Northwind s-Datenbank gespeicherte Prozeduren, und Öffnen der `Employees_Select` gespeicherten Prozedur.</span><span class="sxs-lookup"><span data-stu-id="58713-211">Start by going to the Server Explorer, drilling down into the Northwind database s Stored Procedures folder, and opening the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="58713-212">Wenn Sie diese gespeicherte Prozedur nicht angezeigt werden, mit der rechten Maustaste auf den Ordner gespeicherte Prozeduren, und wählen Sie aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="58713-212">If you do not see this stored procedure, right-click on the Stored Procedures folder and choose Refresh.</span></span> <span data-ttu-id="58713-213">Aktualisieren Sie die gespeicherte Prozedur so, dass es verwendet ein `LEFT JOIN` zuerst den Manager s zurückgegeben und Nachnamen:</span><span class="sxs-lookup"><span data-stu-id="58713-213">Update the stored procedure so that it uses a `LEFT JOIN` to return the manager s first and last name:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample5.sql)]

<span data-ttu-id="58713-214">Nach der Aktualisierung der `SELECT` -Anweisung, speichern Sie die Änderungen, indem Sie im Menü Datei aufrufen und Auswählen von Speichern `Employees_Select`.</span><span class="sxs-lookup"><span data-stu-id="58713-214">After updating the `SELECT` statement, save the changes by going to the File menu and choosing Save `Employees_Select`.</span></span> <span data-ttu-id="58713-215">Sie können Alternativ klicken Sie auf das Symbol "Speichern" in der Symbolleiste oder drücken Sie STRG + S.</span><span class="sxs-lookup"><span data-stu-id="58713-215">Alternatively, you can click the Save icon in the toolbar or hit Ctrl+S.</span></span> <span data-ttu-id="58713-216">Nach dem Speichern der Änderungen an, mit der Maustaste auf die `Employees_Select` gespeicherte Prozedur im Server-Explorer, und wählen Sie Execute.</span><span class="sxs-lookup"><span data-stu-id="58713-216">After saving your changes, right-click on the `Employees_Select` stored procedure in the Server Explorer and choose Execute.</span></span> <span data-ttu-id="58713-217">Dies führen Sie die gespeicherte Prozedur und Anzeigen der Ergebnisse im Ausgabefenster angezeigt wird (siehe Abbildung 9).</span><span class="sxs-lookup"><span data-stu-id="58713-217">This will run the stored procedure and show its results in the Output window (see Figure 9).</span></span>


<span data-ttu-id="58713-218">[![Die Ergebnisse der gespeicherten Prozeduren werden im Ausgabefenster angezeigt.](updating-the-tableadapter-to-use-joins-vb/_static/image22.png)](updating-the-tableadapter-to-use-joins-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="58713-218">[![The Stored Procedures Results are Displayed in the Output Window](updating-the-tableadapter-to-use-joins-vb/_static/image22.png)](updating-the-tableadapter-to-use-joins-vb/_static/image21.png)</span></span>

<span data-ttu-id="58713-219">**Abbildung 9**: die gespeicherten Prozeduren Ergebnisse werden im Ausgabefenster angezeigt ([klicken Sie hier, um das Bild in voller Größe angezeigt](updating-the-tableadapter-to-use-joins-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="58713-219">**Figure 9**: The Stored Procedures Results are Displayed in the Output Window ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image23.png))</span></span>


## <a name="step-3-updating-the-datatable-s-columns"></a><span data-ttu-id="58713-220">Schritt 3: Aktualisieren der DataTable-s-Spalten</span><span class="sxs-lookup"><span data-stu-id="58713-220">Step 3: Updating the DataTable s Columns</span></span>

<span data-ttu-id="58713-221">An diesem Punkt der `Employees_Select` gespeicherte Prozedur gibt `ManagerFirstName` und `ManagerLastName` Werte, aber die `EmployeesDataTable` fehlt für diese Spalten.</span><span class="sxs-lookup"><span data-stu-id="58713-221">At this point, the `Employees_Select` stored procedure returns `ManagerFirstName` and `ManagerLastName` values, but the `EmployeesDataTable` is missing these columns.</span></span> <span data-ttu-id="58713-222">Diese fehlenden Spalten können in das DataTable auf zwei Arten hinzugefügt werden:</span><span class="sxs-lookup"><span data-stu-id="58713-222">These missing columns can be added to the DataTable in one of two ways:</span></span>

- <span data-ttu-id="58713-223">**Manuell** – mit der rechten Maustaste auf die DataTable im DataSet-Designer und wählen Sie aus, klicken Sie im Menü hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="58713-223">**Manually** - right-click on the DataTable in the DataSet Designer and, from the Add menu, choose Column.</span></span> <span data-ttu-id="58713-224">Sie können den Namen der Spalte und Festlegen von Eigenschaften entsprechend.</span><span class="sxs-lookup"><span data-stu-id="58713-224">You can then name the column and set its properties accordingly.</span></span>
- <span data-ttu-id="58713-225">**Automatisch** -der TableAdapter-Konfigurations-Assistent aktualisiert die DataTable-s-Spalten entsprechend der von zurückgegebenen Felder die `SelectCommand` gespeicherte Prozedur.</span><span class="sxs-lookup"><span data-stu-id="58713-225">**Automatically** - the TableAdapter Configuration wizard will update the DataTable s columns to reflect the fields returned by the `SelectCommand` stored procedure.</span></span> <span data-ttu-id="58713-226">Wenn Sie Ad-hoc-SQL-Anweisungen verwenden, wird der Assistent auch Entfernen der `InsertCommand`, `UpdateCommand`, und `DeleteCommand` Eigenschaften seit der `SelectCommand` enthält jetzt eine `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="58713-226">When using ad-hoc SQL statements, the wizard will also remove the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties since the `SelectCommand` now contains a `JOIN`.</span></span> <span data-ttu-id="58713-227">Während diese Befehlseigenschaften bei der Verwendung von gespeicherten Prozeduren, jedoch intakt bleiben.</span><span class="sxs-lookup"><span data-stu-id="58713-227">But when using stored procedures, these command properties remain intact.</span></span>

<span data-ttu-id="58713-228">Wir haben manuelle Hinzufügen von DataTable-Spalten in der vorherigen Lernprogramme, darunter auch untersucht [Master/Detail, verwenden eine Aufzählung der Master-Datensätze mit Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) und [Hochladen von Dateien](../working-with-binary-files/uploading-files-vb.md), und wir werden sollen. Betrachten Sie diesen Vorgang erneut im Detail in unserem nächsten Lernprogramm aus.</span><span class="sxs-lookup"><span data-stu-id="58713-228">We have explored manually adding DataTable columns in previous tutorials, including [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) and [Uploading Files](../working-with-binary-files/uploading-files-vb.md), and we will look at this process again in more detail in our next tutorial.</span></span> <span data-ttu-id="58713-229">Können Sie für dieses Lernprogramm jedoch, s, die die automatische Methode über den TableAdapter-Konfigurations-Assistenten zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="58713-229">For this tutorial, however, let s use the automatic approach via the TableAdapter Configuration wizard.</span></span>

<span data-ttu-id="58713-230">Starten, indem Sie mit der rechten Maustaste auf die `EmployeesTableAdapter` und konfigurieren Sie im Kontextmenü auswählen.</span><span class="sxs-lookup"><span data-stu-id="58713-230">Start by right-clicking on the `EmployeesTableAdapter` and selecting Configure from the context menu.</span></span> <span data-ttu-id="58713-231">Daraufhin wird der TableAdapter-Konfigurations-Assistenten, in der Listet die gespeicherten Prozeduren zum auswählen, einfügen, aktualisieren und löschen, sowie deren Rückgabewerte und Parameter (sofern vorhanden).</span><span class="sxs-lookup"><span data-stu-id="58713-231">This brings up the TableAdapter Configuration wizard, which lists the stored procedures used for selecting, inserting, updating, and deleting, along with their return values and parameters (if any).</span></span> <span data-ttu-id="58713-232">Abbildung 10 zeigt dieses Assistenten.</span><span class="sxs-lookup"><span data-stu-id="58713-232">Figure 10 shows this wizard.</span></span> <span data-ttu-id="58713-233">Hier sehen wir, dass die `Employees_Select` gibt die gespeicherte Prozedur die `ManagerFirstName` und `ManagerLastName` Felder.</span><span class="sxs-lookup"><span data-stu-id="58713-233">Here we can see that the `Employees_Select` stored procedure now returns the `ManagerFirstName` and `ManagerLastName` fields.</span></span>


<span data-ttu-id="58713-234">[![Der Assistent zeigt der aktualisierten Spaltenliste für den Employees_Select gespeicherte Prozedur](updating-the-tableadapter-to-use-joins-vb/_static/image25.png)](updating-the-tableadapter-to-use-joins-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="58713-234">[![The Wizard Shows the Updated Column List for the Employees_Select Stored Procedure](updating-the-tableadapter-to-use-joins-vb/_static/image25.png)](updating-the-tableadapter-to-use-joins-vb/_static/image24.png)</span></span>

<span data-ttu-id="58713-235">**Abbildung 10**: der Assistent zeigt die Spaltenliste aktualisiert für die `Employees_Select` gespeicherte Prozedur ([klicken Sie hier, um das Bild in voller Größe angezeigt](updating-the-tableadapter-to-use-joins-vb/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="58713-235">**Figure 10**: The Wizard Shows the Updated Column List for the `Employees_Select` Stored Procedure ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image26.png))</span></span>


<span data-ttu-id="58713-236">Schließen Sie den Assistenten, indem Sie auf ' Fertig stellen '.</span><span class="sxs-lookup"><span data-stu-id="58713-236">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="58713-237">Bei der Rückkehr zu DataSet-Designer die `EmployeesDataTable` umfasst zwei zusätzliche Spalten: `ManagerFirstName` und `ManagerLastName`.</span><span class="sxs-lookup"><span data-stu-id="58713-237">Upon returning to the DataSet Designer, the `EmployeesDataTable` includes two additional columns: `ManagerFirstName` and `ManagerLastName`.</span></span>


<span data-ttu-id="58713-238">[![Die EmployeesDataTable enthält zwei neue Spalten](updating-the-tableadapter-to-use-joins-vb/_static/image28.png)](updating-the-tableadapter-to-use-joins-vb/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="58713-238">[![The EmployeesDataTable Contains Two New Columns](updating-the-tableadapter-to-use-joins-vb/_static/image28.png)](updating-the-tableadapter-to-use-joins-vb/_static/image27.png)</span></span>

<span data-ttu-id="58713-239">**Abbildung 11**: die `EmployeesDataTable` enthält zwei neue Spalten ([klicken Sie hier, um das Bild in voller Größe angezeigt](updating-the-tableadapter-to-use-joins-vb/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="58713-239">**Figure 11**: The `EmployeesDataTable` Contains Two New Columns ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image29.png))</span></span>


<span data-ttu-id="58713-240">Um zu veranschaulichen, die die aktualisierte `Employees_Select` gespeicherte Prozedur im Endeffekt dasselbe ist, und dass die INSERT-, Update- und delete-Funktionen des TableAdapter sind zwar noch funktionsfähig, s, die eine Webseite erstellen, die ermöglicht Benutzern das Anzeigen und Löschen von Mitarbeitern ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="58713-240">To illustrate that the updated `Employees_Select` stored procedure is in effect and that the insert, update, and delete capabilities of the TableAdapter are still functional, let s create a web page that allows users to view and delete employees.</span></span> <span data-ttu-id="58713-241">Bevor wir eine solche Seite erstellen, es jedoch zunächst eine neue Klasse in der Business Logic Layer für das Arbeiten mit Mitarbeitern aus erstellen die `NorthwindWithSprocs` DataSet.</span><span class="sxs-lookup"><span data-stu-id="58713-241">Before we create such a page, however, we need to first create a new class in the Business Logic Layer for working with employees from the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="58713-242">In Schritt 4, erstellen wir eine `EmployeesBLLWithSprocs` Klasse.</span><span class="sxs-lookup"><span data-stu-id="58713-242">In Step 4, we will create an `EmployeesBLLWithSprocs` class.</span></span> <span data-ttu-id="58713-243">In Schritt 5 verwenden wir diese Klasse von einer ASP.NET-Seite.</span><span class="sxs-lookup"><span data-stu-id="58713-243">In Step 5, we will use this class from an ASP.NET page.</span></span>

## <a name="step-4-implementing-the-business-logic-layer"></a><span data-ttu-id="58713-244">Schritt 4: Implementieren der Geschäftslogikebene</span><span class="sxs-lookup"><span data-stu-id="58713-244">Step 4: Implementing the Business Logic Layer</span></span>

<span data-ttu-id="58713-245">Erstellen Sie eine neue Klassendatei in der `~/App_Code/BLL` Ordner mit dem Namen `EmployeesBLLWithSprocs.vb`.</span><span class="sxs-lookup"><span data-stu-id="58713-245">Create a new class file in the `~/App_Code/BLL` folder named `EmployeesBLLWithSprocs.vb`.</span></span> <span data-ttu-id="58713-246">Diese Klasse imitiert die Semantik des vorhandenen `EmployeesBLL` -Klasse, nur diese neue eine bietet weniger Methoden und verwendet die `NorthwindWithSprocs` DataSet (anstelle von der `Northwind` DataSet).</span><span class="sxs-lookup"><span data-stu-id="58713-246">This class mimics the semantics of the existing `EmployeesBLL` class, only this new one provides fewer methods and uses the `NorthwindWithSprocs` DataSet (instead of the `Northwind` DataSet).</span></span> <span data-ttu-id="58713-247">Fügen Sie der `EmployeesBLLWithSprocs`-Klasse folgenden Code hinzu.</span><span class="sxs-lookup"><span data-stu-id="58713-247">Add the following code to the `EmployeesBLLWithSprocs` class.</span></span>


[!code-vb[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample6.vb)]

<span data-ttu-id="58713-248">Die `EmployeesBLLWithSprocs` Klasse s `Adapter` Eigenschaft gibt eine Instanz von der `NorthwindWithSprocs` DataSet s `EmployeesTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="58713-248">The `EmployeesBLLWithSprocs` class s `Adapter` property returns an instance of the `NorthwindWithSprocs` DataSet s `EmployeesTableAdapter`.</span></span> <span data-ttu-id="58713-249">Dies wird verwendet, von der Klasse s `GetEmployees` und `DeleteEmployee` Methoden.</span><span class="sxs-lookup"><span data-stu-id="58713-249">This is used by the class s `GetEmployees` and `DeleteEmployee` methods.</span></span> <span data-ttu-id="58713-250">Die `GetEmployees` Methodenaufrufe der `EmployeesTableAdapter` s entspricht `GetEmployees` -Methode, die aufruft der `Employees_Select` gespeicherte Prozedur und füllt Sie seine Ergebnisse in ein `EmployeeDataTable`.</span><span class="sxs-lookup"><span data-stu-id="58713-250">The `GetEmployees` method calls the `EmployeesTableAdapter` s corresponding `GetEmployees` method, which invokes the `Employees_Select` stored procedure and populates its results in an `EmployeeDataTable`.</span></span> <span data-ttu-id="58713-251">Der `DeleteEmployee` Methodenaufrufe auf ähnliche Weise die `EmployeesTableAdapter` s `Delete` -Methode, die ruft der `Employees_Delete` gespeicherte Prozedur.</span><span class="sxs-lookup"><span data-stu-id="58713-251">The `DeleteEmployee` method similarly calls the `EmployeesTableAdapter` s `Delete` method, which invokes the `Employees_Delete` stored procedure.</span></span>

## <a name="step-5-working-with-the-data-in-the-presentation-layer"></a><span data-ttu-id="58713-252">Schritt 5: Arbeiten mit den Daten in der Darstellungsschicht</span><span class="sxs-lookup"><span data-stu-id="58713-252">Step 5: Working with the Data in the Presentation Layer</span></span>

<span data-ttu-id="58713-253">Mit der `EmployeesBLLWithSprocs` Klasse abgeschlossen ist, wir re kann jetzt zur Bearbeitung der Mitarbeiterdaten über eine ASP.NET-Seite.</span><span class="sxs-lookup"><span data-stu-id="58713-253">With the `EmployeesBLLWithSprocs` class complete, we re ready to work with employee data through an ASP.NET page.</span></span> <span data-ttu-id="58713-254">Öffnen der `JOINs.aspx` auf der Seite der `AdvancedDAL` Ordner, und ziehen Sie eine GridView aus der Toolbox in den Designer, Festlegen seiner `ID` Eigenschaft `Employees`.</span><span class="sxs-lookup"><span data-stu-id="58713-254">Open the `JOINs.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` property to `Employees`.</span></span> <span data-ttu-id="58713-255">Binden Sie als Nächstes aus den GridView s smart Tag im Raster an ein neues ObjectDataSource-Steuerelement mit dem Namen `EmployeesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="58713-255">Next, from the GridView s smart tag, bind the grid to a new ObjectDataSource control named `EmployeesDataSource`.</span></span>

<span data-ttu-id="58713-256">Konfigurieren der ObjectDataSource verwenden die `EmployeesBLLWithSprocs` Klasse und von den Registerkarten auswählen "und" DELETE "sicher, dass die `GetEmployees` und `DeleteEmployee` Methoden aus der Dropdown-Liste ausgewählt werden.</span><span class="sxs-lookup"><span data-stu-id="58713-256">Configure the ObjectDataSource to use the `EmployeesBLLWithSprocs` class and, from the SELECT and DELETE tabs, ensure that the `GetEmployees` and `DeleteEmployee` methods are selected from the drop-down lists.</span></span> <span data-ttu-id="58713-257">Klicken Sie auf ' Fertig stellen ', um die Konfiguration der ObjectDataSource s abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="58713-257">Click Finish to complete the ObjectDataSource s configuration.</span></span>


<span data-ttu-id="58713-258">[![Konfigurieren der ObjectDataSource zur Verwendung der EmployeesBLLWithSprocs-Klasse](updating-the-tableadapter-to-use-joins-vb/_static/image31.png)](updating-the-tableadapter-to-use-joins-vb/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="58713-258">[![Configure the ObjectDataSource to Use the EmployeesBLLWithSprocs Class](updating-the-tableadapter-to-use-joins-vb/_static/image31.png)](updating-the-tableadapter-to-use-joins-vb/_static/image30.png)</span></span>

<span data-ttu-id="58713-259">**Abbildung 12**: Konfigurieren der ObjectDataSource verwenden die `EmployeesBLLWithSprocs` Klasse ([klicken Sie hier, um das Bild in voller Größe angezeigt](updating-the-tableadapter-to-use-joins-vb/_static/image32.png))</span><span class="sxs-lookup"><span data-stu-id="58713-259">**Figure 12**: Configure the ObjectDataSource to Use the `EmployeesBLLWithSprocs` Class ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image32.png))</span></span>


<span data-ttu-id="58713-260">[![Haben Sie die Verwendung ObjectDataSource, die GetEmployees und DeleteEmployee-Methoden](updating-the-tableadapter-to-use-joins-vb/_static/image34.png)](updating-the-tableadapter-to-use-joins-vb/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="58713-260">[![Have the ObjectDataSource Use the GetEmployees and DeleteEmployee Methods](updating-the-tableadapter-to-use-joins-vb/_static/image34.png)](updating-the-tableadapter-to-use-joins-vb/_static/image33.png)</span></span>

<span data-ttu-id="58713-261">**Abbildung 13**: haben Sie die Verwendung ObjectDataSource der `GetEmployees` und `DeleteEmployee` Methoden ([klicken Sie hier, um das Bild in voller Größe angezeigt](updating-the-tableadapter-to-use-joins-vb/_static/image35.png))</span><span class="sxs-lookup"><span data-stu-id="58713-261">**Figure 13**: Have the ObjectDataSource Use the `GetEmployees` and `DeleteEmployee` Methods ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image35.png))</span></span>


<span data-ttu-id="58713-262">Visual Studio wird ein BoundField an die GridView hinzufügen, für jede der `EmployeesDataTable` s-Spalten.</span><span class="sxs-lookup"><span data-stu-id="58713-262">Visual Studio will add a BoundField to the GridView for each of the `EmployeesDataTable` s columns.</span></span> <span data-ttu-id="58713-263">Entfernen Sie alle diese BoundFields mit Ausnahme von `Title`, `LastName`, `FirstName`, `ManagerFirstName`, und `ManagerLastName` , und benennen Sie die `HeaderText` Eigenschaften für die letzten vier BoundFields Nachname, Vorname, Manager s First Name, und Manager s Nachname, bzw.</span><span class="sxs-lookup"><span data-stu-id="58713-263">Remove all of these BoundFields except for `Title`, `LastName`, `FirstName`, `ManagerFirstName`, and `ManagerLastName` and rename the `HeaderText` properties for the last four BoundFields to Last Name, First Name, Manager s First Name, and Manager s Last Name, respectively.</span></span>

<span data-ttu-id="58713-264">Benutzern gestatten, Mitarbeiter, die auf dieser Seite löschen zwei Dinge erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="58713-264">To allow users to delete employees from this page we need to do two things.</span></span> <span data-ttu-id="58713-265">Weisen Sie zunächst GridView Löschen von Funktionen bereitzustellen, durch Aktivieren der Option löschen aktivieren von smart Tag.</span><span class="sxs-lookup"><span data-stu-id="58713-265">First, instruct the GridView to provide deleting capabilities by checking the Enable Deleting option from its smart tag.</span></span> <span data-ttu-id="58713-266">Zweitens, ändern Sie das ObjectDataSource-s `OldValuesParameterFormatString` Eigenschaft aus dem Wert festgelegt, indem das ObjectDataSource-Assistenten (`original_{0}`) auf den Standardwert (`{0}`).</span><span class="sxs-lookup"><span data-stu-id="58713-266">Second, change the ObjectDataSource s `OldValuesParameterFormatString` property from the value set by the ObjectDataSource wizard (`original_{0}`) to its default value (`{0}`).</span></span> <span data-ttu-id="58713-267">Nachdem diese Änderungen vorgenommen wurden, sollte GridView und ObjectDataSource s deklarative Markup etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="58713-267">After making these changes, your GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample7.aspx)]

<span data-ttu-id="58713-268">Testen Sie die Seite, indem Sie es über einen Browser besuchen.</span><span class="sxs-lookup"><span data-stu-id="58713-268">Test out the page by visiting it through a browser.</span></span> <span data-ttu-id="58713-269">Wie in Abbildung 14 gezeigt, wird die Seite aufgelistet, jedes Mitarbeiters und seinen Manager s Namen (sofern vorhanden).</span><span class="sxs-lookup"><span data-stu-id="58713-269">As Figure 14 shows, the page will list each employee and his or her manager s name (assuming they have one).</span></span>


<span data-ttu-id="58713-270">[![Der JOIN in der Employees_Select gespeicherte Prozedur gibt den Namen des Managers s](updating-the-tableadapter-to-use-joins-vb/_static/image37.png)](updating-the-tableadapter-to-use-joins-vb/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="58713-270">[![The JOIN in the Employees_Select Stored Procedure Returns the Manager s Name](updating-the-tableadapter-to-use-joins-vb/_static/image37.png)](updating-the-tableadapter-to-use-joins-vb/_static/image36.png)</span></span>

<span data-ttu-id="58713-271">**Abbildung 14**: die `JOIN` in der `Employees_Select` gespeicherte Prozedur gibt die Manager-s-Name ([klicken Sie hier, um das Bild in voller Größe angezeigt](updating-the-tableadapter-to-use-joins-vb/_static/image38.png))</span><span class="sxs-lookup"><span data-stu-id="58713-271">**Figure 14**: The `JOIN` in the `Employees_Select` Stored Procedure Returns the Manager s Name ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image38.png))</span></span>


<span data-ttu-id="58713-272">Löschen von Workflows, der bei der Ausführung endet mit Klicken auf die Schaltfläche "löschen" startet die `Employees_Delete` gespeicherte Prozedur.</span><span class="sxs-lookup"><span data-stu-id="58713-272">Clicking the Delete button starts the deleting workflow, which culminates in the execution of the `Employees_Delete` stored procedure.</span></span> <span data-ttu-id="58713-273">Allerdings die versuchte `DELETE` Anweisung in der gespeicherten Prozedur, die erzeugt einen Fehler aufgrund einer Verletzung der foreign Key-Einschränkung (siehe Abbildung 15).</span><span class="sxs-lookup"><span data-stu-id="58713-273">However, the attempted `DELETE` statement in the stored procedure fails because of a foreign key constraint violation (see Figure 15).</span></span> <span data-ttu-id="58713-274">Insbesondere verfügt jeder Mitarbeiter eine oder mehrere Datensätze der `Orders` Tabelle, verursacht den Löschvorgang fehl.</span><span class="sxs-lookup"><span data-stu-id="58713-274">Specifically, each employee has one or more records in the `Orders` table, causing the delete to fail.</span></span>


<span data-ttu-id="58713-275">[![Löschen eines Mitarbeiters, in der entsprechenden Aufträge Ergebnisse zu einer Verletzung der Foreign Key-Einschränkung hat](updating-the-tableadapter-to-use-joins-vb/_static/image40.png)](updating-the-tableadapter-to-use-joins-vb/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="58713-275">[![Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation](updating-the-tableadapter-to-use-joins-vb/_static/image40.png)](updating-the-tableadapter-to-use-joins-vb/_static/image39.png)</span></span>

<span data-ttu-id="58713-276">**Abbildung 15**: Löschen von einem Mitarbeiter, die Ergebnisse der entsprechenden Aufträge zu einer Verletzung der Foreign Key-Einschränkung aufweist ([klicken Sie hier, um das Bild in voller Größe angezeigt](updating-the-tableadapter-to-use-joins-vb/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="58713-276">**Figure 15**: Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image41.png))</span></span>


<span data-ttu-id="58713-277">Um ein Mitarbeiter zu ermöglichen Sie ein gelöschtes konnte:</span><span class="sxs-lookup"><span data-stu-id="58713-277">To allow an employee to be deleted you could:</span></span>

- <span data-ttu-id="58713-278">Update der foreign Key-Einschränkung, um Löschvorgänge Kaskadierend weiterzugeben,</span><span class="sxs-lookup"><span data-stu-id="58713-278">Update the foreign key constraint to cascade deletes,</span></span>
- <span data-ttu-id="58713-279">Löschen Sie manuell die Datensätze aus der `Orders` Tabelle für die Mitarbeiter, die Sie löschen möchten, oder</span><span class="sxs-lookup"><span data-stu-id="58713-279">Manually delete the records from the `Orders` table for the employee(s) you want to delete, or</span></span>
- <span data-ttu-id="58713-280">Update der `Employees_Delete` gespeicherte Prozedur So löschen Sie zuerst die verknüpften Datensätze aus der `Orders` Tabelle vor dem Löschen der `Employees` Datensatz.</span><span class="sxs-lookup"><span data-stu-id="58713-280">Update the `Employees_Delete` stored procedure to first delete the related records from the `Orders` table before deleting the `Employees` record.</span></span> <span data-ttu-id="58713-281">Wir haben auch diese Technik in der [vorhandene gespeicherte Prozeduren verwenden, für die typisierte DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) Lernprogramm.</span><span class="sxs-lookup"><span data-stu-id="58713-281">We discussed this technique in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span>

<span data-ttu-id="58713-282">Ich lassen Sie dieses als Übung für den Leser.</span><span class="sxs-lookup"><span data-stu-id="58713-282">I leave this as an exercise for the reader.</span></span>

## <a name="summary"></a><span data-ttu-id="58713-283">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="58713-283">Summary</span></span>

<span data-ttu-id="58713-284">Bei der Arbeit mit relationalen Datenbanken wird häufig Abfragen zum Abrufen ihrer Daten aus mehreren verknüpften Tabellen.</span><span class="sxs-lookup"><span data-stu-id="58713-284">When working with relational databases, it is common for queries to pull their data from multiple, related tables.</span></span> <span data-ttu-id="58713-285">Korrelierte Unterabfragen und `JOIN` s bieten zwei verschiedene Techniken zum Zugreifen auf Daten aus verknüpften Tabellen in einer Abfrage.</span><span class="sxs-lookup"><span data-stu-id="58713-285">Correlated subqueries and `JOIN` s provide two different techniques for accessing data from related tables in a query.</span></span> <span data-ttu-id="58713-286">In vorherige Lernprogrammen, die wir am häufigsten vorgenommen korrelierte Unterabfragen verwenden, da es sich bei der TableAdapter Automatisches Generieren von kann nicht `INSERT`, `UPDATE`, und `DELETE` -Anweisungen für Abfragen, die im Zusammenhang mit `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="58713-286">In previous tutorials we most commonly made use of correlated subqueries because the TableAdapter cannot auto-generate `INSERT`, `UPDATE`, and `DELETE` statements for queries involving `JOIN` s.</span></span> <span data-ttu-id="58713-287">Während diese Werte manuell bereitgestellt werden können, wenn mithilfe von Ad-hoc-SQL-Anweisungen werden alle Anpassungen überschrieben, wenn der TableAdapter-Konfigurations-Assistent abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="58713-287">While these values can be provided manually, when using ad-hoc SQL statements any customizations will be overwritten when the TableAdapter Configuration wizard is completed.</span></span>

<span data-ttu-id="58713-288">Glücklicherweise sind TableAdapters, die mithilfe von gespeicherten Prozeduren erstellt aus der gleichen unzulänglichen als solche, die mit Ad-hoc-SQL-Anweisungen erstellt nicht wesentlich beeinträchtigt.</span><span class="sxs-lookup"><span data-stu-id="58713-288">Fortunately, TableAdapters created using stored procedures do not suffer from the same brittleness as those created using ad-hoc SQL statements.</span></span> <span data-ttu-id="58713-289">Daher ist es möglich, einen TableAdapter erstellen, deren Hauptabfrage verwendet, eine `JOIN` bei der Verwendung gespeicherter Prozeduren.</span><span class="sxs-lookup"><span data-stu-id="58713-289">Therefore, it is feasible to create a TableAdapter whose main query uses a `JOIN` when using stored procedures.</span></span> <span data-ttu-id="58713-290">In diesem Lernprogramm wurde erläutert, wie solche einen TableAdapter erstellen.</span><span class="sxs-lookup"><span data-stu-id="58713-290">In this tutorial we saw how to create such a TableAdapter.</span></span> <span data-ttu-id="58713-291">Wir beginnen mit einem `JOIN`-weniger `SELECT` Abfragen für die Hauptabfrage des TableAdapter s, damit die entsprechenden Einfüge-, Update- und Delete gespeicherten Prozeduren automatisch erstellt werden würde.</span><span class="sxs-lookup"><span data-stu-id="58713-291">We started by using a `JOIN`-less `SELECT` query for the TableAdapter s main query so that the corresponding insert, update, and delete stored procedures would be auto-created.</span></span> <span data-ttu-id="58713-292">Mit dem TableAdapter s anfängliche Konfiguration abgeschlossen, es erweitert die `SelectCommand` gespeicherte Prozedur verwendet eine `JOIN` und der TableAdapter-Konfigurations-Assistenten die Aktualisierung erneut ausgeführt der `EmployeesDataTable` s-Spalten.</span><span class="sxs-lookup"><span data-stu-id="58713-292">With the TableAdapter s initial configuration complete, we augmented the `SelectCommand` stored procedure to use a `JOIN` and re-ran the TableAdapter Configuration wizard to update the `EmployeesDataTable` s columns.</span></span>

<span data-ttu-id="58713-293">Erneutes Ausführen der TableAdapter-Konfigurations-Assistent automatisch aktualisiert, die `EmployeesDataTable` Spalten entsprechend der Datenfelder zurückgegebenes der `Employees_Select` gespeicherte Prozedur.</span><span class="sxs-lookup"><span data-stu-id="58713-293">Re-running the TableAdapter Configuration wizard automatically updated the `EmployeesDataTable` columns to reflect the data fields returned by the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="58713-294">Alternativ können Sie konnten wir diese Spalten manuell DataTable hinzugefügt haben.</span><span class="sxs-lookup"><span data-stu-id="58713-294">Alternatively, we could have added these columns manually to the DataTable.</span></span> <span data-ttu-id="58713-295">Wir untersuchen manuelle Hinzufügen von Spalten zu der "DataTable" in den nächsten Lernprogrammen.</span><span class="sxs-lookup"><span data-stu-id="58713-295">We will explore manually adding columns to the DataTable in the next tutorial.</span></span>

<span data-ttu-id="58713-296">Viel Spaß beim Programmieren!</span><span class="sxs-lookup"><span data-stu-id="58713-296">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="58713-297">Informationen zum Autor</span><span class="sxs-lookup"><span data-stu-id="58713-297">About the Author</span></span>

<span data-ttu-id="58713-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor von sieben ASP/ASP.NET-Büchern und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), Microsoft Web-Technologien seit 1998 arbeitet.</span><span class="sxs-lookup"><span data-stu-id="58713-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="58713-299">Scott fungiert als ein unabhängiger Berater, Trainer und Writer.</span><span class="sxs-lookup"><span data-stu-id="58713-299">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="58713-300">Sein neueste Buch wird [ *Sams Schulen selbst ASP.NET 2.0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="58713-300">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="58713-301">Er die erreicht werden kann, zur [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) oder über seinen Blog die finden Sie unter [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="58713-301">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="58713-302">Besonderen Dank an</span><span class="sxs-lookup"><span data-stu-id="58713-302">Special Thanks To</span></span>

<span data-ttu-id="58713-303">Diese Reihe von Lernprogrammen wurde durch viele nützliche Bearbeiter überprüft.</span><span class="sxs-lookup"><span data-stu-id="58713-303">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="58713-304">Lead Prüfer für dieses Lernprogramm wurden Hilton Geisenow, David Suru und Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="58713-304">Lead reviewers for this tutorial were Hilton Geisenow, David Suru, and Teresa Murphy.</span></span> <span data-ttu-id="58713-305">Meine bevorstehende MSDN-Artikel Überprüfen von Interesse?</span><span class="sxs-lookup"><span data-stu-id="58713-305">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="58713-306">Wenn dies der Fall ist, löschen Sie mich zeilenweise [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="58713-306">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="58713-307">[Zurück](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
> [Weiter](adding-additional-datatable-columns-vb.md)</span><span class="sxs-lookup"><span data-stu-id="58713-307">[Previous](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
[Next](adding-additional-datatable-columns-vb.md)</span></span>
