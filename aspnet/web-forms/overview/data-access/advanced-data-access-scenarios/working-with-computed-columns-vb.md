---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/working-with-computed-columns-vb
title: Arbeiten mit berechneten Spalten (VB) | Microsoft Docs
author: rick-anderson
description: Beim Erstellen einer Datenbanktabelle, Microsoft SQL Server können Sie eine berechnete Spalte zu definieren, dessen Wert aus einem Ausdruck berechnet wird, der normalerweise verw...
ms.author: aspnetcontent
manager: wpickett
ms.date: 08/03/2007
ms.topic: article
ms.assetid: 5811b8ff-ed56-40fc-9397-6b69ae09a8f6
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/working-with-computed-columns-vb
msc.type: authoredcontent
ms.openlocfilehash: 04b39902aae05d815eb11ec7b7163988d017f78c
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/06/2018
ms.locfileid: "30877202"
---
<a name="working-with-computed-columns-vb"></a><span data-ttu-id="c5568-103">Arbeiten mit berechneten Spalten (VB)</span><span class="sxs-lookup"><span data-stu-id="c5568-103">Working with Computed Columns (VB)</span></span>
====================
<span data-ttu-id="c5568-104">durch [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="c5568-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="c5568-105">[Herunterladen von Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_71_VB.zip) oder [PDF herunterladen](working-with-computed-columns-vb/_static/datatutorial71vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="c5568-105">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_71_VB.zip) or [Download PDF](working-with-computed-columns-vb/_static/datatutorial71vb1.pdf)</span></span>

> <span data-ttu-id="c5568-106">Wenn Sie eine Datenbanktabelle zu erstellen, können mit Microsoft SQL Server eine berechnete Spalte definieren, deren Wert aus einem Ausdruck berechnet wird, die auf andere Werte in der gleichen Datensatz in der Datenbank in der Regel verweist.</span><span class="sxs-lookup"><span data-stu-id="c5568-106">When creating a database table, Microsoft SQL Server allows you to define a computed column whose value is calculated from an expression that usually references other values in the same database record.</span></span> <span data-ttu-id="c5568-107">Solche Werte sind in der Datenbank, wofür Besonderheiten beim Arbeiten mit TableAdapters schreibgeschützt.</span><span class="sxs-lookup"><span data-stu-id="c5568-107">Such values are read-only at the database, which requires special considerations when working with TableAdapters.</span></span> <span data-ttu-id="c5568-108">In diesem Lernprogramm erfahren wir die Bedrohung durch berechnete Spalten Auflagen erfüllt werden können.</span><span class="sxs-lookup"><span data-stu-id="c5568-108">In this tutorial we learn how to meet the challenges posed by computed columns.</span></span>


## <a name="introduction"></a><span data-ttu-id="c5568-109">Einführung</span><span class="sxs-lookup"><span data-stu-id="c5568-109">Introduction</span></span>

<span data-ttu-id="c5568-110">Microsoft SQL Server ermöglicht  *[berechnete Spalten](https://msdn.microsoft.com/library/ms191250.aspx)*, die Spalten, deren Werte werden von einem Ausdruck, der in der Regel die Werte aus anderen Spalten in derselben Tabelle verweist auf berechnet, werden.</span><span class="sxs-lookup"><span data-stu-id="c5568-110">Microsoft SQL Server allows for *[computed columns](https://msdn.microsoft.com/library/ms191250.aspx)*, which are columns whose values are calculated from an expression that usually references the values from other columns in the same table.</span></span> <span data-ttu-id="c5568-111">Eine Zeit nachverfolgen Datenmodell möglicherweise als Beispiel eine Tabelle namens `ServiceLog` mit Spalten, einschließlich `ServicePerformed`, `EmployeeID`, `Rate`, und `Duration`, o. ä.</span><span class="sxs-lookup"><span data-stu-id="c5568-111">As an example, a time tracking data model might have a table named `ServiceLog` with columns including `ServicePerformed`, `EmployeeID`, `Rate`, and `Duration`, among others.</span></span> <span data-ttu-id="c5568-112">Während der Gesamtbetrag pro-Dienst-Element (wird die Rate, multipliziert mit der Dauer) konnte über eine Webseite oder andere programmgesteuerte Schnittstelle berechnet werden, ist es möglicherweise hilfreich, eine Spalte in der `ServiceLog` Tabelle mit dem Namen `AmountDue` , die dies gemeldet Informationen.</span><span class="sxs-lookup"><span data-stu-id="c5568-112">While the amount due per service item (being the rate multiplied by the duration) could be calculated through a web page or other programmatic interface, it might be handy to include a column in the `ServiceLog` table named `AmountDue` that reported this information.</span></span> <span data-ttu-id="c5568-113">Diese Spalte kann als normale Spalte erstellt werden, aber er dürfte jederzeit aktualisiert werden die `Rate` oder `Duration` Spaltenwerte geändert.</span><span class="sxs-lookup"><span data-stu-id="c5568-113">This column could be created as a normal column, but it would need to be updated anytime the `Rate` or `Duration` column values changed.</span></span> <span data-ttu-id="c5568-114">Ein besserer Ansatz wäre, stellen die `AmountDue` Spalte eine berechnete Spalte mit dem Ausdruck `Rate * Duration`.</span><span class="sxs-lookup"><span data-stu-id="c5568-114">A better approach would be to make the `AmountDue` column a computed column using the expression `Rate * Duration`.</span></span> <span data-ttu-id="c5568-115">Auf diese Weise würde dazu führen, dass SQL Server für die automatische Berechnung der `AmountDue` Spaltenwert immer in einer Abfrage auf sie verwiesen wurde.</span><span class="sxs-lookup"><span data-stu-id="c5568-115">Doing so would cause SQL Server to automatically calculate the `AmountDue` column value whenever it was referenced in a query.</span></span>

<span data-ttu-id="c5568-116">Da ein berechnete Spalte s-Wert durch einen Ausdruck bestimmt ist, solche Spalten sind schreibgeschützt und aus diesem Grund können keine Werte zugewiesene auf diese Dateien im `INSERT` oder `UPDATE` Anweisungen.</span><span class="sxs-lookup"><span data-stu-id="c5568-116">Since a computed column s value is determined by an expression, such columns are read-only and therefore cannot have values assigned to them in `INSERT` or `UPDATE` statements.</span></span> <span data-ttu-id="c5568-117">Wenn berechnete Spalten Teil der Hauptabfrage für einen TableAdapter, die Ad-hoc-SQL-Anweisungen verwendet handelt, sie werden jedoch automatisch eingeschlossen in automatisch generierte `INSERT` und `UPDATE` Anweisungen.</span><span class="sxs-lookup"><span data-stu-id="c5568-117">However, when computed columns are part of the main query for a TableAdapter that uses ad-hoc SQL statements, they are automatically included in the auto-generated `INSERT` and `UPDATE` statements.</span></span> <span data-ttu-id="c5568-118">Folglich die TableAdapter `INSERT` und `UPDATE` Abfragen und `InsertCommand` und `UpdateCommand` Eigenschaften müssen aktualisiert werden, um Verweise auf alle berechneten Spalten zu entfernen.</span><span class="sxs-lookup"><span data-stu-id="c5568-118">Consequently, the TableAdapter s `INSERT` and `UPDATE` queries and `InsertCommand` and `UpdateCommand` properties must be updated to remove references to any computed columns.</span></span>

<span data-ttu-id="c5568-119">Eine Herausforderung der Verwendung von berechneten Spalten mit einem TableAdapter, die Ad-hoc-SQL-Anweisungen verwendet wird, die die TableAdapter `INSERT` und `UPDATE` Abfragen automatisch erneut generiert, einem beliebigen Zeitpunkt der TableAdapter-Konfigurations-Assistent abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="c5568-119">One challenge of using computed columns with a TableAdapter that uses ad-hoc SQL statements is that the TableAdapter s `INSERT` and `UPDATE` queries are automatically regenerated any time the TableAdapter Configuration wizard is completed.</span></span> <span data-ttu-id="c5568-120">Aus diesem Grund manuell die berechneten Spalten daraus die `INSERT` und `UPDATE` Abfragen werden erneut angezeigt, wenn der Assistent erneut ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="c5568-120">Therefore, the computed columns manually removed from the `INSERT` and `UPDATE` queries will reappear if the wizard is re-run.</span></span> <span data-ttu-id="c5568-121">Obwohl TableAdapters, die gespeicherten Prozeduren verwenden t Verschlüsselungskennwort aus dieser unzulänglichen beeinträchtigt, besitzen ihre eigenen Quirksmodus, die wir in Schritt 3 gerecht werden.</span><span class="sxs-lookup"><span data-stu-id="c5568-121">Although TableAdapters that use stored procedures don t suffer from this brittleness, they do have their own quirks that we will address in Step 3.</span></span>

<span data-ttu-id="c5568-122">In diesem Lernprogramm werden wir eine berechnete Spalte hinzufügen der `Suppliers` -Tabelle in der Northwind-Datenbank und erstellen Sie einen entsprechenden TableAdapter zum Arbeiten mit dieser Tabelle und einer berechneten Spalte.</span><span class="sxs-lookup"><span data-stu-id="c5568-122">In this tutorial we will add a computed column to the `Suppliers` table in the Northwind database and then create a corresponding TableAdapter to work with this table and its computed column.</span></span> <span data-ttu-id="c5568-123">Wir haben unsere TableAdapter gespeicherte Prozeduren anstelle von Ad-hoc-SQL-Anweisungen verwenden, sodass unsere Anpassungen sind t verloren, wenn der TableAdapter-Konfigurations-Assistent verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="c5568-123">We will have our TableAdapter use stored procedures instead of ad-hoc SQL statements so that our customizations aren t lost when the TableAdapter Configuration wizard is used.</span></span>

<span data-ttu-id="c5568-124">Lassen Sie s beginnen!</span><span class="sxs-lookup"><span data-stu-id="c5568-124">Let s get started!</span></span>

## <a name="step-1-adding-a-computed-column-to-thesupplierstable"></a><span data-ttu-id="c5568-125">Schritt 1: Hinzufügen einer berechneten Spalte, die`Suppliers`Tabelle</span><span class="sxs-lookup"><span data-stu-id="c5568-125">Step 1: Adding a Computed Column to the`Suppliers`Table</span></span>

<span data-ttu-id="c5568-126">Die Northwind-Datenbank besitzt keine berechneten Spalten, sodass wir uns ein hinzuzufügende benötigen.</span><span class="sxs-lookup"><span data-stu-id="c5568-126">The Northwind database does not have any computed columns so we will need to add one ourselves.</span></span> <span data-ttu-id="c5568-127">Für dieses Lernprogramm s eine berechnete Spalte hinzufügen kann die `Suppliers` Tabelle mit dem Namen `FullContactName` , die der-s-Kontaktname, Titel und das Unternehmen, die sie für funktionieren zurückgibt, im folgenden Format: `ContactName` (`ContactTitle`, `CompanyName`).</span><span class="sxs-lookup"><span data-stu-id="c5568-127">For this tutorial let s add a computed column to the `Suppliers` table called `FullContactName` that returns the contact s name, title, and the company they work for in the following format: `ContactName` (`ContactTitle`, `CompanyName`).</span></span> <span data-ttu-id="c5568-128">Diese berechnete Spalte möglicherweise beim Anzeigen von Informationen zu Lieferanten in Berichten verwendet.</span><span class="sxs-lookup"><span data-stu-id="c5568-128">This computed column might be used in reports when displaying information about suppliers.</span></span>

<span data-ttu-id="c5568-129">Öffnen Sie zunächst die `Suppliers` Tabellendefinition mit der rechten Maustaste auf die `Suppliers` Tabelle im Server-Explorer und Tabellendefinition öffnen aus dem Kontextmenü auswählen.</span><span class="sxs-lookup"><span data-stu-id="c5568-129">Start by opening the `Suppliers` table definition by right-clicking on the `Suppliers` table in the Server Explorer and choosing Open Table Definition from the context-menu.</span></span> <span data-ttu-id="c5568-130">Dadurch werden die Spalten der Tabelle und ihre Eigenschaften, z. B. ihr Datentyp angezeigt, ob sie zulassen `NULL` s und So weiter.</span><span class="sxs-lookup"><span data-stu-id="c5568-130">This will display the columns of the table and their properties, such as their data type, whether they allow `NULL` s, and so forth.</span></span> <span data-ttu-id="c5568-131">Um eine berechnete Spalte hinzuzufügen, starten Sie dazu den Namen der Spalte in der Tabelle (Definition).</span><span class="sxs-lookup"><span data-stu-id="c5568-131">To add a computed column, start by typing in the name of the column into the table definition.</span></span> <span data-ttu-id="c5568-132">Geben Sie anschließend den Ausdruck in das Textfeld (Formel), unter dem Abschnitt Berechnetespaltespezifikation im Fenster Spalteneigenschaften (siehe Abbildung 1).</span><span class="sxs-lookup"><span data-stu-id="c5568-132">Next, enter its expression into the (Formula) textbox under the Computed Column Specification section in the Column Properties window (see Figure 1).</span></span> <span data-ttu-id="c5568-133">Benennen Sie die berechnete Spalte `FullContactName` und verwenden Sie den folgenden Ausdruck:</span><span class="sxs-lookup"><span data-stu-id="c5568-133">Name the computed column `FullContactName` and use the following expression:</span></span>


[!code-sql[Main](working-with-computed-columns-vb/samples/sample1.sql)]

<span data-ttu-id="c5568-134">Beachten Sie, dass Zeichenfolgen können, in SQL verkettet werden mit dem `+` Operator.</span><span class="sxs-lookup"><span data-stu-id="c5568-134">Note that strings can be concatenated in SQL using the `+` operator.</span></span> <span data-ttu-id="c5568-135">Die `CASE` -Anweisung kann verwendet werden, wie eine bedingte in einer herkömmlichen Programmiersprache Ihrer Wahl.</span><span class="sxs-lookup"><span data-stu-id="c5568-135">The `CASE` statement can be used like a conditional in a traditional programming language.</span></span> <span data-ttu-id="c5568-136">Im obigen Ausdruck der `CASE` Anweisung als gelesen werden kann: Wenn `ContactTitle` ist nicht `NULL` ausgeben der `ContactTitle` durch ein Komma, andernfalls verketteter Wert ausgeben nichts.</span><span class="sxs-lookup"><span data-stu-id="c5568-136">In the above expression the `CASE` statement can be read as: If `ContactTitle` is not `NULL` then output the `ContactTitle` value concatenated with a comma, otherwise emit nothing.</span></span> <span data-ttu-id="c5568-137">Weitere Informationen über die Nützlichkeit der der `CASE` -Anweisung finden Sie unter [der SQL-Power `CASE` Anweisungen](http://www.4guysfromrolla.com/webtech/102704-1.shtml).</span><span class="sxs-lookup"><span data-stu-id="c5568-137">For more on the usefulness of the `CASE` statement, see [The Power of SQL `CASE` Statements](http://www.4guysfromrolla.com/webtech/102704-1.shtml).</span></span>

> [!NOTE]
> <span data-ttu-id="c5568-138">Anstatt eine `CASE` Anweisung hier wir Alternativ hätte `ISNULL(ContactTitle, '')`.</span><span class="sxs-lookup"><span data-stu-id="c5568-138">Instead of using a `CASE` statement here, we could have alternatively used `ISNULL(ContactTitle, '')`.</span></span> <span data-ttu-id="c5568-139">[`ISNULL(checkExpression, replacementValue)`](https://msdn.microsoft.com/library/ms184325.aspx) Gibt *CheckExpression* , wenn er nicht NULL ist, anderfalls wird *Ersatzwert*.</span><span class="sxs-lookup"><span data-stu-id="c5568-139">[`ISNULL(checkExpression, replacementValue)`](https://msdn.microsoft.com/library/ms184325.aspx) returns *checkExpression* if it is non-NULL, otherwise it returns *replacementValue*.</span></span> <span data-ttu-id="c5568-140">Entweder während `ISNULL` oder `CASE` funktioniert in dieser Instanz stehen mehr komplizierte Szenarien, in denen die Flexibilität der `CASE` Anweisung kann nicht zugeordnet werden, indem `ISNULL`.</span><span class="sxs-lookup"><span data-stu-id="c5568-140">While either `ISNULL` or `CASE` will work in this instance, there are more intricate scenarios where the flexibility of the `CASE` statement cannot be matched by `ISNULL`.</span></span>


<span data-ttu-id="c5568-141">Nach dem Hinzufügen der diese berechnete Spalte sollten Ihren Bildschirm wie im Screenshot in Abbildung 1 aussehen.</span><span class="sxs-lookup"><span data-stu-id="c5568-141">After adding this computed column your screen should look like the screen shot in Figure 1.</span></span>


<span data-ttu-id="c5568-142">[![Fügen Sie eine berechnete Spalte mit dem Namen FullContactName der Lieferanten-Tabelle](working-with-computed-columns-vb/_static/image2.png)](working-with-computed-columns-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="c5568-142">[![Add a Computed Column Named FullContactName to the Suppliers Table](working-with-computed-columns-vb/_static/image2.png)](working-with-computed-columns-vb/_static/image1.png)</span></span>

<span data-ttu-id="c5568-143">**Abbildung 1**: Hinzufügen einer berechneten Spalte mit dem Namen `FullContactName` auf die `Suppliers` Tabelle ([klicken Sie hier, um das Bild in voller Größe angezeigt](working-with-computed-columns-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="c5568-143">**Figure 1**: Add a Computed Column Named `FullContactName` to the `Suppliers` Table ([Click to view full-size image](working-with-computed-columns-vb/_static/image3.png))</span></span>


<span data-ttu-id="c5568-144">Nach dem Benennen der berechneten Spalte, und der Ausdruck eingeben, speichern Sie die Änderungen in der Tabelle durch Klicken auf das Symbol "Speichern" in der Symbolleiste, drücken Sie STRG + S oder indem Sie im Menü Datei aufrufen und Auswählen von Speichern `Suppliers`.</span><span class="sxs-lookup"><span data-stu-id="c5568-144">After naming the computed column and entering its expression, save the changes to the table by clicking the Save icon in the toolbar, by hitting Ctrl+S, or by going to the File menu and choosing Save `Suppliers`.</span></span>

<span data-ttu-id="c5568-145">Speichern der Tabelle einschließlich der gerade hinzugefügten Spalte im Server-Explorer aktualisieren sollten die `Suppliers` Spaltenliste s'-Tabelle.</span><span class="sxs-lookup"><span data-stu-id="c5568-145">Saving the table should refresh the Server Explorer, including the just-added column in the `Suppliers` table s column list.</span></span> <span data-ttu-id="c5568-146">Der Ausdruck in das Textfeld (Formel) eingegeben werden darüber hinaus automatisch angepasst, um einen entsprechenden Ausdruck aus, die Spaltennamen in Klammern umgeben unnötige Leerzeichen entfernt (`[]`), sowie Klammern, um mehr explizit anzeigen die Reihenfolge der Vorgänge:</span><span class="sxs-lookup"><span data-stu-id="c5568-146">Furthermore, the expression entered into the (Formula) textbox will automatically adjust to an equivalent expression that strips unnecessary whitespace, surrounds column names with brackets (`[]`), and includes parentheses to more explicitly show the order of operations:</span></span>


[!code-sql[Main](working-with-computed-columns-vb/samples/sample2.sql)]

<span data-ttu-id="c5568-147">Weitere Informationen zu berechneten Spalten in der Microsoft SQL Server, finden Sie in der [technische Dokumentation](https://msdn.microsoft.com/library/ms191250.aspx).</span><span class="sxs-lookup"><span data-stu-id="c5568-147">For more information on computed columns in Microsoft SQL Server, refer to the [technical documentation](https://msdn.microsoft.com/library/ms191250.aspx).</span></span> <span data-ttu-id="c5568-148">Außerdem sehen Sie sich die [How to: Specify Computed Columns](https://msdn.microsoft.com/library/ms188300.aspx) eine schrittweise Anleitung zum Erstellen von berechneten Spalten.</span><span class="sxs-lookup"><span data-stu-id="c5568-148">Also check out the [How to: Specify Computed Columns](https://msdn.microsoft.com/library/ms188300.aspx) for a step-by-step walkthrough of creating computed columns.</span></span>

> [!NOTE]
> <span data-ttu-id="c5568-149">Standardmäßig werden berechnete Spalten nicht physisch in der Tabelle gespeichert sind jedoch jedes Mal, wenn diese in einer Abfrage verwiesen wird, werden stattdessen neu berechnet.</span><span class="sxs-lookup"><span data-stu-id="c5568-149">By default, computed columns are not physically stored in the table but are instead recalculated each time they are referenced in a query.</span></span> <span data-ttu-id="c5568-150">Überprüfen Sie das Kontrollkästchen wird beibehalten, jedoch können Sie SQL Server, um die berechnete Spalte in der Tabelle physisch gespeichert anweisen.</span><span class="sxs-lookup"><span data-stu-id="c5568-150">By checking the Is Persisted checkbox, however, you can instruct SQL Server to physically store the computed column in the table.</span></span> <span data-ttu-id="c5568-151">Auf diese Weise kann ein Index für die berechnete Spalte erstellt werden, die die Leistung von Abfragen verbessern können, mit denen der Wert der berechneten Spalte in ihren `WHERE` Klauseln.</span><span class="sxs-lookup"><span data-stu-id="c5568-151">Doing so allows an index to be created on the computed column, which can improve the performance of queries that use the computed column value in their `WHERE` clauses.</span></span> <span data-ttu-id="c5568-152">Finden Sie unter [Erstellen von Indizes für berechnete Spalten](https://msdn.microsoft.com/library/ms189292.aspx) für Weitere Informationen.</span><span class="sxs-lookup"><span data-stu-id="c5568-152">See [Creating Indexes on Computed Columns](https://msdn.microsoft.com/library/ms189292.aspx) for more information.</span></span>


## <a name="step-2-viewing-the-computed-column-s-values"></a><span data-ttu-id="c5568-153">Schritt 2: Anzeigen der Werte für berechnete Spalten s</span><span class="sxs-lookup"><span data-stu-id="c5568-153">Step 2: Viewing the Computed Column s Values</span></span>

<span data-ttu-id="c5568-154">Bevor wir die Arbeit auf der Datenzugriffsebene beginnen, Let s nehmen Sie sich an den `FullContactName` Werte.</span><span class="sxs-lookup"><span data-stu-id="c5568-154">Before we start work on the Data Access Layer, let s take a minute to view the `FullContactName` values.</span></span> <span data-ttu-id="c5568-155">Im Server-Explorer mit der Maustaste auf die `Suppliers` Tabellennamen ein, und wählen Sie die neue Abfrage aus dem Kontextmenü.</span><span class="sxs-lookup"><span data-stu-id="c5568-155">From the Server Explorer, right-click on the `Suppliers` table name and choose New Query from the context-menu.</span></span> <span data-ttu-id="c5568-156">Hierdurch wird ein Abfragefenster angezeigt, die uns, welche Tabellen in der Abfrage wählen aufgefordert werden.</span><span class="sxs-lookup"><span data-stu-id="c5568-156">This will bring up a Query window that prompts us to choose what tables to include in the query.</span></span> <span data-ttu-id="c5568-157">Hinzufügen der `Suppliers` Tabelle, und klicken Sie auf Schließen.</span><span class="sxs-lookup"><span data-stu-id="c5568-157">Add the `Suppliers` table and click Close.</span></span> <span data-ttu-id="c5568-158">Überprüfen Sie anschließend die `CompanyName`, `ContactName`, `ContactTitle`, und `FullContactName` Spalten aus der Tabelle "Suppliers".</span><span class="sxs-lookup"><span data-stu-id="c5568-158">Next, check the `CompanyName`, `ContactName`, `ContactTitle`, and `FullContactName` columns from the Suppliers table.</span></span> <span data-ttu-id="c5568-159">Klicken Sie abschließend auf das Symbol "rotes Ausrufezeichen" in der Symbolleiste, um die Abfrage auszuführen und die Ergebnisse anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="c5568-159">Finally, click the red exclamation point icon in the Toolbar to execute the query and view the results.</span></span>

<span data-ttu-id="c5568-160">Wie in Abbildung 2 gezeigt, enthalten die Ergebnisse `FullContactName`, die Listen der `CompanyName`, `ContactName`, und `ContactTitle` Spalten unter Verwendung des Formats `ContactName` (`ContactTitle`, `CompanyName`).</span><span class="sxs-lookup"><span data-stu-id="c5568-160">As Figure 2 shows, the results include `FullContactName`, which lists the `CompanyName`, `ContactName`, and `ContactTitle` columns using the format `ContactName` (`ContactTitle`, `CompanyName`) .</span></span>


<span data-ttu-id="c5568-161">[![Die FullContactName verwendet das Format ContactName (ContactTitle, CompanyName)](working-with-computed-columns-vb/_static/image5.png)](working-with-computed-columns-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="c5568-161">[![The FullContactName Uses the Format ContactName (ContactTitle, CompanyName)](working-with-computed-columns-vb/_static/image5.png)](working-with-computed-columns-vb/_static/image4.png)</span></span>

<span data-ttu-id="c5568-162">**Abbildung 2**: die `FullContactName` verwendet das Format `ContactName` (`ContactTitle`, `CompanyName`) ([klicken Sie hier, um das Bild in voller Größe angezeigt](working-with-computed-columns-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="c5568-162">**Figure 2**: The `FullContactName` Uses the Format `ContactName` (`ContactTitle`, `CompanyName`) ([Click to view full-size image](working-with-computed-columns-vb/_static/image6.png))</span></span>


## <a name="step-3-adding-thesupplierstableadapterto-the-data-access-layer"></a><span data-ttu-id="c5568-163">Schritt 3: Hinzufügen der`SuppliersTableAdapter`auf der Datenzugriffsebene</span><span class="sxs-lookup"><span data-stu-id="c5568-163">Step 3: Adding the`SuppliersTableAdapter`to the Data Access Layer</span></span>

<span data-ttu-id="c5568-164">Um mit den Lieferanten in der vorliegenden Anwendung arbeiten muss zunächst ein TableAdapter und einer Datentabelle in unserer DAL erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="c5568-164">In order to work with the supplier information in our application we need to first create a TableAdapter and DataTable in our DAL.</span></span> <span data-ttu-id="c5568-165">Im Idealfall würde dies erfolgen mithilfe der gleichen einfache Schritte, die in früheren Lernprogramme untersucht.</span><span class="sxs-lookup"><span data-stu-id="c5568-165">Ideally, this would be accomplished using the same straightforward steps examined in earlier tutorials.</span></span> <span data-ttu-id="c5568-166">Arbeiten mit berechneten Spalten stellt jedoch einige Falten, die Erläuterung bedürfen.</span><span class="sxs-lookup"><span data-stu-id="c5568-166">However, working with computed columns introduces a few wrinkles that merit discussion.</span></span>

<span data-ttu-id="c5568-167">Wenn Sie einen TableAdapter, die Ad-hoc-SQL-Anweisungen verwendet verwenden, können Sie einfach die berechnete Spalte in der TableAdapter Hauptabfrage s über den TableAdapter-Konfigurations-Assistenten einschließen.</span><span class="sxs-lookup"><span data-stu-id="c5568-167">If you are using a TableAdapter that uses ad-hoc SQL statements, you can simply include the computed column in the TableAdapter s main query via the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="c5568-168">Hierzu jedoch automatisch generiert `INSERT` und `UPDATE` Anweisungen, die die berechnete Spalte enthalten.</span><span class="sxs-lookup"><span data-stu-id="c5568-168">This, however, will auto-generate `INSERT` and `UPDATE` statements that include the computed column.</span></span> <span data-ttu-id="c5568-169">Wenn Sie versuchen, eine dieser Methoden Ausführen einer `SqlException` mit der Meldung der Spalte *ColumnName* kann nicht geändert werden, da sie entweder eine berechnete Spalte ist oder das Ergebnis eines UNION-Operators wird ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="c5568-169">If you attempt to execute one of these methods, a `SqlException` with the message The column *ColumnName* cannot be modified because it is either a computed column or is the result of a UNION operator will be thrown.</span></span> <span data-ttu-id="c5568-170">Während der `INSERT` und `UPDATE` Anweisung angepasst werden, manuell über die TableAdapter `InsertCommand` und `UpdateCommand` Eigenschaften, diese Anpassungen gehen verloren, sobald der TableAdapter-Konfigurations-Assistent erneut ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="c5568-170">While the `INSERT` and `UPDATE` statement can be manually adjusted through the TableAdapter s `InsertCommand` and `UpdateCommand` properties, these customizations will be lost whenever the TableAdapter Configuration wizard is re-run.</span></span>

<span data-ttu-id="c5568-171">Aufgrund der unzulänglichen TableAdapters, die Ad-hoc-SQL-Anweisungen verwenden, wird empfohlen, dass wir bei der Arbeit mit berechneten Spalten gespeicherte Prozeduren verwenden.</span><span class="sxs-lookup"><span data-stu-id="c5568-171">Due to the brittleness of TableAdapters that use ad-hoc SQL statements, it is recommended that we use stored procedures when working with computed columns.</span></span> <span data-ttu-id="c5568-172">Wenn Sie vorhandene gespeicherte Prozeduren verwenden, Konfigurieren des TableAdapter einfach wie beschrieben in der [vorhandene gespeicherte Prozeduren verwenden, für die typisierte DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) Lernprogramm.</span><span class="sxs-lookup"><span data-stu-id="c5568-172">If you are using existing stored procedures, simply configure the TableAdapter as discussed in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span> <span data-ttu-id="c5568-173">Wenn Sie den TableAdapter-Assistenten, die die gespeicherten Prozeduren erstellt haben, ist es allerdings wichtig, zunächst alle berechneten Spalten aus der Hauptabfrage weglassen.</span><span class="sxs-lookup"><span data-stu-id="c5568-173">If you have the TableAdapter wizard create the stored procedures for you, however, it is important to initially omit any computed columns from the main query.</span></span> <span data-ttu-id="c5568-174">Wenn Sie eine berechnete Spalte in der Hauptabfrage enthalten, informiert der TableAdapter-Konfigurations-Assistent, nach Abschluss des Vorgangs Sie, dass die entsprechenden gespeicherten Prozeduren erstellt werden kann.</span><span class="sxs-lookup"><span data-stu-id="c5568-174">If you include a computed column in the main query, the TableAdapter Configuration wizard will inform you, upon completion, that it cannot create the corresponding stored procedures.</span></span> <span data-ttu-id="c5568-175">Kurz gesagt, müssen wir den TableAdapter eine berechnete Spalte frei hauptspeicherpool für Abfragen mit Beginn zu konfigurieren und dann manuell aktualisieren, die entsprechende gespeicherte Prozedur und die TableAdapter `SelectCommand` die berechnete Spalte eingeschlossen werden soll.</span><span class="sxs-lookup"><span data-stu-id="c5568-175">In short, we need to initially configure the TableAdapter using a computed column-free main query and then manually update the corresponding stored procedure and the TableAdapter s `SelectCommand` to include the computed column.</span></span> <span data-ttu-id="c5568-176">Dieser Ansatz gleicht die Abfrage verwendet die [Aktualisieren des TableAdapters zu verwendenden](updating-the-tableadapter-to-use-joins-vb.md)`JOIN`*s* Lernprogramm.</span><span class="sxs-lookup"><span data-stu-id="c5568-176">This approach is similar to the one used in the [Updating the TableAdapter to Use](updating-the-tableadapter-to-use-joins-vb.md)`JOIN`*s* tutorial.</span></span>

<span data-ttu-id="c5568-177">Können Sie für dieses Lernprogramm s fügen Sie einen neuen TableAdapter und sorgen sie die gespeicherten Prozeduren automatisch für uns erstellt.</span><span class="sxs-lookup"><span data-stu-id="c5568-177">For this tutorial, let s add a new TableAdapter and have it automatically create the stored procedures for us.</span></span> <span data-ttu-id="c5568-178">Folglich müssen wir zunächst weglassen der `FullContactName` berechnete Spalte aus der Hauptabfrage.</span><span class="sxs-lookup"><span data-stu-id="c5568-178">Consequently, we will need to initially omit the `FullContactName` computed column from the main query.</span></span>

<span data-ttu-id="c5568-179">Öffnen Sie zunächst die `NorthwindWithSprocs` DataSet in den `~/App_Code/DAL` Ordner.</span><span class="sxs-lookup"><span data-stu-id="c5568-179">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="c5568-180">Mit der rechten Maustaste im Designer, und wählen Sie aus dem Kontextmenü, um einen neuen TableAdapter hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="c5568-180">Right-click in the Designer and, from the context-menu, choose to add a new TableAdapter.</span></span> <span data-ttu-id="c5568-181">Hierdurch wird der TableAdapter-Konfigurations-Assistent gestartet.</span><span class="sxs-lookup"><span data-stu-id="c5568-181">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="c5568-182">Geben Sie zum Abfragen von Daten aus der Datenbank (`NORTHWNDConnectionString` aus `Web.config`), und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="c5568-182">Specify the database to query data from (`NORTHWNDConnectionString` from `Web.config`) and click Next.</span></span> <span data-ttu-id="c5568-183">Da alle gespeicherten Prozeduren zum Abfragen oder Ändern von noch nicht erstellt haben die `Suppliers` table, aktivieren Sie das Erstellen neue gespeicherte Prozeduren aus, damit der Assistent für uns zu erstellen, und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="c5568-183">Since we have not yet created any stored procedures for querying or modifying the `Suppliers` table, select the Create new stored procedures option so that the wizard will create them for us and click Next.</span></span>


<span data-ttu-id="c5568-184">[![Wählen Sie die neuen gespeicherten Prozeduren Option für das Erstellen](working-with-computed-columns-vb/_static/image8.png)](working-with-computed-columns-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="c5568-184">[![Choose the Create new stored procedures Option](working-with-computed-columns-vb/_static/image8.png)](working-with-computed-columns-vb/_static/image7.png)</span></span>

<span data-ttu-id="c5568-185">**Abbildung 3**: Wählen Sie die neuen gespeicherten Prozeduren Option für das Erstellen ([klicken Sie hier, um das Bild in voller Größe angezeigt](working-with-computed-columns-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="c5568-185">**Figure 3**: Choose the Create new stored procedures Option ([Click to view full-size image](working-with-computed-columns-vb/_static/image9.png))</span></span>


<span data-ttu-id="c5568-186">Die nachfolgende Schritt werden uns der Hauptabfrage aufgefordert.</span><span class="sxs-lookup"><span data-stu-id="c5568-186">The subsequent step prompts us for the main query.</span></span> <span data-ttu-id="c5568-187">Geben Sie die folgende Abfrage gibt die `SupplierID`, `CompanyName`, `ContactName`, und `ContactTitle` Spalten für jeden Lieferanten.</span><span class="sxs-lookup"><span data-stu-id="c5568-187">Enter the following query, which returns the `SupplierID`, `CompanyName`, `ContactName`, and `ContactTitle` columns for each supplier.</span></span> <span data-ttu-id="c5568-188">Beachten Sie, dass diese Abfrage die berechnete Spalte absichtlich ausgelassen (`FullContactName`); Wir aktualisieren die entsprechende gespeicherte Prozedur, dass diese Spalte in Schritt 4 enthalten.</span><span class="sxs-lookup"><span data-stu-id="c5568-188">Note that this query purposefully omits the computed column (`FullContactName`); we will update the corresponding stored procedure to include this column in Step 4.</span></span>


[!code-sql[Main](working-with-computed-columns-vb/samples/sample3.sql)]

<span data-ttu-id="c5568-189">Nach dem Eingeben der Hauptabfrage und wenn Sie auf Weiter, kann der Assistent Wir nennen Sie die vier gespeicherten Prozeduren aus die es generiert werden.</span><span class="sxs-lookup"><span data-stu-id="c5568-189">After entering the main query and clicking Next, the wizard allows us to name the four stored procedures it will generate.</span></span> <span data-ttu-id="c5568-190">Nennen Sie diese gespeicherten Prozeduren `Suppliers_Select`, `Suppliers_Insert`, `Suppliers_Update`, und `Suppliers_Delete`, wie in Abbildung 4 dargestellt.</span><span class="sxs-lookup"><span data-stu-id="c5568-190">Name these stored procedures `Suppliers_Select`, `Suppliers_Insert`, `Suppliers_Update`, and `Suppliers_Delete`, as Figure 4 illustrates.</span></span>


<span data-ttu-id="c5568-191">[![Passen Sie die Namen der automatisch generierten gespeicherten Prozeduren](working-with-computed-columns-vb/_static/image11.png)](working-with-computed-columns-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="c5568-191">[![Customize the Names of the Auto-Generated Stored Procedures](working-with-computed-columns-vb/_static/image11.png)](working-with-computed-columns-vb/_static/image10.png)</span></span>

<span data-ttu-id="c5568-192">**Abbildung 4**: die Namen von Auto-Generated gespeicherte Prozeduren ([klicken Sie hier, um das Bild in voller Größe angezeigt](working-with-computed-columns-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="c5568-192">**Figure 4**: Customize the Names of the Auto-Generated Stored Procedures ([Click to view full-size image](working-with-computed-columns-vb/_static/image12.png))</span></span>


<span data-ttu-id="c5568-193">Der nächste Assistentenschritt kann wir ein TableAdapter-s-Methoden, und geben die Muster, die zum Zugreifen auf und Aktualisieren von Daten.</span><span class="sxs-lookup"><span data-stu-id="c5568-193">The next wizard step allows us to name the TableAdapter s methods and specify the patterns used to access and update data.</span></span> <span data-ttu-id="c5568-194">Belassen Sie alle drei Kontrollkästchen aktiviert, aber Umbenennen der `GetData` aufzurufende Methode `GetSuppliers`.</span><span class="sxs-lookup"><span data-stu-id="c5568-194">Leave all three checkboxes checked, but rename the `GetData` method to `GetSuppliers`.</span></span> <span data-ttu-id="c5568-195">Klicken Sie auf ' Fertig stellen ', um den Assistenten abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="c5568-195">Click Finish to complete the wizard.</span></span>


<span data-ttu-id="c5568-196">[![Benennen Sie die GetData-Methode in GetSuppliers](working-with-computed-columns-vb/_static/image14.png)](working-with-computed-columns-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="c5568-196">[![Rename the GetData Method to GetSuppliers](working-with-computed-columns-vb/_static/image14.png)](working-with-computed-columns-vb/_static/image13.png)</span></span>

<span data-ttu-id="c5568-197">**Abbildung 5**: Benennen der `GetData` aufzurufende Methode `GetSuppliers` ([klicken Sie hier, um das Bild in voller Größe angezeigt](working-with-computed-columns-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="c5568-197">**Figure 5**: Rename the `GetData` Method to `GetSuppliers` ([Click to view full-size image](working-with-computed-columns-vb/_static/image15.png))</span></span>


<span data-ttu-id="c5568-198">Beim Klicken auf "Fertig stellen" wird der Assistent vier gespeicherte Prozeduren erstellen und Hinzufügen des TableAdapter und die entsprechenden DataTable zu das typisierte DataSet.</span><span class="sxs-lookup"><span data-stu-id="c5568-198">Upon clicking Finish, the wizard will create the four stored procedures and add the TableAdapter and corresponding DataTable to the Typed DataSet.</span></span>

## <a name="step-4-including-the-computed-column-in-the-tableadapter-s-main-query"></a><span data-ttu-id="c5568-199">Schritt 4: Die berechnete Spalte in der Hauptabfrage des TableAdapter s einschließen</span><span class="sxs-lookup"><span data-stu-id="c5568-199">Step 4: Including the Computed Column in the TableAdapter s Main Query</span></span>

<span data-ttu-id="c5568-200">Jetzt müssen wir den TableAdapter aktualisieren und DataTable erstellt in Schritt 3 enthalten die `FullContactName` berechnete Spalte.</span><span class="sxs-lookup"><span data-stu-id="c5568-200">We now need to update the TableAdapter and DataTable created in Step 3 to include the `FullContactName` computed column.</span></span> <span data-ttu-id="c5568-201">Dies umfasst zwei Schritte:</span><span class="sxs-lookup"><span data-stu-id="c5568-201">This involves two steps:</span></span>

1. <span data-ttu-id="c5568-202">Aktualisieren der `Suppliers_Select` gespeicherten Prozedur zurückgeben der `FullContactName` berechnete Spalte ist, und</span><span class="sxs-lookup"><span data-stu-id="c5568-202">Updating the `Suppliers_Select` stored procedure to return the `FullContactName` computed column, and</span></span>
2. <span data-ttu-id="c5568-203">Aktualisieren von DataTable, um ein entsprechendes enthalten `FullContactName` Spalte.</span><span class="sxs-lookup"><span data-stu-id="c5568-203">Updating the DataTable to include a corresponding `FullContactName` column.</span></span>

<span data-ttu-id="c5568-204">Starten Sie, indem Sie auf den Server-Explorer navigieren und Drilldowns in den Ordner "Stored Procedures".</span><span class="sxs-lookup"><span data-stu-id="c5568-204">Start by navigating to the Server Explorer and drilling down into the Stored Procedures folder.</span></span> <span data-ttu-id="c5568-205">Öffnen der `Suppliers_Select` gespeicherte Prozedur und ein Update der `SELECT` Abfrage der `FullContactName` berechnete Spalte:</span><span class="sxs-lookup"><span data-stu-id="c5568-205">Open the `Suppliers_Select` stored procedure and update the `SELECT` query to include the `FullContactName` computed column:</span></span>


[!code-sql[Main](working-with-computed-columns-vb/samples/sample4.sql)]

<span data-ttu-id="c5568-206">Speichern Sie die Änderungen an die gespeicherte Prozedur, indem Sie auf das Symbol "Speichern" in der Symbolleiste, durch Drücken von STRG + S oder durch Auswählen von Speichern `Suppliers_Select` Option über das Menü Datei.</span><span class="sxs-lookup"><span data-stu-id="c5568-206">Save the changes to the stored procedure by clicking the Save icon in the Toolbar, by hitting Ctrl+S, or by choosing the Save `Suppliers_Select` option from the File menu.</span></span>

<span data-ttu-id="c5568-207">Als Nächstes auf der DataSet-Designer zurück, mit der rechten Maustaste auf die `SuppliersTableAdapter`, und wählen Sie aus dem Kontextmenü konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="c5568-207">Next, return to the DataSet Designer, right-click on the `SuppliersTableAdapter`, and choose Configure from the context-menu.</span></span> <span data-ttu-id="c5568-208">Beachten Sie, dass die `Suppliers_Select` Spalte enthält jetzt die `FullContactName` Spalte in der Data Columns-Auflistung.</span><span class="sxs-lookup"><span data-stu-id="c5568-208">Note that the `Suppliers_Select` column now includes the `FullContactName` column in its Data Columns collection.</span></span>


<span data-ttu-id="c5568-209">[![Führen Sie den TableAdapter-s-Konfigurations-Assistenten zum Aktualisieren von DataTable-s-Spalten](working-with-computed-columns-vb/_static/image17.png)](working-with-computed-columns-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="c5568-209">[![Run the TableAdapter s Configuration Wizard to Update the DataTable s Columns](working-with-computed-columns-vb/_static/image17.png)](working-with-computed-columns-vb/_static/image16.png)</span></span>

<span data-ttu-id="c5568-210">**Abbildung 6**: Führen Sie die TableAdapter-Konfigurations-Assistenten zum Aktualisieren der DataTable-s-Spalten ([klicken Sie hier, um das Bild in voller Größe angezeigt](working-with-computed-columns-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="c5568-210">**Figure 6**: Run the TableAdapter s Configuration Wizard to Update the DataTable s Columns ([Click to view full-size image](working-with-computed-columns-vb/_static/image18.png))</span></span>


<span data-ttu-id="c5568-211">Klicken Sie auf ' Fertig stellen ', um den Assistenten abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="c5568-211">Click Finish to complete the wizard.</span></span> <span data-ttu-id="c5568-212">Dadurch wird automatisch hinzugefügt, eine entsprechende Spalte der `SuppliersDataTable`.</span><span class="sxs-lookup"><span data-stu-id="c5568-212">This will automatically add a corresponding column to the `SuppliersDataTable`.</span></span> <span data-ttu-id="c5568-213">TableAdapter-Assistenten ist intelligent genug, um zu erkennen, die die `FullContactName` Spalte ist eine berechnete Spalte und daher schreibgeschützt.</span><span class="sxs-lookup"><span data-stu-id="c5568-213">The TableAdapter wizard is smart enough to detect that the `FullContactName` column is a computed column and therefore read-only.</span></span> <span data-ttu-id="c5568-214">Folglich wird die Spalte s `ReadOnly` Eigenschaft `true`.</span><span class="sxs-lookup"><span data-stu-id="c5568-214">Consequently, it sets the column s `ReadOnly` property to `true`.</span></span> <span data-ttu-id="c5568-215">Um dies zu überprüfen, wählen Sie die Spalte aus der `SuppliersDataTable` und fahren Sie mit dem Eigenschaftenfenster (siehe Abbildung 7).</span><span class="sxs-lookup"><span data-stu-id="c5568-215">To verify this, select the column from the `SuppliersDataTable` and then go to the Properties window (see Figure 7).</span></span> <span data-ttu-id="c5568-216">Beachten Sie, dass die `FullContactName` Spalte s `DataType` und `MaxLength` Eigenschaften werden auch entsprechend festgelegt.</span><span class="sxs-lookup"><span data-stu-id="c5568-216">Note that the `FullContactName` column s `DataType` and `MaxLength` properties are also set accordingly.</span></span>


<span data-ttu-id="c5568-217">[![Die FullContactName-Spalte ist als schreibgeschützt gekennzeichnet.](working-with-computed-columns-vb/_static/image20.png)](working-with-computed-columns-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="c5568-217">[![The FullContactName Column is Marked as Read-Only](working-with-computed-columns-vb/_static/image20.png)](working-with-computed-columns-vb/_static/image19.png)</span></span>

<span data-ttu-id="c5568-218">**Abbildung 7**: die `FullContactName` Spalte ist als schreibgeschützt gekennzeichnet ([klicken Sie hier, um das Bild in voller Größe angezeigt](working-with-computed-columns-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="c5568-218">**Figure 7**: The `FullContactName` Column is Marked as Read-Only ([Click to view full-size image](working-with-computed-columns-vb/_static/image21.png))</span></span>


## <a name="step-5-adding-agetsupplierbysupplieridmethod-to-the-tableadapter"></a><span data-ttu-id="c5568-219">Schritt 5: Hinzufügen einer`GetSupplierBySupplierID`aufzurufende Methode des TableAdapter</span><span class="sxs-lookup"><span data-stu-id="c5568-219">Step 5: Adding a`GetSupplierBySupplierID`Method to the TableAdapter</span></span>

<span data-ttu-id="c5568-220">Für dieses Lernprogramm erstellen wir eine ASP.NET-Seite auf, die die Lieferanten in einer aktualisierbaren Tabelle anzeigt.</span><span class="sxs-lookup"><span data-stu-id="c5568-220">For this tutorial we will create an ASP.NET page that displays the suppliers in an updateable grid.</span></span> <span data-ttu-id="c5568-221">In wurden hinter Lernprogramme wir aktualisiert einen einzelnen Datensatz aus der Business Logic Layer durch Abrufen, DAL zum Weitergeben von Änderungen an bestimmten Datensatz von der DAL als stark typisierte DataTable, aktualisieren die Eigenschaften und anschließendes Senden der aktualisierten DataTable zurück die Datenbank.</span><span class="sxs-lookup"><span data-stu-id="c5568-221">In past tutorials we have updated a single record from the Business Logic Layer by retrieving that particular record from the DAL as a strongly-typed DataTable, updating its properties, and then sending the updated DataTable back to the DAL to propagate the changes to the database.</span></span> <span data-ttu-id="c5568-222">Im ersten Schritt – Abrufen der den aktualisierten Datensatz gelesen von der DAL - Durchführung wir müssen zunächst eine `GetSupplierBySupplierID(supplierID)` Methode, um der DAL.</span><span class="sxs-lookup"><span data-stu-id="c5568-222">To accomplish this first step - retrieving the record being updated from the DAL - we need to first add a `GetSupplierBySupplierID(supplierID)` method to the DAL.</span></span>

<span data-ttu-id="c5568-223">Mit der rechten Maustaste auf die `SuppliersTableAdapter` DataSet entwerfen, und wählen Sie aus dem Kontextmenü die Option der Abfrage hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="c5568-223">Right-click on the `SuppliersTableAdapter` in the DataSet Design and choose the Add Query option from the context-menu.</span></span> <span data-ttu-id="c5568-224">Wie in Schritt 3, können Sie den Assistenten eine neue gespeicherte Prozedur für uns zu generieren, indem Sie die Option erstellen neue gespeicherte Prozedur (siehe Abbildung 3 für einen Screenshot der dieser Schritt des Assistenten).</span><span class="sxs-lookup"><span data-stu-id="c5568-224">As we did in Step 3, let the wizard generate a new stored procedure for us by selecting the Create new stored procedure option (refer back to Figure 3 for a screenshot of this wizard step).</span></span> <span data-ttu-id="c5568-225">Da diese Methode einen Datensatz mit mehreren Spalten zurückgibt, geben Sie an, dass wir verwenden möchten, verwenden Sie eine SQL-Abfrage, die eine SELECT-Anweisung ist die Zeilen zurückgibt, und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="c5568-225">Since this method will return a record with multiple columns, indicate that we want to use a SQL query that is a SELECT which returns rows and click Next.</span></span>


<span data-ttu-id="c5568-226">[![Wählen Sie wählen die Option-Zeilen zurückgibt](working-with-computed-columns-vb/_static/image23.png)](working-with-computed-columns-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="c5568-226">[![Choose the SELECT which returns rows Option](working-with-computed-columns-vb/_static/image23.png)](working-with-computed-columns-vb/_static/image22.png)</span></span>

<span data-ttu-id="c5568-227">**Abbildung 8**: Wählen Sie die wählen Sie die Zeilen Option zurückgibt ([klicken Sie hier, um das Bild in voller Größe angezeigt](working-with-computed-columns-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="c5568-227">**Figure 8**: Choose the SELECT which returns rows Option ([Click to view full-size image](working-with-computed-columns-vb/_static/image24.png))</span></span>


<span data-ttu-id="c5568-228">Die nachfolgende Schritt fordert "us" für die Abfrage für diese Methode verwendet.</span><span class="sxs-lookup"><span data-stu-id="c5568-228">The subsequent step prompts us for the query to use for this method.</span></span> <span data-ttu-id="c5568-229">Geben Sie Folgendes ein, die die gleichen Datenfelder wie der Hauptabfrage jedoch für einen bestimmten Lieferanten zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="c5568-229">Enter the following, which returns the same data fields as the main query but for a particular supplier.</span></span>


[!code-sql[Main](working-with-computed-columns-vb/samples/sample5.sql)]

<span data-ttu-id="c5568-230">Der nächste Bildschirm fordert uns auf den Namen der gespeicherten Prozedur, die automatisch generiert werden.</span><span class="sxs-lookup"><span data-stu-id="c5568-230">The next screen asks us to name the stored procedure that will be auto-generated.</span></span> <span data-ttu-id="c5568-231">Nennen Sie diese gespeicherte Prozedur `Suppliers_SelectBySupplierID` , und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="c5568-231">Name this stored procedure `Suppliers_SelectBySupplierID` and click Next.</span></span>


<span data-ttu-id="c5568-232">[![Name der gespeicherten Prozedur Suppliers_SelectBySupplierID](working-with-computed-columns-vb/_static/image26.png)](working-with-computed-columns-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="c5568-232">[![Name the Stored Procedure Suppliers_SelectBySupplierID](working-with-computed-columns-vb/_static/image26.png)](working-with-computed-columns-vb/_static/image25.png)</span></span>

<span data-ttu-id="c5568-233">**Abbildung 9**: Benennen Sie die gespeicherte Prozedur `Suppliers_SelectBySupplierID` ([klicken Sie hier, um das Bild in voller Größe angezeigt](working-with-computed-columns-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="c5568-233">**Figure 9**: Name the Stored Procedure `Suppliers_SelectBySupplierID` ([Click to view full-size image](working-with-computed-columns-vb/_static/image27.png))</span></span>


<span data-ttu-id="c5568-234">Schließlich der Assistent fordert "us" für die Daten Muster und Methodennamen, verwenden Sie für den TableAdapter zugreifen.</span><span class="sxs-lookup"><span data-stu-id="c5568-234">Lastly, the wizard prompts us for the data access patterns and method names to use for the TableAdapter.</span></span> <span data-ttu-id="c5568-235">Lassen Sie beide Kontrollkästchen aktiviert, aber Umbenennen der `FillBy` und `GetDataBy` Methoden `FillBySupplierID` und `GetSupplierBySupplierID`bzw.</span><span class="sxs-lookup"><span data-stu-id="c5568-235">Leave both checkboxes checked, but rename the `FillBy` and `GetDataBy` methods to `FillBySupplierID` and `GetSupplierBySupplierID`, respectively.</span></span>


<span data-ttu-id="c5568-236">[![Name der TableAdapter-Methoden FillBySupplierID und GetSupplierBySupplierID](working-with-computed-columns-vb/_static/image29.png)](working-with-computed-columns-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="c5568-236">[![Name the TableAdapter Methods FillBySupplierID and GetSupplierBySupplierID](working-with-computed-columns-vb/_static/image29.png)](working-with-computed-columns-vb/_static/image28.png)</span></span>

<span data-ttu-id="c5568-237">**Abbildung 10**: Benennen Sie die TableAdapter-Methoden `FillBySupplierID` und `GetSupplierBySupplierID` ([klicken Sie hier, um das Bild in voller Größe angezeigt](working-with-computed-columns-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="c5568-237">**Figure 10**: Name the TableAdapter Methods `FillBySupplierID` and `GetSupplierBySupplierID` ([Click to view full-size image](working-with-computed-columns-vb/_static/image30.png))</span></span>


<span data-ttu-id="c5568-238">Klicken Sie auf ' Fertig stellen ', um den Assistenten abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="c5568-238">Click Finish to complete the wizard.</span></span>

## <a name="step-6-creating-the-business-logic-layer"></a><span data-ttu-id="c5568-239">Schritt 6: Erstellen der Geschäftslogikebene</span><span class="sxs-lookup"><span data-stu-id="c5568-239">Step 6: Creating the Business Logic Layer</span></span>

<span data-ttu-id="c5568-240">Bevor wir eine ASP.NET-Seite erstellen, die berechnete Spalte, die in Schritt 1 erstellten verwendet, müssen wir zunächst die entsprechenden Methoden in der BLL hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="c5568-240">Before we create an ASP.NET page that uses the computed column created in Step 1, we first need to add the corresponding methods in the BLL.</span></span> <span data-ttu-id="c5568-241">Unsere ASP.NET-Seite, die wir in Schritt 7 erstellt werden, ermöglicht Benutzern das Anzeigen und Bearbeiten von Lieferanten.</span><span class="sxs-lookup"><span data-stu-id="c5568-241">Our ASP.NET page, which we will create in Step 7, will allow users to view and edit suppliers.</span></span> <span data-ttu-id="c5568-242">Deshalb benötigen wir unsere BLL um mindestens eine Methode zum Abrufen aller Lieferanten und ein anderes zum Aktualisieren eines bestimmten Lieferanten bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="c5568-242">Therefore, we need our BLL to provide, at minimum, a method to get all of the suppliers and another to update a particular supplier.</span></span>

<span data-ttu-id="c5568-243">Erstellen Sie eine neue Klassendatei mit dem Namen `SuppliersBLLWithSprocs` in den `~/App_Code/BLL` Ordner, und fügen Sie den folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="c5568-243">Create a new class file named `SuppliersBLLWithSprocs` in the `~/App_Code/BLL` folder and add the following code:</span></span>


[!code-vb[Main](working-with-computed-columns-vb/samples/sample6.vb)]

<span data-ttu-id="c5568-244">Wie die anderen Klassen BLL, `SuppliersBLLWithSprocs` verfügt über eine `Protected` `Adapter` -Eigenschaft, die eine Instanz zurückgegeben der `SuppliersTableAdapter` Klasse zusammen mit zwei `Public` Methoden: `GetSuppliers` und `UpdateSupplier`.</span><span class="sxs-lookup"><span data-stu-id="c5568-244">Like the other BLL classes, `SuppliersBLLWithSprocs` has a `Protected` `Adapter` property that returns an instance of the `SuppliersTableAdapter` class along with two `Public` methods: `GetSuppliers` and `UpdateSupplier`.</span></span> <span data-ttu-id="c5568-245">Die `GetSuppliers` Methode aufruft, und gibt die `SuppliersDataTable` zurückgegeben, die mit den entsprechenden `GetSupplier` Methode in der Datenzugriffsebene.</span><span class="sxs-lookup"><span data-stu-id="c5568-245">The `GetSuppliers` method calls and returns the `SuppliersDataTable` returned by the corresponding `GetSupplier` method in the Data Access Layer.</span></span> <span data-ttu-id="c5568-246">Die `UpdateSupplier` Methode ruft Informationen zu den bestimmten Lieferanten, die über einen Aufruf an die DAL s aktualisiert `GetSupplierBySupplierID(supplierID)` Methode.</span><span class="sxs-lookup"><span data-stu-id="c5568-246">The `UpdateSupplier` method retrieves information about the particular supplier being updated via a call to the DAL s `GetSupplierBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="c5568-247">Anschließend aktualisiert der `CategoryName`, `ContactName`, und `ContactTitle` Eigenschaften und führt einen Commit dieser Änderungen auf die Datenbank durch Aufrufen der Datenzugriffsebene s `Update` -Methode auf und übergibt den geänderten `SuppliersRow` Objekt.</span><span class="sxs-lookup"><span data-stu-id="c5568-247">It then updates the `CategoryName`, `ContactName`, and `ContactTitle` properties and commits these changes to the database by calling the Data Access Layer s `Update` method, passing in the modified `SuppliersRow` object.</span></span>

> [!NOTE]
> <span data-ttu-id="c5568-248">Mit Ausnahme von `SupplierID` und `CompanyName`, können Sie alle Spalten in der Tabelle "Suppliers" `NULL` Werte.</span><span class="sxs-lookup"><span data-stu-id="c5568-248">Except for `SupplierID` and `CompanyName`, all columns in the Suppliers table allow `NULL` values.</span></span> <span data-ttu-id="c5568-249">Aus diesem Grund Wenn übergebenen `contactName` oder `contactTitle` Parameter sind `Nothing` wir müssen die entsprechenden festlegen `ContactName` und `ContactTitle` Eigenschaften einer `NULL` Datenbank Wert mithilfe der `SetContactNameNull` und `SetContactTitleNull`Methoden bzw.</span><span class="sxs-lookup"><span data-stu-id="c5568-249">Therefore, if the passed-in `contactName` or `contactTitle` parameters are `Nothing` we need to set the corresponding `ContactName` and `ContactTitle` properties to a `NULL` database value using the `SetContactNameNull` and `SetContactTitleNull` methods, respectively.</span></span>


## <a name="step-7-working-with-the-computed-column-from-the-presentation-layer"></a><span data-ttu-id="c5568-250">Schritt 7: Arbeiten mit der berechneten Spalte aus der Darstellungsschicht</span><span class="sxs-lookup"><span data-stu-id="c5568-250">Step 7: Working with the Computed Column from the Presentation Layer</span></span>

<span data-ttu-id="c5568-251">Mit der berechneten Spalte hinzugefügt, die `Suppliers` Tabelle, die DAL und BLL entsprechend aktualisiert, wir können zu eine ASP.NET-Seite zu erstellen, die mit der `FullContactName` berechnete Spalte.</span><span class="sxs-lookup"><span data-stu-id="c5568-251">With the computed column added to the `Suppliers` table and the DAL and BLL updated accordingly, we are ready to build an ASP.NET page that works with the `FullContactName` computed column.</span></span> <span data-ttu-id="c5568-252">Öffnen Sie zunächst die `ComputedColumns.aspx` auf der Seite der `AdvancedDAL` Ordner, und ziehen Sie eine GridView aus der Toolbox in den Designer.</span><span class="sxs-lookup"><span data-stu-id="c5568-252">Start by opening the `ComputedColumns.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="c5568-253">Legen Sie die GridView s `ID` Eigenschaft `Suppliers` und aus seinem Smarttag binden Sie es an eine neue ObjectDataSource mit dem Namen `SuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="c5568-253">Set the GridView s `ID` property to `Suppliers` and, from its smart tag, bind it to a new ObjectDataSource named `SuppliersDataSource`.</span></span> <span data-ttu-id="c5568-254">Konfigurieren der ObjectDataSource verwenden die `SuppliersBLLWithSprocs` Klasse, die wir hinzugefügt, in Schritt 6 sichern, und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="c5568-254">Configure the ObjectDataSource to use the `SuppliersBLLWithSprocs` class we added back in Step 6 and click Next.</span></span>


<span data-ttu-id="c5568-255">[![Konfigurieren der ObjectDataSource zur Verwendung der SuppliersBLLWithSprocs-Klasse](working-with-computed-columns-vb/_static/image32.png)](working-with-computed-columns-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="c5568-255">[![Configure the ObjectDataSource to Use the SuppliersBLLWithSprocs Class](working-with-computed-columns-vb/_static/image32.png)](working-with-computed-columns-vb/_static/image31.png)</span></span>

<span data-ttu-id="c5568-256">**Abbildung 11**: Konfigurieren der ObjectDataSource verwenden die `SuppliersBLLWithSprocs` Klasse ([klicken Sie hier, um das Bild in voller Größe angezeigt](working-with-computed-columns-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="c5568-256">**Figure 11**: Configure the ObjectDataSource to Use the `SuppliersBLLWithSprocs` Class ([Click to view full-size image](working-with-computed-columns-vb/_static/image33.png))</span></span>


<span data-ttu-id="c5568-257">Es gibt nur zwei Methoden definiert, der `SuppliersBLLWithSprocs` Klasse: `GetSuppliers` und `UpdateSupplier`.</span><span class="sxs-lookup"><span data-stu-id="c5568-257">There are only two methods defined in the `SuppliersBLLWithSprocs` class: `GetSuppliers` and `UpdateSupplier`.</span></span> <span data-ttu-id="c5568-258">Stellen Sie sicher, dass diese beiden Methoden werden in die SELECT-Anweisung angegeben bzw. Aktualisieren der Registerkarten, und klicken Sie auf "Fertig stellen", um die Konfiguration der ObjectDataSource abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="c5568-258">Ensure that these two methods are specified in the SELECT and UPDATE tabs, respectively, and click Finish to complete the configuration of the ObjectDataSource.</span></span>

<span data-ttu-id="c5568-259">Nach Abschluss des Assistenten zum Konfigurieren von Datenquellen wird Visual Studio ein BoundField für jede der Datenfelder zurückgegeben hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="c5568-259">Upon completion of the Data Source Configuration wizard, Visual Studio will add a BoundField for each of the data fields returned.</span></span> <span data-ttu-id="c5568-260">Entfernen der `SupplierID` BoundField und ändern Sie die `HeaderText` Eigenschaften der `CompanyName`, `ContactName`, `ContactTitle`, und `FullContactName` BoundFields Unternehmen, Contact Name, Titel und vollständige Contact Name bzw.</span><span class="sxs-lookup"><span data-stu-id="c5568-260">Remove the `SupplierID` BoundField and change the `HeaderText` properties of the `CompanyName`, `ContactName`, `ContactTitle`, and `FullContactName` BoundFields to Company, Contact Name, Title, and Full Contact Name, respectively.</span></span> <span data-ttu-id="c5568-261">Aktivieren Sie das Kontrollkästchen Bearbeiten aktivieren, um die GridView s integrierten Bearbeitungsfunktionen zu aktivieren, aus dem Smarttag.</span><span class="sxs-lookup"><span data-stu-id="c5568-261">From the smart tag, check the Enable Editing checkbox to turn on the GridView s built-in editing capabilities.</span></span>

<span data-ttu-id="c5568-262">Zusätzlich zum Hinzufügen von BoundFields an die GridView, Abschluss des Datenquellen-Assistenten auch bewirkt, dass Visual Studio, um das ObjectDataSource-s `OldValuesParameterFormatString` Eigenschaft ursprünglichen\_{0}.</span><span class="sxs-lookup"><span data-stu-id="c5568-262">In addition to adding BoundFields to the GridView, completion of the Data Source Wizard also causes Visual Studio to set the ObjectDataSource s `OldValuesParameterFormatString` property to original\_{0}.</span></span> <span data-ttu-id="c5568-263">Diese Einstellung wieder auf den Standardwert {0} zurückgesetzt werden.</span><span class="sxs-lookup"><span data-stu-id="c5568-263">Revert this setting back to its default value, {0} .</span></span>

<span data-ttu-id="c5568-264">Nach dieser Änderungen an die GridView und ObjectDataSource vorgenommen werden, sollte ihre deklarative Markup etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="c5568-264">After making these edits to the GridView and ObjectDataSource, their declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](working-with-computed-columns-vb/samples/sample7.aspx)]

<span data-ttu-id="c5568-265">Als Nächstes finden Sie auf dieser Seite über einen Browser.</span><span class="sxs-lookup"><span data-stu-id="c5568-265">Next, visit this page through a browser.</span></span> <span data-ttu-id="c5568-266">Wie Abbildung 12 zeigt, wird der einzelnen Lieferanten aufgeführt, in ein Raster mit den enthält die `FullContactName` Spalte, deren Wert einfach die Verkettung von den anderen drei Spalten ist als formatierte `ContactName` (`ContactTitle`, `CompanyName`).</span><span class="sxs-lookup"><span data-stu-id="c5568-266">As Figure 12 shows, each supplier is listed in a grid that includes the `FullContactName` column, whose value is simply the concatenation of the other three columns formatted as `ContactName` (`ContactTitle`, `CompanyName`) .</span></span>


<span data-ttu-id="c5568-267">[![Jeder Lieferant wird im Raster aufgeführt.](working-with-computed-columns-vb/_static/image35.png)](working-with-computed-columns-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="c5568-267">[![Each Supplier is Listed in the Grid](working-with-computed-columns-vb/_static/image35.png)](working-with-computed-columns-vb/_static/image34.png)</span></span>

<span data-ttu-id="c5568-268">**Abbildung 12**: jede Lieferanten wird im Raster aufgeführt ([klicken Sie hier, um das Bild in voller Größe angezeigt](working-with-computed-columns-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="c5568-268">**Figure 12**: Each Supplier is Listed in the Grid ([Click to view full-size image](working-with-computed-columns-vb/_static/image36.png))</span></span>


<span data-ttu-id="c5568-269">Klicken auf die Schaltfläche "Bearbeiten" für ein bestimmter Lieferanten einen Postback verursacht, und diese Zeile im gerenderten dessen Bearbeitung Schnittstelle (siehe Abbildung 13).</span><span class="sxs-lookup"><span data-stu-id="c5568-269">Clicking the Edit button for a particular supplier causes a postback and has that row rendered in its editing interface (see Figure 13).</span></span> <span data-ttu-id="c5568-270">Die ersten drei Spalten, wie in der Standardeinstellung Schnittstelle Bearbeiten gerendert – ein TextBox-Steuerelement, dessen `Text` Eigenschaft auf den Wert des Feld "Daten" festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="c5568-270">The first three columns render in their default editing interface - a TextBox control whose `Text` property is set to the value of the data field.</span></span> <span data-ttu-id="c5568-271">Die `FullContactName` Spalte bleibt jedoch als Text.</span><span class="sxs-lookup"><span data-stu-id="c5568-271">The `FullContactName` column, however, remains as text.</span></span> <span data-ttu-id="c5568-272">Bei der BoundFields an die GridView nach dem Abschluss des Assistenten Datenquellenkonfiguration hinzugefügt wurden die `FullContactName` BoundField-s `ReadOnly` -Eigenschaft wurde festgelegt, um `True` da das entsprechende `FullContactName` Spalte in der `SuppliersDataTable` hat ihre `ReadOnly` -Eigenschaftensatz auf `True`.</span><span class="sxs-lookup"><span data-stu-id="c5568-272">When the BoundFields were added to the GridView at the completion of the Data Source Configuration wizard, the `FullContactName` BoundField s `ReadOnly` property was set to `True` because the corresponding `FullContactName` column in the `SuppliersDataTable` has its `ReadOnly` property set to `True`.</span></span> <span data-ttu-id="c5568-273">Wie in Schritt 4 notiert die `FullContactName` s `ReadOnly` -Eigenschaft wurde festgelegt, um `True` TableAdapter erkannt, dass die Spalte eine berechnete Spalte war.</span><span class="sxs-lookup"><span data-stu-id="c5568-273">As noted in Step 4, the `FullContactName` s `ReadOnly` property was set to `True` because the TableAdapter detected that the column was a computed column.</span></span>


<span data-ttu-id="c5568-274">[![Die FullContactName-Spalte kann nicht bearbeitet werden](working-with-computed-columns-vb/_static/image38.png)](working-with-computed-columns-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="c5568-274">[![The FullContactName Column is Not Editable](working-with-computed-columns-vb/_static/image38.png)](working-with-computed-columns-vb/_static/image37.png)</span></span>

<span data-ttu-id="c5568-275">**Abbildung 13**: die `FullContactName` Spalte kann nicht bearbeitet werden ([klicken Sie hier, um das Bild in voller Größe angezeigt](working-with-computed-columns-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="c5568-275">**Figure 13**: The `FullContactName` Column is Not Editable ([Click to view full-size image](working-with-computed-columns-vb/_static/image39.png))</span></span>


<span data-ttu-id="c5568-276">Fahren Sie fort, und aktualisieren Sie den Wert aus einem oder mehreren Spalten bearbeitet werden, und klicken Sie auf aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="c5568-276">Go ahead and update the value of one or more of the editable columns and click Update.</span></span> <span data-ttu-id="c5568-277">Hinweis wie die `FullContactName` s-Wert wird automatisch aktualisiert, um die Änderung widerzuspiegeln.</span><span class="sxs-lookup"><span data-stu-id="c5568-277">Note how the `FullContactName` s value is automatically updated to reflect the change.</span></span>

> [!NOTE]
> <span data-ttu-id="c5568-278">Die GridView verwendet derzeit BoundFields für die Elemente bearbeitet, wodurch der Standardbereich Schnittstelle bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="c5568-278">The GridView currently uses BoundFields for the editable fields, resulting in the default editing interface.</span></span> <span data-ttu-id="c5568-279">Da die `CompanyName` Feld ist erforderlich, sie sollten in ein, die einen RequiredFieldValidator enthält TemplateField konvertiert werden.</span><span class="sxs-lookup"><span data-stu-id="c5568-279">Since the `CompanyName` field is required, it should be converted into a TemplateField that includes a RequiredFieldValidator.</span></span> <span data-ttu-id="c5568-280">Ich lassen Sie dieses als Übung für die gewünschten Reader.</span><span class="sxs-lookup"><span data-stu-id="c5568-280">I leave this as an exercise for the interested reader.</span></span> <span data-ttu-id="c5568-281">Wenden Sie sich an den [Validierungssteuerelemente hinzufügen, bearbeiten und Einfügen von Schnittstellen](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) Tutorial schrittweise Anleitung zum Hinzufügen von Steuerelementen für die Validierung und ein BoundField in ein TemplateField konvertiert.</span><span class="sxs-lookup"><span data-stu-id="c5568-281">Consult the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) tutorial for step-by-step instructions on converting a BoundField to a TemplateField and adding validation controls.</span></span>


## <a name="summary"></a><span data-ttu-id="c5568-282">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="c5568-282">Summary</span></span>

<span data-ttu-id="c5568-283">Wenn Sie das Schema für eine Tabelle definieren, können Microsoft SQL Server die Einbindung von berechneten Spalten.</span><span class="sxs-lookup"><span data-stu-id="c5568-283">When defining the schema for a table, Microsoft SQL Server allows the inclusion of computed columns.</span></span> <span data-ttu-id="c5568-284">Dies sind die Spalten, deren Werte aus einem Ausdruck berechnet werden, die die Werte aus anderen Spalten in den gleichen Datensatz in der Regel verweist.</span><span class="sxs-lookup"><span data-stu-id="c5568-284">These are columns whose values are calculated from an expression that usually references the values from other columns in the same record.</span></span> <span data-ttu-id="c5568-285">Da die Werte, für berechnete Spalten in einem Ausdruck basieren sie sind schreibgeschützt und kann einen Wert in zugewiesen werden ein `INSERT` oder `UPDATE` Anweisung.</span><span class="sxs-lookup"><span data-stu-id="c5568-285">Since the values for computed columns are based on an expression, they are read-only and cannot be assigned a value in an `INSERT` or `UPDATE` statement.</span></span> <span data-ttu-id="c5568-286">Dies stellt die Herausforderung dar, wenn eine berechnete Spalte in der Hauptabfrage des TableAdapter verwenden, die zum automatischen Generieren von entsprechenden versucht `INSERT`, `UPDATE`, und `DELETE` Anweisungen.</span><span class="sxs-lookup"><span data-stu-id="c5568-286">This introduces challenges when using a computed column in the main query of a TableAdapter that tries to automatically generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span>

<span data-ttu-id="c5568-287">In diesem Lernprogramm erläutert Techniken für die Herausforderungen, die Bedrohung durch berechnete Spalten umgehen.</span><span class="sxs-lookup"><span data-stu-id="c5568-287">In this tutorial we discussed techniques for circumventing the challenges posed by computed columns.</span></span> <span data-ttu-id="c5568-288">Insbesondere verwendet es gespeicherte Prozeduren in unserer TableAdapter, um die TableAdapters innewohnende unzulänglichen überwunden werden, die Ad-hoc-SQL-Anweisungen verwenden.</span><span class="sxs-lookup"><span data-stu-id="c5568-288">In particular, we used stored procedures in our TableAdapter to overcome the brittleness inherent in TableAdapters that use ad-hoc SQL statements.</span></span> <span data-ttu-id="c5568-289">Wenn Sie Prozeduren mit dem TableAdapter-Assistenten neu erstellen gespeicherte, ist es wichtig, wir haben die Hauptabfrage anfänglich alle berechneten Spalten auslassen, da deren Vorhandensein verhindert, dass die Datenänderung gespeicherte Prozeduren generiert wird.</span><span class="sxs-lookup"><span data-stu-id="c5568-289">When having the TableAdapter wizard create new stored procedures, it is important that we have the main query initially omit any computed columns because their presence prevents the data modification stored procedures from being generated.</span></span> <span data-ttu-id="c5568-290">Nachdem der TableAdapter ursprünglich konfiguriert wurde, dessen `SelectCommand` gespeicherte Prozedur retooled werden kann, um berechnete Spalten enthalten.</span><span class="sxs-lookup"><span data-stu-id="c5568-290">After the TableAdapter has been initially configured, its `SelectCommand` stored procedure can be retooled to include any computed columns.</span></span>

<span data-ttu-id="c5568-291">Viel Spaß beim Programmieren!</span><span class="sxs-lookup"><span data-stu-id="c5568-291">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="c5568-292">Informationen zum Autor</span><span class="sxs-lookup"><span data-stu-id="c5568-292">About the Author</span></span>

<span data-ttu-id="c5568-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor von sieben ASP/ASP.NET-Büchern und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), Microsoft Web-Technologien seit 1998 arbeitet.</span><span class="sxs-lookup"><span data-stu-id="c5568-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="c5568-294">Scott fungiert als ein unabhängiger Berater, Trainer und Writer.</span><span class="sxs-lookup"><span data-stu-id="c5568-294">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="c5568-295">Sein neueste Buch wird [ *Sams Schulen selbst ASP.NET 2.0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="c5568-295">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="c5568-296">Er die erreicht werden kann, zur [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) oder über seinen Blog die finden Sie unter [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="c5568-296">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="c5568-297">Besonderen Dank an</span><span class="sxs-lookup"><span data-stu-id="c5568-297">Special Thanks To</span></span>

<span data-ttu-id="c5568-298">Diese Reihe von Lernprogrammen wurde durch viele nützliche Bearbeiter überprüft.</span><span class="sxs-lookup"><span data-stu-id="c5568-298">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="c5568-299">Lead Prüfer für dieses Lernprogramm wurden Hilton Geisenow und Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="c5568-299">Lead reviewers for this tutorial were Hilton Geisenow and Teresa Murphy.</span></span> <span data-ttu-id="c5568-300">Meine bevorstehende MSDN-Artikel Überprüfen von Interesse?</span><span class="sxs-lookup"><span data-stu-id="c5568-300">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="c5568-301">Wenn dies der Fall ist, löschen Sie mich zeilenweise [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="c5568-301">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="c5568-302">[Zurück](adding-additional-datatable-columns-vb.md)
> [Weiter](configuring-the-data-access-layer-s-connection-and-command-level-settings-vb.md)</span><span class="sxs-lookup"><span data-stu-id="c5568-302">[Previous](adding-additional-datatable-columns-vb.md)
[Next](configuring-the-data-access-layer-s-connection-and-command-level-settings-vb.md)</span></span>
