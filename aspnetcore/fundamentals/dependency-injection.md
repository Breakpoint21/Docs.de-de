---
title: Dependency Injection in ASP.NET Core
author: ardalis
description: Erfahren Sie, wie ASP.NET Core Dependency Injection implementiert und wie Sie dieses Muster verwenden können.
manager: wpickett
ms.author: riande
ms.custom: H1Hack27Feb2017
ms.date: 10/14/2016
ms.prod: asp.net-core
ms.technology: aspnet
ms.topic: article
uid: fundamentals/dependency-injection
ms.openlocfilehash: 067d9bd09f6d5e54bbafd953eea169d2df2be34e
ms.sourcegitcommit: a66f38071e13685bbe59d48d22aa141ac702b432
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 05/17/2018
ms.locfileid: "34233455"
---
# <a name="dependency-injection-in-aspnet-core"></a><span data-ttu-id="525b9-103">Dependency Injection in ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="525b9-103">Dependency injection in ASP.NET Core</span></span>

<a name="fundamentals-dependency-injection"></a>

<span data-ttu-id="525b9-104">Von [Steve Smith](https://ardalis.com/) und [Scott Addie](https://scottaddie.com)</span><span class="sxs-lookup"><span data-stu-id="525b9-104">By [Steve Smith](https://ardalis.com/) and [Scott Addie](https://scottaddie.com)</span></span>

<span data-ttu-id="525b9-105">ASP.NET Core wurde von Grund auf für die Unterstützung und Nutzung von Dependency Injection entwickelt.</span><span class="sxs-lookup"><span data-stu-id="525b9-105">ASP.NET Core is designed from the ground up to support and leverage dependency injection.</span></span> <span data-ttu-id="525b9-106">ASP.NET Core-Anwendungen können integrierte Frameworkdienste nutzen, indem diese in Methoden in der Startklasse eingefügt werden. Zudem können Anwendungsdienste für die Injection konfiguriert werden.</span><span class="sxs-lookup"><span data-stu-id="525b9-106">ASP.NET Core applications can leverage built-in framework services by having them injected into methods in the Startup class, and application services can be configured for injection as well.</span></span> <span data-ttu-id="525b9-107">Der von ASP.NET Core bereitgestellte Standarddienstcontainer bietet eine minimale Featuregruppe und ist nicht als Ersatz für andere Container vorgesehen.</span><span class="sxs-lookup"><span data-stu-id="525b9-107">The default services container provided by ASP.NET Core provides a minimal feature set and isn't intended to replace other containers.</span></span>

<span data-ttu-id="525b9-108">[Anzeigen oder Herunterladen von Beispielcode](https://github.com/aspnet/Docs/tree/master/aspnetcore/fundamentals/dependency-injection/sample) ([Vorgehensweise zum Herunterladen](xref:tutorials/index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="525b9-108">[View or download sample code](https://github.com/aspnet/Docs/tree/master/aspnetcore/fundamentals/dependency-injection/sample) ([how to download](xref:tutorials/index#how-to-download-a-sample))</span></span>

## <a name="what-is-dependency-injection"></a><span data-ttu-id="525b9-109">Was ist Dependency Injection?</span><span class="sxs-lookup"><span data-stu-id="525b9-109">What is dependency injection?</span></span>

<span data-ttu-id="525b9-110">Bei Dependency Injection handelt es sich um eine Technik, bei der eine lose Kopplung zwischen Objekten und ihren Projektmitarbeitern bzw. Abhängigkeiten erzielt wird.</span><span class="sxs-lookup"><span data-stu-id="525b9-110">Dependency injection (DI) is a technique for achieving loose coupling between objects and their collaborators, or dependencies.</span></span> <span data-ttu-id="525b9-111">Anstelle einer direkten Instanziierung von Projektmitarbeitern oder der Verwendung statischer Referenzen werden die Objekte, die eine Klasse für die Durchführung ihrer Aktionen benötigt, in gewisser Weise für die Klasse bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="525b9-111">Rather than directly instantiating collaborators, or using static references, the objects a class needs in order to perform its actions are provided to the class in some fashion.</span></span> <span data-ttu-id="525b9-112">In den meisten Fällen deklarieren Klassen ihre Abhängigkeiten über ihren Konstruktor, wodurch sie dem [Prinzip der expliziten Abhängigkeiten](http://deviq.com/explicit-dependencies-principle/) folgen können.</span><span class="sxs-lookup"><span data-stu-id="525b9-112">Most often, classes will declare their dependencies via their constructor, allowing them to follow the [Explicit Dependencies Principle](http://deviq.com/explicit-dependencies-principle/).</span></span> <span data-ttu-id="525b9-113">Dieser Ansatz wird als „Constructor Injection“ bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="525b9-113">This approach is known as "constructor injection".</span></span>

<span data-ttu-id="525b9-114">Wenn Klassen vor dem Hintergrund von Dependency Injection entworfen werden, sind sie loser gekoppelt, da sie über keine direkten, hartcodierten Abhängigkeiten für ihre Projektmitarbeiter verfügen.</span><span class="sxs-lookup"><span data-stu-id="525b9-114">When classes are designed with DI in mind, they're more loosely coupled because they don't have direct, hard-coded dependencies on their collaborators.</span></span> <span data-ttu-id="525b9-115">Dies ergibt sich aus dem [Prinzip der Abhängigkeitsinversion](http://deviq.com/dependency-inversion-principle/), das Folgendes besagt: *„Module der oberen Ebene sollten nicht von Modulen der niedrigen Ebene abhängen; beide sollten von Abstraktionen abhängen.“*</span><span class="sxs-lookup"><span data-stu-id="525b9-115">This follows the [Dependency Inversion Principle](http://deviq.com/dependency-inversion-principle/), which states that *"high level modules shouldn't depend on low level modules; both should depend on abstractions."*</span></span> <span data-ttu-id="525b9-116">Statt auf bestimmte Implementierungen zu verweisen, fordern Klassen Abstraktionen an (in der Regel `interfaces`), die bei der Erstellung der Klassen für sie bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="525b9-116">Instead of referencing specific implementations, classes request abstractions (typically `interfaces`) which are provided to them when the class is constructed.</span></span> <span data-ttu-id="525b9-117">Das Extrahieren von Abhängigkeiten in Schnittstellen und das Bereitstellen von Implementierungen dieser Schnittstellen als Parameter stellen ein weiteres Beispiel für das [Strategieentwurfsmuster](http://deviq.com/strategy-design-pattern/) dar.</span><span class="sxs-lookup"><span data-stu-id="525b9-117">Extracting dependencies into interfaces and providing implementations of these interfaces as parameters is also an example of the [Strategy design pattern](http://deviq.com/strategy-design-pattern/).</span></span>

<span data-ttu-id="525b9-118">Wenn ein System für die Verwendung von Dependency Injection entworfen wird und viele Klassen ihre Abhängigkeiten über ihren Konstruktur (oder Eigenschaften) anfordern, ist es hilfreich, wenn Sie über eine Klasse verfügen, die sich der Erstellung dieser Klassen mit den zugehörigen Abhängigkeiten widmet.</span><span class="sxs-lookup"><span data-stu-id="525b9-118">When a system is designed to use DI, with many classes requesting their dependencies via their constructor (or properties), it's helpful to have a class dedicated to creating these classes with their associated dependencies.</span></span> <span data-ttu-id="525b9-119">Diese Klassen werden als *Container* oder genauer gesagt als [Inversion of Control(-IoC)](http://deviq.com/inversion-of-control/)-Container oder Dependency Injection-Container bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="525b9-119">These classes are referred to as *containers*, or more specifically, [Inversion of Control (IoC)](http://deviq.com/inversion-of-control/) containers or Dependency Injection (DI) containers.</span></span> <span data-ttu-id="525b9-120">Ein Container ist im Wesentlichen eine Factory, die für die Bereitstellung der von ihm angeforderten Instanzen von Typen verantwortlich ist.</span><span class="sxs-lookup"><span data-stu-id="525b9-120">A container is essentially a factory that's responsible for providing instances of types that are requested from it.</span></span> <span data-ttu-id="525b9-121">Wenn ein bestimmter Typ deklariert hat, dass er über Abhängigkeiten verfügt und der Container so konfiguriert wurde, dass die Abhängigkeitstypen bereitgestellt werden können, erstellt er diese Abhängigkeiten im Rahmen der Erstellung der angeforderten Instanz.</span><span class="sxs-lookup"><span data-stu-id="525b9-121">If a given type has declared that it has dependencies, and the container has been configured to provide the dependency types, it will create the dependencies as part of creating the requested instance.</span></span> <span data-ttu-id="525b9-122">Auf diese Weise können komplexe Abhängigkeitsdiagramme für Klassen bereitgestellt werden, ohne dass eine hartcodierte Objektkonstruktion erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="525b9-122">In this way, complex dependency graphs can be provided to classes without the need for any hard-coded object construction.</span></span> <span data-ttu-id="525b9-123">Neben dem Erstellen von Objekten mit den zugehörigen Abhängigkeiten verwalten Container normalerweise auch die Objektlebensdauer innerhalb der Anwendung.</span><span class="sxs-lookup"><span data-stu-id="525b9-123">In addition to creating objects with their dependencies, containers typically manage object lifetimes within the application.</span></span>

<span data-ttu-id="525b9-124">ASP.NET Core enthält einen einfachen integrierten Container (dargestellt durch die Schnittstelle `IServiceProvider`), der die Constructor Injection standardmäßig unterstützt. Zudem stellt ASP.NET bestimmte Dienste über Dependency Injection zur Verfügbar.</span><span class="sxs-lookup"><span data-stu-id="525b9-124">ASP.NET Core includes a simple built-in container (represented by the `IServiceProvider` interface) that supports constructor injection by default, and ASP.NET makes certain services available through DI.</span></span> <span data-ttu-id="525b9-125">Der ASP. NET-Container bezeichnet von ihm verwaltete Typen als *Dienste*.</span><span class="sxs-lookup"><span data-stu-id="525b9-125">ASP.NET's container refers to the types it manages as *services*.</span></span> <span data-ttu-id="525b9-126">Im weiteren Verlauf dieses Artikels bezieht sich der Ausdruck *Dienste* auf Typen, die vom ASP.NET Core-IoC-Container verwaltet werden.</span><span class="sxs-lookup"><span data-stu-id="525b9-126">Throughout the rest of this article, *services* will refer to types that are managed by ASP.NET Core's IoC container.</span></span> <span data-ttu-id="525b9-127">Sie konfigurieren die integrierten Containerdienste in der `ConfigureServices`-Methode in der Klasse `Startup` Ihrer Anwendung.</span><span class="sxs-lookup"><span data-stu-id="525b9-127">You configure the built-in container's services in the `ConfigureServices` method in your application's `Startup` class.</span></span>

> [!NOTE]
> <span data-ttu-id="525b9-128">Martin Fowler hat einen ausführlichen Artikel zur [Inversion of Control Containers and the Dependency Injection Pattern (Umkehrung von Steuerelementcontainern und dem Dependency Injection-Muster)](https://www.martinfowler.com/articles/injection.html) geschrieben.</span><span class="sxs-lookup"><span data-stu-id="525b9-128">Martin Fowler has written an extensive article on [Inversion of Control Containers and the Dependency Injection Pattern](https://www.martinfowler.com/articles/injection.html).</span></span> <span data-ttu-id="525b9-129">Microsoft Patterns and Practices verfügt auch über eine hervorragende Beschreibung für [Dependency Injection](https://msdn.microsoft.com/library/hh323705.aspx).</span><span class="sxs-lookup"><span data-stu-id="525b9-129">Microsoft Patterns and Practices also has a great description of [Dependency Injection](https://msdn.microsoft.com/library/hh323705.aspx).</span></span>

> [!NOTE]
> <span data-ttu-id="525b9-130">Dieser Artikel behandelt das Thema Dependency Injection. Dieses Muster kann für alle ASP.NET-Anwendungen verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="525b9-130">This article covers Dependency Injection as it applies to all ASP.NET applications.</span></span> <span data-ttu-id="525b9-131">Dependency Injection in MVC-Controllern wird unter [Dependency Injection and Controllers (Dependency Injection und Controller)](../mvc/controllers/dependency-injection.md) behandelt.</span><span class="sxs-lookup"><span data-stu-id="525b9-131">Dependency Injection within MVC controllers is covered in [Dependency Injection and Controllers](../mvc/controllers/dependency-injection.md).</span></span>

### <a name="constructor-injection-behavior"></a><span data-ttu-id="525b9-132">Verhalten von Constructor Injection</span><span class="sxs-lookup"><span data-stu-id="525b9-132">Constructor injection behavior</span></span>

<span data-ttu-id="525b9-133">Für Constructor Injection ist erforderlich, dass der betreffende Konstruktor *öffentlich* ist.</span><span class="sxs-lookup"><span data-stu-id="525b9-133">Constructor injection requires that the constructor in question be *public*.</span></span> <span data-ttu-id="525b9-134">Andernfalls löst Ihre App eine `InvalidOperationException` aus:</span><span class="sxs-lookup"><span data-stu-id="525b9-134">Otherwise, your app will throw an `InvalidOperationException`:</span></span>

> <span data-ttu-id="525b9-135">Es konnte kein geeigneter Konstruktor für den Typ „YourType“ gefunden werden.</span><span class="sxs-lookup"><span data-stu-id="525b9-135">A suitable constructor for type 'YourType' couldn't be located.</span></span> <span data-ttu-id="525b9-136">Stellen Sie sicher, dass der Typ konkret ist und für alle Parameter eines öffentlichen Konstruktors Dienste registriert sind.</span><span class="sxs-lookup"><span data-stu-id="525b9-136">Ensure the type is concrete and services are registered for all parameters of a public constructor.</span></span>

<span data-ttu-id="525b9-137">Bei Constructor Injection darf nur ein anwendbarer Konstruktor vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="525b9-137">Constructor injection requires that only one applicable constructor exist.</span></span> <span data-ttu-id="525b9-138">Konstruktorüberladungen werden unterstützt. Es darf jedoch nur eine Überladung vorhanden sein, deren Argumente alle durch Dependency Injection erfüllt werden können.</span><span class="sxs-lookup"><span data-stu-id="525b9-138">Constructor overloads are supported, but only one overload can exist whose arguments can all be fulfilled by dependency injection.</span></span> <span data-ttu-id="525b9-139">Wenn mehrere Überladungen vorhanden sind, löst Ihre App eine `InvalidOperationException` aus:</span><span class="sxs-lookup"><span data-stu-id="525b9-139">If more than one exists, your app will throw an `InvalidOperationException`:</span></span>

> <span data-ttu-id="525b9-140">Im Typ „YourType“ wurden mehrere Konstruktoren gefunden, die alle angegebenen Argumenttypen akzeptieren.</span><span class="sxs-lookup"><span data-stu-id="525b9-140">Multiple constructors accepting all given argument types have been found in type 'YourType'.</span></span> <span data-ttu-id="525b9-141">Es sollte nur ein anwendbarer Konstruktor vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="525b9-141">There should only be one applicable constructor.</span></span>

<span data-ttu-id="525b9-142">Konstruktoren können Argumente akzeptieren, die nicht durch Dependency Injection bereitgestellt werden. Diese müssen jedoch die Standardwerte unterstützen.</span><span class="sxs-lookup"><span data-stu-id="525b9-142">Constructors can accept arguments that are not provided by dependency injection, but these must support default values.</span></span> <span data-ttu-id="525b9-143">Zum Beispiel:</span><span class="sxs-lookup"><span data-stu-id="525b9-143">For example:</span></span>

```csharp
// throws InvalidOperationException: Unable to resolve service for type 'System.String'...
public CharactersController(ICharacterRepository characterRepository, string title)
{
    _characterRepository = characterRepository;
    _title = title;
}

// runs without error
public CharactersController(ICharacterRepository characterRepository, string title = "Characters")
{
    _characterRepository = characterRepository;
    _title = title;
}
```

## <a name="using-framework-provided-services"></a><span data-ttu-id="525b9-144">Verwenden von im Framework bereitgestellten Diensten</span><span class="sxs-lookup"><span data-stu-id="525b9-144">Using framework-provided services</span></span>

<span data-ttu-id="525b9-145">Die Methode `ConfigureServices` in der `Startup`-Klasse ist verantwortlich für das Definieren der von der Anwendung verwendeten Dienste. Dies beinhaltet Plattformfeatures wie Entity Framework Core und ASP.NET Core MVC.</span><span class="sxs-lookup"><span data-stu-id="525b9-145">The `ConfigureServices` method in the `Startup` class is responsible for defining the services the application will use, including platform features like Entity Framework Core and ASP.NET Core MVC.</span></span> <span data-ttu-id="525b9-146">Zunächst enthält die in `ConfigureServices` bereitgestellte `IServiceCollection` folgende definierten Dienste (abhängig von der [Vorgehensweise bei der Konfiguration des Hosts](xref:fundamentals/host/index)):</span><span class="sxs-lookup"><span data-stu-id="525b9-146">Initially, the `IServiceCollection` provided to `ConfigureServices` has the following services defined (depending on [how the host was configured](xref:fundamentals/host/index)):</span></span>

| <span data-ttu-id="525b9-147">Diensttyp</span><span class="sxs-lookup"><span data-stu-id="525b9-147">Service Type</span></span> | <span data-ttu-id="525b9-148">Lebensdauer</span><span class="sxs-lookup"><span data-stu-id="525b9-148">Lifetime</span></span> |
| ----- | ------- |
| [<span data-ttu-id="525b9-149">Microsoft.AspNetCore.Hosting.IHostingEnvironment</span><span class="sxs-lookup"><span data-stu-id="525b9-149">Microsoft.AspNetCore.Hosting.IHostingEnvironment</span></span>](/dotnet/api/microsoft.aspnetcore.hosting.ihostingenvironment) | <span data-ttu-id="525b9-150">Singleton</span><span class="sxs-lookup"><span data-stu-id="525b9-150">Singleton</span></span> |
| [<span data-ttu-id="525b9-151">Microsoft.Extensions.Logging.ILoggerFactory</span><span class="sxs-lookup"><span data-stu-id="525b9-151">Microsoft.Extensions.Logging.ILoggerFactory</span></span>](/dotnet/api/microsoft.extensions.logging.iloggerfactory) | <span data-ttu-id="525b9-152">Singleton</span><span class="sxs-lookup"><span data-stu-id="525b9-152">Singleton</span></span> |
| [<span data-ttu-id="525b9-153">Microsoft.Extensions.Logging.ILogger&lt;T&gt;</span><span class="sxs-lookup"><span data-stu-id="525b9-153">Microsoft.Extensions.Logging.ILogger&lt;T&gt;</span></span>](/dotnet/api/microsoft.extensions.logging.ilogger) | <span data-ttu-id="525b9-154">Singleton</span><span class="sxs-lookup"><span data-stu-id="525b9-154">Singleton</span></span> |
| [<span data-ttu-id="525b9-155">Microsoft.AspNetCore.Hosting.Builder.IApplicationBuilderFactory</span><span class="sxs-lookup"><span data-stu-id="525b9-155">Microsoft.AspNetCore.Hosting.Builder.IApplicationBuilderFactory</span></span>](/dotnet/api/microsoft.aspnetcore.hosting.builder.iapplicationbuilderfactory) | <span data-ttu-id="525b9-156">Transient (vorübergehend)</span><span class="sxs-lookup"><span data-stu-id="525b9-156">Transient</span></span> |
| [<span data-ttu-id="525b9-157">Microsoft.AspNetCore.Http.IHttpContextFactory</span><span class="sxs-lookup"><span data-stu-id="525b9-157">Microsoft.AspNetCore.Http.IHttpContextFactory</span></span>](/dotnet/api/microsoft.aspnetcore.http.ihttpcontextfactory) | <span data-ttu-id="525b9-158">Transient (vorübergehend)</span><span class="sxs-lookup"><span data-stu-id="525b9-158">Transient</span></span> |
| [<span data-ttu-id="525b9-159">Microsoft.Extensions.Options.IOptions&lt;T&gt;</span><span class="sxs-lookup"><span data-stu-id="525b9-159">Microsoft.Extensions.Options.IOptions&lt;T&gt;</span></span>](/dotnet/api/microsoft.extensions.options.ioptions-1) | <span data-ttu-id="525b9-160">Singleton</span><span class="sxs-lookup"><span data-stu-id="525b9-160">Singleton</span></span> |
| [<span data-ttu-id="525b9-161">System.Diagnostics.DiagnosticSource</span><span class="sxs-lookup"><span data-stu-id="525b9-161">System.Diagnostics.DiagnosticSource</span></span>](https://docs.microsoft.com/dotnet/core/api/system.diagnostics.diagnosticsource) | <span data-ttu-id="525b9-162">Singleton</span><span class="sxs-lookup"><span data-stu-id="525b9-162">Singleton</span></span> |
| [<span data-ttu-id="525b9-163">System.Diagnostics.DiagnosticListener</span><span class="sxs-lookup"><span data-stu-id="525b9-163">System.Diagnostics.DiagnosticListener</span></span>](https://docs.microsoft.com/dotnet/core/api/system.diagnostics.diagnosticlistener) | <span data-ttu-id="525b9-164">Singleton</span><span class="sxs-lookup"><span data-stu-id="525b9-164">Singleton</span></span> |
| [<span data-ttu-id="525b9-165">Microsoft.AspNetCore.Hosting.IStartupFilter</span><span class="sxs-lookup"><span data-stu-id="525b9-165">Microsoft.AspNetCore.Hosting.IStartupFilter</span></span>](/dotnet/api/microsoft.aspnetcore.hosting.istartupfilter) | <span data-ttu-id="525b9-166">Transient (vorübergehend)</span><span class="sxs-lookup"><span data-stu-id="525b9-166">Transient</span></span> |
| [<span data-ttu-id="525b9-167">Microsoft.Extensions.ObjectPool.ObjectPoolProvider</span><span class="sxs-lookup"><span data-stu-id="525b9-167">Microsoft.Extensions.ObjectPool.ObjectPoolProvider</span></span>](/dotnet/api/microsoft.extensions.objectpool.objectpoolprovider) | <span data-ttu-id="525b9-168">Singleton</span><span class="sxs-lookup"><span data-stu-id="525b9-168">Singleton</span></span> |
| [<span data-ttu-id="525b9-169">Microsoft.Extensions.Options.IConfigureOptions&lt;T&gt;</span><span class="sxs-lookup"><span data-stu-id="525b9-169">Microsoft.Extensions.Options.IConfigureOptions&lt;T&gt;</span></span>](/dotnet/api/microsoft.extensions.options.iconfigureoptions-1) | <span data-ttu-id="525b9-170">Transient (vorübergehend)</span><span class="sxs-lookup"><span data-stu-id="525b9-170">Transient</span></span> |
| [<span data-ttu-id="525b9-171">Microsoft.AspNetCore.Hosting.Server.IServer</span><span class="sxs-lookup"><span data-stu-id="525b9-171">Microsoft.AspNetCore.Hosting.Server.IServer</span></span>](/dotnet/api/microsoft.aspnetcore.hosting.server.iserver) | <span data-ttu-id="525b9-172">Singleton</span><span class="sxs-lookup"><span data-stu-id="525b9-172">Singleton</span></span> |
| [<span data-ttu-id="525b9-173">Microsoft.AspNetCore.Hosting.IStartup</span><span class="sxs-lookup"><span data-stu-id="525b9-173">Microsoft.AspNetCore.Hosting.IStartup</span></span>](/dotnet/api/microsoft.aspnetcore.hosting.istartup) | <span data-ttu-id="525b9-174">Singleton</span><span class="sxs-lookup"><span data-stu-id="525b9-174">Singleton</span></span> |
| [<span data-ttu-id="525b9-175">Microsoft.AspNetCore.Hosting.IApplicationLifetime</span><span class="sxs-lookup"><span data-stu-id="525b9-175">Microsoft.AspNetCore.Hosting.IApplicationLifetime</span></span>](/dotnet/api/microsoft.aspnetcore.hosting.iapplicationlifetime) | <span data-ttu-id="525b9-176">Singleton</span><span class="sxs-lookup"><span data-stu-id="525b9-176">Singleton</span></span> |

<span data-ttu-id="525b9-177">Im Folgenden finden Sie ein Beispiel zur Vorgehensweise beim Hinzufügen zusätzlicher Dienste zum Container mit einer Reihe von Erweiterungsmethoden wie `AddDbContext`, `AddIdentity` und `AddMvc`.</span><span class="sxs-lookup"><span data-stu-id="525b9-177">Below is an example of how to add additional services to the container using a number of extension methods like `AddDbContext`, `AddIdentity`, and `AddMvc`.</span></span>

[!code-csharp[](../common/samples/WebApplication1/Startup.cs?highlight=5-6,8-10,12&range=39-56)]

<span data-ttu-id="525b9-178">Die von ASP.NET bereitgestellten Features und die bereitgestellte Middleware, wie z.B. MVC, folgen einer Konvention, bei der eine einzelne Erweiterungsmethode zum Hinzufügen von *ServiceName* für die Registrierung aller für dieses Feature erforderlichen Dienste verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="525b9-178">The features and middleware provided by ASP.NET, such as MVC, follow a convention of using a single Add*ServiceName* extension method to register all of the services required by that feature.</span></span>

> [!TIP]
> <span data-ttu-id="525b9-179">In `Startup`-Methoden können Sie über die zugehörigen Parameterlisten bestimmte im Framework bereitgestellten Dienste anfordern. Weitere Einzelheiten hierzu finden Sie unter [Anwendungsstart](startup.md).</span><span class="sxs-lookup"><span data-stu-id="525b9-179">You can request certain framework-provided services within `Startup` methods through their parameter lists - see [Application Startup](startup.md) for more details.</span></span>

## <a name="registering-services"></a><span data-ttu-id="525b9-180">Registrieren von Diensten</span><span class="sxs-lookup"><span data-stu-id="525b9-180">Registering services</span></span>

<span data-ttu-id="525b9-181">Sie können Ihre eigenen Anwendungsdienste wie folgt registrieren.</span><span class="sxs-lookup"><span data-stu-id="525b9-181">You can register your own application services as follows.</span></span> <span data-ttu-id="525b9-182">Der erste generische Typ stellt den vom Container angeforderten Typ dar (in der Regel eine Schnittstelle).</span><span class="sxs-lookup"><span data-stu-id="525b9-182">The first generic type represents the type (typically an interface) that will be requested from the container.</span></span> <span data-ttu-id="525b9-183">Der zweite generische Typ stellt den konkreten Typ dar, der vom Container instanziiert und zur Erfüllung solcher Anforderungen verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="525b9-183">The second generic type represents the concrete type that will be instantiated by the container and used to fulfill such requests.</span></span>

[!code-csharp[](../common/samples/WebApplication1/Startup.cs?range=53-54)]

> [!NOTE]
> <span data-ttu-id="525b9-184">Jede Erweiterungsmethode vom Typ `services.Add<ServiceName>` fügt Dienste hinzu (und konfiguriert diese möglicherweise).</span><span class="sxs-lookup"><span data-stu-id="525b9-184">Each `services.Add<ServiceName>` extension method adds (and potentially configures) services.</span></span> <span data-ttu-id="525b9-185">So fügt `services.AddMvc()` beispielsweise die für MVC erforderlichen Dienste hinzu.</span><span class="sxs-lookup"><span data-stu-id="525b9-185">For example, `services.AddMvc()` adds the services MVC requires.</span></span> <span data-ttu-id="525b9-186">Es wird empfohlen, dieser Konvention zu folgen und dabei Erweiterungsmethoden in den Namespace `Microsoft.Extensions.DependencyInjection` einzufügen, damit Gruppen von Dienstregistrierungen eingeschlossen werden.</span><span class="sxs-lookup"><span data-stu-id="525b9-186">It's recommended that you follow this convention, placing extension methods in the `Microsoft.Extensions.DependencyInjection` namespace, to encapsulate groups of service registrations.</span></span>

<span data-ttu-id="525b9-187">Mit der Methode `AddTransient` werden konkreten Diensten abstrakte Typen zugeordnet, die separat für jedes Objekt instanziiert werden, für das dies erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="525b9-187">The `AddTransient` method is used to map abstract types to concrete services that are instantiated separately for every object that requires it.</span></span> <span data-ttu-id="525b9-188">Dies wird als *Lebensdauer* des Dienstes bezeichnet. Weitere Lebensdaueroptionen werden nachfolgend beschrieben.</span><span class="sxs-lookup"><span data-stu-id="525b9-188">This is known as the service's *lifetime*, and additional lifetime options are described below.</span></span> <span data-ttu-id="525b9-189">Es ist wichtig, dass für jeden der von Ihnen registrierten Dienste eine geeignete Lebensdauer ausgewählt wird.</span><span class="sxs-lookup"><span data-stu-id="525b9-189">It's important to choose an appropriate lifetime for each of the services you register.</span></span> <span data-ttu-id="525b9-190">Sollte für jede Klasse, die dies anfordert, eine neue Dienstinstanz bereitgestellt werden?</span><span class="sxs-lookup"><span data-stu-id="525b9-190">Should a new instance of the service be provided to each class that requests it?</span></span> <span data-ttu-id="525b9-191">Sollte eine Instanz über eine bestimmte Webanforderung hindurch verwendet werden?</span><span class="sxs-lookup"><span data-stu-id="525b9-191">Should one instance be used throughout a given web request?</span></span> <span data-ttu-id="525b9-192">Oder sollte für die Lebensdauer der Anwendung eine einzelne Instanz verwendet werden?</span><span class="sxs-lookup"><span data-stu-id="525b9-192">Or should a single instance be used for the lifetime of the application?</span></span>

<span data-ttu-id="525b9-193">In dem Beispiel für diesen Artikel gibt es einen einfachen Controller, der Zeichennamen anzeigt, die als `CharactersController` bezeichnet werden.</span><span class="sxs-lookup"><span data-stu-id="525b9-193">In the sample for this article, there's a simple controller that displays character names, called `CharactersController`.</span></span> <span data-ttu-id="525b9-194">Die zugehörige Methode `Index` zeigt die aktuelle Liste der Zeichen an, die in der Anwendung gespeichert worden sind, und initialisiert die Auflistung mit einer Reihe von Zeichen, sofern keine Werte vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="525b9-194">Its `Index` method displays the current list of characters that have been stored in the application, and initializes the collection with a handful of characters if none exist.</span></span> <span data-ttu-id="525b9-195">Beachten Sie, dass obwohl diese Anwendung Entity Framework Core und die Klasse `ApplicationDbContext` für ihre Persistenz verwendet, nichts davon im Controller offensichtlich ist.</span><span class="sxs-lookup"><span data-stu-id="525b9-195">Note that although this application uses Entity Framework Core and the `ApplicationDbContext` class for its persistence, none of that's apparent in the controller.</span></span> <span data-ttu-id="525b9-196">Stattdessen wurde der spezifische Datenzugriffsmechanismus hinter einer Schnittstelle, `ICharacterRepository`, abstrahiert, die dem [Repositorymuster](http://deviq.com/repository-pattern/) folgt.</span><span class="sxs-lookup"><span data-stu-id="525b9-196">Instead, the specific data access mechanism has been abstracted behind an interface, `ICharacterRepository`, which follows the [repository pattern](http://deviq.com/repository-pattern/).</span></span> <span data-ttu-id="525b9-197">Eine Instanz von `ICharacterRepository` wird über den Konstruktor angefordert und einem privaten Feld zugeordnet, über das anschließend ggf. auf Zeichen zugegriffen wird.</span><span class="sxs-lookup"><span data-stu-id="525b9-197">An instance of `ICharacterRepository` is requested via the constructor and assigned to a private field, which is then used to access characters as necessary.</span></span>

[!code-csharp[](../fundamentals/dependency-injection/sample/DependencyInjectionSample/Controllers/CharactersController.cs?highlight=3,5,6,7,8,14,21-27&range=8-36)]

<span data-ttu-id="525b9-198">Das `ICharacterRepository` definiert die beiden Methoden, in denen der Controller mit `Character`-Instanzen arbeiten muss.</span><span class="sxs-lookup"><span data-stu-id="525b9-198">The `ICharacterRepository` defines the two methods the controller needs to work with `Character` instances.</span></span>

[!code-csharp[](../fundamentals/dependency-injection/sample/DependencyInjectionSample/Interfaces/ICharacterRepository.cs?highlight=8,9)]

<span data-ttu-id="525b9-199">Diese Schnittstelle wiederum wird von einem konkreten Typ, `CharacterRepository`, implementiert, der zur Laufzeit verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="525b9-199">This interface is in turn implemented by a concrete type, `CharacterRepository`, that's used at runtime.</span></span>

> [!NOTE]
> <span data-ttu-id="525b9-200">Die Verwendungsweise der Dependency Injection mit der Klasse `CharacterRepository` stellt ein allgemeines Modell dar, dem Sie bei allen Ihren Anwendungsdiensten folgen können, nicht nur in „Repositorys“ oder Datenzugriffsklassen.</span><span class="sxs-lookup"><span data-stu-id="525b9-200">The way DI is used with the `CharacterRepository` class is a general model you can follow for all of your application services, not just in "repositories" or data access classes.</span></span>

[!code-csharp[](../fundamentals/dependency-injection/sample/DependencyInjectionSample/Models/CharacterRepository.cs?highlight=9,11,12,13,14)]

<span data-ttu-id="525b9-201">Beachten Sie, dass das `CharacterRepository` einen `ApplicationDbContext` beim zugehörigen Konstruktor anfordert.</span><span class="sxs-lookup"><span data-stu-id="525b9-201">Note that `CharacterRepository` requests an `ApplicationDbContext` in its constructor.</span></span> <span data-ttu-id="525b9-202">Es ist nicht ungewöhnlich, dass Dependency Injection auf solch verkettete Weise verwendet wird, in der jede angeforderte Abhängigkeit wiederum eine eigene Abhängigkeit anfordert.</span><span class="sxs-lookup"><span data-stu-id="525b9-202">It's not unusual for dependency injection to be used in a chained fashion like this, with each requested dependency in turn requesting its own dependencies.</span></span> <span data-ttu-id="525b9-203">Der Container ist für die Auflösung all dieser Abhängigkeiten im Diagramm und die Rückgabe der vollständig aufgelösten Dienste verantwortlich.</span><span class="sxs-lookup"><span data-stu-id="525b9-203">The container is responsible for resolving all of the dependencies in the graph and returning the fully resolved service.</span></span>

> [!NOTE]
> <span data-ttu-id="525b9-204">Die Erstellung des angeforderten Objekts, sowie aller dafür erforderlichen Objekte und wiederum aller dafür erforderlichen Objekte wird manchmal als *Objektdiagramm* bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="525b9-204">Creating the requested object, and all of the objects it requires, and all of the objects those require, is sometimes referred to as an *object graph*.</span></span> <span data-ttu-id="525b9-205">Gleichermaßen werden die gesammelten aufzulösenden Abhängigkeiten normalerweise als *Abhängigkeitsstruktur* oder *Abhängigkeitsdiagramm* bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="525b9-205">Likewise, the collective set of dependencies that must be resolved is typically referred to as a *dependency tree* or *dependency graph*.</span></span>

<span data-ttu-id="525b9-206">In diesem Fall müssen das `ICharacterRepository` und `ApplicationDbContext` wiederum beim Dienstcontainer in `ConfigureServices` unter `Startup` registriert werden.</span><span class="sxs-lookup"><span data-stu-id="525b9-206">In this case, both `ICharacterRepository` and in turn `ApplicationDbContext` must be registered with the services container in `ConfigureServices` in `Startup`.</span></span> <span data-ttu-id="525b9-207">`ApplicationDbContext` wird mit dem Aufruf der Erweiterungsmethode `AddDbContext<T>` konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="525b9-207">`ApplicationDbContext` is configured with the call to the extension method `AddDbContext<T>`.</span></span> <span data-ttu-id="525b9-208">Im folgenden Code wird die Registrierung des Typs `CharacterRepository` veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="525b9-208">The following code shows the registration of the `CharacterRepository` type.</span></span>

[!code-csharp[](dependency-injection/sample/DependencyInjectionSample/Startup.cs?highlight=3-5,11&range=16-32)]

<span data-ttu-id="525b9-209">Entity Framework-Kontexte sollten mit der Lebensdauer `Scoped` zum Dienstcontainer hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="525b9-209">Entity Framework contexts should be added to the services container using the `Scoped` lifetime.</span></span> <span data-ttu-id="525b9-210">Wenn Sie die Methoden des Hilfsprogramms wie oben dargestellt verwenden, geschieht dies automatisch.</span><span class="sxs-lookup"><span data-stu-id="525b9-210">This is taken care of automatically if you use the helper methods as shown above.</span></span> <span data-ttu-id="525b9-211">Repositorys, die Entity Framework nutzen, sollten die gleiche Lebensdauer verwenden.</span><span class="sxs-lookup"><span data-stu-id="525b9-211">Repositories that will make use of Entity Framework should use the same lifetime.</span></span>

> [!WARNING]
> <span data-ttu-id="525b9-212">Größte Vorsicht ist geboten, wenn ein `Scoped`-Dienst über ein Singleton aufgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="525b9-212">The main danger to be wary of is resolving a `Scoped` service from a singleton.</span></span> <span data-ttu-id="525b9-213">In einem solchen Fall ist die Wahrscheinlichkeit groß, dass der Dienst bei der Verarbeitung nachfolgender Anforderungen einen falschen Status aufweist.</span><span class="sxs-lookup"><span data-stu-id="525b9-213">It's likely in such a case that the service will have incorrect state when processing subsequent requests.</span></span>

<span data-ttu-id="525b9-214">Dienste, die über Abhängigkeiten verfügen, sollten diese im Container registrieren.</span><span class="sxs-lookup"><span data-stu-id="525b9-214">Services that have dependencies should register them in the container.</span></span> <span data-ttu-id="525b9-215">Wenn für einen Dienstkonstruktor ein Grundtyp erforderlich ist, wie z.B. eine `string`, kann dieser über [Konfiguration](xref:fundamentals/configuration/index) und das [Optionsmuster](xref:fundamentals/configuration/options) eingefügt werden.</span><span class="sxs-lookup"><span data-stu-id="525b9-215">If a service's constructor requires a primitive, such as a `string`, this can be injected by using [configuration](xref:fundamentals/configuration/index) and the [options pattern](xref:fundamentals/configuration/options).</span></span>

## <a name="service-lifetimes-and-registration-options"></a><span data-ttu-id="525b9-216">Dienstlebensdauer und Registrierungsoptionen</span><span class="sxs-lookup"><span data-stu-id="525b9-216">Service lifetimes and registration options</span></span>

<span data-ttu-id="525b9-217">ASP.NET-Dienste können mit folgender Lebensdauer konfiguriert werden:</span><span class="sxs-lookup"><span data-stu-id="525b9-217">ASP.NET services can be configured with the following lifetimes:</span></span>

<span data-ttu-id="525b9-218">**Transient** (vorübergehend)</span><span class="sxs-lookup"><span data-stu-id="525b9-218">**Transient**</span></span>

<span data-ttu-id="525b9-219">Dienste mit vorübergehender Lebensdauer werden bei jeder Anforderung neu erstellt.</span><span class="sxs-lookup"><span data-stu-id="525b9-219">Transient lifetime services are created each time they're requested.</span></span> <span data-ttu-id="525b9-220">Diese Lebensdauer ist am besten für einfache, zustandslose Dienste geeignet.</span><span class="sxs-lookup"><span data-stu-id="525b9-220">This lifetime works best for lightweight, stateless services.</span></span>

<span data-ttu-id="525b9-221">**Scoped** (bereichsbezogen)</span><span class="sxs-lookup"><span data-stu-id="525b9-221">**Scoped**</span></span>

<span data-ttu-id="525b9-222">Dienste mit bereichsbezogener Lebensdauer werden einmal pro Anforderung erstellt.</span><span class="sxs-lookup"><span data-stu-id="525b9-222">Scoped lifetime services are created once per request.</span></span>

> [!WARNING]
> <span data-ttu-id="525b9-223">Wenn Sie einen bereichsbezogenen Dienst in einer Middleware verwenden, müssen Sie den Dienst in eine `Invoke`- oder `InvokeAsync`-Methode einfügen.</span><span class="sxs-lookup"><span data-stu-id="525b9-223">If you're using a scoped service in a middleware, inject the service into the `Invoke` or `InvokeAsync` method.</span></span> <span data-ttu-id="525b9-224">Fügen Sie ihn nicht über Constructor Injection ein, da hierdurch der Dienst ein Verhalten wie ein Singleton zeigt.</span><span class="sxs-lookup"><span data-stu-id="525b9-224">Don't inject via constructor injection because it forces the service to behave like a singleton.</span></span>

<span data-ttu-id="525b9-225">**Singleton**</span><span class="sxs-lookup"><span data-stu-id="525b9-225">**Singleton**</span></span>

<span data-ttu-id="525b9-226">Dienste mit Singleton-Lebensdauer werden bei ihrer Anforderung zum ersten Mal erstellt (oder wenn `ConfigureServices` ausgeführt wird, wenn Sie dort eine Instanz angeben); in jeder nachfolgenden Anforderung wird anschließend dieselbe Instanz verwendet.</span><span class="sxs-lookup"><span data-stu-id="525b9-226">Singleton lifetime services are created the first time they're requested (or when `ConfigureServices` is run if you specify an instance there) and then every subsequent request will use the same instance.</span></span> <span data-ttu-id="525b9-227">Wenn für Ihre Anwendung Singleton-Verhalten erforderlich ist, sollte zugelassen werden, dass der Dienstcontainer die Lebensdauer des Dienstes verwaltet, statt das Singleton-Entwurfsmuster zu implementieren und die Lebensdauer Ihres Objekts selbst in der Klasse zu verwalten.</span><span class="sxs-lookup"><span data-stu-id="525b9-227">If your application requires singleton behavior, allowing the services container to manage the service's lifetime is recommended instead of implementing the singleton design pattern and managing your object's lifetime in the class yourself.</span></span>

<span data-ttu-id="525b9-228">Dienste können auf verschiedene Weisen beim Container registriert werden.</span><span class="sxs-lookup"><span data-stu-id="525b9-228">Services can be registered with the container in several ways.</span></span> <span data-ttu-id="525b9-229">Es wurde bereits gezeigt, wie eine Dienstimplementierung mit einem angegebenen Typ durch die Angabe des zu verwendenden konkreten Typs registriert wird.</span><span class="sxs-lookup"><span data-stu-id="525b9-229">We have already seen how to register a service implementation with a given type by specifying the concrete type to use.</span></span> <span data-ttu-id="525b9-230">Darüber hinaus kann eine Factory angegeben werden, die dann bei Bedarf zum Erstellen der Instanz verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="525b9-230">In addition, a factory can be specified, which will then be used to create the instance on demand.</span></span> <span data-ttu-id="525b9-231">Im dritten Ansatz wird die Instanz des zu verwendenden Typs direkt angegeben. In diesem Fall versucht der Container niemals, eine Instanz zu erstellen (und er verfügt auch nicht über die Instanz).</span><span class="sxs-lookup"><span data-stu-id="525b9-231">The third approach is to directly specify the instance of the type to use, in which case the container will never attempt to create an instance (nor will it dispose of the instance).</span></span>

<span data-ttu-id="525b9-232">Stellen Sie sich zur Veranschaulichung des Unterschieds zwischen diesen Lebensdauer- und Registrierungsoptionen eine einfache Schnittstelle vor, die mindestens eine Task als *Vorgang* mit einem eindeutigen Bezeichner, `OperationId`, darstellt.</span><span class="sxs-lookup"><span data-stu-id="525b9-232">To demonstrate the difference between these lifetime and registration options, consider a simple interface that represents one or more tasks as an *operation* with a unique identifier, `OperationId`.</span></span> <span data-ttu-id="525b9-233">Der Container stellt abhängig davon, wie die Lebensdauer für diesen Dienst konfiguriert wird, entweder die gleichen oder andere Instanzen des Diensts für die anfordernde Klasse bereit.</span><span class="sxs-lookup"><span data-stu-id="525b9-233">Depending on how we configure the lifetime for this service, the container will provide either the same or different instances of the service to the requesting class.</span></span> <span data-ttu-id="525b9-234">Es wird ein Typ pro Lebensdaueroption erstellt, um zu verdeutlichen, welche Lebensdauer angefordert wird:</span><span class="sxs-lookup"><span data-stu-id="525b9-234">To make it clear which lifetime is being requested, we will create one type per lifetime option:</span></span>

[!code-csharp[](../fundamentals/dependency-injection/sample/DependencyInjectionSample/Interfaces/IOperation.cs?highlight=5-8)]

<span data-ttu-id="525b9-235">Diese Schnittstellen werden über eine einzelne Klasse, `Operation`, implementiert, die eine `Guid` in ihrem Konstruktor akzeptiert oder eine neue `Guid` verwendet, wenn keine bereitgestellt wurde.</span><span class="sxs-lookup"><span data-stu-id="525b9-235">We implement these interfaces using a single class, `Operation`, that accepts a `Guid` in its constructor, or uses a new `Guid` if none is provided.</span></span>

<span data-ttu-id="525b9-236">Im nächsten Schritt werden in `ConfigureServices` die einzelnen Typen entsprechend ihrer benannten Lebensdauer zum Container hinzugefügt:</span><span class="sxs-lookup"><span data-stu-id="525b9-236">Next, in `ConfigureServices`, each type is added to the container according to its named lifetime:</span></span>

[!code-csharp[](dependency-injection/sample/DependencyInjectionSample/Startup.cs?range=26-32)]

<span data-ttu-id="525b9-237">Beachten Sie, dass der `IOperationSingletonInstance`-Dienst eine bestimmte Instanz mit einer bekannten ID von `Guid.Empty` verwendet, damit klar ist, wenn dieser Typ verwendet wird (die zugehörige GUID besteht ausschließlich aus 0 (Nullen)).</span><span class="sxs-lookup"><span data-stu-id="525b9-237">Note that the `IOperationSingletonInstance` service is using a specific instance with a known ID of `Guid.Empty` so it will be clear when this type is in use (its Guid will be all zeroes).</span></span> <span data-ttu-id="525b9-238">Zudem wurde ein `OperationService` registriert, der von den jeweils anderen `Operation`-Typen abhängt, damit innerhalb einer Anforderung klar ist, ob dieser Dienst bei den einzelnen Vorgangstypen die gleiche Instanz abruft wie der Controller oder eine neue.</span><span class="sxs-lookup"><span data-stu-id="525b9-238">We have also registered an `OperationService` that depends on each of the other `Operation` types, so that it will be clear within a request whether this service is getting the same instance as the controller, or a new one, for each operation type.</span></span> <span data-ttu-id="525b9-239">Dieser Dienst macht nur seine Abhängigkeiten als Eigenschaften verfügbar, damit diese in der Ansicht angezeigt werden können.</span><span class="sxs-lookup"><span data-stu-id="525b9-239">All this service does is expose its dependencies as properties, so they can be displayed in the view.</span></span>

[!code-csharp[](dependency-injection/sample/DependencyInjectionSample/Services/OperationService.cs)]

<span data-ttu-id="525b9-240">Zur Veranschaulichung der Objektlebensdauer innerhalb und zwischen separaten einzelnen Anforderungen an die Anwendung enthält das Beispiel einen `OperationsController`, der die einzelnen Arten von `IOperation`-Typen und einen `OperationService` anfordert.</span><span class="sxs-lookup"><span data-stu-id="525b9-240">To demonstrate the object lifetimes within and between separate individual requests to the application, the sample includes an `OperationsController` that requests each kind of `IOperation` type as well as an `OperationService`.</span></span> <span data-ttu-id="525b9-241">Die `Index`-Aktion zeigt dann alle `OperationId`-Werte des Controllers und des Diensts an.</span><span class="sxs-lookup"><span data-stu-id="525b9-241">The `Index` action then displays all of the controller's and service's `OperationId` values.</span></span>

[!code-csharp[](dependency-injection/sample/DependencyInjectionSample/Controllers/OperationsController.cs)]

<span data-ttu-id="525b9-242">Nun werden zwei separate Anforderungen an diese Controlleraktion gesendet:</span><span class="sxs-lookup"><span data-stu-id="525b9-242">Now two separate requests are made to this controller action:</span></span>

![Die Ansicht „Vorgänge“ in der Webanwendung mit dem Dependency Injection-Beispiel, die in Microsoft Edge ausgeführt wird und in der bei der ersten Anforderung Vorgangs-ID-Werte (GUID) für die Controller „Transient“ (vorübergehend), „Scoped“ (bereichsbezogen), „Singleton“ und „Instance“ (Instanz) sowie „Operation Service Operations“ (Vorgänge des Vorgangsdiensts) angezeigt werden.](dependency-injection/_static/lifetimes_request1.png)

![Die Vorgangsansicht, in der die Vorgangs-ID-Werte für eine zweite Anforderung angezeigt werden.](dependency-injection/_static/lifetimes_request2.png)

<span data-ttu-id="525b9-245">Beobachten Sie, welche der `OperationId`-Werte innerhalb einer Anforderung und zwischen Anforderungen variieren.</span><span class="sxs-lookup"><span data-stu-id="525b9-245">Observe which of the `OperationId` values vary within a request, and between requests.</span></span>

* <span data-ttu-id="525b9-246">*Vorübergehende* Objekte sind immer unterschiedlich. Für jeden Controller und jeden Dienst wird eine neue Instanz bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="525b9-246">*Transient* objects are always different; a new instance is provided to every controller and every service.</span></span>

* <span data-ttu-id="525b9-247">*Bereichsbezogene* Objekte sind innerhalb einer Anforderung identisch, anforderungsübergreifend sind sie jedoch unterschiedlich.</span><span class="sxs-lookup"><span data-stu-id="525b9-247">*Scoped* objects are the same within a request, but different across different requests</span></span>

* <span data-ttu-id="525b9-248">*Singleton*-Objekte sind bei jedem Objekt und in jeder Anforderung identisch (unabhängig davon, ob eine Instanz in `ConfigureServices` bereitgestellt wird)</span><span class="sxs-lookup"><span data-stu-id="525b9-248">*Singleton* objects are the same for every object and every request (regardless of whether an instance is provided in `ConfigureServices`)</span></span>

## <a name="resolve-a-scoped-service-within-the-application-scope"></a><span data-ttu-id="525b9-249">Auflösen eines bereichsbezogenen Diensts innerhalb des Anwendungsbereichs</span><span class="sxs-lookup"><span data-stu-id="525b9-249">Resolve a scoped service within the application scope</span></span>

<span data-ttu-id="525b9-250">Erstellen Sie [IServiceScope](/dotnet/api/microsoft.extensions.dependencyinjection.iservicescope) mit [IServiceScopeFactory.CreateScope](/dotnet/api/microsoft.extensions.dependencyinjection.iservicescopefactory.createscope), um einen bereichsbezogenen Dienst innerhalb des Anwendungsbereichs aufzulösen.</span><span class="sxs-lookup"><span data-stu-id="525b9-250">Create an [IServiceScope](/dotnet/api/microsoft.extensions.dependencyinjection.iservicescope) with [IServiceScopeFactory.CreateScope](/dotnet/api/microsoft.extensions.dependencyinjection.iservicescopefactory.createscope) to resolve a scoped service within the app's scope.</span></span> <span data-ttu-id="525b9-251">Dieser Ansatz eignet sich gut dafür, beim Start auf einen bereichsbezogenen Dienst zuzugreifen und Initialisierungsaufgaben auszuführen.</span><span class="sxs-lookup"><span data-stu-id="525b9-251">This approach is useful to access a scoped service at startup to run initialization tasks.</span></span> <span data-ttu-id="525b9-252">Das folgende Beispiel veranschaulicht, wie man einen Kontext für `MyScopedService` in `Program.Main` erhält:</span><span class="sxs-lookup"><span data-stu-id="525b9-252">The following example shows how to obtain a context for the `MyScopedService` in `Program.Main`:</span></span>

```csharp
public static void Main(string[] args)
{
    var host = BuildWebHost(args);

    using (var serviceScope = host.Services.CreateScope())
    {
        var services = serviceScope.ServiceProvider;

        try
        {
            var serviceContext = services.GetRequiredService<MyScopedService>();
            // Use the context here
        }
        catch (Exception ex)
        {
            var logger = services.GetRequiredService<ILogger<Program>>();
            logger.LogError(ex, "An error occurred.");
        }
    }

    host.Run();
}
```

## <a name="scope-validation"></a><span data-ttu-id="525b9-253">Bereichsvalidierung</span><span class="sxs-lookup"><span data-stu-id="525b9-253">Scope validation</span></span>

<span data-ttu-id="525b9-254">Wenn die App in der Entwicklungsumgebung unter ASP.NET Core 2.0 oder höher ausgeführt wird, führt der Standarddienstanbieter Überprüfungen aus, um sicherzustellen, dass:</span><span class="sxs-lookup"><span data-stu-id="525b9-254">When the app is running in the Development environment on ASP.NET Core 2.0 or later, the default service provider performs checks to verify that:</span></span>

* <span data-ttu-id="525b9-255">Bereichsbezogene Dienste nicht direkt oder indirekt vom Stammdienstanbieter aufgelöst werden</span><span class="sxs-lookup"><span data-stu-id="525b9-255">Scoped services aren't directly or indirectly resolved from the root service provider.</span></span>
* <span data-ttu-id="525b9-256">Bereichsbezogene Dienste nicht direkt oder indirekt in Singletons eingefügt werden</span><span class="sxs-lookup"><span data-stu-id="525b9-256">Scoped services aren't directly or indirectly injected into singletons.</span></span>

<span data-ttu-id="525b9-257">Der Stammdienstanbieter wird erstellt, wenn [BuildServiceProvider](/dotnet/api/microsoft.extensions.dependencyinjection.servicecollectioncontainerbuilderextensions.buildserviceprovider) aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="525b9-257">The root service provider is created when [BuildServiceProvider](/dotnet/api/microsoft.extensions.dependencyinjection.servicecollectioncontainerbuilderextensions.buildserviceprovider) is called.</span></span> <span data-ttu-id="525b9-258">Die Lebensdauer des Stammdienstanbieters entspricht der Lebensdauer der App/des Servers, wenn der Anbieter mit der App erstellt wird und verworfen wird, wenn die App beendet wird.</span><span class="sxs-lookup"><span data-stu-id="525b9-258">The root service provider's lifetime corresponds to the app/server's lifetime when the provider starts with the app and is disposed when the app shuts down.</span></span>

<span data-ttu-id="525b9-259">Bereichsbezogene Dienste werden von dem Container verworfen, der sie erstellt hat.</span><span class="sxs-lookup"><span data-stu-id="525b9-259">Scoped services are disposed by the container that created them.</span></span> <span data-ttu-id="525b9-260">Wenn ein bereichsbezogener Dienst im Stammcontainer erstellt wird, wird die Lebensdauer effektiv auf Singleton heraufgestuft, da er nur vom Stammcontainer verworfen wird, wenn die App/der Server heruntergefahren wird.</span><span class="sxs-lookup"><span data-stu-id="525b9-260">If a scoped service is created in the root container, the service's lifetime is effectively promoted to singleton because it's only disposed by the root container when app/server is shut down.</span></span> <span data-ttu-id="525b9-261">Die Überprüfung bereichsbezogener Dienste erfasst diese Situationen, wenn `BuildServiceProvider` aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="525b9-261">Validating service scopes catches these situations when `BuildServiceProvider` is called.</span></span>

<span data-ttu-id="525b9-262">Weitere Informationen finden Sie unter [Bereichsvalidierung im Artikel zu „Webhost“](xref:fundamentals/host/web-host#scope-validation).</span><span class="sxs-lookup"><span data-stu-id="525b9-262">For more information, see [Scope validation in the Web Host topic](xref:fundamentals/host/web-host#scope-validation).</span></span>

## <a name="request-services"></a><span data-ttu-id="525b9-263">Anfordern von Diensten</span><span class="sxs-lookup"><span data-stu-id="525b9-263">Request Services</span></span>

<span data-ttu-id="525b9-264">Die Dienste, die innerhalb einer ASP.NET-Anforderung von `HttpContext` verfügbar sind, werden über die `RequestServices`-Sammlung verfügbar gemacht.</span><span class="sxs-lookup"><span data-stu-id="525b9-264">The services available within an ASP.NET request from `HttpContext` are exposed through the `RequestServices` collection.</span></span>

![Kontextbezogener IntelliSense-Dialog von HttpContext-Anforderungsdiensten, in dem angegeben wird, dass Anforderungsdienste den IServiceProvider abrufen oder festlegen, der Zugriff auf den Dienstcontainer der Anforderung bietet.](dependency-injection/_static/request-services.png)

<span data-ttu-id="525b9-266">Anforderungsdienste stellen die Dienste dar, die Sie als Teil Ihrer Anwendung konfigurieren und anfordern.</span><span class="sxs-lookup"><span data-stu-id="525b9-266">Request Services represent the services you configure and request as part of your application.</span></span> <span data-ttu-id="525b9-267">Wenn Ihre Objekte Abhängigkeiten angeben, werden diese von den in `RequestServices`, nicht in `ApplicationServices`, gefundenen Typen erfüllt.</span><span class="sxs-lookup"><span data-stu-id="525b9-267">When your objects specify dependencies, these are satisfied by the types found in `RequestServices`, not `ApplicationServices`.</span></span>

<span data-ttu-id="525b9-268">Im Allgemeinen sollten Sie diese Eigenschaften nicht direkt verwenden. Fordern Sie stattdessen lieber die Typen der erforderlichen Klassen über den Konstruktor Ihrer Klasse an, und lassen Sie diese Abhängigkeiten über das Framework einfügen.</span><span class="sxs-lookup"><span data-stu-id="525b9-268">Generally, you shouldn't use these properties directly, preferring instead to request the types your classes you require via your class's constructor, and letting the framework inject these dependencies.</span></span> <span data-ttu-id="525b9-269">Dadurch werden Klassen angehalten, die leichter getestet werden können (siehe [Testen und Debuggen](xref:testing/index)) und loser gekoppelt sind.</span><span class="sxs-lookup"><span data-stu-id="525b9-269">This yields classes that are easier to test (see [Test and debug](xref:testing/index)) and are more loosely coupled.</span></span>

> [!NOTE]
> <span data-ttu-id="525b9-270">Fordern Sie für den Zugriff auf die `RequestServices`-Sammlung Abhängigkeiten lieber als Konstruktorparameter an.</span><span class="sxs-lookup"><span data-stu-id="525b9-270">Prefer requesting dependencies as constructor parameters to accessing the `RequestServices` collection.</span></span>

## <a name="designing-services-for-dependency-injection"></a><span data-ttu-id="525b9-271">Entwerfen von Diensten für Dependency Injection</span><span class="sxs-lookup"><span data-stu-id="525b9-271">Designing services for dependency injection</span></span>

<span data-ttu-id="525b9-272">Sie sollten Ihre Dienste so entwerfen, dass Dependency Injection zum Abrufen ihrer Projektmitarbeiter verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="525b9-272">You should design your services to use dependency injection to get their collaborators.</span></span> <span data-ttu-id="525b9-273">Dies bedeutet, dass die Verwendung zustandsbehafteter statischer Methodenaufrufe (die zu einem Code-Smell führen, auch bekannt als [Static Cling (statischer Zusammenhang)](http://deviq.com/static-cling/)) und die direkte Instanziierung abhängiger Klassen innerhalb Ihrer Dienste vermieden werden sollten.</span><span class="sxs-lookup"><span data-stu-id="525b9-273">This means avoiding the use of stateful static method calls (which result in a code smell known as [static cling](http://deviq.com/static-cling/)) and the direct instantiation of dependent classes within your services.</span></span> <span data-ttu-id="525b9-274">Es kann hilfreich sein, bei der Entscheidung, ob ein Typ instanziiert oder über Dependency Injection angefordert werden soll, an den Merksatz [New is Glue](https://ardalis.com/new-is-glue) („New“ hält besser) zu denken.</span><span class="sxs-lookup"><span data-stu-id="525b9-274">It may help to remember the phrase, [New is Glue](https://ardalis.com/new-is-glue), when choosing whether to instantiate a type or to request it via dependency injection.</span></span> <span data-ttu-id="525b9-275">Indem Sie den [SOLID-Grundsätzen für objektorientiertes Design](http://deviq.com/solid/) folgen, tendieren Ihre Klassen auf natürliche Weise dazu, klein und gut gestaltet zu sein und ohne großen Aufwand getestet werden zu können.</span><span class="sxs-lookup"><span data-stu-id="525b9-275">By following the [SOLID Principles of Object Oriented Design](http://deviq.com/solid/), your classes will naturally tend to be small, well-factored, and easily tested.</span></span>

<span data-ttu-id="525b9-276">Was geschieht, wenn Sie den Eindruck haben, dass in Ihre Klassen tendenziell zu viele Abhängigkeiten eingefügt werden?</span><span class="sxs-lookup"><span data-stu-id="525b9-276">What if you find that your classes tend to have way too many dependencies being injected?</span></span> <span data-ttu-id="525b9-277">Dies ist im Allgemeinen ein Zeichen dafür, dass Ihre Klasse versucht, zu viele Vorgänge durchzuführen, und gegen das SRP, das [Single-Responsibility-Prinzip](http://deviq.com/single-responsibility-principle/), verstößt.</span><span class="sxs-lookup"><span data-stu-id="525b9-277">This is generally a sign that your class is trying to do too much, and is probably violating SRP - the [Single Responsibility Principle](http://deviq.com/single-responsibility-principle/).</span></span> <span data-ttu-id="525b9-278">Versuchen Sie, die Klasse umzugestalten, indem Sie einige ihrer Aufgaben in eine neue Klasse verschieben.</span><span class="sxs-lookup"><span data-stu-id="525b9-278">See if you can refactor the class by moving some of its responsibilities into a new class.</span></span> <span data-ttu-id="525b9-279">Denken Sie daran, dass der Schwerpunkt Ihrer `Controller`-Klassen auf Problemen der Benutzeroberfläche liegen sollte. Daher sollten Geschäftsregeln und Implementierungsdetails für den Datenzugriff in für diese [separaten Probleme](http://deviq.com/separation-of-concerns/) angemessenen Klassen enthalten sein.</span><span class="sxs-lookup"><span data-stu-id="525b9-279">Keep in mind that your `Controller` classes should be focused on UI concerns, so business rules and data access implementation details should be kept in classes appropriate to these [separate concerns](http://deviq.com/separation-of-concerns/).</span></span>

<span data-ttu-id="525b9-280">Insbesondere im Hinblick auf den Datenzugriff können Sie den `DbContext` in Ihre Controller einfügen (vorausgesetzt, Sie haben in `ConfigureServices` Entity Framwork zum Dienstcontainer hinzugefügt).</span><span class="sxs-lookup"><span data-stu-id="525b9-280">With regards to data access specifically, you can inject the `DbContext` into your controllers (assuming you've added EF to the services container in `ConfigureServices`).</span></span> <span data-ttu-id="525b9-281">Einige Entwickler bevorzugen die Verwendung einer Repository-Schnittstelle für die Datenbank, statt den `DbContext` direkt einzufügen.</span><span class="sxs-lookup"><span data-stu-id="525b9-281">Some developers prefer to use a repository interface to the database rather than injecting the `DbContext` directly.</span></span> <span data-ttu-id="525b9-282">Durch die Verwendung einer Schnittstelle zum Einschließen der Datenzugriffslogik an einer Stelle kann die Anzahl der Stellen minimiert werden, die bei Änderungen Ihrer Datenbank geändert werden müssen.</span><span class="sxs-lookup"><span data-stu-id="525b9-282">Using an interface to encapsulate the data access logic in one place can minimize how many places you will have to change when your database changes.</span></span>

### <a name="disposing-of-services"></a><span data-ttu-id="525b9-283">Freigeben von Diensten</span><span class="sxs-lookup"><span data-stu-id="525b9-283">Disposing of services</span></span>

<span data-ttu-id="525b9-284">Der Container ruft `Dispose` für die erstellten `IDisposable`-Typen auf.</span><span class="sxs-lookup"><span data-stu-id="525b9-284">The container will call `Dispose` for `IDisposable` types it creates.</span></span> <span data-ttu-id="525b9-285">Wenn Sie jedoch selbst eine Instanz zum Container hinzufügen, wird diese nicht freigegeben.</span><span class="sxs-lookup"><span data-stu-id="525b9-285">However, if you add an instance to the container yourself, it will not be disposed.</span></span>

<span data-ttu-id="525b9-286">Beispiel:</span><span class="sxs-lookup"><span data-stu-id="525b9-286">Example:</span></span>

```csharp
// Services implement IDisposable:
public class Service1 : IDisposable {}
public class Service2 : IDisposable {}
public class Service3 : IDisposable {}

public interface ISomeService {}
public class SomeServiceImplementation : ISomeService, IDisposable {}


public void ConfigureServices(IServiceCollection services)
{
    // container will create the instance(s) of these types and will dispose them
    services.AddScoped<Service1>();
    services.AddSingleton<Service2>();
    services.AddSingleton<ISomeService>(sp => new SomeServiceImplementation());

    // container didn't create instance so it will NOT dispose it
    services.AddSingleton<Service3>(new Service3());
    services.AddSingleton(new Service3());
}
```

> [!NOTE]
> <span data-ttu-id="525b9-287">In Version 1.0 hat der Container für *alle* `IDisposable`-Objekte, einschließlich der nicht von ihm erstellten Objekte, „Dispose“ aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="525b9-287">In version 1.0, the container called dispose on *all* `IDisposable` objects, including those it didn't create.</span></span>

## <a name="replacing-the-default-services-container"></a><span data-ttu-id="525b9-288">Ersetzen der Standarddienstcontainer</span><span class="sxs-lookup"><span data-stu-id="525b9-288">Replacing the default services container</span></span>

<span data-ttu-id="525b9-289">Der integrierte Dienstcontainer dient dazu, die grundlegenden Anforderungen des Frameworks und der meisten darin integrierten Consumeranwendungen zu erfüllen.</span><span class="sxs-lookup"><span data-stu-id="525b9-289">The built-in services container is meant to serve the basic needs of the framework and most consumer applications built on it.</span></span> <span data-ttu-id="525b9-290">Entwickler können den integrierten Container jedoch durch ihren bevorzugten Container ersetzen.</span><span class="sxs-lookup"><span data-stu-id="525b9-290">However, developers can replace the built-in container with their preferred container.</span></span> <span data-ttu-id="525b9-291">Bei der Methode `ConfigureServices` wird in der Regel `void` zurückgegeben. Wenn ihre Signatur jedoch so geändert wird, dass `IServiceProvider` zurückgegeben wird, kann ein anderer Container konfiguriert und zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="525b9-291">The `ConfigureServices` method typically returns `void`, but if its signature is changed to return `IServiceProvider`, a different container can be configured and returned.</span></span> <span data-ttu-id="525b9-292">Für .NET sind viele IOC-Container verfügbar.</span><span class="sxs-lookup"><span data-stu-id="525b9-292">There are many IOC containers available for .NET.</span></span> <span data-ttu-id="525b9-293">In diesem Beispiel wird das Paket [Autofac](https://autofac.org/) verwendet.</span><span class="sxs-lookup"><span data-stu-id="525b9-293">In this example, the [Autofac](https://autofac.org/) package is used.</span></span>

<span data-ttu-id="525b9-294">Installieren Sie zunächst das entsprechende Containerpaket bzw. die entsprechenden Containerpakete:</span><span class="sxs-lookup"><span data-stu-id="525b9-294">First, install the appropriate container package(s):</span></span>

* `Autofac`
* `Autofac.Extensions.DependencyInjection`

<span data-ttu-id="525b9-295">Konfigurieren Sie als Nächstes den Container in `ConfigureServices`, und geben Sie einen `IServiceProvider` zurück:</span><span class="sxs-lookup"><span data-stu-id="525b9-295">Next, configure the container in `ConfigureServices` and return an `IServiceProvider`:</span></span>

```csharp
public IServiceProvider ConfigureServices(IServiceCollection services)
{
    services.AddMvc();
    // Add other framework services

    // Add Autofac
    var containerBuilder = new ContainerBuilder();
    containerBuilder.RegisterModule<DefaultModule>();
    containerBuilder.Populate(services);
    var container = containerBuilder.Build();
    return new AutofacServiceProvider(container);
}
```

> [!NOTE]
> <span data-ttu-id="525b9-296">Wenn Sie den Dependency Injection-Container eines Drittanbieters verwenden, müssen Sie `ConfigureServices` so ändern, dass `IServiceProvider` anstelle von `void` zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="525b9-296">When using a third-party DI container, you must change `ConfigureServices` so that it returns `IServiceProvider` instead of `void`.</span></span>

<span data-ttu-id="525b9-297">Konfigurieren Sie Autofac abschließend wie gewohnt in `DefaultModule`:</span><span class="sxs-lookup"><span data-stu-id="525b9-297">Finally, configure Autofac as normal in `DefaultModule`:</span></span>

```csharp
public class DefaultModule : Module
{
    protected override void Load(ContainerBuilder builder)
    {
        builder.RegisterType<CharacterRepository>().As<ICharacterRepository>();
    }
}
```

<span data-ttu-id="525b9-298">Zur Laufzeit wird Autofac zum Auflösen von Typen und Einfügen von Abhängigkeiten verwendet.</span><span class="sxs-lookup"><span data-stu-id="525b9-298">At runtime, Autofac will be used to resolve types and inject dependencies.</span></span> <span data-ttu-id="525b9-299">[Weitere Informationen zur Verwendung von Autofac und ASP.NET Core](http://docs.autofac.org/en/latest/integration/aspnetcore.html).</span><span class="sxs-lookup"><span data-stu-id="525b9-299">[Learn more about using Autofac and ASP.NET Core](http://docs.autofac.org/en/latest/integration/aspnetcore.html).</span></span>

### <a name="thread-safety"></a><span data-ttu-id="525b9-300">Threadsicherheit</span><span class="sxs-lookup"><span data-stu-id="525b9-300">Thread safety</span></span>

<span data-ttu-id="525b9-301">Singleton-Dienste müssen threadsicher sein.</span><span class="sxs-lookup"><span data-stu-id="525b9-301">Singleton services need to be thread safe.</span></span> <span data-ttu-id="525b9-302">Wenn ein Singleton-Dienst eine Abhängigkeit von einem vorübergehenden Dienst aufweist, muss der vorübergehende Dienst abhängig von der Verwendungsweise durch den Singleton-Dienst ebenfalls threadsicher sein.</span><span class="sxs-lookup"><span data-stu-id="525b9-302">If a singleton service has a dependency on a transient service, the transient service may also need to be thread safe depending how it's used by the singleton.</span></span>

## <a name="recommendations"></a><span data-ttu-id="525b9-303">Empfehlungen</span><span class="sxs-lookup"><span data-stu-id="525b9-303">Recommendations</span></span>

<span data-ttu-id="525b9-304">Beachten Sie folgende Empfehlungen bei der Arbeit mit Dependency Injection:</span><span class="sxs-lookup"><span data-stu-id="525b9-304">When working with dependency injection, keep the following recommendations in mind:</span></span>

* <span data-ttu-id="525b9-305">Dependency Injection ist für Objekte mit komplexen Abhängigkeiten bestimmt.</span><span class="sxs-lookup"><span data-stu-id="525b9-305">DI is for objects that have complex dependencies.</span></span> <span data-ttu-id="525b9-306">Controller, Dienste, Adapter und Repositorys sind alles Beispiele für Objekte, die zu Dependency Injection hinzugefügt werden könnten.</span><span class="sxs-lookup"><span data-stu-id="525b9-306">Controllers, services, adapters, and repositories are all examples of objects that might be added to DI.</span></span>

* <span data-ttu-id="525b9-307">Vermeiden Sie das Speichern von Daten und die direkte Konfiguration in Dependency Injection.</span><span class="sxs-lookup"><span data-stu-id="525b9-307">Avoid storing data and configuration directly in DI.</span></span> <span data-ttu-id="525b9-308">Der Einkaufswagen eines Benutzers sollte z.B. normalerweise nicht zum Dienstcontainer hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="525b9-308">For example, a user's shopping cart shouldn't typically be added to the services container.</span></span> <span data-ttu-id="525b9-309">Bei der Konfiguration sollte das [Optionsmuster](xref:fundamentals/configuration/options) verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="525b9-309">Configuration should use the [options pattern](xref:fundamentals/configuration/options).</span></span> <span data-ttu-id="525b9-310">Gleichermaßen sollten Sie „Datencontainer“-Objekte vermeiden, die nur vorhanden sind, um den Zugriff auf einige andere Objekte zuzulassen.</span><span class="sxs-lookup"><span data-stu-id="525b9-310">Similarly, avoid "data holder" objects that only exist to allow access to some other object.</span></span> <span data-ttu-id="525b9-311">Wenn möglich, sollte dass tatsächlich benötige Element besser über Dependency Injection angefordert werden.</span><span class="sxs-lookup"><span data-stu-id="525b9-311">It's better to request the actual item needed via DI, if possible.</span></span>

* <span data-ttu-id="525b9-312">Vermeiden Sie statischen Zugriff auf Dienste.</span><span class="sxs-lookup"><span data-stu-id="525b9-312">Avoid static access to services.</span></span>

* <span data-ttu-id="525b9-313">Vermeiden Sie die Dienstidentifizierung in Ihrem Anwendungscode.</span><span class="sxs-lookup"><span data-stu-id="525b9-313">Avoid service location in your application code.</span></span>

* <span data-ttu-id="525b9-314">Vermeiden Sie statischen Zugriff auf `HttpContext`.</span><span class="sxs-lookup"><span data-stu-id="525b9-314">Avoid static access to `HttpContext`.</span></span>

<span data-ttu-id="525b9-315">Wie bei allen Empfehlungen treffen Sie möglicherweise auf Situationen, in denen eine der Empfehlungen ignoriert werden muss.</span><span class="sxs-lookup"><span data-stu-id="525b9-315">Like all sets of recommendations, you may encounter situations where ignoring one is required.</span></span> <span data-ttu-id="525b9-316">Es gibt nur wenige Ausnahmen, die sich meistens auf ganz besondere Fälle innerhalb des Frameworks selbst beziehen.</span><span class="sxs-lookup"><span data-stu-id="525b9-316">We have found exceptions to be rare -- mostly very special cases within the framework itself.</span></span>

<span data-ttu-id="525b9-317">Dependency Injection stellt eine *Alternative* zu statischen bzw. globalen Objektzugriffsmustern dar.</span><span class="sxs-lookup"><span data-stu-id="525b9-317">Dependency injection is an *alternative* to static/global object access patterns.</span></span> <span data-ttu-id="525b9-318">Sie werden keinen Nutzen aus der Dependency Injection ziehen können, wenn Sie diese mit dem Zugriff auf statische Objekte kombinieren.</span><span class="sxs-lookup"><span data-stu-id="525b9-318">You may not be able to realize the benefits of DI if you mix it with static object access.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="525b9-319">Zusätzliche Ressourcen</span><span class="sxs-lookup"><span data-stu-id="525b9-319">Additional resources</span></span>

* [<span data-ttu-id="525b9-320">Abhängigkeitsinjektion in Ansichten</span><span class="sxs-lookup"><span data-stu-id="525b9-320">Dependency injection into views</span></span>](xref:mvc/views/dependency-injection)
* [<span data-ttu-id="525b9-321">Abhängigkeitsinjektion in Controller</span><span class="sxs-lookup"><span data-stu-id="525b9-321">Dependency injection into controllers</span></span>](xref:mvc/controllers/dependency-injection)
* [<span data-ttu-id="525b9-322">Abhängigkeitsinjektion in Anforderungshandlern</span><span class="sxs-lookup"><span data-stu-id="525b9-322">Dependency injection in requirement handlers</span></span>](xref:security/authorization/dependencyinjection)
* [<span data-ttu-id="525b9-323">Application Startup (Starten von Anwendungen)</span><span class="sxs-lookup"><span data-stu-id="525b9-323">Application Startup</span></span>](xref:fundamentals/startup)
* [<span data-ttu-id="525b9-324">Testen und Debuggen</span><span class="sxs-lookup"><span data-stu-id="525b9-324">Test and debug</span></span>](xref:testing/index)
* [<span data-ttu-id="525b9-325">Factorybezogene Middlewareaktivierung</span><span class="sxs-lookup"><span data-stu-id="525b9-325">Factory-based middleware activation</span></span>](xref:fundamentals/middleware/extensibility)
* [<span data-ttu-id="525b9-326">Schreiben von sauberem Code in ASP.NET Core über Dependency Injection (MSDN)</span><span class="sxs-lookup"><span data-stu-id="525b9-326">Writing Clean Code in ASP.NET Core with Dependency Injection (MSDN)</span></span>](https://msdn.microsoft.com/magazine/mt703433.aspx)
* [<span data-ttu-id="525b9-327">Entwurf einer mit Containern verwalteten Anwendung, Einleitung: Welche Zugehörigkeit hat der Container?</span><span class="sxs-lookup"><span data-stu-id="525b9-327">Container-Managed Application Design, Prelude: Where does the Container Belong?</span></span>](https://blogs.msdn.microsoft.com/nblumhardt/2008/12/26/container-managed-application-design-prelude-where-does-the-container-belong/)
* [<span data-ttu-id="525b9-328">Prinzip der expliziten Abhängigkeiten</span><span class="sxs-lookup"><span data-stu-id="525b9-328">Explicit Dependencies Principle</span></span>](http://deviq.com/explicit-dependencies-principle/)
* <span data-ttu-id="525b9-329">[Die Umkehrung von Steuerelementcontainern und das Dependency Injection-Muster](https://www.martinfowler.com/articles/injection.html) (Fowler)</span><span class="sxs-lookup"><span data-stu-id="525b9-329">[Inversion of Control Containers and the Dependency Injection Pattern](https://www.martinfowler.com/articles/injection.html) (Fowler)</span></span>
