---
uid: web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/using-parameterized-queries-with-the-sqldatasource-vb
title: Verwenden parametrisierte Abfragen mit der SqlDataSource (VB) | Microsoft Docs
author: rick-anderson
description: "In diesem Lernprogramm haben wir unsere Betrachtung der SqlDataSource-Steuerelement fortfahren und erfahren Sie, wie parametrisierte Abfragen zu definieren. Die Parameter können angegeben werden, beide Decla..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/20/2007
ms.topic: article
ms.assetid: e322f34c-83b7-41ea-ab65-ab1e0bdcc609
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/using-parameterized-queries-with-the-sqldatasource-vb
msc.type: authoredcontent
ms.openlocfilehash: 1a56990c87c1faa93612dcca0732ee789078dfe2
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/10/2017
---
<a name="using-parameterized-queries-with-the-sqldatasource-vb"></a><span data-ttu-id="74f00-104">Verwenden parametrisierte Abfragen mit der SqlDataSource (VB)</span><span class="sxs-lookup"><span data-stu-id="74f00-104">Using Parameterized Queries with the SqlDataSource (VB)</span></span>
====================
<span data-ttu-id="74f00-105">durch [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="74f00-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="74f00-106">[Beispiel-App herunterladen](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_48_VB.exe) oder [PDF herunterladen](using-parameterized-queries-with-the-sqldatasource-vb/_static/datatutorial48vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="74f00-106">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_48_VB.exe) or [Download PDF](using-parameterized-queries-with-the-sqldatasource-vb/_static/datatutorial48vb1.pdf)</span></span>

> <span data-ttu-id="74f00-107">In diesem Lernprogramm haben wir unsere Betrachtung der SqlDataSource-Steuerelement fortfahren und erfahren Sie, wie parametrisierte Abfragen zu definieren.</span><span class="sxs-lookup"><span data-stu-id="74f00-107">In this tutorial, we continue our look at the SqlDataSource control and learn how to define parameterized queries.</span></span> <span data-ttu-id="74f00-108">Der Parameter können sowohl deklarativ und programmgesteuert angegeben werden und können von mehreren Standorten wie die Abfragezeichenfolge, Session State, andere Steuerelemente und vieles mehr abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="74f00-108">The parameters can be specified both declaratively and programmatically, and can be pulled from a number of locations such as the querystring, Session state, other controls, and more.</span></span>


## <a name="introduction"></a><span data-ttu-id="74f00-109">Einführung</span><span class="sxs-lookup"><span data-stu-id="74f00-109">Introduction</span></span>

<span data-ttu-id="74f00-110">Im vorherigen Lernprogramm wurde erläutert, wie die SqlDataSource-Steuerelement verwenden, um Daten direkt aus einer Datenbank abzurufen.</span><span class="sxs-lookup"><span data-stu-id="74f00-110">In the previous tutorial we saw how to use the SqlDataSource control to retrieve data directly from a database.</span></span> <span data-ttu-id="74f00-111">Mit dem Konfigurieren von Datenquellen-Assistenten können wir die Datenbank aus, und klicken Sie dann entweder auswählen: Wählen Sie die Spalten aus einer Tabelle oder Sicht; zurückgegeben. Geben Sie eine benutzerdefinierte SQL­Anweisung aus. oder verwenden Sie eine gespeicherte Prozedur.</span><span class="sxs-lookup"><span data-stu-id="74f00-111">Using the Configure Data Source wizard, we could choose the database and then either: pick the columns to return from a table or view; enter a custom SQL statement; or use a stored procedure.</span></span> <span data-ttu-id="74f00-112">Ob die Auswahl von Spalten aus einer Tabelle oder Sicht, oder Sie eine benutzerdefinierte SQL­Anweisung eingeben, die SqlDataSource s steuern `SelectCommand` Eigenschaft erhält die resultierende Ad-hoc-SQL `SELECT` -Anweisung, und es ist dies `SELECT` Anweisung, die ausgeführt wird, wenn die SqlDataSource s `Select()` Methode aufgerufen wird (entweder programmgesteuert oder automatisch aus einem Websteuerelement).</span><span class="sxs-lookup"><span data-stu-id="74f00-112">Whether selecting columns from a table or view or entering a custom SQL statement, the SqlDataSource control s `SelectCommand` property is assigned the resulting ad-hoc SQL `SELECT` statement and it is this `SELECT` statement that is executed when the SqlDataSource s `Select()` method is invoked (either programmatically or automatically from a data Web control).</span></span>

<span data-ttu-id="74f00-113">Die SQL `SELECT` -Anweisungen in der vorherigen Lernprogramm s Demos fehlte `WHERE` Klauseln.</span><span class="sxs-lookup"><span data-stu-id="74f00-113">The SQL `SELECT` statements used in the previous tutorial s demos lacked `WHERE` clauses.</span></span> <span data-ttu-id="74f00-114">In einem `SELECT` -Anweisung, die `WHERE` -Klausel kann verwendet werden, um die zurückgegebenen Ergebnisse zu begrenzen.</span><span class="sxs-lookup"><span data-stu-id="74f00-114">In a `SELECT` statement, the `WHERE` clause can be used to limit the results returned.</span></span> <span data-ttu-id="74f00-115">Um die Namen von Produkten, die mehr als 50,00 $ Kostenberechnungen anzuzeigen, könnten wir z. B. die folgende Abfrage verwenden:</span><span class="sxs-lookup"><span data-stu-id="74f00-115">For example, to display the names of products costing more than $50.00, we could use the following query:</span></span>


[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-vb/samples/sample1.sql)]

<span data-ttu-id="74f00-116">In der Regel die Werte, die in verwendet eine `WHERE` Klausel werden von einer externen Quelle, z. B. eine Querystring-Wert, Sitzungsvariablen oder eine Benutzereingabe aus einem Webserver-Steuerelement auf der Seite zu bestimmen.</span><span class="sxs-lookup"><span data-stu-id="74f00-116">Typically, the values used in a `WHERE` clause are determine by some external source, such as a querystring value, a session variable, or user input from a Web control on the page.</span></span> <span data-ttu-id="74f00-117">Im Idealfall werden diese Eingaben mithilfe des angegeben *Parameter*.</span><span class="sxs-lookup"><span data-stu-id="74f00-117">Ideally, such inputs are specified through the use of *parameters*.</span></span> <span data-ttu-id="74f00-118">Mit Microsoft SQL Server, werden Parameter angegeben, mit `@parameterName`, z. B.:</span><span class="sxs-lookup"><span data-stu-id="74f00-118">With Microsoft SQL Server, parameters are denoted using `@parameterName`, as in:</span></span>


[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-vb/samples/sample2.sql)]

<span data-ttu-id="74f00-119">Die ': SqlDataSource unterstützt parametrisierte Abfragen, sowohl für `SELECT` Anweisungen und `INSERT`, `UPDATE`, und `DELETE` Anweisungen.</span><span class="sxs-lookup"><span data-stu-id="74f00-119">The SqlDataSource supports parameterized queries, both for `SELECT` statements and `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="74f00-120">Darüber hinaus die Parameterwerte können automatisch abgerufen werden aus einer Vielzahl von Quellen die Abfragezeichenfolge, Sitzungszustand, Steuerelemente auf der Seite usw. und programmgesteuert zugewiesen werden können.</span><span class="sxs-lookup"><span data-stu-id="74f00-120">Moreover, the parameter values can be automatically pulled from a variety of sources the querystring, session state, controls on the page, and so on or can be assigned programmatically.</span></span> <span data-ttu-id="74f00-121">In diesem Lernprogramm sehen wir, wie parametrisierte Abfragen auch definiert, wie zum Angeben des Parameters deklarativ und programmgesteuert Werte.</span><span class="sxs-lookup"><span data-stu-id="74f00-121">In this tutorial, we'll see how to define parameterized queries as well as how to specify the parameter values both declaratively and programmatically.</span></span>

> [!NOTE]
> <span data-ttu-id="74f00-122">Im vorherigen Lernprogramm verglichen wir das ObjectDataSource, unserem Werkzeug Wahl über die ersten 46 Lernprogramme mit dem SqlDataSource, beachten Sie die konzeptionellen Ähnlichkeit wurde.</span><span class="sxs-lookup"><span data-stu-id="74f00-122">In the previous tutorial we compared the ObjectDataSource which has been our tool of choice over the first 46 tutorials with the SqlDataSource, noting their conceptual similarities.</span></span> <span data-ttu-id="74f00-123">Diese ähnlichkeiten erweitern auch Parameter.</span><span class="sxs-lookup"><span data-stu-id="74f00-123">These similarities also extend to parameters.</span></span> <span data-ttu-id="74f00-124">Die ObjectDataSource s-Parameter, die Eingabeparameter für Methoden in der Business Logic Layer zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="74f00-124">The ObjectDataSource s parameters mapped to the input parameters for the methods in the Business Logic Layer.</span></span> <span data-ttu-id="74f00-125">Die Parameter sind mit den SqlDataSource direkt in die SQL-Abfrage definiert.</span><span class="sxs-lookup"><span data-stu-id="74f00-125">With the SqlDataSource, the parameters are defined directly within the SQL query.</span></span> <span data-ttu-id="74f00-126">Beide Steuerelemente sind Auflistungen von Parametern für ihre `Select()`, `Insert()`, `Update()`, und `Delete()` Methoden, und beide können diese Parameterwerte aus vordefinierten Quellen (Querystring-Werte, Sitzungsvariablen usw. aufgefüllt haben ) oder programmgesteuert zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="74f00-126">Both controls have collections of parameters for their `Select()`, `Insert()`, `Update()`, and `Delete()` methods, and both can have these parameter values populated from pre-defined sources (querystring values, session variables, and so on) or assigned programmatically.</span></span>


## <a name="creating-a-parameterized-query"></a><span data-ttu-id="74f00-127">Erstellen einer parametrisierten Abfrage</span><span class="sxs-lookup"><span data-stu-id="74f00-127">Creating a Parameterized Query</span></span>

<span data-ttu-id="74f00-128">Die ': SqlDataSource-Steuerelement-Assistent zum Konfigurieren von Datenquellen der s bietet drei Möglichkeiten zum Definieren des Befehls zum Abrufen von Datenbankdatensätzen ausführen:</span><span class="sxs-lookup"><span data-stu-id="74f00-128">The SqlDataSource control s Configure Data Source wizard offers three avenues for defining the command to execute to retrieve database records:</span></span>

- <span data-ttu-id="74f00-129">Durch Entnahme von Spalten aus einer vorhandenen Tabelle oder Sicht,</span><span class="sxs-lookup"><span data-stu-id="74f00-129">By picking the columns from an existing table or view,</span></span>
- <span data-ttu-id="74f00-130">Indem Sie eine benutzerdefinierte SQL­Anweisung eingeben oder</span><span class="sxs-lookup"><span data-stu-id="74f00-130">By entering a custom SQL statement, or</span></span>
- <span data-ttu-id="74f00-131">Durch Auswahl einer gespeicherten Prozedur</span><span class="sxs-lookup"><span data-stu-id="74f00-131">By choosing a stored procedure</span></span>

<span data-ttu-id="74f00-132">Wenn Spalten aus einer vorhandenen Tabelle oder Sicht, die Parameter für die Entnahme der `WHERE` -Klausel muss angegeben werden, durch das Hinzufügen `WHERE` Dialogfeld '-Klausel.</span><span class="sxs-lookup"><span data-stu-id="74f00-132">When picking columns from an existing table or view, the parameters for the `WHERE` clause must be specified through the Add `WHERE` Clause dialog box.</span></span> <span data-ttu-id="74f00-133">Wenn Sie eine benutzerdefinierte SQL­Anweisung zu erstellen, aber Sie können Geben Sie die Parameter direkt in die `WHERE` -Klausel (mit `@parameterName` um jeden Parameter zu bezeichnen).</span><span class="sxs-lookup"><span data-stu-id="74f00-133">When creating a custom SQL statement, however, you can enter the parameters directly into the `WHERE` clause (using `@parameterName` to denote each parameter).</span></span> <span data-ttu-id="74f00-134">Ein [gespeicherte Prozedur](http://www.awprofessional.com/articles/article.asp?p=25288&amp;rl=1) besteht aus einem oder mehreren SQL-Anweisungen, und diese Anweisungen können parametrisiert sein.</span><span class="sxs-lookup"><span data-stu-id="74f00-134">A [stored procedure](http://www.awprofessional.com/articles/article.asp?p=25288&amp;rl=1) consists of one or more SQL statements, and these statements can be parameterized.</span></span> <span data-ttu-id="74f00-135">Die in der SQL-Anweisung verwendeten Parameter müssen allerdings in als Eingabeparameter an die gespeicherte Prozedur übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="74f00-135">The parameters used in the SQL statements, however, must be passed in as input parameters to the stored procedure.</span></span>

<span data-ttu-id="74f00-136">Da erstellen eine parametrisierte Abfrage wie voraussetzt SqlDataSource s `SelectCommand` wird angegeben, so können s sehen Sie alle drei Ansätze.</span><span class="sxs-lookup"><span data-stu-id="74f00-136">Since creating a parameterized query depends on how the SqlDataSource s `SelectCommand` is specified, let s take a look at all three approaches.</span></span> <span data-ttu-id="74f00-137">Öffnen Sie zum Einstieg die `ParameterizedQueries.aspx` auf der Seite der `SqlDataSource` Ordner ein SqlDataSource-Steuerelement aus der Toolbox in den Designer ziehen, und legen Sie dessen `ID` auf `Products25BucksAndUnderDataSource`.</span><span class="sxs-lookup"><span data-stu-id="74f00-137">To get started, open the `ParameterizedQueries.aspx` page in the `SqlDataSource` folder, drag a SqlDataSource control from the Toolbox onto the Designer, and set its `ID` to `Products25BucksAndUnderDataSource`.</span></span> <span data-ttu-id="74f00-138">Klicken Sie dann auf den Link "Datenquelle konfigurieren" aus dem Steuerelement s Smarttag.</span><span class="sxs-lookup"><span data-stu-id="74f00-138">Next, click the Configure Data Source link from the control s smart tag.</span></span> <span data-ttu-id="74f00-139">Wählen Sie die zu verwendende Datenbank (`NORTHWINDConnectionString`), und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="74f00-139">Select the database to use (`NORTHWINDConnectionString`) and click Next.</span></span>

## <a name="step-1-adding-awhereclause-when-picking-the-columns-from-a-table-or-view"></a><span data-ttu-id="74f00-140">Schritt 1: Hinzufügen einer`WHERE`-Klausel, wenn die Spalten aus einer Tabelle oder Sicht auswählen</span><span class="sxs-lookup"><span data-stu-id="74f00-140">Step 1: Adding a`WHERE`Clause When Picking the Columns from a Table or View</span></span>

<span data-ttu-id="74f00-141">Bei der Auswahl der Daten mit SqlDataSource-Steuerelement aus der Datenbank zurückgeben, ermöglicht das Konfigurieren von Datenquellen-Assistenten uns, wählen Sie einfach die Spalten aus einer vorhandenen Tabelle zurückzugeben oder anzeigen (siehe Abbildung 1).</span><span class="sxs-lookup"><span data-stu-id="74f00-141">When selecting the data to return from the database with the SqlDataSource control, the Configure Data Source wizard allows us to simply pick the columns to return from an existing table or view (see Figure 1).</span></span> <span data-ttu-id="74f00-142">Auf diese Weise automatisch erstellt, eine SQL `SELECT` -Anweisung, die die Datenbank gesendeten ist bei der SqlDataSource-s `Select()` Methode wird aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="74f00-142">Doing so automatically builds up a SQL `SELECT` statement, which is what is sent to the database when the SqlDataSource s `Select()` method is invoked.</span></span> <span data-ttu-id="74f00-143">Wie wir im vorherigen Lernprogramm ausgeführt haben, wählen Sie die Products-Tabelle aus der Dropdown-Liste, und Überprüfen der `ProductID`, `ProductName`, und `UnitPrice` Spalten.</span><span class="sxs-lookup"><span data-stu-id="74f00-143">As we did in the previous tutorial, select the Products table from the drop-down list and check the `ProductID`, `ProductName`, and `UnitPrice` columns.</span></span>


<span data-ttu-id="74f00-144">[![Wählen Sie die Spalten aus einer Tabelle oder Sicht zurückgegeben.](using-parameterized-queries-with-the-sqldatasource-vb/_static/image1.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="74f00-144">[![Pick the Columns to Return from a Table or View](using-parameterized-queries-with-the-sqldatasource-vb/_static/image1.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image1.png)</span></span>

<span data-ttu-id="74f00-145">**Abbildung 1**: die Spalten auswählen, um die Rückgabe aus einer Tabelle oder Sicht ([klicken Sie hier, um das Bild in voller Größe angezeigt](using-parameterized-queries-with-the-sqldatasource-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="74f00-145">**Figure 1**: Pick the Columns to Return from a Table or View ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-vb/_static/image2.png))</span></span>


<span data-ttu-id="74f00-146">Einschließen einer `WHERE` -Klausel in der `SELECT` -Anweisung, klicken Sie auf die `WHERE` Schaltfläche untergebracht oben hinzufügen `WHERE` Klausel Dialogfeld (siehe Abbildung 2).</span><span class="sxs-lookup"><span data-stu-id="74f00-146">To include a `WHERE` clause in the `SELECT` statement, click the `WHERE` button, which brings up the Add `WHERE` Clause dialog box (see Figure 2).</span></span> <span data-ttu-id="74f00-147">Hinzufügen ein Parameters, um die von der zurückgegebenen Ergebnisse zu begrenzen der `SELECT` abzufragen, wählen Sie zuerst die Spalte, die die Daten nach filtern.</span><span class="sxs-lookup"><span data-stu-id="74f00-147">To add a parameter to limit the results returned by the `SELECT` query, first choose the column to filter the data by.</span></span> <span data-ttu-id="74f00-148">Als nächstes wählen Sie den Operator zum Filtern (=, &lt;, &lt;=, &gt;usw.).</span><span class="sxs-lookup"><span data-stu-id="74f00-148">Next, choose the operator to use for filtering (=, &lt;, &lt;=, &gt;, and so on).</span></span> <span data-ttu-id="74f00-149">Wählen Sie abschließend die Quelle des Parameterwerts s wie z. B. aus dem Zustand Querystring oder Sitzung.</span><span class="sxs-lookup"><span data-stu-id="74f00-149">Finally, choose the source of the parameter s value, such as from the querystring or session state.</span></span> <span data-ttu-id="74f00-150">Klicken Sie nach dem Konfigurieren des Parameters an, auf die Schaltfläche "hinzufügen" Einbeziehung in die `SELECT` Abfrage.</span><span class="sxs-lookup"><span data-stu-id="74f00-150">After configuring the parameter, click the Add button to include it in the `SELECT` query.</span></span>

<span data-ttu-id="74f00-151">In diesem Beispiel können s nur diese Ergebnisse zurückgeben, in denen die `UnitPrice` Wert ist kleiner als oder gleich 25,00.</span><span class="sxs-lookup"><span data-stu-id="74f00-151">For this example, let s only return those results where the `UnitPrice` value is less than or equal to $25.00.</span></span> <span data-ttu-id="74f00-152">Wählen Sie aus diesem Grund `UnitPrice` aus der Dropdown-Spaltenliste und &lt;= aus der Dropdownliste Operator.</span><span class="sxs-lookup"><span data-stu-id="74f00-152">Therefore, pick `UnitPrice` from the Column drop-down list and &lt;= from the Operator drop-down list.</span></span> <span data-ttu-id="74f00-153">Bei Verwendung von hartcodierten Parameterwert (z. B. 25,00), oder wenn der Parameterwert ist programmgesteuert angegeben werden, wählen Sie keine aus der Dropdown-Quellliste.</span><span class="sxs-lookup"><span data-stu-id="74f00-153">When using a hard-coded parameter value (such as $25.00) or if the parameter value is to be specified programmatically, select None from the Source drop-down list.</span></span> <span data-ttu-id="74f00-154">Als Nächstes geben Sie den hartcodierten Parameterwert im Textfeld Wert 25,00 aus, und schließen Sie den Prozess, indem Sie auf die Schaltfläche "hinzufügen".</span><span class="sxs-lookup"><span data-stu-id="74f00-154">Next, enter the hard-coded parameter value in the Value textbox 25.00 and complete the process by clicking the Add button.</span></span>


<span data-ttu-id="74f00-155">[![Begrenzen der zurückgegebenen Ergebnisse der hinzufügen WHERE-Klausel (Dialogfeld)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image2.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="74f00-155">[![Limit the Results Returned from the Add WHERE Clause Dialog Box](using-parameterized-queries-with-the-sqldatasource-vb/_static/image2.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image3.png)</span></span>

<span data-ttu-id="74f00-156">**Abbildung 2**: Einschränken der Ergebnisse zurückgegeben hinzufügen `WHERE` -Klausel (Dialogfeld) ([klicken Sie hier, um das Bild in voller Größe angezeigt](using-parameterized-queries-with-the-sqldatasource-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="74f00-156">**Figure 2**: Limit the Results Returned from the Add `WHERE` Clause Dialog Box ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-vb/_static/image4.png))</span></span>


<span data-ttu-id="74f00-157">Klicken Sie nachdem der Parameter hinzugefügt wurde auf OK, um beim Konfigurieren von Datenquellen-Assistenten zurückzukehren.</span><span class="sxs-lookup"><span data-stu-id="74f00-157">After adding the parameter, click OK to return to the Configure Data Source wizard.</span></span> <span data-ttu-id="74f00-158">Die `SELECT` -Anweisung am Ende des Assistenten enthalten sollte nun eine `WHERE` -Klausel mit einem Parameter namens `@UnitPrice`:</span><span class="sxs-lookup"><span data-stu-id="74f00-158">The `SELECT` statement at the bottom of the wizard should now include a `WHERE` clause with a parameter named `@UnitPrice`:</span></span>


[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-vb/samples/sample3.sql)]

> [!NOTE]
> <span data-ttu-id="74f00-159">Wenn Sie angeben, dass mehrere Bedingungen in der `WHERE` Klausel hinzufügen `WHERE` Dialogfeld '-Klausel, um der Assistenten verknüpft sie mit der `AND` Operator.</span><span class="sxs-lookup"><span data-stu-id="74f00-159">If you specify multiple conditions in the `WHERE` clause from the Add `WHERE` Clause dialog box, the wizard joins them with the `AND` operator.</span></span> <span data-ttu-id="74f00-160">Wenn Sie müssen eine `OR` in der `WHERE` -Klausel (z. B. `WHERE UnitPrice <= @UnitPrice OR Discontinued = 1`) müssen Sie erstellen die `SELECT` -Anweisung über den Bildschirm der benutzerdefinierten SQL-Anweisung.</span><span class="sxs-lookup"><span data-stu-id="74f00-160">If you need to include an `OR` in the `WHERE` clause (such as `WHERE UnitPrice <= @UnitPrice OR Discontinued = 1`) then you have to build the `SELECT` statement through the custom SQL statement screen.</span></span>


<span data-ttu-id="74f00-161">Abzuschließen Sie die SqlDataSource (klicken Sie auf Weiter und beenden) Konfiguration, und überprüfen Sie dann das deklarative SqlDataSource-s-Markup.</span><span class="sxs-lookup"><span data-stu-id="74f00-161">Complete configuring the SqlDataSource (click Next, then Finish) and then inspect the SqlDataSource s declarative markup.</span></span> <span data-ttu-id="74f00-162">Das Markup enthält jetzt eine `<SelectParameters>` -Auflistung, die ausgeschrieben Quellen für die Parameter in der `SelectCommand`.</span><span class="sxs-lookup"><span data-stu-id="74f00-162">The markup now includes a `<SelectParameters>` collection, which spells out the sources for the parameters in the `SelectCommand`.</span></span>


[!code-aspx[Main](using-parameterized-queries-with-the-sqldatasource-vb/samples/sample4.aspx)]

<span data-ttu-id="74f00-163">Wenn die SqlDataSource-s `Select()` Methode wird aufgerufen, die `UnitPrice` Parameterwert (25,00) wird angewendet, um die `@UnitPrice` Parameter in der `SelectCommand` vor dem Senden an die Datenbank.</span><span class="sxs-lookup"><span data-stu-id="74f00-163">When the SqlDataSource s `Select()` method is invoked, the `UnitPrice` parameter value (25.00) is applied to the `@UnitPrice` parameter in the `SelectCommand` before being sent to the database.</span></span> <span data-ttu-id="74f00-164">Das Ergebnis ist, dass nur die Produkte, die kleiner oder gleich 25,00 werden zurückgegeben, aus der `Products` Tabelle.</span><span class="sxs-lookup"><span data-stu-id="74f00-164">The net result is that only those products less than or equal to $25.00 are returned from the `Products` table.</span></span> <span data-ttu-id="74f00-165">Vergewissern Sie sich hierzu hinzuzufügen GridView auf der Seite, auf diese Datenquelle zu binden Sie und zeigen Sie dann auf der Seite über einen Browser.</span><span class="sxs-lookup"><span data-stu-id="74f00-165">To confirm this, add a GridView to the page, bind it to this data source, and then view the page through a browser.</span></span> <span data-ttu-id="74f00-166">Sie sollten nur aufgeführten Produkte angezeigt, die kleiner oder gleich 25,00, wie in Abbildung 3 bestätigt werden.</span><span class="sxs-lookup"><span data-stu-id="74f00-166">You should only see those products listed that are less than or equal to $25.00, as Figure 3 confirms.</span></span>


<span data-ttu-id="74f00-167">[![Nur solche Produkte kleiner oder gleich dem 25,00 werden angezeigt.](using-parameterized-queries-with-the-sqldatasource-vb/_static/image3.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="74f00-167">[![Only Those Products Less Than or Equal to $25.00 are Displayed](using-parameterized-queries-with-the-sqldatasource-vb/_static/image3.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image5.png)</span></span>

<span data-ttu-id="74f00-168">**Abbildung 3**: nur solche Produkte kleiner oder gleich dem 25,00 angezeigt werden ([klicken Sie hier, um das Bild in voller Größe angezeigt](using-parameterized-queries-with-the-sqldatasource-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="74f00-168">**Figure 3**: Only Those Products Less Than or Equal to $25.00 are Displayed ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-vb/_static/image6.png))</span></span>


## <a name="step-2-adding-parameters-to-a-custom-sql-statement"></a><span data-ttu-id="74f00-169">Schritt 2: Hinzufügen von Parametern an eine benutzerdefinierte SQL-Anweisung</span><span class="sxs-lookup"><span data-stu-id="74f00-169">Step 2: Adding Parameters to a Custom SQL Statement</span></span>

<span data-ttu-id="74f00-170">Beim Hinzufügen einer benutzerdefinierten SQL-Anweisung können Sie geben die `WHERE` Klausel explizit, oder geben Sie einen Wert in der Zelle Filter den Abfrage-Generator.</span><span class="sxs-lookup"><span data-stu-id="74f00-170">When adding a custom SQL statement you can enter the `WHERE` clause explicitly or specify a value in the Filter cell of the Query Builder.</span></span> <span data-ttu-id="74f00-171">Um dies zu demonstrieren, können Sie s, die nur die Produkte in einer GridView anzeigen, deren Preis unter einen bestimmten Schwellenwert liegen.</span><span class="sxs-lookup"><span data-stu-id="74f00-171">To demonstrate this, let s display just those products in a GridView whose prices are less than a certain threshold.</span></span> <span data-ttu-id="74f00-172">Durch Hinzufügen eines Textfelds zum Starten der `ParameterizedQueries.aspx` Seite, um diesen Schwellenwert vom Benutzer zu erfassen.</span><span class="sxs-lookup"><span data-stu-id="74f00-172">Start by adding a TextBox to the `ParameterizedQueries.aspx` page to collect this threshold value from the user.</span></span> <span data-ttu-id="74f00-173">Legen Sie das Textfeld s `ID` Eigenschaft `MaxPrice`.</span><span class="sxs-lookup"><span data-stu-id="74f00-173">Set the TextBox s `ID` property to `MaxPrice`.</span></span> <span data-ttu-id="74f00-174">Fügen Sie ein Websteuerelement Schaltfläche hinzu, und legen Sie dessen `Text` Eigenschaft, um übereinstimmende Produkte angezeigt.</span><span class="sxs-lookup"><span data-stu-id="74f00-174">Add a Button Web control and set its `Text` property to Display Matching Products .</span></span>

<span data-ttu-id="74f00-175">Als Nächstes eine GridView auf die Seite ziehen, und wählen Sie das Smarttag, erstellen Sie eine neue, mit dem Namen ': SqlDataSource `ProductsFilteredByPriceDataSource`.</span><span class="sxs-lookup"><span data-stu-id="74f00-175">Next, drag a GridView onto the page and from its smart tag choose to create a new SqlDataSource named `ProductsFilteredByPriceDataSource`.</span></span> <span data-ttu-id="74f00-176">Aus dem Konfigurieren von Datenquellen-Assistenten fortfahren die angeben, an eine benutzerdefinierte SQL-Anweisung oder gespeicherte Prozedur Bildschirm (siehe Abbildung 4), und geben Sie die folgende Abfrage:</span><span class="sxs-lookup"><span data-stu-id="74f00-176">From the Configure Data Source wizard, proceed to the Specify a custom SQL statement or stored procedure screen (see Figure 4) and enter the following query:</span></span>


[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-vb/samples/sample5.sql)]

<span data-ttu-id="74f00-177">Klicken Sie nachdem Sie die Abfrage eingegeben haben (entweder manuell oder über den Abfrage-Generator) auf "Weiter".</span><span class="sxs-lookup"><span data-stu-id="74f00-177">After entering the query (either manually or through the Query Builder), click Next.</span></span>


<span data-ttu-id="74f00-178">[![Nur solche Produkte zurück kleiner oder gleich einem Parameterwert](using-parameterized-queries-with-the-sqldatasource-vb/_static/image4.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="74f00-178">[![Return Only Those Products Less Than or Equal to a Parameter Value](using-parameterized-queries-with-the-sqldatasource-vb/_static/image4.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image7.png)</span></span>

<span data-ttu-id="74f00-179">**Abbildung 4**: Zurückgeben nur solche Produkte kleiner oder gleich dem Parameterwert ([klicken Sie hier, um das Bild in voller Größe angezeigt](using-parameterized-queries-with-the-sqldatasource-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="74f00-179">**Figure 4**: Return Only Those Products Less Than or Equal to a Parameter Value ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-vb/_static/image8.png))</span></span>


<span data-ttu-id="74f00-180">Da die Abfrage Parameter enthält, werden aufgefordert, dem nächsten Bildschirm des Assistenten uns für die Quelle der Parameterwerte.</span><span class="sxs-lookup"><span data-stu-id="74f00-180">Since the query includes parameters, the next screen in the wizard prompts us for the source of the parameters values.</span></span> <span data-ttu-id="74f00-181">Wählen Sie aus der Parameterliste für Quelle Dropdown-Steuerelement und `MaxPrice` (dem TextBox-Steuerelement s `ID` Wert) aus der ControlID Dropdown-Liste.</span><span class="sxs-lookup"><span data-stu-id="74f00-181">Choose Control from the Parameter source drop-down list and `MaxPrice` (the TextBox control s `ID` value) from the ControlID drop-down list.</span></span> <span data-ttu-id="74f00-182">Sie können auch einen Optionaler Standardwert in die Groß-/Kleinschreibung verwendet, in denen der Benutzer verfügt über Text in nicht eingegeben, Eingeben der `MaxPrice` Textfeld.</span><span class="sxs-lookup"><span data-stu-id="74f00-182">You can also enter an optional default value to use in the case where the user has not entered any text into the `MaxPrice` TextBox.</span></span> <span data-ttu-id="74f00-183">Geben Sie für die zurzeit keinen Standardwert ein.</span><span class="sxs-lookup"><span data-stu-id="74f00-183">For the time being, do not enter a default value.</span></span>


<span data-ttu-id="74f00-184">[![Die MaxPrice TextBox-s-Text-Eigenschaft wird als Quelle für Parameter verwendet.](using-parameterized-queries-with-the-sqldatasource-vb/_static/image5.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="74f00-184">[![The MaxPrice TextBox s Text Property is Used as the Parameter Source](using-parameterized-queries-with-the-sqldatasource-vb/_static/image5.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image9.png)</span></span>

<span data-ttu-id="74f00-185">**Abbildung 5**: die `MaxPrice` Textfeld s `Text` Eigenschaft dient als Quelle für Parameter ([klicken Sie hier, um das Bild in voller Größe angezeigt](using-parameterized-queries-with-the-sqldatasource-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="74f00-185">**Figure 5**: The `MaxPrice` TextBox s `Text` Property is Used as the Parameter Source ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-vb/_static/image10.png))</span></span>


<span data-ttu-id="74f00-186">Schließen Sie den Assistenten für die Datenquelle konfigurieren, indem Sie auf Weiter, dann auf Fertig stellen.</span><span class="sxs-lookup"><span data-stu-id="74f00-186">Complete the Configure Data Source wizard by clicking Next, then Finish.</span></span> <span data-ttu-id="74f00-187">Das deklarative Markup für die GridView, Textfeld, Schaltfläche und SqlDataSource lautet folgendermaßen:</span><span class="sxs-lookup"><span data-stu-id="74f00-187">The declarative markup for the GridView, TextBox, Button, and SqlDataSource follows:</span></span>


[!code-aspx[Main](using-parameterized-queries-with-the-sqldatasource-vb/samples/sample6.aspx)]

<span data-ttu-id="74f00-188">Beachten Sie, dass dem Parameter innerhalb der SqlDataSource s `<SelectParameters>` Abschnitt ist eine `ControlParameter`, darunter zusätzliche Eigenschaften wie `ControlID` und `PropertyName`.</span><span class="sxs-lookup"><span data-stu-id="74f00-188">Note that the parameter within the SqlDataSource s `<SelectParameters>` section is a `ControlParameter`, which includes additional properties like `ControlID` and `PropertyName`.</span></span> <span data-ttu-id="74f00-189">Wenn die SqlDataSource-s `Select()` Methode wird aufgerufen, die `ControlParameter` grabs den Wert aus der angegebenen Eigenschaft für die Web-Steuerelements und weist ihn dem entsprechenden Parameter in der `SelectCommand`.</span><span class="sxs-lookup"><span data-stu-id="74f00-189">When the SqlDataSource s `Select()` method is invoked, the `ControlParameter` grabs the value from the specified Web control property and assigns it to the corresponding parameter in the `SelectCommand`.</span></span> <span data-ttu-id="74f00-190">In diesem Beispiel wird die `MaxPrice` Text-Eigenschaft wird verwendet, als die `@MaxPrice` Parameterwert.</span><span class="sxs-lookup"><span data-stu-id="74f00-190">In this example, the `MaxPrice` s Text property is used as the `@MaxPrice` parameter value.</span></span>

<span data-ttu-id="74f00-191">Nehmen Sie zum Anzeigen dieser Seite über einen Browser an.</span><span class="sxs-lookup"><span data-stu-id="74f00-191">Take a minute to view this page through a browser.</span></span> <span data-ttu-id="74f00-192">Beim ersten Seite besuchen, oder wenn die `MaxPrice` TextBox verfügt nicht über einen Wert, der keine Datensätze in der GridView angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="74f00-192">When first visiting the page or whenever the `MaxPrice` TextBox lacks a value no records are displayed in the GridView.</span></span>


<span data-ttu-id="74f00-193">[![Sind keine Datensätze angezeigt, wenn die MaxPrice Textfeld leer ist.](using-parameterized-queries-with-the-sqldatasource-vb/_static/image6.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="74f00-193">[![No Records are Displayed When the MaxPrice TextBox is Empty](using-parameterized-queries-with-the-sqldatasource-vb/_static/image6.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image11.png)</span></span>

<span data-ttu-id="74f00-194">**Abbildung 6**: keine Datensätze werden angezeigt, wenn die `MaxPrice` Textfeld ist leer ([klicken Sie hier, um das Bild in voller Größe angezeigt](using-parameterized-queries-with-the-sqldatasource-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="74f00-194">**Figure 6**: No Records are Displayed When the `MaxPrice` TextBox is Empty ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-vb/_static/image12.png))</span></span>


<span data-ttu-id="74f00-195">Der Grund sind keine Produkte angezeigt liegt daran, dass standardmäßig eine leere Zeichenfolge für einen Parameterwert in einer Datenbank konvertiert wird `NULL` Wert.</span><span class="sxs-lookup"><span data-stu-id="74f00-195">The reason no products are shown is because, by default, an empty string for a parameter value is converted into a database `NULL` value.</span></span> <span data-ttu-id="74f00-196">Da der Vergleich von `[UnitPrice] <= NULL` ergibt immer als "false", werden keine Ergebnisse zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="74f00-196">Since the comparison of `[UnitPrice] <= NULL` always evaluates as False, no results are returned.</span></span>

<span data-ttu-id="74f00-197">Geben Sie einen Wert in das Textfeld ein, z. B. 5,00, und klicken Sie auf die Schaltfläche mit den übereinstimmenden Produkte angezeigt.</span><span class="sxs-lookup"><span data-stu-id="74f00-197">Enter a value into the textbox, like 5.00, and click the Display Matching Products button.</span></span> <span data-ttu-id="74f00-198">Beim Postback informiert die SqlDataSource an die GridView, dass eine der Quellen Parameter geändert wurde.</span><span class="sxs-lookup"><span data-stu-id="74f00-198">On postback, the SqlDataSource informs the GridView that one of its parameter sources has changed.</span></span> <span data-ttu-id="74f00-199">Folglich bindet die GridView, die ': SqlDataSource dieser Produkte kleiner oder gleich $5,00 angezeigt.</span><span class="sxs-lookup"><span data-stu-id="74f00-199">Consequently, the GridView rebinds to the SqlDataSource, displaying those products less than or equal to $5.00.</span></span>


<span data-ttu-id="74f00-200">[![Produkte kleiner oder gleich dem $5,00 werden angezeigt.](using-parameterized-queries-with-the-sqldatasource-vb/_static/image7.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="74f00-200">[![Products Less Than or Equal to $5.00 are Displayed](using-parameterized-queries-with-the-sqldatasource-vb/_static/image7.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image13.png)</span></span>

<span data-ttu-id="74f00-201">**Abbildung 7**: Produkte kleiner oder gleich $5,00 angezeigt werden ([klicken Sie hier, um das Bild in voller Größe angezeigt](using-parameterized-queries-with-the-sqldatasource-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="74f00-201">**Figure 7**: Products Less Than or Equal to $5.00 are Displayed ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-vb/_static/image14.png))</span></span>


## <a name="initially-displaying-all-products"></a><span data-ttu-id="74f00-202">Anfänglich anzeigen alle Produkte</span><span class="sxs-lookup"><span data-stu-id="74f00-202">Initially Displaying All Products</span></span>

<span data-ttu-id="74f00-203">Anstatt zum Anzeigen von keine Produkte beim ersten Laden der Seite "wird möglicherweise angezeigt werden soll *alle* Produkte.</span><span class="sxs-lookup"><span data-stu-id="74f00-203">Rather than displaying no products when the page is first loaded, we may want to display *all* products.</span></span> <span data-ttu-id="74f00-204">Eine Möglichkeit zum Auflisten aller Produkte immer die `MaxPrice` Textfeld leer ist der Standardwert des Parameters s auf einigen können, ausgesprochen hohen Wert festgelegt wie 1000000, da es 1.000.000 $ s unwahrscheinlich, dass Northwind Traders wird jemals, deren Preis pro Einheit inventarisiert wurden überschreitet.</span><span class="sxs-lookup"><span data-stu-id="74f00-204">One way to list all products whenever the `MaxPrice` TextBox is empty is to set the parameter s default value to some insanely high value, like 1000000, since it s unlikely that Northwind Traders will ever have inventory whose unit price exceeds $1,000,000.</span></span> <span data-ttu-id="74f00-205">Dieser Ansatz ist Ansichtsweise allerdings und funktionieren ggf. nicht in anderen Situationen.</span><span class="sxs-lookup"><span data-stu-id="74f00-205">However, this approach is shortsighted and might not work in other situations.</span></span>

<span data-ttu-id="74f00-206">In vorherigen Lernprogrammen - [deklarative Parameter](../basic-reporting/declarative-parameters-vb.md) und [Master/Detail-Filtern mit einer DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) wir ein ähnliches Problem Kundenangebote wurden.</span><span class="sxs-lookup"><span data-stu-id="74f00-206">In previous tutorials - [Declarative Parameters](../basic-reporting/declarative-parameters-vb.md) and [Master/Detail Filtering With a DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) we were faced with a similar problem.</span></span> <span data-ttu-id="74f00-207">Unsere Lösung vorhanden war, diese Logik in der Business Logic Layer eingefügt werden soll.</span><span class="sxs-lookup"><span data-stu-id="74f00-207">Our solution there was to put this logic in the Business Logic Layer.</span></span> <span data-ttu-id="74f00-208">Insbesondere die BLL den eingehenden Wert überprüft und, wenn es war `NULL` oder einige reservierte Wert, der Aufruf an die DAL-Methode, die alle Datensätze zurückgegeben weitergeleitet wurde.</span><span class="sxs-lookup"><span data-stu-id="74f00-208">Specifically, the BLL examined the incoming value and, if it was `NULL` or some reserved value, the call was routed to the DAL method that returned all records.</span></span> <span data-ttu-id="74f00-209">Wenn der eingehende Wert einer normalen Filterwert war, eine Puffermethode wurde an die DAL-Methode, die eine SQL-Anweisung ausgeführt, die eine parametrisierte verwendet `WHERE` -Klausel mit den angegebenen Wert.</span><span class="sxs-lookup"><span data-stu-id="74f00-209">If the incoming value was a normal filtering value, a call was made to the DAL method that executed a SQL statement that used a parameterized `WHERE` clause with the supplied value.</span></span>

<span data-ttu-id="74f00-210">Leider umgehen wir die Architektur auf, wenn die SqlDataSource verwenden.</span><span class="sxs-lookup"><span data-stu-id="74f00-210">Unfortunately, we bypass the architecture when using the SqlDataSource.</span></span> <span data-ttu-id="74f00-211">Stattdessen müssen wir anpassen, die SQL-Anweisung aus, um alle Datensätze und beziehen Sie bei der `@MaximumPrice` Parameter ist `NULL` oder einige reservierten Wert.</span><span class="sxs-lookup"><span data-stu-id="74f00-211">Instead, we need to customize the SQL statement to intelligently grab all records if the `@MaximumPrice` parameter is `NULL` or some reserved value.</span></span> <span data-ttu-id="74f00-212">Für diese Übung Let s haben sie daher, auch wenn die `@MaximumPrice` -Parameters `-1.0`, klicken Sie dann *alle* Datensätze zurückgegeben werden sollen (`-1.0` fungiert als ein reservierter Wert an, da kein Produkt eine Negative aufweisenkann`UnitPrice`Wert).</span><span class="sxs-lookup"><span data-stu-id="74f00-212">For this exercise, let s have it so that if the `@MaximumPrice` parameter is equal to `-1.0`, then *all* of the records are to be returned (`-1.0` works as a reserved value since no product can have a negative `UnitPrice` value).</span></span> <span data-ttu-id="74f00-213">Um dies zu erreichen, können wir die folgende SQL-Anweisung verwenden:</span><span class="sxs-lookup"><span data-stu-id="74f00-213">To accomplish this we can use the following SQL statement:</span></span>


[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-vb/samples/sample7.sql)]

<span data-ttu-id="74f00-214">Dies `WHERE` -Klausel zurück *alle* aufgezeichnet, wenn die `@MaximumPrice` entspricht `-1.0`.</span><span class="sxs-lookup"><span data-stu-id="74f00-214">This `WHERE` clause returns *all* records if the `@MaximumPrice` parameter equals `-1.0`.</span></span> <span data-ttu-id="74f00-215">Der Parameterwert ist nicht `-1.0`, nur die Produkte, deren `UnitPrice` ist kleiner als oder gleich der `@MaximumPrice` Parameterwert zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="74f00-215">If the parameter value is not `-1.0`, only those products whose `UnitPrice` is less than or equal to the `@MaximumPrice` parameter value are returned.</span></span> <span data-ttu-id="74f00-216">Durch Festlegen des Standardwerts der `@MaximumPrice` Parameter `-1.0`, beim ersten Laden der Seite (oder wenn die `MaxPrice` Textfeld leer ist), `@MaximumPrice` ein Wert von `-1.0` und alle Produkte angezeigt.</span><span class="sxs-lookup"><span data-stu-id="74f00-216">By setting the default value of the `@MaximumPrice` parameter to `-1.0`, on the first page load (or whenever the `MaxPrice` TextBox is empty), `@MaximumPrice` will have a value of `-1.0` and all products will be displayed.</span></span>


<span data-ttu-id="74f00-217">[![Nun alle Produkte werden ist angezeigt, wenn die MaxPrice Textfeld leer.](using-parameterized-queries-with-the-sqldatasource-vb/_static/image8.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="74f00-217">[![Now All Products are Displayed When the MaxPrice TextBox is Empty](using-parameterized-queries-with-the-sqldatasource-vb/_static/image8.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image15.png)</span></span>

<span data-ttu-id="74f00-218">**Abbildung 8**: jetzt alle Produkte werden angezeigt, wenn die `MaxPrice` Textfeld ist leer ([klicken Sie hier, um das Bild in voller Größe angezeigt](using-parameterized-queries-with-the-sqldatasource-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="74f00-218">**Figure 8**: Now All Products are Displayed When the `MaxPrice` TextBox is Empty ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-vb/_static/image16.png))</span></span>


<span data-ttu-id="74f00-219">Es gibt eine Reihe von Vorsichtsmaßnahmen beachten Sie bei diesem Ansatz.</span><span class="sxs-lookup"><span data-stu-id="74f00-219">There are a couple of caveats to note with this approach.</span></span> <span data-ttu-id="74f00-220">Beachten Sie zunächst, dass die s-Parameterdatentyp von ihr abgeleitet wird s-Verwendung in der SQL-Abfrage.</span><span class="sxs-lookup"><span data-stu-id="74f00-220">First, realize that the parameter s data type is inferred by it s usage in the SQL query.</span></span> <span data-ttu-id="74f00-221">Wenn Sie ändern die `WHERE` -Klausel aus `@MaximumPrice = -1.0` zu `@MaximumPrice = -1`, behandelt die Runtime den Parameter als ganze Zahl.</span><span class="sxs-lookup"><span data-stu-id="74f00-221">If you change the `WHERE` clause from `@MaximumPrice = -1.0` to `@MaximumPrice = -1`, the runtime treats the parameter as an integer.</span></span> <span data-ttu-id="74f00-222">Wenn Sie dann versuchen, weisen Sie die `MaxPrice` Textfeld in einen Dezimalwert (z. B. 5,00), da er 5,00 in eine ganze Zahl konvertieren kann, wird eine Fehlermeldung angezeigt.</span><span class="sxs-lookup"><span data-stu-id="74f00-222">If you then attempt to assign the `MaxPrice` TextBox to a decimal value (like 5.00 ), an error will occur because it cannot convert 5.00 to an integer.</span></span> <span data-ttu-id="74f00-223">Zur Behebung des Problems, nehmen Sie sich, dass Sie `@MaximumPrice = -1.0` in der `WHERE` -Klausel oder besser noch, legen Sie die `ControlParameter` s-Objekt `Type` Eigenschaft in eine Dezimalzahl.</span><span class="sxs-lookup"><span data-stu-id="74f00-223">To remedy this, either make sure that you use `@MaximumPrice = -1.0` in the `WHERE` clause or, better yet, set the `ControlParameter` object s `Type` property to Decimal .</span></span>

<span data-ttu-id="74f00-224">Zweitens können durch Hinzufügen der `OR @MaximumPrice = -1.0` auf die `WHERE` -Klausel das Abfragemodul kann nicht verwenden, einen Index auf `UnitPrice` (sofern eine vorhanden), wodurch Tabellensuche.</span><span class="sxs-lookup"><span data-stu-id="74f00-224">Secondly, by adding the `OR @MaximumPrice = -1.0` to the `WHERE` clause, the query engine cannot use an index on `UnitPrice` (assuming one exists), thereby resulting in a table scan.</span></span> <span data-ttu-id="74f00-225">Dadurch kann die Leistung beeinträchtigen, wenn es eine ausreichend große Anzahl von Datensätzen in gibt der `Products` Tabelle.</span><span class="sxs-lookup"><span data-stu-id="74f00-225">This can impact performance if there are a sufficiently large number of records in the `Products` table.</span></span> <span data-ttu-id="74f00-226">Ein besserer Ansatz wäre, diese Logik in einer gespeicherten Prozedur zu verschieben, in dem ein `IF` Anweisung würde entweder auszuführen. eine `SELECT` Abfrage aus der `Products` Tabelle ohne einen `WHERE` -Klausel, wenn alle Datensätze zurückgegeben werden müssen oder eine, deren `WHERE` -Klausel enthält nur die `UnitPrice` Kriterien, so, dass ein Index verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="74f00-226">A better approach would be to move this logic to a stored procedure where an `IF` statement would either perform a `SELECT` query from the `Products` table without a `WHERE` clause when all records need to be returned or one whose `WHERE` clause contains just the `UnitPrice` criteria, so that an index can be used.</span></span>

## <a name="step-3-creating-and-using-parameterized-stored-procedures"></a><span data-ttu-id="74f00-227">Schritt 3: Erstellen und verwenden parametrisierte gespeicherte Prozeduren</span><span class="sxs-lookup"><span data-stu-id="74f00-227">Step 3: Creating and Using Parameterized Stored Procedures</span></span>

<span data-ttu-id="74f00-228">Gespeicherte Prozeduren beinhalten einen Satz von Eingabeparametern, die dann verwendet werden können, in die SQL-Anweisungen, die in der gespeicherten Prozedur definiert.</span><span class="sxs-lookup"><span data-stu-id="74f00-228">Stored procedures can include a set of input parameters that can then be used in the SQL statement(s) defined within the stored procedure.</span></span> <span data-ttu-id="74f00-229">Beim Konfigurieren der SqlDataSource um eine gespeicherte Prozedur verwenden, die Eingabeparameter akzeptiert, können diese Parameterwerte mit den gleichen Verfahren wie bei Ad-hoc-SQL-Anweisungen angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="74f00-229">When configuring the SqlDataSource to use a stored procedure that accepts input parameters, these parameter values can be specified using the same techniques as with ad-hoc SQL statements.</span></span>

<span data-ttu-id="74f00-230">Zur Veranschaulichung der Verwendung von gespeicherten Prozeduren in der ': SqlDataSource Let s, erstellen Sie eine neue gespeicherte Prozedur in der Northwind-Datenbank mit dem Namen `GetProductsByCategory`, der akzeptiert eines Parameters namens `@CategoryID` und gibt alle Spalten der Produkte zurück, dessen `CategoryID` entspricht der Spalte `@CategoryID`.</span><span class="sxs-lookup"><span data-stu-id="74f00-230">To illustrate using stored procedures in the SqlDataSource, let s create a new stored procedure in the Northwind database named `GetProductsByCategory`, which accepts a parameter named `@CategoryID` and returns all of the columns of the products whose `CategoryID` column matches `@CategoryID`.</span></span> <span data-ttu-id="74f00-231">Um eine gespeicherte Prozedur zu erstellen, wechseln Sie zu dem Server-Explorer und Drilldown in die `NORTHWND.MDF` Datenbank.</span><span class="sxs-lookup"><span data-stu-id="74f00-231">To create a stored procedure, go to the Server Explorer and drill down into the `NORTHWND.MDF` database.</span></span> <span data-ttu-id="74f00-232">(Wenn Sie Ich möchte den Server-Explorer angezeigt wird, schalten Sie ihn von indem Sie im Menü "Ansicht" aufrufen und dabei die Option Server-Explorer.)</span><span class="sxs-lookup"><span data-stu-id="74f00-232">(If you don t see the Server Explorer, bring it up by going to the View menu and selecting the Server Explorer option.)</span></span>

<span data-ttu-id="74f00-233">Aus der `NORTHWND.MDF` -Datenbank mit der rechten Maustaste auf den Ordner gespeicherte Prozeduren, wählen Sie die neue gespeicherte Prozedur hinzufügen, und geben Sie die folgende Syntax:</span><span class="sxs-lookup"><span data-stu-id="74f00-233">From the `NORTHWND.MDF` database, right-click on the Stored Procedures folder, choose Add New Stored Procedure, and enter the following syntax:</span></span>


[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-vb/samples/sample8.sql)]

<span data-ttu-id="74f00-234">Klicken Sie auf die speichern-Symbol (oder STRG + S) zum Speichern der gespeicherten Prozedur.</span><span class="sxs-lookup"><span data-stu-id="74f00-234">Click the Save icon (or Ctrl+S) to save the stored procedure.</span></span> <span data-ttu-id="74f00-235">Sie können die gespeicherte Prozedur testen, indem Sie mit der rechten Maustaste in den Ordner gespeicherte Prozeduren und Execute.</span><span class="sxs-lookup"><span data-stu-id="74f00-235">You can test the stored procedure by right-clicking it from the Stored Procedures folder and choosing Execute.</span></span> <span data-ttu-id="74f00-236">Daraufhin werden Sie aufgefordert, für die gespeicherte Prozedur s-Parameter (`@CategoryID`, in dieser Instanz), nach dem die Ergebnisse im Ausgabefenster angezeigt.</span><span class="sxs-lookup"><span data-stu-id="74f00-236">This will prompt you for the stored procedure s parameters (`@CategoryID`, in this instance), after which the results will be displayed in the Output window.</span></span>


<span data-ttu-id="74f00-237">[![Die GetProductsByCategory gespeicherte Prozedur bei der Ausführung einer @CategoryID 1](using-parameterized-queries-with-the-sqldatasource-vb/_static/image9.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="74f00-237">[![The GetProductsByCategory Stored Procedure when Executed with a @CategoryID of 1](using-parameterized-queries-with-the-sqldatasource-vb/_static/image9.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image17.png)</span></span>

<span data-ttu-id="74f00-238">**Abbildung 9**: die `GetProductsByCategory` gespeicherte Prozedur bei der Ausführung einer `@CategoryID` 1 ([klicken Sie hier, um das Bild in voller Größe angezeigt](using-parameterized-queries-with-the-sqldatasource-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="74f00-238">**Figure 9**: The `GetProductsByCategory` Stored Procedure when Executed with a `@CategoryID` of 1 ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-vb/_static/image18.png))</span></span>


<span data-ttu-id="74f00-239">Lassen Sie s, die diese gespeicherte Prozedur zu verwenden, um alle Produkte in der Kategorie "Getränke" in einem GridView anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="74f00-239">Let s use this stored procedure to display all products in the Beverages category in a GridView.</span></span> <span data-ttu-id="74f00-240">Die Seite neue GridView hinzu, und binden es an eine neue, mit dem Namen ': SqlDataSource `BeverageProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="74f00-240">Add a new GridView to the page and bind it to a new SqlDataSource named `BeverageProductsDataSource`.</span></span> <span data-ttu-id="74f00-241">Geben Sie eine benutzerdefinierte SQL-Anweisung oder gespeicherte Prozedur Bildschirm weiterhin, wählen Sie das Optionsfeld für gespeicherte Prozedur, und wählen die `GetProductsByCategory` gespeicherten Prozedur aus der Dropdown Liste.</span><span class="sxs-lookup"><span data-stu-id="74f00-241">Continue to the Specify a custom SQL statement or stored procedure screen, select the Stored procedure radio button, and pick the `GetProductsByCategory` stored procedure from the drop-down list.</span></span>


<span data-ttu-id="74f00-242">[![Wählen Sie die GetProductsByCategory gespeicherten Prozedur aus der Dropdown Liste](using-parameterized-queries-with-the-sqldatasource-vb/_static/image10.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="74f00-242">[![Select the GetProductsByCategory Stored Procedure from the Drop-Down List](using-parameterized-queries-with-the-sqldatasource-vb/_static/image10.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image19.png)</span></span>

<span data-ttu-id="74f00-243">**Abbildung 10**: Wählen Sie die `GetProductsByCategory` gespeicherte Prozedur aus der Dropdown-Liste ([klicken Sie hier, um das Bild in voller Größe angezeigt](using-parameterized-queries-with-the-sqldatasource-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="74f00-243">**Figure 10**: Select the `GetProductsByCategory` Stored Procedure from the Drop-Down List ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-vb/_static/image20.png))</span></span>


<span data-ttu-id="74f00-244">Da die gespeicherte Prozedur einen Eingabeparameter akzeptiert (`@CategoryID`), Sie auf Weiter, fordert Sie uns die Quelle für diesen Parameter-s-Wert angegeben.</span><span class="sxs-lookup"><span data-stu-id="74f00-244">Since the stored procedure accepts an input parameter (`@CategoryID`), clicking Next prompts us to specify the source for this parameter s value.</span></span> <span data-ttu-id="74f00-245">Die Getränke `CategoryID` 1 ist, so behalten Sie für keine der Quellliste Dropdown-Parameter, und geben Sie 1 in das Textfeld "DefaultValue".</span><span class="sxs-lookup"><span data-stu-id="74f00-245">The Beverages `CategoryID` is 1, so leave the Parameter source drop-down list at None and enter 1 into the DefaultValue textbox.</span></span>


<span data-ttu-id="74f00-246">[![Verwenden Sie den hartcodierten Wert 1 die Produkte in der Kategorie "Getränke" zurückgegeben](using-parameterized-queries-with-the-sqldatasource-vb/_static/image11.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="74f00-246">[![Use a Hard-Coded Value of 1 to Return the Products in the Beverages Category](using-parameterized-queries-with-the-sqldatasource-vb/_static/image11.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image21.png)</span></span>

<span data-ttu-id="74f00-247">**Abbildung 11**: Verwenden Sie die Produkte in der Kategorie "Getränke" zurückgegeben Hard-Coded Wert 1 ([klicken Sie hier, um das Bild in voller Größe angezeigt](using-parameterized-queries-with-the-sqldatasource-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="74f00-247">**Figure 11**: Use a Hard-Coded Value of 1 to Return the Products in the Beverages Category ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-vb/_static/image22.png))</span></span>


<span data-ttu-id="74f00-248">Wie im folgenden deklarativem Markup gezeigt, bei Verwendung einer gespeicherten Prozedur, die ': SqlDataSource-s `SelectCommand` Eigenschaft auf den Namen der gespeicherten Prozedur festgelegt ist und die [ `SelectCommandType` Eigenschaft](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.sqldatasource.selectcommandtype.aspx) festgelegt ist, um `StoredProcedure`gibt an, die die `SelectCommand` ist der Name einer gespeicherten Prozedur, statt eine Ad-hoc-SQL-Anweisung.</span><span class="sxs-lookup"><span data-stu-id="74f00-248">As the following declarative markup shows, when using a stored procedure, the SqlDataSource s `SelectCommand` property is set to the name of the stored procedure and the [`SelectCommandType` property](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.sqldatasource.selectcommandtype.aspx) is set to `StoredProcedure`, indicating that the `SelectCommand` is the name of a stored procedure rather than an ad-hoc SQL statement.</span></span>


[!code-aspx[Main](using-parameterized-queries-with-the-sqldatasource-vb/samples/sample9.aspx)]

<span data-ttu-id="74f00-249">Testen Sie die Seite in einem Browser aus.</span><span class="sxs-lookup"><span data-stu-id="74f00-249">Test out the page in a browser.</span></span> <span data-ttu-id="74f00-250">Nur die Produkte, die zur Kategorie "Getränke" gehören angezeigt, obwohl *alle* des Produkts werden Felder angezeigt, da die `GetProductsByCategory` gespeicherte Prozedur gibt alle Spalten aus der `Products` Tabelle.</span><span class="sxs-lookup"><span data-stu-id="74f00-250">Only those products that belong to the Beverages category are displayed, although *all* of the product fields are displayed since the `GetProductsByCategory` stored procedure returns all of the columns from the `Products` table.</span></span> <span data-ttu-id="74f00-251">Wir können natürlich einschränken oder passen Sie die Felder in der GridView aus dem GridView s Spalten bearbeiten-Dialogfeld angezeigt.</span><span class="sxs-lookup"><span data-stu-id="74f00-251">We could, of course, limit or customize the fields displayed in the GridView from the GridView s Edit Columns dialog box.</span></span>


<span data-ttu-id="74f00-252">[![Alle von Getränken werden angezeigt](using-parameterized-queries-with-the-sqldatasource-vb/_static/image12.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="74f00-252">[![All of the Beverages are Displayed](using-parameterized-queries-with-the-sqldatasource-vb/_static/image12.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image23.png)</span></span>

<span data-ttu-id="74f00-253">**Abbildung 12**: alle von Getränken werden angezeigt ([klicken Sie hier, um das Bild in voller Größe angezeigt](using-parameterized-queries-with-the-sqldatasource-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="74f00-253">**Figure 12**: All of the Beverages are Displayed ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-vb/_static/image24.png))</span></span>


## <a name="step-4-programmatically-invoking-a-sqldatasource-sselectstatement"></a><span data-ttu-id="74f00-254">Schritt 4: Programmgesteuerten Aufrufen SqlDataSource s`Select()`Anweisung</span><span class="sxs-lookup"><span data-stu-id="74f00-254">Step 4: Programmatically Invoking a SqlDataSource s`Select()`Statement</span></span>

<span data-ttu-id="74f00-255">In den Beispielen wird in der vorherigen und dieses Lernprogramms bisher vorgefundener Ve SqlDataSource-Steuerelemente direkt an die GridView gebunden haben.</span><span class="sxs-lookup"><span data-stu-id="74f00-255">The examples we ve seen in the previous tutorial and this tutorial so far have bound SqlDataSource controls directly to a GridView.</span></span> <span data-ttu-id="74f00-256">Die SqlDataSource-Steuerelement s-Daten, jedoch können programmgesteuert zugegriffen und aufgelistet, die im Code.</span><span class="sxs-lookup"><span data-stu-id="74f00-256">The SqlDataSource control s data, however, can be programmatically accessed and enumerated in code.</span></span> <span data-ttu-id="74f00-257">Dies kann besonders hilfreich sein, wenn Sie zum Abfragen von Daten benötigen, um es zu überprüfen, aber Don ' t müssen, um diese anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="74f00-257">This can be particularly useful when you need to query data to inspect it, but don t need to display it.</span></span> <span data-ttu-id="74f00-258">Anstatt aller der Textbaustein ADO.NET-Code zum Herstellen einer Verbindung mit der Datenbank und geben Sie den Befehl Abrufen der Ergebnisse zu schreiben, können Sie die SqlDataSource dieser monotonen Code behandeln lassen.</span><span class="sxs-lookup"><span data-stu-id="74f00-258">Rather than having to write all of the boilerplate ADO.NET code to connect to the database, specify the command, and retrieve the results, you can let the SqlDataSource handle this monotonous code.</span></span>

<span data-ttu-id="74f00-259">Zur Veranschaulichung der Arbeit mit dem SqlDataSource-s stellen Sie sich vor Daten programmgesteuert, dass Ihr Chef Sie mit einer Anforderung Tabellenpartitionierung wurde an eine Webseite erstellen, die den Namen einer zufällig ausgewählten Kategorie und seine zugehörigen Produkte anzeigt.</span><span class="sxs-lookup"><span data-stu-id="74f00-259">To illustrate working with the SqlDataSource s data programmatically, imagine that your boss has approached you with a request to create a web page that displays the name of a randomly selected category and its associated products.</span></span> <span data-ttu-id="74f00-260">D. h., wenn ein Benutzer auf dieser Seite besucht, wir nach dem Zufallsprinzip eine Kategorie aus auswählen möchten die `Categories` Tabelle, zeigen Sie den Namen der Kategorie und Listen Sie die Produkte, die zu dieser Kategorie gehören.</span><span class="sxs-lookup"><span data-stu-id="74f00-260">That is, when a user visits this page, we want to randomly choose a category from the `Categories` table, display the category name, and then list the products belonging to that category.</span></span>

<span data-ttu-id="74f00-261">Um dies zu erreichen, die wir benötigen zwei SqlDataSource Steuerelemente in einem auf eine zufällige Kategorie aus der `Categories` Tabelle und eine andere Kategorie Produkte abgerufen.</span><span class="sxs-lookup"><span data-stu-id="74f00-261">To accomplish this we need two SqlDataSource controls one to grab a random category from the `Categories` table and another to get the category s products.</span></span> <span data-ttu-id="74f00-262">Wir müssen die SqlDataSource zu erstellen, einen zufälligen Kategoriedatensatz in diesem Schritt abruft; Schritt 5 prüft Objekt die SqlDataSource, die die Kategorie s Produkte abruft.</span><span class="sxs-lookup"><span data-stu-id="74f00-262">We'll build the SqlDataSource that retrieves a random category record in this step; Step 5 looks at crafting the SqlDataSource that retrieves the category s products.</span></span>

<span data-ttu-id="74f00-263">Durch Hinzufügen von einem SqlDataSource zum Starten `ParameterizedQueries.aspx` und legen Sie dessen `ID` auf `RandomCategoryDataSource`.</span><span class="sxs-lookup"><span data-stu-id="74f00-263">Start by adding a SqlDataSource to `ParameterizedQueries.aspx` and set its `ID` to `RandomCategoryDataSource`.</span></span> <span data-ttu-id="74f00-264">Konfigurieren Sie es so, dass sie die folgende SQL-Abfrage verwendet:</span><span class="sxs-lookup"><span data-stu-id="74f00-264">Configure it so that it uses the following SQL query:</span></span>


[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-vb/samples/sample10.sql)]

<span data-ttu-id="74f00-265">`ORDER BY NEWID()`Gibt die Datensätze in zufälliger Reihenfolge sortiert (finden Sie unter [Using `NEWID()` , nach dem Zufallsprinzip Sortieren von Datensätzen](http://www.sqlteam.com/item.asp?ItemID=8747)).</span><span class="sxs-lookup"><span data-stu-id="74f00-265">`ORDER BY NEWID()` returns the records sorted in random order (see [Using `NEWID()` to Randomly Sort Records](http://www.sqlteam.com/item.asp?ItemID=8747)).</span></span> <span data-ttu-id="74f00-266">`SELECT TOP 1`Gibt den ersten Datensatz aus dem Resultset zurück.</span><span class="sxs-lookup"><span data-stu-id="74f00-266">`SELECT TOP 1` returns the first record from the result set.</span></span> <span data-ttu-id="74f00-267">Zusammengestellt, die diese Abfrage gibt die `CategoryID` und `CategoryName` Spaltenwerte aus einer einzelnen, zufällig ausgewählten Kategorie.</span><span class="sxs-lookup"><span data-stu-id="74f00-267">Put together, this query returns the `CategoryID` and `CategoryName` column values from a single, randomly selected category.</span></span>

<span data-ttu-id="74f00-268">Die Kategorie s angezeigt `CategoryName` -Wert, der Seite ein Label-Websteuerelement hinzugefügt haben, legen Sie seine `ID` Eigenschaft, um `CategoryNameLabel`, und löschen, dessen `Text` Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="74f00-268">To display the category s `CategoryName` value, add a Label Web control to the page, set its `ID` property to `CategoryNameLabel`, and clear out its `Text` property.</span></span> <span data-ttu-id="74f00-269">Um die Daten von einem SqlDataSource-Steuerelement programmgesteuert abzurufen, müssen wir Aufrufen seiner `Select()` Methode.</span><span class="sxs-lookup"><span data-stu-id="74f00-269">To programmatically retrieve the data from a SqlDataSource control, we need to invoke its `Select()` method.</span></span> <span data-ttu-id="74f00-270">Die [ `Select()` Methode](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.sqldatasource.select.aspx) erwartet einen einzelnen Eingabeparameter vom Typ [ `DataSourceSelectArguments` ](https://msdn.microsoft.com/en-us/library/system.web.ui.datasourceselectarguments.aspx), der angibt, wie die Daten vor der Rückgabe Nachrichten werden sollte.</span><span class="sxs-lookup"><span data-stu-id="74f00-270">The [`Select()` method](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.sqldatasource.select.aspx) expects a single input parameter of type [`DataSourceSelectArguments`](https://msdn.microsoft.com/en-us/library/system.web.ui.datasourceselectarguments.aspx), which specifies how the data should be messaged before being returned.</span></span> <span data-ttu-id="74f00-271">Dies kann die Anweisungen zum Sortieren und Filtern der Daten enthalten und wird durch die Daten, die Websteuerelemente beim Sortieren oder paging durch die Daten von einem SqlDataSource-Steuerelement verwendet.</span><span class="sxs-lookup"><span data-stu-id="74f00-271">This can include instructions on sorting and filtering the data, and is used by the data Web controls when sorting or paging through the data from a SqlDataSource control.</span></span> <span data-ttu-id="74f00-272">In unserem Beispiel jedoch wir Verschlüsselungskennwort t müssen die Daten vor der Rückgabe geändert werden, und daher wird auf die `DataSourceSelectArguments.Empty` Objekt.</span><span class="sxs-lookup"><span data-stu-id="74f00-272">For our example, though, we don t need the data to be modified before being returned, and therefore will pass in the `DataSourceSelectArguments.Empty` object.</span></span>

<span data-ttu-id="74f00-273">Die `Select()` Methode gibt ein Objekt, das implementiert `IEnumerable`.</span><span class="sxs-lookup"><span data-stu-id="74f00-273">The `Select()` method returns an object that implements `IEnumerable`.</span></span> <span data-ttu-id="74f00-274">Der genaue Typ zurückgegeben, hängt vom Wert des SqlDataSource-Steuerelement s [ `DataSourceMode` Eigenschaft](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.sqldatasource.datasourcemode.aspx).</span><span class="sxs-lookup"><span data-stu-id="74f00-274">The precise type returned depends on the value of the SqlDataSource control s [`DataSourceMode` property](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.sqldatasource.datasourcemode.aspx).</span></span> <span data-ttu-id="74f00-275">Wie im vorherigen Lernprogramm erläutert wird, kann diese Eigenschaft festgelegt werden, auf den Wert entweder `DataSet` oder `DataReader`.</span><span class="sxs-lookup"><span data-stu-id="74f00-275">As discussed in the previous tutorial, this property can be set to a value of either `DataSet` or `DataReader`.</span></span> <span data-ttu-id="74f00-276">Wenn auf festgelegt `DataSet`, die `Select()` Methode gibt ein ["DataView"](https://msdn.microsoft.com/en-us/library/01s96x0z.aspx) Objekt; gesetzt `DataReader`, es gibt ein Objekt, das implementiert [ `IDataReader` ](https://msdn.microsoft.com/en-us/library/system.data.idatareader.aspx).</span><span class="sxs-lookup"><span data-stu-id="74f00-276">If set to `DataSet`, the `Select()` method returns a [DataView](https://msdn.microsoft.com/en-us/library/01s96x0z.aspx) object; if set to `DataReader`, it returns an object that implements [`IDataReader`](https://msdn.microsoft.com/en-us/library/system.data.idatareader.aspx).</span></span> <span data-ttu-id="74f00-277">Da die `RandomCategoryDataSource` SqlDataSource hat seine `DataSourceMode` -Eigenschaftensatz auf `DataSet` (Standard), wir arbeiten mit einer "DataView"-Objekt.</span><span class="sxs-lookup"><span data-stu-id="74f00-277">Since the `RandomCategoryDataSource` SqlDataSource has its `DataSourceMode` property set to `DataSet` (the default), we will be working with a DataView object.</span></span>

<span data-ttu-id="74f00-278">Im folgende Code wird veranschaulicht, wie die Datensätze aus Abrufen der `RandomCategoryDataSource` SqlDataSource als einer "DataView" sowie zum Lesen der `CategoryName` Spaltenwert aus der ersten Zeile von "DataView":</span><span class="sxs-lookup"><span data-stu-id="74f00-278">The following code illustrates how to retrieve the records from the `RandomCategoryDataSource` SqlDataSource as a DataView as well as how to read the `CategoryName` column value from the first DataView row:</span></span>


[!code-vb[Main](using-parameterized-queries-with-the-sqldatasource-vb/samples/sample11.vb)]

<span data-ttu-id="74f00-279">`randomCategoryView(0)`Gibt das erste `DataRowView` in der DataView.</span><span class="sxs-lookup"><span data-stu-id="74f00-279">`randomCategoryView(0)` returns the first `DataRowView` in the DataView.</span></span> <span data-ttu-id="74f00-280">`randomCategoryView(0)("CategoryName")`Gibt den Wert der `CategoryName` Spalte in dieser ersten Zeile.</span><span class="sxs-lookup"><span data-stu-id="74f00-280">`randomCategoryView(0)("CategoryName")` returns the value of the `CategoryName` column in this first row.</span></span> <span data-ttu-id="74f00-281">Beachten Sie, dass die DataView lose typisierten ist.</span><span class="sxs-lookup"><span data-stu-id="74f00-281">Note that the DataView is loosely-typed.</span></span> <span data-ttu-id="74f00-282">Einen bestimmter Spaltenwert verweisen muss den Namen der Spalte als Zeichenfolge (in diesem Fall CategoryName) übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="74f00-282">To reference a particular column value we need to pass in the name of the column as a string ( CategoryName, in this case).</span></span> <span data-ttu-id="74f00-283">Abbildung 13 zeigt die Meldung angezeigt, der `CategoryNameLabel` beim Anzeigen der Seite ".</span><span class="sxs-lookup"><span data-stu-id="74f00-283">Figure 13 shows the message displayed in the `CategoryNameLabel` when viewing the page.</span></span> <span data-ttu-id="74f00-284">Natürlich ist die tatsächliche Kategorienamen angezeigt nach dem Zufallsprinzip ausgewählt, die `RandomCategoryDataSource` SqlDataSource auf jeden Besuch der Seite "(einschließlich Postbacks).</span><span class="sxs-lookup"><span data-stu-id="74f00-284">Of course, the actual category name displayed is randomly selected by the `RandomCategoryDataSource` SqlDataSource on each visit to the page (including postbacks).</span></span>


<span data-ttu-id="74f00-285">[![Nach dem Zufallsprinzip ausgewählte Kategorie-s, auf die Namen angezeigt wird](using-parameterized-queries-with-the-sqldatasource-vb/_static/image13.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="74f00-285">[![The Randomly Selected Category s Name is Displayed](using-parameterized-queries-with-the-sqldatasource-vb/_static/image13.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image25.png)</span></span>

<span data-ttu-id="74f00-286">**Abbildung 13**: Name angezeigt wird, der nach dem Zufallsprinzip ausgewählte Kategorie-s ([klicken Sie hier, um das Bild in voller Größe angezeigt](using-parameterized-queries-with-the-sqldatasource-vb/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="74f00-286">**Figure 13**: The Randomly Selected Category s Name is Displayed ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-vb/_static/image26.png))</span></span>


> [!NOTE]
> <span data-ttu-id="74f00-287">Wenn die SqlDataSource-, s Steuerelement `DataSourceMode` Eigenschaft festgelegt wurde `DataReader`, der Rückgabewert der `Select()` Methode würde in umgewandelt werden mussten `IDataReader`.</span><span class="sxs-lookup"><span data-stu-id="74f00-287">If the SqlDataSource control s `DataSourceMode` property had been set to `DataReader`, the return value from the `Select()` method would have needed to be cast to `IDataReader`.</span></span> <span data-ttu-id="74f00-288">Zum Lesen der `CategoryName` Spaltenwert aus der ersten Zeile, wir d verwenden Sie Code wie:</span><span class="sxs-lookup"><span data-stu-id="74f00-288">To read the `CategoryName` column value from the first row, we d use code like:</span></span>


[!code-vb[Main](using-parameterized-queries-with-the-sqldatasource-vb/samples/sample12.vb)]

<span data-ttu-id="74f00-289">Mit dem SqlDataSource zufällig durch Auswahl einer Kategorie, wir re kann jetzt die GridView hinzugefügt, die der s Kategorieprodukte aufgeführt sind.</span><span class="sxs-lookup"><span data-stu-id="74f00-289">With the SqlDataSource randomly selecting a category, we re ready to add the GridView that lists the category s products.</span></span>

> [!NOTE]
> <span data-ttu-id="74f00-290">Statt ein Websteuerelement Bezeichnung der Kategorie-s-Name angezeigt, es konnte eine FormView oder DetailsView haben auf der Seite hinzugefügt binden es an die SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="74f00-290">Rather than using a Label Web control to display the category s name, we could have added a FormView or DetailsView to the page, binding it to the SqlDataSource.</span></span> <span data-ttu-id="74f00-291">Verwenden die Bezeichnung ein, uns, wie Sie programmgesteuert aufrufen, die SqlDataSource s untersuchen jedoch zulässig `Select()` -Anweisung und zum Arbeiten mit der resultierenden Daten im Code.</span><span class="sxs-lookup"><span data-stu-id="74f00-291">Using the Label, however, allowed us to explore how to programmatically invoke the SqlDataSource s `Select()` statement and work with its resulting data in code.</span></span>


## <a name="step-5-assigning-parameter-values-programmatically"></a><span data-ttu-id="74f00-292">Schritt 5: Zuweisen von Parameterwerten programmgesteuert</span><span class="sxs-lookup"><span data-stu-id="74f00-292">Step 5: Assigning Parameter Values Programmatically</span></span>

<span data-ttu-id="74f00-293">Alle Beispiele wir haben bisher vorgefundener in diesem Lernprogramm verwendet einen hartcodierten Parameterwert oder eine entnommen, bis eine der vordefinierten Parameter Quellen (Querystring-Wert, ein Websteuerelement auf der Seite "usw.).</span><span class="sxs-lookup"><span data-stu-id="74f00-293">All of the examples we ve seen so far in this tutorial have used either a hard-coded parameter value or one taken from one of the pre-defined parameter sources (a querystring value, a Web control on the page, and so on).</span></span> <span data-ttu-id="74f00-294">SqlDataSource-Steuerelement-s-Parameter können jedoch auch programmgesteuert festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="74f00-294">However, the SqlDataSource control s parameters can also be set programmatically.</span></span> <span data-ttu-id="74f00-295">Zum Beispiel mit aktuellen abschließen zu können, benötigen wir SqlDataSource, die alle Produkte, die auf eine angegebene Kategorie gehören zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="74f00-295">To complete our current example, we need a SqlDataSource that returns all of the products belonging to a specified category.</span></span> <span data-ttu-id="74f00-296">Diesen SqlDataSource müssen eine `CategoryID` Parameter, dessen Wert festgelegt werden muss, basierend auf der `CategoryID` von zurückgegebene Wert für die `RandomCategoryDataSource` SqlDataSource in der `Page_Load` -Ereignishandler.</span><span class="sxs-lookup"><span data-stu-id="74f00-296">This SqlDataSource will have a `CategoryID` parameter whose value needs to be set based on the `CategoryID` column value returned by the `RandomCategoryDataSource` SqlDataSource in the `Page_Load` event handler.</span></span>

<span data-ttu-id="74f00-297">Starten, indem eine GridView zur Seite hinzufügen und binden es an eine neue, mit dem Namen ': SqlDataSource `ProductsByCategoryDataSource`.</span><span class="sxs-lookup"><span data-stu-id="74f00-297">Start by adding a GridView to the page and bind it to a new SqlDataSource named `ProductsByCategoryDataSource`.</span></span> <span data-ttu-id="74f00-298">Wie wir es in Schritt 3 getan haben, die SqlDataSource so konfigurieren, dass er ruft die `GetProductsByCategory` gespeicherte Prozedur.</span><span class="sxs-lookup"><span data-stu-id="74f00-298">Much like we did in Step 3, configure the SqlDataSource so that it invokes the `GetProductsByCategory` stored procedure.</span></span> <span data-ttu-id="74f00-299">Behalten Sie die Parameter Quelle die Dropdown-Liste auf None, aber geben Sie einen Standardwert nicht auf, da wir diesen Wert programmgesteuert festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="74f00-299">Leave the Parameter source drop-down list set to None, but do not enter a default value, as we will set this default value programmatically.</span></span>


<span data-ttu-id="74f00-300">[![Geben Sie keine Parameterquelle oder Standardwert](using-parameterized-queries-with-the-sqldatasource-vb/_static/image14.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="74f00-300">[![Do Not Specify a Parameter Source or Default Value](using-parameterized-queries-with-the-sqldatasource-vb/_static/image14.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image27.png)</span></span>

<span data-ttu-id="74f00-301">**Abbildung 14**: Geben Sie keine Parameterquelle oder Standardwert ([klicken Sie hier, um das Bild in voller Größe angezeigt](using-parameterized-queries-with-the-sqldatasource-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="74f00-301">**Figure 14**: Do Not Specify a Parameter Source or Default Value ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-vb/_static/image28.png))</span></span>


<span data-ttu-id="74f00-302">Nach Abschluss des Assistenten SqlDataSource sollte die resultierende deklarative Markup etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="74f00-302">After completing the SqlDataSource wizard, the resulting declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](using-parameterized-queries-with-the-sqldatasource-vb/samples/sample13.aspx)]

<span data-ttu-id="74f00-303">Wir können Zuweisen der `DefaultValue` von der `CategoryID` Parameter programmgesteuert in die `Page_Load` Ereignishandler:</span><span class="sxs-lookup"><span data-stu-id="74f00-303">We can assign the `DefaultValue` of the `CategoryID` parameter programmatically in the `Page_Load` event handler:</span></span>


[!code-vb[Main](using-parameterized-queries-with-the-sqldatasource-vb/samples/sample14.vb)]

<span data-ttu-id="74f00-304">Durch diese hinzufügen enthält die Seite eine GridView, die die Produkte, die nach dem Zufallsprinzip ausgewählte Kategorie zugeordnet wird.</span><span class="sxs-lookup"><span data-stu-id="74f00-304">With this addition, the page includes a GridView that shows the products associated with the randomly selected category.</span></span>


<span data-ttu-id="74f00-305">[![Geben Sie keine Parameterquelle oder Standardwert](using-parameterized-queries-with-the-sqldatasource-vb/_static/image15.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="74f00-305">[![Do Not Specify a Parameter Source or Default Value](using-parameterized-queries-with-the-sqldatasource-vb/_static/image15.gif)](using-parameterized-queries-with-the-sqldatasource-vb/_static/image29.png)</span></span>

<span data-ttu-id="74f00-306">**Abbildung 15**: Geben Sie keine Parameterquelle oder Standardwert ([klicken Sie hier, um das Bild in voller Größe angezeigt](using-parameterized-queries-with-the-sqldatasource-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="74f00-306">**Figure 15**: Do Not Specify a Parameter Source or Default Value ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-vb/_static/image30.png))</span></span>


## <a name="summary"></a><span data-ttu-id="74f00-307">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="74f00-307">Summary</span></span>

<span data-ttu-id="74f00-308">Die ': SqlDataSource ermöglicht Entwicklern parametrisierte Abfragen definieren, deren Parameterwerte fest programmiert, aus vordefinierten Parameter Quellen abgerufen oder programmgesteuert zugewiesen werden können.</span><span class="sxs-lookup"><span data-stu-id="74f00-308">The SqlDataSource enables page developers to define parameterized queries whose parameter values can be hard-coded, pulled from pre-defined parameter sources, or assigned programmatically.</span></span> <span data-ttu-id="74f00-309">In diesem Lernprogramm wurde erläutert, wie eine parametrisierte Abfrage aus der Datenquelle konfigurieren-Assistent für Ad-hoc-SQL-Abfragen und gespeicherte Prozeduren zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="74f00-309">In this tutorial we saw how to craft a parameterized query from the Configure Data Source wizard for both ad-hoc SQL queries and stored procedures.</span></span> <span data-ttu-id="74f00-310">Wir haben uns auch hartcodierter Parameter Quellen, ein Websteuerelement als Parameterquelle zu verwenden und den Parameterwert programmgesteuert festlegen.</span><span class="sxs-lookup"><span data-stu-id="74f00-310">We also looked at using hard-coded parameter sources, a Web control as a parameter source, and programmatically specifying the parameter value.</span></span>

<span data-ttu-id="74f00-311">Bietet genau wie mit der ObjectDataSource die SqlDataSource auch Funktionen, um die zugrunde liegenden Daten ändern.</span><span class="sxs-lookup"><span data-stu-id="74f00-311">Like with the ObjectDataSource, the SqlDataSource also provides capabilities to modify its underlying data.</span></span> <span data-ttu-id="74f00-312">In den nächsten Lernprogrammen betrachten wir zum Definieren `INSERT`, `UPDATE`, und `DELETE` -Anweisungen mit der SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="74f00-312">In the next tutorial we'll look at how to define `INSERT`, `UPDATE`, and `DELETE` statements with the SqlDataSource.</span></span> <span data-ttu-id="74f00-313">Sobald diese Anweisungen hinzugefügt wurden, können wir die integrierte einfügen, bearbeiten und Löschen von Features der GridView, DetailsView und FormView nutzen.</span><span class="sxs-lookup"><span data-stu-id="74f00-313">Once these statements have been added, we can utilize the built-in inserting, editing, and deleting features inherent to the GridView, DetailsView, and FormView controls.</span></span>

<span data-ttu-id="74f00-314">Viel Spaß beim Programmieren!</span><span class="sxs-lookup"><span data-stu-id="74f00-314">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="74f00-315">Informationen zum Autor</span><span class="sxs-lookup"><span data-stu-id="74f00-315">About the Author</span></span>

<span data-ttu-id="74f00-316">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor von sieben ASP/ASP.NET-Büchern und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), Microsoft Web-Technologien seit 1998 arbeitet.</span><span class="sxs-lookup"><span data-stu-id="74f00-316">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="74f00-317">Scott fungiert als ein unabhängiger Berater, Trainer und Writer.</span><span class="sxs-lookup"><span data-stu-id="74f00-317">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="74f00-318">Sein neueste Buch wird [ *Sams Schulen selbst ASP.NET 2.0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="74f00-318">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="74f00-319">Er die erreicht werden kann, zur [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) oder über seinen Blog die finden Sie unter [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="74f00-319">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="74f00-320">Besonderen Dank an</span><span class="sxs-lookup"><span data-stu-id="74f00-320">Special Thanks To</span></span>

<span data-ttu-id="74f00-321">Diese Reihe von Lernprogrammen wurde durch viele nützliche Bearbeiter überprüft.</span><span class="sxs-lookup"><span data-stu-id="74f00-321">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="74f00-322">Lead Prüfer für dieses Lernprogramm wurden Scott Clyde Randell Schmidt und Ken Pespisa.</span><span class="sxs-lookup"><span data-stu-id="74f00-322">Lead reviewers for this tutorial were Scott Clyde, Randell Schmidt, and Ken Pespisa.</span></span> <span data-ttu-id="74f00-323">Meine bevorstehende MSDN-Artikel Überprüfen von Interesse?</span><span class="sxs-lookup"><span data-stu-id="74f00-323">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="74f00-324">Wenn dies der Fall ist, löschen Sie mich zeilenweise [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="74f00-324">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="74f00-325">[Zurück](querying-data-with-the-sqldatasource-control-vb.md)
[Weiter](inserting-updating-and-deleting-data-with-the-sqldatasource-vb.md)</span><span class="sxs-lookup"><span data-stu-id="74f00-325">[Previous](querying-data-with-the-sqldatasource-control-vb.md)
[Next](inserting-updating-and-deleting-data-with-the-sqldatasource-vb.md)</span></span>
