---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs
title: Verwenden die vorhandene gespeicherte Prozeduren für das typisierte DataSet TableAdapters (c#) | Microsoft Docs
author: rick-anderson
description: Im vorherigen Lernprogramm haben wir gelernt, den TableAdapter-Assistenten verwenden, um neue gespeicherte Prozeduren zu generieren. In diesem Lernprogramm erfahren Sie, wie die gleichen TableAdapter...
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/18/2007
ms.topic: article
ms.assetid: 440bef2a-1641-4238-99e3-8e2d44e7d94c
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs
msc.type: authoredcontent
ms.openlocfilehash: df8a714325ce99db615eddc3d457da5c926919ba
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/06/2018
---
<a name="using-existing-stored-procedures-for-the-typed-datasets-tableadapters-c"></a><span data-ttu-id="2056e-104">Verwenden die vorhandene gespeicherte Prozeduren für das typisierte DataSet TableAdapters (c#)</span><span class="sxs-lookup"><span data-stu-id="2056e-104">Using Existing Stored Procedures for the Typed DataSet's TableAdapters (C#)</span></span>
====================
<span data-ttu-id="2056e-105">durch [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="2056e-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="2056e-106">[Herunterladen von Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_68_CS.zip) oder [PDF herunterladen](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/datatutorial68cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="2056e-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_68_CS.zip) or [Download PDF](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/datatutorial68cs1.pdf)</span></span>

> <span data-ttu-id="2056e-107">Im vorherigen Lernprogramm haben wir gelernt, den TableAdapter-Assistenten verwenden, um neue gespeicherte Prozeduren zu generieren.</span><span class="sxs-lookup"><span data-stu-id="2056e-107">In the previous tutorial we learned how to use the TableAdapter Wizard to generate new stored procedures.</span></span> <span data-ttu-id="2056e-108">In diesem Lernprogramm lernen wir an, wie die gleichen TableAdapter-Assistenten mit bereits vorhandener gespeicherter Prozeduren arbeiten können.</span><span class="sxs-lookup"><span data-stu-id="2056e-108">In this tutorial we learn how the same TableAdapter Wizard can work with existing stored procedures.</span></span> <span data-ttu-id="2056e-109">Wir erfahren Sie, wie die Datenbank neue gespeicherte Prozeduren manuell hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="2056e-109">We also learn how to manually add new stored procedures to our database.</span></span>


## <a name="introduction"></a><span data-ttu-id="2056e-110">Einführung</span><span class="sxs-lookup"><span data-stu-id="2056e-110">Introduction</span></span>

<span data-ttu-id="2056e-111">In der [vorherigen Lernprogramm](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) wurde erläutert, wie das typisierte DataSet s TableAdapters konfiguriert werden konnte, um gespeicherte Prozeduren für den Zugriff Daten anstelle von Ad-hoc-SQL-Anweisungen verwenden.</span><span class="sxs-lookup"><span data-stu-id="2056e-111">In the [preceding tutorial](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) we saw how the Typed DataSet s TableAdapters could be configured to use stored procedures to access data rather than ad-hoc SQL statements.</span></span> <span data-ttu-id="2056e-112">Insbesondere untersucht es wie den TableAdapter-Assistenten automatisch diese gespeicherten Prozeduren erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="2056e-112">In particular, we examined how to have the TableAdapter wizard automatically create these stored procedures.</span></span> <span data-ttu-id="2056e-113">Beim Portieren einer älteren Anwendung in ASP.NET 2.0 oder eine ASP.NET 2.0-Website, um ein vorhandenes Data Modell erstellen, sind wahrscheinlich, dass die Datenbank enthält bereits die gespeicherten Prozeduren, die Sie benötigen.</span><span class="sxs-lookup"><span data-stu-id="2056e-113">When porting a legacy application to ASP.NET 2.0 or when building an ASP.NET 2.0 website around an existing data model, chances are that the database already contains the stored procedures we need.</span></span> <span data-ttu-id="2056e-114">Alternativ empfiehlt es sich um die gespeicherten Prozeduren zu erstellen, manuell oder über ein Tool als dem TableAdapter-Assistenten, der die gespeicherten Prozeduren automatisch generiert.</span><span class="sxs-lookup"><span data-stu-id="2056e-114">Alternatively, you may prefer to create your stored procedures by hand or through some tool other than the TableAdapter wizard that auto-generates your stored procedures.</span></span>

<span data-ttu-id="2056e-115">In diesem Lernprogramm werden wir konfigurieren den TableAdapter um vorhandene gespeicherte Prozeduren betrachten.</span><span class="sxs-lookup"><span data-stu-id="2056e-115">In this tutorial we will look at how to configure the TableAdapter to use existing stored procedures.</span></span> <span data-ttu-id="2056e-116">Da die Northwind-Datenbank nur einen kleinen Satz von integrierten gespeicherten Prozeduren aufweist, werden wir auch die erforderlichen Schritte zum neue gespeicherte Prozeduren über Visual Studio-Umgebung auf die Datenbank manuell hinzufügen betrachten.</span><span class="sxs-lookup"><span data-stu-id="2056e-116">Since the Northwind database only has a small set of built-in stored procedures, we will also look at the steps needed to manually add new stored procedures to the database through the Visual Studio environment.</span></span> <span data-ttu-id="2056e-117">Lassen Sie s beginnen!</span><span class="sxs-lookup"><span data-stu-id="2056e-117">Let s get started!</span></span>

> [!NOTE]
> <span data-ttu-id="2056e-118">In der [Umbruch Datenbankänderungen innerhalb einer Transaktion](../working-with-batched-data/wrapping-database-modifications-within-a-transaction-cs.md) Lernprogramm hinzugefügt Methoden des TableAdapter zum Unterstützen von Transaktionen (`BeginTransaction`, `CommitTransaction`usw.).</span><span class="sxs-lookup"><span data-stu-id="2056e-118">In the [Wrapping Database Modifications within a Transaction](../working-with-batched-data/wrapping-database-modifications-within-a-transaction-cs.md) tutorial we added methods to the TableAdapter to support transactions (`BeginTransaction`, `CommitTransaction`, and so on).</span></span> <span data-ttu-id="2056e-119">Alternativ können Transaktionen vollständig innerhalb einer gespeicherten Prozedur verwaltet werden, die keine Änderungen an der Datenzugriffsebene Code erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="2056e-119">Alternatively, transactions can be managed entirely within a stored procedure, which requires no modifications to the Data Access Layer code.</span></span> <span data-ttu-id="2056e-120">In diesem Lernprogramm lernen wir die T-SQL-Befehle zum Ausführen einer gespeicherten Prozedur s-Anweisungen innerhalb des Bereichs einer Transaktion kennen.</span><span class="sxs-lookup"><span data-stu-id="2056e-120">In this tutorial we'll explore the T-SQL commands used to execute a stored procedure s statements within the scope of a transaction.</span></span>


## <a name="step-1-adding-stored-procedures-to-the-northwind-database"></a><span data-ttu-id="2056e-121">Schritt 1: Hinzufügen von gespeicherten Prozeduren mit der Datenbank Northwind</span><span class="sxs-lookup"><span data-stu-id="2056e-121">Step 1: Adding Stored Procedures to the Northwind Database</span></span>

<span data-ttu-id="2056e-122">Visual Studio erleichtert das Hinzufügen einer Datenbank neuer gespeicherter Prozeduren.</span><span class="sxs-lookup"><span data-stu-id="2056e-122">Visual Studio makes it easy to add new stored procedures to a database.</span></span> <span data-ttu-id="2056e-123">Let s hinzufügen eine neue gespeicherte Prozedur zur Northwind-Datenbank, die alle Spalten gibt die `Products` für diejenigen, die über eine bestimmte Tabelle `CategoryID` Wert.</span><span class="sxs-lookup"><span data-stu-id="2056e-123">Let s add a new stored procedure to the Northwind database that returns all columns from the `Products` table for those that have a particular `CategoryID` value.</span></span> <span data-ttu-id="2056e-124">Erweitern Sie in Server Explorer-Fenster der Northwind-Datenbank, so, dass die Ordner - Datenbank-Diagrammen, Tabellen, Sichten usw. -angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="2056e-124">From the Server Explorer window, expand the Northwind database so that its folders - Database Diagrams, Tables, Views, and so forth - are displayed.</span></span> <span data-ttu-id="2056e-125">Wie im vorherigen Lernprogramm wurde gezeigt, enthält der Ordner gespeicherte Prozeduren der Datenbank s bereits vorhandener gespeicherter Prozeduren.</span><span class="sxs-lookup"><span data-stu-id="2056e-125">As we saw in the preceding tutorial, the Stored Procedures folder contains the database s existing stored procedures.</span></span> <span data-ttu-id="2056e-126">Zum Hinzufügen einer neuen gespeicherten Prozedur mit der rechten Maustaste in des Ordners gespeicherte Prozeduren und wählen Sie im Kontextmenü die Option neue gespeicherte Prozedur hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="2056e-126">To add a new stored procedure, simply right-click the Stored Procedures folder and choose the Add New Stored Procedure option from the context menu.</span></span>


<span data-ttu-id="2056e-127">[![Mit der rechten Maustaste in des Ordners gespeicherte Prozeduren und Hinzufügen einer neuen gespeicherten Prozedur](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image2.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="2056e-127">[![Right-Click the Stored Procedures Folder and Add a New Stored Procedure](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image2.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image1.png)</span></span>

<span data-ttu-id="2056e-128">**Abbildung 1**: mit der rechten Maustaste in den Ordner für die gespeicherten Prozeduren und Hinzufügen einer neuen gespeicherten Prozedur ([klicken Sie hier, um das Bild in voller Größe angezeigt](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="2056e-128">**Figure 1**: Right-Click the Stored Procedures Folder and Add a New Stored Procedure ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image3.png))</span></span>


<span data-ttu-id="2056e-129">Wie in Abbildung 1 gezeigt, die Option Neue gespeicherte Prozedur hinzufügen wird ein Skriptfenster geöffnet in Visual Studio mit der Gliederung des SQL-Skripts zum Erstellen der gespeicherten Prozedur erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="2056e-129">As Figure 1 shows, selecting the Add New Stored Procedure option opens a script window in Visual Studio with the outline of the SQL script needed to create the stored procedure.</span></span> <span data-ttu-id="2056e-130">Es ist unsere Aufgabe rolloutphasen dieses Skript aus, und führen Sie es, die an diesem Punkt der Datenbank die gespeicherte Prozedur hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="2056e-130">It is our job to flesh out this script and execute it, at which point the stored procedure will be added to the database.</span></span>

<span data-ttu-id="2056e-131">Geben Sie das folgende Skript aus:</span><span class="sxs-lookup"><span data-stu-id="2056e-131">Enter the following script:</span></span>


[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/samples/sample1.sql)]

<span data-ttu-id="2056e-132">Mit diesem Skript, das bei der Ausführung wird eine neue gespeicherte Prozedur hinzufügen, mit der Northwind-Datenbank mit dem Namen `Products_SelectByCategoryID`.</span><span class="sxs-lookup"><span data-stu-id="2056e-132">This script, when executed, will add a new stored procedure to the Northwind database named `Products_SelectByCategoryID`.</span></span> <span data-ttu-id="2056e-133">Diese gespeicherte Prozedur nimmt einen einzelnen Eingabeparameter (`@CategoryID`, des Typs `int`) und alle Felder für diese Produkte mit einer passenden Längenwert `CategoryID` Wert.</span><span class="sxs-lookup"><span data-stu-id="2056e-133">This stored procedure accepts a single input parameter (`@CategoryID`, of type `int`) and it returns all of the fields for those products with a matching `CategoryID` value.</span></span>

<span data-ttu-id="2056e-134">Zum Ausführen dieser `CREATE PROCEDURE` Skript und fügen Sie die gespeicherte Prozedur in der Datenbank, klicken Sie auf das Symbol "Speichern" in der Symbolleiste oder STRG + S drücken.</span><span class="sxs-lookup"><span data-stu-id="2056e-134">To execute this `CREATE PROCEDURE` script and add the stored procedure to the database, click the Save icon in the toolbar or hit Ctrl+S.</span></span> <span data-ttu-id="2056e-135">Zeigt die neu erstellte nach dies der Fall, Aktualisierungen Ordner "Stored Procedures" gespeicherte Prozedur aus.</span><span class="sxs-lookup"><span data-stu-id="2056e-135">After doing so, the Stored Procedures folder refreshes, showing the newly created stored procedure.</span></span> <span data-ttu-id="2056e-136">Außerdem ändert das Skript im Fenster Besonderheit aus `CREATE PROCEDURE dbo.Products_SelectProductByCategoryID` auf `ALTER PROCEDURE` `dbo.Products_SelectProductByCategoryID`.</span><span class="sxs-lookup"><span data-stu-id="2056e-136">Also, the script in the window will change subtlety from `CREATE PROCEDURE dbo.Products_SelectProductByCategoryID` to `ALTER PROCEDURE` `dbo.Products_SelectProductByCategoryID`.</span></span> <span data-ttu-id="2056e-137">`CREATE PROCEDURE` Fügt eine neue gespeicherte Prozedur mit der Datenbank, während `ALTER PROCEDURE` aktualisiert eine vorhandene.</span><span class="sxs-lookup"><span data-stu-id="2056e-137">`CREATE PROCEDURE` adds a new stored procedure to the database, while `ALTER PROCEDURE` updates an existing one.</span></span> <span data-ttu-id="2056e-138">Seit dem Start des Skripts geändert hat `ALTER PROCEDURE`, ändern die gespeicherten Prozeduren geben Sie Parameter oder SQL-Anweisungen, und klicken auf das Symbol "Speichern", wird die gespeicherte Prozedur mit diesen Änderungen aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="2056e-138">Since the start of the script has changed to `ALTER PROCEDURE`, changing the stored procedures input parameters or SQL statements and clicking the Save icon will update the stored procedure with these changes.</span></span>

<span data-ttu-id="2056e-139">Abbildung 2 zeigt Visual Studio nach dem `Products_SelectByCategoryID` gespeicherte Prozedur wurde gespeichert.</span><span class="sxs-lookup"><span data-stu-id="2056e-139">Figure 2 shows Visual Studio after the `Products_SelectByCategoryID` stored procedure has been saved.</span></span>


<span data-ttu-id="2056e-140">[![Die gespeicherte Prozedur Products_SelectByCategoryID wurde hinzugefügt, mit der Datenbank](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image5.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="2056e-140">[![The Stored Procedure Products_SelectByCategoryID Has Been Added to the Database](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image5.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image4.png)</span></span>

<span data-ttu-id="2056e-141">**Abbildung 2**: die gespeicherte Prozedur `Products_SelectByCategoryID` wurde in der Datenbank hinzugefügt wurde ([klicken Sie hier, um das Bild in voller Größe angezeigt](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="2056e-141">**Figure 2**: The Stored Procedure `Products_SelectByCategoryID` Has Been Added to the Database ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image6.png))</span></span>


## <a name="step-2-configuring-the-tableadapter-to-use-an-existing-stored-procedure"></a><span data-ttu-id="2056e-142">Schritt 2: Konfigurieren des TableAdapters zum Verwenden einer vorhandenen gespeicherten Prozedur</span><span class="sxs-lookup"><span data-stu-id="2056e-142">Step 2: Configuring the TableAdapter to Use an Existing Stored Procedure</span></span>

<span data-ttu-id="2056e-143">Nachdem die `Products_SelectByCategoryID` gespeicherte Prozedur wurde mit der Datenbank können wir Concigure unserer Data Access Layer, um diese gespeicherte Prozedur zu verwenden, wenn einer der Methoden aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="2056e-143">Now that the `Products_SelectByCategoryID` stored procedure has been added to the database, we can concigure our Data Access Layer to use this stored procedure when one of its methods is invoked.</span></span> <span data-ttu-id="2056e-144">Insbesondere fügen wir eine `GetProducstByCategoryID(categoryID)` Methode, um die `ProductsTableAdapter` in der `NorthwindWithSprocs` typisierte DataSet, das Aufrufe der `Products_SelectByCategoryID` gespeicherte Prozedur, die soeben erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="2056e-144">In particular, we will add a `GetProducstByCategoryID(categoryID)` method to the `ProductsTableAdapter` in the `NorthwindWithSprocs` Typed DataSet that calls the `Products_SelectByCategoryID` stored procedure we just created.</span></span>

<span data-ttu-id="2056e-145">Öffnen Sie zunächst die `NorthwindWithSprocs` DataSet.</span><span class="sxs-lookup"><span data-stu-id="2056e-145">Start by opening the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="2056e-146">Mit der rechten Maustaste auf die `ProductsTableAdapter` , und wählen Sie die Abfrage hinzufügen, um den TableAdapter-Abfrage-Konfigurations-Assistenten zu starten.</span><span class="sxs-lookup"><span data-stu-id="2056e-146">Right-click on the `ProductsTableAdapter` and choose Add Query to launch the TableAdapter Query Configuration wizard.</span></span> <span data-ttu-id="2056e-147">In der [vorherigen Lernprogramm](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) wir entschied sich für die TableAdapter eine neue gespeicherte Prozedur für uns erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="2056e-147">In the [preceding tutorial](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) we opted to have the TableAdapter create a new stored procedure for us.</span></span> <span data-ttu-id="2056e-148">Dieses Lernprogramm jedoch möchten wir die neue Methode des TableAdapter zur vorhandenen Netzwerkdaten `Products_SelectByCategoryID` gespeicherte Prozedur.</span><span class="sxs-lookup"><span data-stu-id="2056e-148">For this tutorial, however, we want to wire the new TableAdapter method to the existing `Products_SelectByCategoryID` stored procedure.</span></span> <span data-ttu-id="2056e-149">Daher wählen Sie die Option zum Verwenden einer vorhandene gespeicherten Prozedur aus dem ersten Schritt des Assistenten-s, und klicken Sie dann auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="2056e-149">Therefore, choose the Use existing stored procedure option from the wizard s first step and then click Next.</span></span>


<span data-ttu-id="2056e-150">[![Wählen Sie die vorhandene gespeicherte Prozedur Option Verwendung](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image8.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="2056e-150">[![Choose the Use existing stored procedure Option](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image8.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image7.png)</span></span>

<span data-ttu-id="2056e-151">**Abbildung 3**: Wählen Sie die vorhandene verwenden gespeicherte Prozedur Option ([klicken Sie hier, um das Bild in voller Größe angezeigt](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="2056e-151">**Figure 3**: Choose the Use existing stored procedure Option ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image9.png))</span></span>


<span data-ttu-id="2056e-152">Der folgende Bildschirm bietet eine Dropdownliste mit s-Datenbank gespeicherte Prozeduren aufgefüllt.</span><span class="sxs-lookup"><span data-stu-id="2056e-152">The following screen provides a drop-down list populated with the database s stored procedures.</span></span> <span data-ttu-id="2056e-153">Auswählen einer gespeicherten Prozedur listet seine Eingabeparameter auf der linken Seite und die Datenfelder zurückgegeben (sofern vorhanden) auf der rechten Seite.</span><span class="sxs-lookup"><span data-stu-id="2056e-153">Selecting a stored procedure lists its input parameters on the left and the data fields returned (if any) on the right.</span></span> <span data-ttu-id="2056e-154">Wählen Sie die `Products_SelectByCategoryID` gespeicherte Prozedur aus der Liste aus, und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="2056e-154">Choose the `Products_SelectByCategoryID` stored procedure from the list and click Next.</span></span>


<span data-ttu-id="2056e-155">[![Wählen Sie die Products_SelectByCategoryID gespeicherte Prozedur](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image11.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="2056e-155">[![Pick the Products_SelectByCategoryID Stored Procedure](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image11.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image10.png)</span></span>

<span data-ttu-id="2056e-156">**Abbildung 4**: Wählen Sie die `Products_SelectByCategoryID` gespeicherte Prozedur ([klicken Sie hier, um das Bild in voller Größe angezeigt](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="2056e-156">**Figure 4**: Pick the `Products_SelectByCategoryID` Stored Procedure ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image12.png))</span></span>


<span data-ttu-id="2056e-157">Im nächste Bildschirm werden wir gefragt, welche Art von Daten von der gespeicherten Prozedur zurückgegeben wird, und hier unsere Antwort bestimmt den Typ, der von der TableAdapter-s-Methode zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="2056e-157">The next screen asks us what kind of data is returned by the stored procedure and our answer here determines the type returned by the TableAdapter s method.</span></span> <span data-ttu-id="2056e-158">Beispielsweise, wenn Sie auf tabellarische Daten zurückgegeben werden, die Methode zurück eine `ProductsDataTable` Instanz, die mit der von der gespeicherten Prozedur zurückgegebenen Datensätze aufgefüllt.</span><span class="sxs-lookup"><span data-stu-id="2056e-158">For example, if we indicate that tabular data is returned, the method will return a `ProductsDataTable` instance populated with the records returned by the stored procedure.</span></span> <span data-ttu-id="2056e-159">Im Gegensatz dazu bei wir, dass diese gespeicherte Prozedur einen einzelnen Wert zurückgibt, die auf der TableAdapter zurück ein `object` , den Wert in der ersten Spalte des ersten Datensatzes, der von der gespeicherten Prozedur zurückgegebenen zugewiesen ist.</span><span class="sxs-lookup"><span data-stu-id="2056e-159">In contrast, if we indicate that this stored procedure returns a single value the TableAdapter will return an `object` that is assigned the value in the first column of the first record returned by the stored procedure.</span></span>

<span data-ttu-id="2056e-160">Da die `Products_SelectByCategoryID` gespeicherte Prozedur gibt alle Produkte, die zu einer bestimmten Kategorie gehören, wählen Sie die erste Antwort - Tabellendaten - aus, und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="2056e-160">Since the `Products_SelectByCategoryID` stored procedure returns all products that belong to a particular category, choose the first answer - Tabular data - and click Next.</span></span>


<span data-ttu-id="2056e-161">[![Um anzugeben Sie, dass die gespeicherte Prozedur Tabellendaten zurückgibt](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image14.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="2056e-161">[![Indicate that the Stored Procedure Returns Tabular Data](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image14.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image13.png)</span></span>

<span data-ttu-id="2056e-162">**Abbildung 5**: anzugeben, dass die gespeicherte Prozedur Tabellendaten zurückgibt ([klicken Sie hier, um das Bild in voller Größe angezeigt](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="2056e-162">**Figure 5**: Indicate that the Stored Procedure Returns Tabular Data ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image15.png))</span></span>


<span data-ttu-id="2056e-163">Übrig bleibt, um anzugeben, welche Methode Muster verwenden die Namen für diese Methoden folgen.</span><span class="sxs-lookup"><span data-stu-id="2056e-163">All that remains is to indicate what method patterns to use followed by the names for these methods.</span></span> <span data-ttu-id="2056e-164">Lassen Sie beide Füllung eine DataTable und der Rückgabewert eine DataTable-Optionen überprüft, aber die Methoden zum Benennen `FillByCategoryID` und `GetProductsByCategoryID`.</span><span class="sxs-lookup"><span data-stu-id="2056e-164">Leave both the Fill a DataTable and Return a DataTable options checked, but rename the methods to `FillByCategoryID` and `GetProductsByCategoryID`.</span></span> <span data-ttu-id="2056e-165">Klicken Sie dann auf Weiter, um eine Zusammenfassung der Aufgaben zu überprüfen, die der Assistent ausführt.</span><span class="sxs-lookup"><span data-stu-id="2056e-165">Then click Next to review a summary of the tasks the wizard will perform.</span></span> <span data-ttu-id="2056e-166">Wenn alles richtig aussieht, klicken Sie auf "Fertig stellen".</span><span class="sxs-lookup"><span data-stu-id="2056e-166">If everything looks correct, click Finish.</span></span>


<span data-ttu-id="2056e-167">[![Name der Methoden FillByCategoryID und GetProductsByCategoryID](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image17.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="2056e-167">[![Name the Methods FillByCategoryID and GetProductsByCategoryID](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image17.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image16.png)</span></span>

<span data-ttu-id="2056e-168">**Abbildung 6**: Benennen Sie die Methoden `FillByCategoryID` und `GetProductsByCategoryID` ([klicken Sie hier, um das Bild in voller Größe angezeigt](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="2056e-168">**Figure 6**: Name the Methods `FillByCategoryID` and `GetProductsByCategoryID` ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image18.png))</span></span>


> [!NOTE]
> <span data-ttu-id="2056e-169">Die TableAdapter-Methoden, die soeben erstellt wurde, `FillByCategoryID` und `GetProductsByCategoryID`, erwarten, dass einen Eingabeparameter vom Typ `int`.</span><span class="sxs-lookup"><span data-stu-id="2056e-169">The TableAdapter methods we just created, `FillByCategoryID` and `GetProductsByCategoryID`, expect an input parameter of type `int`.</span></span> <span data-ttu-id="2056e-170">Dieser Eingabeparameterwert wird übergeben, in der gespeicherten Prozedur über seine `@CategoryID` Parameter.</span><span class="sxs-lookup"><span data-stu-id="2056e-170">This input parameter value is passed into the stored procedure via its `@CategoryID` parameter.</span></span> <span data-ttu-id="2056e-171">Wenn Sie ändern die `Products_SelectByCategory` Parameter der gespeicherten Prozeduren s, Sie müssen auch die Parameter für diese TableAdapter-Methoden zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="2056e-171">If you modify the `Products_SelectByCategory` stored procedure s parameters, you'll need to also update the parameters for these TableAdapter methods.</span></span> <span data-ttu-id="2056e-172">Entsprechend der Anleitung unter dem [vorherigen Lernprogramm](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md), dies kann auf zwei Arten ausgeführt werden: durch manuell hinzufügen oder Entfernen von Parametern aus der Parameterauflistung oder durch den TableAdapter-Assistenten erneut.</span><span class="sxs-lookup"><span data-stu-id="2056e-172">As discussed in the [previous tutorial](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md), this can be done in one of two ways: by manually adding or removing parameters from the parameters collection or by rerunning the TableAdapter wizard.</span></span>


## <a name="step-3-adding-agetproductsbycategoryidcategoryidmethod-to-the-bll"></a><span data-ttu-id="2056e-173">Schritt 3: Hinzufügen einer`GetProductsByCategoryID(categoryID)`Methode, um die BLL</span><span class="sxs-lookup"><span data-stu-id="2056e-173">Step 3: Adding a`GetProductsByCategoryID(categoryID)`Method to the BLL</span></span>

<span data-ttu-id="2056e-174">Mit der `GetProductsByCategoryID` DAL-Methode abgeschlossen, der nächste Schritt ist für den Zugriff auf diese Methode in der Geschäftslogikebene.</span><span class="sxs-lookup"><span data-stu-id="2056e-174">With the `GetProductsByCategoryID` DAL method complete, the next step is to provide access to this method in the Business Logic Layer.</span></span> <span data-ttu-id="2056e-175">Öffnen der `ProductsBLLWithSprocs` Klassendatei, und fügen Sie die folgende Methode hinzu:</span><span class="sxs-lookup"><span data-stu-id="2056e-175">Open the `ProductsBLLWithSprocs` class file and add the following method:</span></span>


[!code-csharp[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/samples/sample2.cs)]

<span data-ttu-id="2056e-176">Diese Methode BLL gibt einfach auftragsantwortnachrichten zurück die `ProductsDataTable` Merry der `ProductsTableAdapter` s `GetProductsByCategoryID` Methode.</span><span class="sxs-lookup"><span data-stu-id="2056e-176">This BLL method simply returns the `ProductsDataTable` returned from the `ProductsTableAdapter` s `GetProductsByCategoryID` method.</span></span> <span data-ttu-id="2056e-177">Die `DataObjectMethodAttribute` Attribut enthält Metadaten, die vom ObjectDataSource s Konfigurieren von Datenquellen-Assistenten verwendet.</span><span class="sxs-lookup"><span data-stu-id="2056e-177">The `DataObjectMethodAttribute` attribute provides metadata used by the ObjectDataSource s Configure Data Source wizard.</span></span> <span data-ttu-id="2056e-178">Diese Methode wird vor allem in der Registerkarte "SELECT" s Dropdown-Liste angezeigt.</span><span class="sxs-lookup"><span data-stu-id="2056e-178">In particular, this method will appear in the SELECT tab s drop-down list.</span></span>

## <a name="step-4-displaying-products-by-category"></a><span data-ttu-id="2056e-179">Schritt 4: Anzeigen von Produkten nach Kategorie</span><span class="sxs-lookup"><span data-stu-id="2056e-179">Step 4: Displaying Products by Category</span></span>

<span data-ttu-id="2056e-180">So testen Sie die neu hinzugefügte `Products_SelectByCategoryID` gespeicherte Prozedur und die entsprechenden DAL und BLL Methoden können s eine ASP.NET-Seite zu erstellen, die einer DropDownList und eine GridView enthält.</span><span class="sxs-lookup"><span data-stu-id="2056e-180">To test the newly added `Products_SelectByCategoryID` stored procedure and the corresponding DAL and BLL methods, let s create an ASP.NET page that contains a DropDownList and a GridView.</span></span> <span data-ttu-id="2056e-181">Der DropDownList werden alle Kategorien in der Datenbank aufgelistet, während die GridView Produkte zur ausgewählten Kategorie angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="2056e-181">The DropDownList will list all of the categories in the database while the GridView will display the products belonging to the selected category.</span></span>

> [!NOTE]
> <span data-ttu-id="2056e-182">Wir Ve erstellt Master/Detail-Schnittstellen mit DropDownLists im vorherigen Lernprogrammen.</span><span class="sxs-lookup"><span data-stu-id="2056e-182">We ve created master/detail interfaces using DropDownLists in previous tutorials.</span></span> <span data-ttu-id="2056e-183">Eine eingehendere Betrachtung ein solchen Master/Detail-Berichts implementieren, finden Sie in der [Master/Detail-Filtern mit einer DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) Lernprogramm.</span><span class="sxs-lookup"><span data-stu-id="2056e-183">For a more in-depth look at implementing such a master/detail report, refer to the [Master/Detail Filtering With a DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) tutorial.</span></span>


<span data-ttu-id="2056e-184">Öffnen der `ExistingSprocs.aspx` auf der Seite der `AdvancedDAL` Ordner, und ziehen Sie eine DropDownList aus der Toolbox in den Designer.</span><span class="sxs-lookup"><span data-stu-id="2056e-184">Open the `ExistingSprocs.aspx` page in the `AdvancedDAL` folder and drag a DropDownList from the Toolbox onto the Designer.</span></span> <span data-ttu-id="2056e-185">Festlegen der DropDownList-s `ID` Eigenschaft `Categories` und seine `AutoPostBack` Eigenschaft `true`.</span><span class="sxs-lookup"><span data-stu-id="2056e-185">Set the DropDownList s `ID` property to `Categories` and its `AutoPostBack` property to `true`.</span></span> <span data-ttu-id="2056e-186">Als Nächstes aus seinem Smarttag an eine neue ObjectDataSource mit dem Namen der DropDownList binden `CategoriesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="2056e-186">Next, from its smart tag, bind the DropDownList to a new ObjectDataSource named `CategoriesDataSource`.</span></span> <span data-ttu-id="2056e-187">Das ObjectDataSource so konfigurieren, dass abgerufen, deren Daten aus der `CategoriesBLL` Klasse s `GetCategories` Methode.</span><span class="sxs-lookup"><span data-stu-id="2056e-187">Configure the ObjectDataSource so that it retrieves its data from the `CategoriesBLL` class s `GetCategories` method.</span></span> <span data-ttu-id="2056e-188">Legen Sie die Dropdownlisten in der Update-, INSERT-, und Löschen von Registerkarten (keine).</span><span class="sxs-lookup"><span data-stu-id="2056e-188">Set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) .</span></span>


<span data-ttu-id="2056e-189">[![Abrufen von Daten aus der CategoriesBLL Klasse s GetCategories-Methode](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image20.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="2056e-189">[![Retrieve Data from the CategoriesBLL Class s GetCategories Method](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image20.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image19.png)</span></span>

<span data-ttu-id="2056e-190">**Abbildung 7**: Abrufen von Daten aus der `CategoriesBLL` Klasse s `GetCategories` Methode ([klicken Sie hier, um das Bild in voller Größe angezeigt](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="2056e-190">**Figure 7**: Retrieve Data from the `CategoriesBLL` Class s `GetCategories` Method ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image21.png))</span></span>


<span data-ttu-id="2056e-191">[![Legen Sie die Dropdownlisten in der Update-, INSERT- und Löschen von Registerkarten auf (keine)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image23.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="2056e-191">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image23.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image22.png)</span></span>

<span data-ttu-id="2056e-192">**Abbildung 8**: Legen Sie das Dropdown-Listen in aktualisieren, einfügen und Löschen von Registerkarten auf (keine) ([klicken Sie hier, um das Bild in voller Größe angezeigt](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="2056e-192">**Figure 8**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image24.png))</span></span>


<span data-ttu-id="2056e-193">Konfigurieren Sie nach Abschluss des Assistenten ObjectDataSource der DropDownList zum Anzeigen der `CategoryName` Feld "Daten" und für die Verwendung der `CategoryID` -Felds ist, als die `Value` für jede `ListItem`.</span><span class="sxs-lookup"><span data-stu-id="2056e-193">After completing the ObjectDataSource wizard, configure the DropDownList to display the `CategoryName` data field and to use the `CategoryID` field as the `Value` for each `ListItem`.</span></span>

<span data-ttu-id="2056e-194">An diesem Punkt sollte DropDownList und ObjectDataSource s deklarative Markup etwa wie folgt:</span><span class="sxs-lookup"><span data-stu-id="2056e-194">At this point, the DropDownList and ObjectDataSource s declarative markup should similar to the following:</span></span>


[!code-aspx[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/samples/sample3.aspx)]

<span data-ttu-id="2056e-195">Ziehen Sie anschließend eine GridView in den Designer, und platzieren es unterhalb der Dropdownliste aus.</span><span class="sxs-lookup"><span data-stu-id="2056e-195">Next, drag a GridView onto the Designer, placing it beneath the DropDownList.</span></span> <span data-ttu-id="2056e-196">Legen Sie die GridView s `ID` auf `ProductsByCategory` und aus seinem Smarttag binden Sie es an eine neue ObjectDataSource mit dem Namen `ProductsByCategoryDataSource`.</span><span class="sxs-lookup"><span data-stu-id="2056e-196">Set the GridView s `ID` to `ProductsByCategory` and, from its smart tag, bind it to a new ObjectDataSource named `ProductsByCategoryDataSource`.</span></span> <span data-ttu-id="2056e-197">Konfigurieren der `ProductsByCategoryDataSource` ObjectDataSource verwenden die `ProductsBLLWithSprocs` -Klasse, wenn sich beide Komponenten rufen Sie die Daten mithilfe der `GetProductsByCategoryID(categoryID)` Methode.</span><span class="sxs-lookup"><span data-stu-id="2056e-197">Configure the `ProductsByCategoryDataSource` ObjectDataSource to use the `ProductsBLLWithSprocs` class, having it retrieve its data using the `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="2056e-198">Seit dieser GridView nur zum Anzeigen von Daten verwendet werden wird, legen Sie die Dropdownlisten in der Update-, INSERT- und Löschen von Registerkarten (keine), und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="2056e-198">Since this GridView will only be used to display data, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) and click Next.</span></span>


<span data-ttu-id="2056e-199">[![Konfigurieren der ObjectDataSource zur Verwendung der ProductsBLLWithSprocs-Klasse](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image26.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="2056e-199">[![Configure the ObjectDataSource to Use the ProductsBLLWithSprocs Class](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image26.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image25.png)</span></span>

<span data-ttu-id="2056e-200">**Abbildung 9**: Konfigurieren der ObjectDataSource verwenden die `ProductsBLLWithSprocs` Klasse ([klicken Sie hier, um das Bild in voller Größe angezeigt](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="2056e-200">**Figure 9**: Configure the ObjectDataSource to Use the `ProductsBLLWithSprocs` Class ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image27.png))</span></span>


<span data-ttu-id="2056e-201">[![Abrufen von Daten aus der GetProductsByCategoryID(categoryID)-Methode](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image29.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="2056e-201">[![Retrieve Data from the GetProductsByCategoryID(categoryID) Method](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image29.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image28.png)</span></span>

<span data-ttu-id="2056e-202">**Abbildung 10**: Abrufen von Daten aus der `GetProductsByCategoryID(categoryID)` Methode ([klicken Sie hier, um das Bild in voller Größe angezeigt](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="2056e-202">**Figure 10**: Retrieve Data from the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image30.png))</span></span>


<span data-ttu-id="2056e-203">Die Methode, die in der Registerkarte "SELECT" ausgewählt wurde erwartet einen Parameter aus, damit der letzte Schritt des Assistenten für die Quelle des Parameters s uns aufgefordert werden.</span><span class="sxs-lookup"><span data-stu-id="2056e-203">The method chosen in the SELECT tab expects a parameter, so the final step of the wizard prompts us for the parameter s source.</span></span> <span data-ttu-id="2056e-204">Festlegen der Parameter-Quellliste Dropdown-Steuerelement, und wählen Sie die `Categories` -Steuerelement aus der Dropdownliste ControlID.</span><span class="sxs-lookup"><span data-stu-id="2056e-204">Set the Parameter source drop-down list to Control and choose the `Categories` control from the ControlID drop-down list.</span></span> <span data-ttu-id="2056e-205">Klicken Sie auf ' Fertig stellen ', um den Assistenten abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="2056e-205">Click Finish to complete the wizard.</span></span>


<span data-ttu-id="2056e-206">[![Verwenden der DropDownList Kategorien als Quelle für die CategoryID-Parameter](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image32.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="2056e-206">[![Use the Categories DropDownList as the Source of the categoryID Parameter](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image32.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image31.png)</span></span>

<span data-ttu-id="2056e-207">**Abbildung 11**: Verwenden der `Categories` DropDownList als Quelle für die `categoryID` Parameter ([klicken Sie hier, um das Bild in voller Größe angezeigt](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="2056e-207">**Figure 11**: Use the `Categories` DropDownList as the Source of the `categoryID` Parameter ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image33.png))</span></span>


<span data-ttu-id="2056e-208">Nach Abschluss des Assistenten ObjectDataSource wird Visual Studio BoundFields und eine CheckBoxField für jedes der Felder Product Daten hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="2056e-208">Upon completing the ObjectDataSource wizard, Visual Studio will add BoundFields and a CheckBoxField for each of the product data fields.</span></span> <span data-ttu-id="2056e-209">Wahlweise können Sie diese Felder anpassen, nach Bedarf.</span><span class="sxs-lookup"><span data-stu-id="2056e-209">Feel free to customize these fields as you see fit.</span></span>

<span data-ttu-id="2056e-210">Besuchen Sie die Seite über einen Browser.</span><span class="sxs-lookup"><span data-stu-id="2056e-210">Visit the page through a browser.</span></span> <span data-ttu-id="2056e-211">Beim Zugriff auf die Seite die Kategorie "Getränke" ausgewählt ist und die entsprechenden Produkte im Raster aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="2056e-211">When visiting the page the Beverages category is selected and the corresponding products listed in the grid.</span></span> <span data-ttu-id="2056e-212">Ändern die Dropdown-Liste in einer alternativen Kategorie als Abbildung 12 zeigt, bewirkt ein Postback und lädt das Raster mit den Produkten der neu ausgewählte Kategorie.</span><span class="sxs-lookup"><span data-stu-id="2056e-212">Changing the drop-down list to an alternative category, as Figure 12 shows, causes a postback and reloads the grid with the products of the newly selected category.</span></span>


<span data-ttu-id="2056e-213">[![Die Produkte in der Kategorie erzeugen werden angezeigt.](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image35.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="2056e-213">[![The Products in the Produce Category are Displayed](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image35.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image34.png)</span></span>

<span data-ttu-id="2056e-214">**Abbildung 12**: der Produkte in der Kategorie zu erzeugen, werden angezeigt ([klicken Sie hier, um das Bild in voller Größe angezeigt](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="2056e-214">**Figure 12**: The Products in the Produce Category are Displayed ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image36.png))</span></span>


## <a name="step-5-wrapping-a-stored-procedure-s-statements-within-the-scope-of-a-transaction"></a><span data-ttu-id="2056e-215">Schritt 5: Wrapping s-Anweisungen eine gespeicherte Prozedur innerhalb des Bereichs einer Transaktion</span><span class="sxs-lookup"><span data-stu-id="2056e-215">Step 5: Wrapping a Stored Procedure s Statements Within the Scope of a Transaction</span></span>

<span data-ttu-id="2056e-216">In der [Umbruch Datenbankänderungen innerhalb einer Transaktion](../working-with-batched-data/wrapping-database-modifications-within-a-transaction-cs.md) Lernprogramm erörterten Techniken zum Ausführen einer Reihe von Datenbank-änderungsanweisungen innerhalb des Bereichs einer Transaktion.</span><span class="sxs-lookup"><span data-stu-id="2056e-216">In the [Wrapping Database Modifications within a Transaction](../working-with-batched-data/wrapping-database-modifications-within-a-transaction-cs.md) tutorial we discussed techniques for performing a series of database modification statements within the scope of a transaction.</span></span> <span data-ttu-id="2056e-217">Wie bereits erwähnt, die die Änderungen des wirkungsfelds einer Transaktion ausgeführt wurde, entweder alle erfolgreich ausgeführt werden, oder alle Fehler, die Unteilbarkeit gewährleistet.</span><span class="sxs-lookup"><span data-stu-id="2056e-217">Recall that the modifications performed under the umbrella of a transaction either all succeed or all fail, guaranteeing atomicity.</span></span> <span data-ttu-id="2056e-218">Methoden für die Verwendung von Transaktionen umfassen Folgendes:</span><span class="sxs-lookup"><span data-stu-id="2056e-218">Techniques for using transactions include:</span></span>

- <span data-ttu-id="2056e-219">Verwenden der Klassen in der `System.Transactions` -Namespace</span><span class="sxs-lookup"><span data-stu-id="2056e-219">Using the classes in the `System.Transactions` namespace,</span></span>
- <span data-ttu-id="2056e-220">Die Datenzugriffsebene nutzen ADO.NET-Klassen wie `SqlTransaction`, und</span><span class="sxs-lookup"><span data-stu-id="2056e-220">Having the Data Access Layer use ADO.NET classes like `SqlTransaction`, and</span></span>
- <span data-ttu-id="2056e-221">Hinzufügen der T-SQL-Transaktion-Befehle direkt in der gespeicherten Prozedur</span><span class="sxs-lookup"><span data-stu-id="2056e-221">Adding the T-SQL transaction commands directly within the stored procedure</span></span>

<span data-ttu-id="2056e-222">Die *Umbruch Datenbankänderungen innerhalb einer Transaktion* Lernprogramm die ADO.NET-Klassen in der DAL verwendet.</span><span class="sxs-lookup"><span data-stu-id="2056e-222">The *Wrapping Database Modifications within a Transaction* tutorial used the ADO.NET classes in the DAL.</span></span> <span data-ttu-id="2056e-223">Im weiteren Verlauf dieses Lernprogramms untersucht, wie eine Transaktion mit T-SQL-Befehlen innerhalb einer gespeicherten Prozedur zu verwalten.</span><span class="sxs-lookup"><span data-stu-id="2056e-223">The remainder of this tutorial examines how to manage a transaction using T-SQL commands from within a stored procedure.</span></span>

<span data-ttu-id="2056e-224">Die drei wichtigsten SQL-Befehle für manuell starten, Commit und Rollback einer Transaktion sind `BEGIN TRANSACTION`, `COMMIT TRANSACTION`, und `ROLLBACK TRANSACTION`zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="2056e-224">The three key SQL commands for manually starting, committing, and rolling back a transaction are `BEGIN TRANSACTION`, `COMMIT TRANSACTION`, and `ROLLBACK TRANSACTION`, respectively.</span></span> <span data-ttu-id="2056e-225">Wie mit den ADO.NET-Ansatz, wenn Transaktionen in einer gespeicherten Prozedur verwenden, wir das folgende Muster angewendet müssen:</span><span class="sxs-lookup"><span data-stu-id="2056e-225">Like with the ADO.NET approach, when using transactions from within a stored procedure we need to apply the following pattern:</span></span>

1. <span data-ttu-id="2056e-226">Geben Sie an den Anfang einer Transaktion.</span><span class="sxs-lookup"><span data-stu-id="2056e-226">Indicate the start of a transaction.</span></span>
2. <span data-ttu-id="2056e-227">Führen Sie die SQL-Anweisungen, die die Transaktion zu bilden.</span><span class="sxs-lookup"><span data-stu-id="2056e-227">Execute the SQL statements that comprise the transaction.</span></span>
3. <span data-ttu-id="2056e-228">Wenn ein Fehler in einer der Anweisungen aus Schritt2, Rollback der Transaktion vorhanden ist</span><span class="sxs-lookup"><span data-stu-id="2056e-228">If there is an error in any one of the statements from Step 2, rollback the transaction</span></span>
4. <span data-ttu-id="2056e-229">Wenn alle Anweisungen aus Schritt2 ohne Fehler abgeschlossen werden, ein commit der Transaktions.</span><span class="sxs-lookup"><span data-stu-id="2056e-229">If all of the statements from Step 2 complete without error, commit the transaction.</span></span>

<span data-ttu-id="2056e-230">Dieses Muster kann in T-SQL-Syntax, die mithilfe der folgenden Vorlage implementiert werden:</span><span class="sxs-lookup"><span data-stu-id="2056e-230">This pattern can be implemented in T-SQL syntax using the following template:</span></span>


[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/samples/sample4.sql)]

<span data-ttu-id="2056e-231">Die Vorlage beginnt mit dem Definieren einer `TRY...CATCH` ein Konstrukt, das noch nicht mit SQL Server 2005 zu blockieren.</span><span class="sxs-lookup"><span data-stu-id="2056e-231">The template starts by defining a `TRY...CATCH` block, a construct new to SQL Server 2005.</span></span> <span data-ttu-id="2056e-232">LIKE mit `try...catch` Blöcke in C#-, SQL `TRY...CATCH` Block wird ausgeführt, die Anweisungen in der `TRY` Block.</span><span class="sxs-lookup"><span data-stu-id="2056e-232">Like with `try...catch` blocks in C#, the SQL `TRY...CATCH` block executes the statements in the `TRY` block.</span></span> <span data-ttu-id="2056e-233">Wenn eine Anweisung einen Fehler auslöst, wird die Steuerung sofort an die `CATCH` Block.</span><span class="sxs-lookup"><span data-stu-id="2056e-233">If any statement raises an error, control is immediately transferred to the `CATCH` block.</span></span>

<span data-ttu-id="2056e-234">Wenn keine Fehler Ausführen der SQL-Anweisungen, Zusammensetzung der Transaktion die `COMMIT TRANSACTION` -Anweisung führt einen Commit der Änderungen und schließt die Transaktion.</span><span class="sxs-lookup"><span data-stu-id="2056e-234">If there are no errors executing the SQL statements that makeup the transaction, the `COMMIT TRANSACTION` statement commits the changes and completes the transaction.</span></span> <span data-ttu-id="2056e-235">Wenn jedoch einer der Anweisungen zu einem Fehler führt der `ROLLBACK TRANSACTION` in die `CATCH` Block wird die Datenbank in den Zustand vor dem Start der Transaktion.</span><span class="sxs-lookup"><span data-stu-id="2056e-235">If, however, one of the statements results in an error, the `ROLLBACK TRANSACTION` in the `CATCH` block returns the database to its state prior to the start of the transaction.</span></span> <span data-ttu-id="2056e-236">Die gespeicherte Prozedur auch löst einen Fehler mit der [RAISERROR-Befehl](https://msdn.microsoft.com/library/ms178592.aspx), wodurch eine `SqlException` , die in der Anwendung ausgelöst werden.</span><span class="sxs-lookup"><span data-stu-id="2056e-236">The stored procedure also raises an error using the [RAISERROR command](https://msdn.microsoft.com/library/ms178592.aspx), which causes a `SqlException` to be raised in the application.</span></span>

> [!NOTE]
> <span data-ttu-id="2056e-237">Da die `TRY...CATCH` Block ist neu in SQL Server 2005, die oben stehende Vorlage kann nicht ausgeführt werden, wenn Sie ältere Versionen von Microsoft SQL Server verwenden.</span><span class="sxs-lookup"><span data-stu-id="2056e-237">Since the `TRY...CATCH` block is new to SQL Server 2005, the above template will not work if you are using older versions of Microsoft SQL Server.</span></span> <span data-ttu-id="2056e-238">Wenn Sie SQL Server 2005 nicht verwenden, wenden Sie sich an [Verwalten von Transaktionen in gespeicherten Prozeduren von SQL Server](http://www.4guysfromrolla.com/webtech/080305-1.shtml) für eine Vorlage, die mit anderen Versionen von SQL Server verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="2056e-238">If you are not using SQL Server 2005, consult [Managing Transactions in SQL Server Stored Procedures](http://www.4guysfromrolla.com/webtech/080305-1.shtml) for a template that will work with other versions of SQL Server.</span></span>


<span data-ttu-id="2056e-239">Lassen Sie s eine konkrete Beispiel betrachten.</span><span class="sxs-lookup"><span data-stu-id="2056e-239">Let s look at a concrete example.</span></span> <span data-ttu-id="2056e-240">Eine foreign Key-Einschränkung besteht zwischen der `Categories` und `Products` Tabellen, was bedeutet, dass jedes `CategoryID` -Feld in der `Products` Tabelle zuordnen muss eine `CategoryID` Wert in der `Categories` Tabelle.</span><span class="sxs-lookup"><span data-stu-id="2056e-240">A foreign key constraint exists between the `Categories` and `Products` tables, meaning that each `CategoryID` field in the `Products` table must map to a `CategoryID` value in the `Categories` table.</span></span> <span data-ttu-id="2056e-241">Alle Aktionen, die verletzen würde diese Einschränkung, z. B. versuchen, eine Kategorie zu löschen, die Produkte verknüpft ist, führt zu einer Verletzung der foreign Key-Einschränkung.</span><span class="sxs-lookup"><span data-stu-id="2056e-241">Any action that would violate this constraint, such as attempting to delete a category that has associated products, results in a foreign key constraint violation.</span></span> <span data-ttu-id="2056e-242">Um dies zu überprüfen, rufen Sie das Beispiel aktualisieren und Löschen von vorhandenen Binärdaten in das Arbeiten mit Binärdaten Abschnitt (`~/BinaryData/UpdatingAndDeleting.aspx`).</span><span class="sxs-lookup"><span data-stu-id="2056e-242">To verify this, revisit the Updating and Deleting Existing Binary Data example in the Working with Binary Data section (`~/BinaryData/UpdatingAndDeleting.aspx`).</span></span> <span data-ttu-id="2056e-243">Auf dieser Seite sind die einzelnen Kategorien im System zusammen mit den Schaltflächen "Bearbeiten" und "Delete" (siehe Abbildung 13), aber wenn Sie versuchen, eine Kategorie löschen, Produkte,-z. B. Getränke - zugeordnet sind, die Delete schlägt fehl, aufgrund einer Verletzung der foreign Key-Einschränkung (siehe Abbildung 14).</span><span class="sxs-lookup"><span data-stu-id="2056e-243">This page lists each category in the system along with Edit and Delete buttons (see Figure 13), but if you attempt to delete a category that has associated products - such as Beverages - the delete fails due to a foreign key constraint violation (see Figure 14).</span></span>


<span data-ttu-id="2056e-244">[![Jede Kategorie wird in einem GridView mit bearbeiten und Löschen von Schaltflächen angezeigt.](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image38.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="2056e-244">[![Each Category is Displayed in a GridView with Edit and Delete Buttons](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image38.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image37.png)</span></span>

<span data-ttu-id="2056e-245">**Abbildung 13**: jede Kategorie wird angezeigt, in einem GridView mit den Schaltflächen löschen und bearbeiten ([klicken Sie hier, um das Bild in voller Größe angezeigt](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="2056e-245">**Figure 13**: Each Category is Displayed in a GridView with Edit and Delete Buttons ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image39.png))</span></span>


<span data-ttu-id="2056e-246">[![Sie können eine Kategorie löschen, vorhandene Produkte hat](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image41.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="2056e-246">[![You Cannot Delete a Category that has Existing Products](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image41.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image40.png)</span></span>

<span data-ttu-id="2056e-247">**Abbildung 14**: eine Kategorie, die vorhandene Produkte kann nicht gelöscht werden ([klicken Sie hier, um das Bild in voller Größe angezeigt](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="2056e-247">**Figure 14**: You Cannot Delete a Category that has Existing Products ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image42.png))</span></span>


<span data-ttu-id="2056e-248">Angenommen Sie, jedoch, dass wir erlauben Kategorien gelöscht werden soll, unabhängig davon, ob sie Produkte verknüpft haben möchten.</span><span class="sxs-lookup"><span data-stu-id="2056e-248">Imagine, though, that we want to allow categories to be deleted regardless of whether they have associated products.</span></span> <span data-ttu-id="2056e-249">Eine Kategorie mit Produkte gelöscht werden soll, angenommen, wir auch löschen, deren vorhandene Produkte möchten (obwohl eine andere Möglichkeit wäre, seine Produkte einfach festzulegende `CategoryID` Werte `NULL`).</span><span class="sxs-lookup"><span data-stu-id="2056e-249">Should a category with products be deleted, imagine that we want to also delete its existing products (although another option would be to simply set its products `CategoryID` values to `NULL`).</span></span> <span data-ttu-id="2056e-250">Diese Funktionalität kann durch die Cascade-Regeln der foreign Key-Einschränkung implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="2056e-250">This functionality could be implemented through the cascade rules of the foreign key constraint.</span></span> <span data-ttu-id="2056e-251">Es konnte auch eine gespeicherte Prozedur, die akzeptiert erstellt eine `@CategoryID` Eingabeparameter und beim Aufrufen, löscht explizit alle die zugehörigen Produkte, und klicken Sie dann die angegebene Kategorie.</span><span class="sxs-lookup"><span data-stu-id="2056e-251">Alternatively, we could create a stored procedure that accepts a `@CategoryID` input parameter and, when invoked, explicitly deletes all of the associated products and then the specified category.</span></span>

<span data-ttu-id="2056e-252">Unsere erste Versuch zum solche gespeicherte Prozedur kann wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="2056e-252">Our first attempt at such a stored procedure might look like the following:</span></span>


[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/samples/sample5.sql)]

<span data-ttu-id="2056e-253">Während dies die zugehörige Produkte und die Kategorie definitiv gelöscht werden, ist dies nicht des wirkungsfelds einer Transaktion erfolgen.</span><span class="sxs-lookup"><span data-stu-id="2056e-253">While this will definitely delete the associated products and category, it does not do so under the umbrella of a transaction.</span></span> <span data-ttu-id="2056e-254">Stellen Sie sich vor, dass einige andere foreign Key-Einschränkung auf `Categories` würde, die das Löschen eines bestimmten verbieten `@CategoryID` Wert.</span><span class="sxs-lookup"><span data-stu-id="2056e-254">Imagine that there is some other foreign key constraint on `Categories` that would prohibit the deletion of a particular `@CategoryID` value.</span></span> <span data-ttu-id="2056e-255">Das Problem ist, dass in einem solchen Fall alle Produkte gelöscht werden, bevor wir versuchen, das die Kategorie zu löschen.</span><span class="sxs-lookup"><span data-stu-id="2056e-255">The problem is that in such a case all of the products will be deleted before we attempt to delete the category.</span></span> <span data-ttu-id="2056e-256">Das Ergebnis darin, dass für eine Kategorie, der diese gespeicherte Prozedur alle seine Produkte entfernen würden während die Kategorie verblieben sind, da er weiterhin Datensätze in einer anderen Tabelle verknüpft wurde.</span><span class="sxs-lookup"><span data-stu-id="2056e-256">The net result is that for such a category, this stored procedure would remove all of its products while the category remained since it still has related records in some other table.</span></span>

<span data-ttu-id="2056e-257">Wenn die gespeicherte Prozedur innerhalb des Bereichs einer Transaktion, jedoch die Löschvorgänge zu umschlossen wurden die `Products` Tabelle würde auf ein Rollback bei einem Fehler beim Löschen `Categories`.</span><span class="sxs-lookup"><span data-stu-id="2056e-257">If the stored procedure were wrapped within the scope of a transaction, however, the deletes to the `Products` table would be rolled back in the face of a failed delete on `Categories`.</span></span> <span data-ttu-id="2056e-258">Das folgende Skript für die gespeicherte Prozedur eine Transaktion verwendet, um die Unteilbarkeit zwischen den beiden gewährleisten `DELETE` Anweisungen:</span><span class="sxs-lookup"><span data-stu-id="2056e-258">The following stored procedure script uses a transaction to assure atomicity between the two `DELETE` statements:</span></span>


[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/samples/sample6.sql)]

<span data-ttu-id="2056e-259">Hinzuzufügende erkundet die `Categories_Delete` gespeicherte Prozedur mit der Datenbank Northwind.</span><span class="sxs-lookup"><span data-stu-id="2056e-259">Take a moment to add the `Categories_Delete` stored procedure to the Northwind database.</span></span> <span data-ttu-id="2056e-260">Verweisen Sie zurück zu Schritt 1 Anleitungen zum Hinzufügen von gespeicherten Prozeduren in einer Datenbank.</span><span class="sxs-lookup"><span data-stu-id="2056e-260">Refer back to Step 1 for instructions on adding stored procedures to a database.</span></span>

## <a name="step-6-updating-thecategoriestableadapter"></a><span data-ttu-id="2056e-261">Schritt 6: Aktualisieren der`CategoriesTableAdapter`</span><span class="sxs-lookup"><span data-stu-id="2056e-261">Step 6: Updating the`CategoriesTableAdapter`</span></span>

<span data-ttu-id="2056e-262">Bei der es hinzugefügt haben die `Categories_Delete` gespeicherte Prozedur mit der Datenbank, die DAL ist derzeit so konfiguriert, dass um Ad-hoc-SQL-Anweisungen zu verwenden, um den Löschvorgang auszuführen.</span><span class="sxs-lookup"><span data-stu-id="2056e-262">While we ve added the `Categories_Delete` stored procedure to the database, the DAL is currently configured to use ad-hoc SQL statements to perform the delete.</span></span> <span data-ttu-id="2056e-263">Wir aktualisieren müssen die `CategoriesTableAdapter` und anweisen, um die Verwendung der `Categories_Delete` stattdessen gespeicherte Prozedur.</span><span class="sxs-lookup"><span data-stu-id="2056e-263">We need to update the `CategoriesTableAdapter` and instruct it to use the `Categories_Delete` stored procedure instead.</span></span>

> [!NOTE]
> <span data-ttu-id="2056e-264">Weiter oben in diesem Lernprogramm wurden wir arbeiten mit den `NorthwindWithSprocs` DataSet.</span><span class="sxs-lookup"><span data-stu-id="2056e-264">Earlier in this tutorial we were working with the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="2056e-265">Aber, dass DataSet nur eine einzelne Entität `ProductsDataTable`, und wir arbeiten mit Kategorien müssen.</span><span class="sxs-lookup"><span data-stu-id="2056e-265">But that DataSet only has a single entity, `ProductsDataTable`, and we need to work with categories.</span></span> <span data-ttu-id="2056e-266">Aus diesem Grund für den Rest dieses Lernprogramms, wenn ich das Data Access Layer I-m verweisen auf Erörtern der `Northwind` DataSet, das Projekt, das wir zuerst im erstellt die [erstellen eine Datenzugriffsschicht](../introduction/creating-a-data-access-layer-cs.md) Lernprogramm.</span><span class="sxs-lookup"><span data-stu-id="2056e-266">Therefore, for the remainder of this tutorial when I talk about the Data Access Layer I m referring to the `Northwind` DataSet, the one that we first created in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-cs.md) tutorial.</span></span>


<span data-ttu-id="2056e-267">Öffnen des Datasets Northwind wählen die `CategoriesTableAdapter`, und fahren Sie mit dem Eigenschaftenfenster.</span><span class="sxs-lookup"><span data-stu-id="2056e-267">Open the Northwind DataSet, select the `CategoriesTableAdapter`, and go to the Properties window.</span></span> <span data-ttu-id="2056e-268">Die Eigenschaften im Fensterlisten der `InsertCommand`, `UpdateCommand`, `DeleteCommand`, und `SelectCommand` TableAdapter als auch die Informationen und die Verbindungszeichenfolge verwendet.</span><span class="sxs-lookup"><span data-stu-id="2056e-268">The Properties window lists the `InsertCommand`, `UpdateCommand`, `DeleteCommand`, and `SelectCommand` used by the TableAdapter, as well as its name and connection information.</span></span> <span data-ttu-id="2056e-269">Erweitern Sie die `DeleteCommand` Eigenschaft zum Anzeigen von Details.</span><span class="sxs-lookup"><span data-stu-id="2056e-269">Expand the `DeleteCommand` property to see its details.</span></span> <span data-ttu-id="2056e-270">Wie in Abbildung 15 gezeigt, die `DeleteCommand` s `ComamndType` Eigenschaftensatz auf Text, den angewiesen wird, senden Sie den Text in der `CommandText` Eigenschaft als Ad-hoc-SQL-Abfrage.</span><span class="sxs-lookup"><span data-stu-id="2056e-270">As Figure 15 shows, the `DeleteCommand` s `ComamndType` property is set to Text, which instructs it to send the text in the `CommandText` property as an ad-hoc SQL query.</span></span>


![Wählen Sie die CategoriesTableAdapter im Designer, um seine Eigenschaften im Eigenschaftenfenster anzuzeigen.](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image43.png)

<span data-ttu-id="2056e-272">**Abbildung 15**: Wählen Sie die `CategoriesTableAdapter` im Designer, um seine Eigenschaften im Eigenschaftenfenster anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="2056e-272">**Figure 15**: Select the `CategoriesTableAdapter` in the Designer to View Its Properties in the Properties Window</span></span>


<span data-ttu-id="2056e-273">Um diese Einstellungen zu ändern, wählen Sie den Text (DeleteCommand) im Eigenschaftenfenster, und wählen Sie aus (neu) aus der Dropdown-Liste.</span><span class="sxs-lookup"><span data-stu-id="2056e-273">To change these settings, select the (DeleteCommand) text in the Properties window and choose (New) from the drop-down list.</span></span> <span data-ttu-id="2056e-274">Hiermit löschen Sie die Einstellungen für die `CommandText`, `CommandType`, und `Parameters` Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="2056e-274">This will clear out the settings for the `CommandText`, `CommandType`, and `Parameters` properties.</span></span> <span data-ttu-id="2056e-275">Legen Sie anschließend die `CommandType` Eigenschaft `StoredProcedure` , und geben Sie den Namen der gespeicherten Prozedur für die `CommandText` (`dbo.Categories_Delete`).</span><span class="sxs-lookup"><span data-stu-id="2056e-275">Next, set the `CommandType` property to `StoredProcedure` and then type in the name of the stored procedure for the `CommandText` (`dbo.Categories_Delete`).</span></span> <span data-ttu-id="2056e-276">Wenn Sie die Eigenschaften in dieser Reihenfolge - geben zuerst sicherstellen der `CommandType` und dann die `CommandText` -Visual Studio füllt automatisch die Parameters-Auflistung.</span><span class="sxs-lookup"><span data-stu-id="2056e-276">If you make sure to enter the properties in this order - first the `CommandType` and then the `CommandText` - Visual Studio will automatically populate the Parameters collection.</span></span> <span data-ttu-id="2056e-277">Wenn Sie diese Eigenschaften nicht in dieser Reihenfolge eingeben, müssen Sie die Parameter durch den Parameter-Auflistungs-Editor manuell hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="2056e-277">If you do not enter these properties in this order, you will have to manually add the parameters through the Parameters Collection Editor.</span></span> <span data-ttu-id="2056e-278">In beiden Fällen wird es s unerlässlich, klicken auf die Auslassungspunkte im Parameters-Eigenschaft, um den Auflistungs-Editor von Parameter zu bringen, um sicherzustellen, dass die richtigen Parameter Einstellungen Änderungen vorgenommen wurden (siehe Abbildung 16).</span><span class="sxs-lookup"><span data-stu-id="2056e-278">In either case, it s prudent to click on the ellipses in the Parameters property to bring up the Parameters Collection Editor to verify that the correct parameter settings changes have been made (see Figure 16).</span></span> <span data-ttu-id="2056e-279">Wenn alle Parameter im Dialogfeld nicht angezeigt wird, fügen Sie der `@CategoryID` Parameter manuell (müssen nicht hinzufügen der `@RETURN_VALUE` Parameter).</span><span class="sxs-lookup"><span data-stu-id="2056e-279">If you do not see any parameters in the dialog box, add the `@CategoryID` parameter manually (you do not need to add the `@RETURN_VALUE` parameter).</span></span>


![Stellen Sie sicher, dass die Parameter-Einstellungen richtig sind.](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs/_static/image44.png)

<span data-ttu-id="2056e-281">**Abbildung 16**: Stellen Sie sicher, dass die Parameter-Einstellungen richtig sind.</span><span class="sxs-lookup"><span data-stu-id="2056e-281">**Figure 16**: Ensure That the Parameters Settings are Correct</span></span>


<span data-ttu-id="2056e-282">Sobald die DAL aktualisiert wurde, löschen eine Kategorie automatisch Löschen aller seiner zugehörigen Produkte und dazu des wirkungsfelds einer Transaktion.</span><span class="sxs-lookup"><span data-stu-id="2056e-282">Once the DAL has been updated, deleting a category will automatically delete all of its associated products and do so under the umbrella of a transaction.</span></span> <span data-ttu-id="2056e-283">Um dies zu überprüfen, auf die Seite aktualisieren und Löschen von vorhandenen Binärdaten zurückgeben Sie, und klicken Sie auf die Schaltfläche "löschen" für eine der Kategorien.</span><span class="sxs-lookup"><span data-stu-id="2056e-283">To verify this, return to the Updating and Deleting Existing Binary Data page and click the Delete button for one of the categories.</span></span> <span data-ttu-id="2056e-284">Mit einem einzigen Mausklick der Maus werden der Kategorie und aller seiner zugehörigen Produkte gelöscht.</span><span class="sxs-lookup"><span data-stu-id="2056e-284">With one single click of the mouse, the category and all of its associated products will be deleted.</span></span>

> [!NOTE]
> <span data-ttu-id="2056e-285">Vor dem Testen der `Categories_Delete` gespeicherte Prozedur, die eine Anzahl der Produkte zusammen mit der ausgewählten Kategorie gelöscht werden, ist es möglicherweise empfehlenswert, eine Sicherungskopie der Datenbank erstellen.</span><span class="sxs-lookup"><span data-stu-id="2056e-285">Before testing the `Categories_Delete` stored procedure, which will delete a number of products along with the selected category, it might be prudent to make a backup copy of your database.</span></span> <span data-ttu-id="2056e-286">Bei Verwendung der `NORTHWND.MDF` in Datenbank `App_Data`, einfach schließen Sie Visual Studio, und kopieren Sie die MDF- und LDF-Dateien in `App_Data` zu einem anderen Ordner.</span><span class="sxs-lookup"><span data-stu-id="2056e-286">If you are using the `NORTHWND.MDF` database in `App_Data`, simply close Visual Studio and copy the MDF and LDF files in `App_Data` to some other folder.</span></span> <span data-ttu-id="2056e-287">Nach dem Testen der Funktionalität können Sie die Datenbank wiederherstellen, indem Sie Visual Studio schließen und ersetzen die aktuellen MDF- und LDF-Dateien im `App_Data` mit der Sicherungskopien.</span><span class="sxs-lookup"><span data-stu-id="2056e-287">After testing the functionality, you can restore the database by closing Visual Studio and replacing the current MDF and LDF files in `App_Data` with the backup copies.</span></span>


## <a name="summary"></a><span data-ttu-id="2056e-288">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="2056e-288">Summary</span></span>

<span data-ttu-id="2056e-289">Während der TableAdapter-s-Assistent automatisch für uns gespeicherte Prozeduren generiert, stehen die Zeiten, wenn wir bereits solchen gespeicherten Prozeduren erstellt oder könnten sie stattdessen manuell oder mit anderen Tools erstellt werden soll.</span><span class="sxs-lookup"><span data-stu-id="2056e-289">While the TableAdapter s wizard will automatically generate stored procedures for us, there are times when we might already have such stored procedures created or want to create them manually or with other tools instead.</span></span> <span data-ttu-id="2056e-290">Um solche Szenarien zu unterstützen, kann auch die TableAdapter konfiguriert werden, um auf eine vorhandene gespeicherte Prozedur verweisen.</span><span class="sxs-lookup"><span data-stu-id="2056e-290">To accommodate such scenarios, the TableAdapter can also be configured to point to an existing stored procedure.</span></span> <span data-ttu-id="2056e-291">In diesem Lernprogramm erläutert wird, wie gespeicherte Prozeduren manuell über die Visual Studio-Umgebung auf eine Datenbank hinzugefügt und die TableAdapter-s-Methoden, diese gespeicherten Prozeduren von Netzwerkdaten.</span><span class="sxs-lookup"><span data-stu-id="2056e-291">In this tutorial we looked at how to manually add stored procedures to a database through the Visual Studio environment and how to wire the TableAdapter s methods to these stored procedures.</span></span> <span data-ttu-id="2056e-292">Außerdem wird untersucht die T-SQL-Befehle und das Skript-Muster, die zum Starten und Ausführen eines Commits für Rollbacks von Transaktionen von innerhalb einer gespeicherten Prozedur.</span><span class="sxs-lookup"><span data-stu-id="2056e-292">We also examined the T-SQL commands and script pattern used for starting, committing, and rolling back transactions from within a stored procedure.</span></span>

<span data-ttu-id="2056e-293">Viel Spaß beim Programmieren!</span><span class="sxs-lookup"><span data-stu-id="2056e-293">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="2056e-294">Informationen zum Autor</span><span class="sxs-lookup"><span data-stu-id="2056e-294">About the Author</span></span>

<span data-ttu-id="2056e-295">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor von sieben ASP/ASP.NET-Büchern und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), Microsoft Web-Technologien seit 1998 arbeitet.</span><span class="sxs-lookup"><span data-stu-id="2056e-295">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="2056e-296">Scott fungiert als ein unabhängiger Berater, Trainer und Writer.</span><span class="sxs-lookup"><span data-stu-id="2056e-296">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="2056e-297">Sein neueste Buch wird [ *Sams Schulen selbst ASP.NET 2.0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="2056e-297">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="2056e-298">Er die erreicht werden kann, zur [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) oder über seinen Blog die finden Sie unter [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="2056e-298">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="2056e-299">Besonderen Dank an</span><span class="sxs-lookup"><span data-stu-id="2056e-299">Special Thanks To</span></span>

<span data-ttu-id="2056e-300">Diese Reihe von Lernprogrammen wurde durch viele nützliche Bearbeiter überprüft.</span><span class="sxs-lookup"><span data-stu-id="2056e-300">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="2056e-301">Lead Prüfer für dieses Lernprogramm wurden Hilton Geisenow S Ren Jacob Lauritsen und Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="2056e-301">Lead reviewers for this tutorial were Hilton Geisenow, S ren Jacob Lauritsen, and Teresa Murphy.</span></span> <span data-ttu-id="2056e-302">Meine bevorstehende MSDN-Artikel Überprüfen von Interesse?</span><span class="sxs-lookup"><span data-stu-id="2056e-302">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="2056e-303">Wenn dies der Fall ist, löschen Sie mich zeilenweise [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="2056e-303">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="2056e-304">[Zurück](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md)
> [Weiter](updating-the-tableadapter-to-use-joins-cs.md)</span><span class="sxs-lookup"><span data-stu-id="2056e-304">[Previous](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md)
[Next](updating-the-tableadapter-to-use-joins-cs.md)</span></span>
