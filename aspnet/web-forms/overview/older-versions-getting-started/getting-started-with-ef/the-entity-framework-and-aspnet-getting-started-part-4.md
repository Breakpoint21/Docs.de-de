---
uid: web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-4
title: Erste Schritte mit Entity Framework 4.0-Datenbank zunächst und ASP.NET 4 Web Forms - Teil 4 | Microsoft Docs
author: tdykstra
description: Die Contoso-University Beispielwebanwendung veranschaulicht, wie ASP.NET Web Forms-Anwendungen, die mit dem Entity Framework. Die beispielanwendung ist...
ms.author: aspnetcontent
manager: wpickett
ms.date: 12/03/2010
ms.topic: article
ms.assetid: ceb9e60f-957c-4d25-9331-cc527de96a33
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-4
msc.type: authoredcontent
ms.openlocfilehash: 6bea5f4faeb0a9c11a406a7e4e87c4929eda6a18
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/06/2018
---
<a name="getting-started-with-entity-framework-40-database-first-and-aspnet-4-web-forms---part-4"></a><span data-ttu-id="56f0d-104">Erste Schritte mit Entity Framework 4.0-Datenbank zunächst und ASP.NET 4 WebForms - Teil 4</span><span class="sxs-lookup"><span data-stu-id="56f0d-104">Getting Started with Entity Framework 4.0 Database First and ASP.NET 4 Web Forms - Part 4</span></span>
====================
<span data-ttu-id="56f0d-105">durch [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="56f0d-105">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

> <span data-ttu-id="56f0d-106">Die Contoso-University Beispielwebanwendung veranschaulicht, wie ASP.NET Web Forms-Anwendungen, die mit dem Entity Framework 4.0 und Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="56f0d-106">The Contoso University sample web application demonstrates how to create ASP.NET Web Forms applications using the Entity Framework 4.0 and Visual Studio 2010.</span></span> <span data-ttu-id="56f0d-107">Informationen über die Reihe von Lernprogrammen finden Sie unter [im ersten Lernprogramm, in der Reihe](the-entity-framework-and-aspnet-getting-started-part-1.md)</span><span class="sxs-lookup"><span data-stu-id="56f0d-107">For information about the tutorial series, see [the first tutorial in the series](the-entity-framework-and-aspnet-getting-started-part-1.md)</span></span>


## <a name="working-with-related-data"></a><span data-ttu-id="56f0d-108">Arbeiten mit verknüpften Daten</span><span class="sxs-lookup"><span data-stu-id="56f0d-108">Working with Related Data</span></span>

<span data-ttu-id="56f0d-109">Im vorherigen Lernprogramm Sie verwendet die `EntityDataSource` Steuerelement zu filtern, Sortieren und Gruppieren von Daten.</span><span class="sxs-lookup"><span data-stu-id="56f0d-109">In the previous tutorial you used the `EntityDataSource` control to filter, sort, and group data.</span></span> <span data-ttu-id="56f0d-110">In diesem Lernprogramm fügen Sie anzeigen und aktualisieren verknüpfte Daten.</span><span class="sxs-lookup"><span data-stu-id="56f0d-110">In this tutorial you'll display and update related data.</span></span>

<span data-ttu-id="56f0d-111">Erstellen Sie die Seite "Lehrkräfte", die eine Liste der Lehrkräfte angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="56f0d-111">You'll create the Instructors page that shows a list of instructors.</span></span> <span data-ttu-id="56f0d-112">Wenn Sie einen Kursleiter auswählen, sehen Sie eine Liste der Kurse, Dozent unterrichtet.</span><span class="sxs-lookup"><span data-stu-id="56f0d-112">When you select an instructor, you see a list of courses taught by that instructor.</span></span> <span data-ttu-id="56f0d-113">Wenn Sie einen Kurs auswählen, sehen Sie Details für den Kurs und eine Liste der Schüler in diesem Kurs registriert.</span><span class="sxs-lookup"><span data-stu-id="56f0d-113">When you select a course, you see details for the course and a list of students enrolled in the course.</span></span> <span data-ttu-id="56f0d-114">Sie können den Dozenten Einstellungsdatum und bürozuweisung bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="56f0d-114">You can edit the instructor name, hire date, and office assignment.</span></span> <span data-ttu-id="56f0d-115">Die Office-Zuweisung ist eine separate Entitätenmenge, die Sie über eine Navigationseigenschaft zugreifen.</span><span class="sxs-lookup"><span data-stu-id="56f0d-115">The office assignment is a separate entity set that you access through a navigation property.</span></span>

<span data-ttu-id="56f0d-116">Sie können Masterdaten Detaildaten im Markup oder im Code verknüpfen.</span><span class="sxs-lookup"><span data-stu-id="56f0d-116">You can link master data to detail data in markup or in code.</span></span> <span data-ttu-id="56f0d-117">In diesem Teil des Lernprogramms verwenden Sie beide Methoden.</span><span class="sxs-lookup"><span data-stu-id="56f0d-117">In this part of the tutorial, you'll use both methods.</span></span>

<span data-ttu-id="56f0d-118">[![Image01 abgerufen wird](the-entity-framework-and-aspnet-getting-started-part-4/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="56f0d-118">[![Image01](the-entity-framework-and-aspnet-getting-started-part-4/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image1.png)</span></span>

## <a name="displaying-and-updating-related-entities-in-a-gridview-control"></a><span data-ttu-id="56f0d-119">Anzeigen und aktualisieren verknüpfte Entitäten in einem GridView-Steuerelement</span><span class="sxs-lookup"><span data-stu-id="56f0d-119">Displaying and Updating Related Entities in a GridView Control</span></span>

<span data-ttu-id="56f0d-120">Erstellen Sie eine neue Webseite mit dem Namen *Instructors.aspx* , verwendet der *Site.Master* Masterseite, und fügen Sie das folgende Markup zum Rendern der `Content` Steuerelement namens `Content2`:</span><span class="sxs-lookup"><span data-stu-id="56f0d-120">Create a new web page named *Instructors.aspx* that uses the *Site.Master* master page, and add the following markup to the `Content` control named `Content2`:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample1.aspx)]

<span data-ttu-id="56f0d-121">Dieses Markup erstellt einen `EntityDataSource` Steuerelement, wählt Dozenten und Updates aktiviert.</span><span class="sxs-lookup"><span data-stu-id="56f0d-121">This markup creates an `EntityDataSource` control that selects instructors and enables updates.</span></span> <span data-ttu-id="56f0d-122">Die `div` Element konfiguriert Markup auf der linken Seite gerendert werden soll, sodass Sie eine Spalte später auf der rechten Seite hinzufügen können.</span><span class="sxs-lookup"><span data-stu-id="56f0d-122">The `div` element configures markup to render on the left so that you can add a column on the right later.</span></span>

<span data-ttu-id="56f0d-123">Zwischen der `EntityDataSource` Markup und das schließende `</div>` zu kennzeichnen, fügen Sie das folgende Markup, das erstellt eine `GridView` Steuerelement und ein `Label` Steuerelement, mit dem Sie Fehlermeldungen:</span><span class="sxs-lookup"><span data-stu-id="56f0d-123">Between the `EntityDataSource` markup and the closing `</div>` tag, add the following markup that creates a `GridView` control and a `Label` control that you'll use for error messages:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample2.aspx)]

<span data-ttu-id="56f0d-124">Dies `GridView` Steuerelement ermöglicht die Zeilenauswahl, die ausgewählte Zeile mit einem hellgraue Hintergrundfarbe hervorgehoben und gibt Handler (die Sie später erstellen) für die `SelectedIndexChanged` und `Updating` Ereignisse.</span><span class="sxs-lookup"><span data-stu-id="56f0d-124">This `GridView` control enables row selection, highlights the selected row with a light gray background color, and specifies handlers (which you'll create later) for the `SelectedIndexChanged` and `Updating` events.</span></span> <span data-ttu-id="56f0d-125">Gibt auch an `PersonID` für die `DataKeyNames` -Eigenschaft, sodass der Schlüsselwert der ausgewählten Zeile auf ein anderes Steuerelement übergeben werden kann, die Sie später hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="56f0d-125">It also specifies `PersonID` for the `DataKeyNames` property, so that the key value of the selected row can be passed to another control that you'll add later.</span></span>

<span data-ttu-id="56f0d-126">Die letzte Spalte enthält den Dozenten bürozuweisung, die in eine Navigationseigenschaft gespeichert ist die `Person` Entität, da es einen zugehörigen Entität stammen.</span><span class="sxs-lookup"><span data-stu-id="56f0d-126">The last column contains the instructor's office assignment, which is stored in a navigation property of the `Person` entity because it comes from an associated entity.</span></span> <span data-ttu-id="56f0d-127">Beachten Sie, dass die `EditItemTemplate` -Element gibt `Eval` anstelle von `Bind`, da die `GridView` Steuerelement kann nicht direkt an Navigationseigenschaften gebunden, um diese zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="56f0d-127">Notice that the `EditItemTemplate` element specifies `Eval` instead of `Bind`, because the `GridView` control cannot directly bind to navigation properties in order to update them.</span></span> <span data-ttu-id="56f0d-128">Aktualisieren Sie die Office-Zuweisung im Code.</span><span class="sxs-lookup"><span data-stu-id="56f0d-128">You'll update the office assignment in code.</span></span> <span data-ttu-id="56f0d-129">Zu diesem Zweck benötigen Sie einen Verweis auf die `TextBox` -Steuerelement, und Sie müssen abrufen und zum Speichern, die in der `TextBox` des Steuerelements `Init` Ereignis.</span><span class="sxs-lookup"><span data-stu-id="56f0d-129">To do that, you'll need a reference to the `TextBox` control, and you'll get and save that in the `TextBox` control's `Init` event.</span></span>

<span data-ttu-id="56f0d-130">Nach der `GridView` -Steuerelement ist ein `Label` Steuerelement, das für Fehlermeldungen verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="56f0d-130">Following the `GridView` control is a `Label` control that's used for error messages.</span></span> <span data-ttu-id="56f0d-131">Des Steuerelements `Visible` Eigenschaft ist `false`, und der Ansichtszustand deaktiviert ist, so, dass die Bezeichnung angezeigt wird, nur wenn Code macht sie sichtbar als Antwort auf einen Fehler.</span><span class="sxs-lookup"><span data-stu-id="56f0d-131">The control's `Visible` property is `false`, and view state is turned off, so that the label will appear only when code makes it visible in response to an error.</span></span>

<span data-ttu-id="56f0d-132">Öffnen der *Instructors.aspx.cs* Datei, und fügen Sie die folgenden `using` Anweisung:</span><span class="sxs-lookup"><span data-stu-id="56f0d-132">Open the *Instructors.aspx.cs* file and add the following `using` statement:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample3.cs)]

<span data-ttu-id="56f0d-133">Fügen Sie eine private Klasse-Feld unmittelbar auf den der partiellen Klasse-Namensdeklaration, um einen Verweis auf das Textfeld der Office-Zuweisung enthalten.</span><span class="sxs-lookup"><span data-stu-id="56f0d-133">Add a private class field immediately after the partial-class name declaration to hold a reference to the office assignment text box.</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample4.cs)]

<span data-ttu-id="56f0d-134">Fügen Sie einen Stub für die `SelectedIndexChanged` -Ereignishandler, dass Sie Code für die spätere hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="56f0d-134">Add a stub for the `SelectedIndexChanged` event handler that you'll add code for later.</span></span> <span data-ttu-id="56f0d-135">Auch hinzufügen, einen Handler für die Office-Zuweisung `TextBox` des Steuerelements `Init` Ereignis, damit Sie einen Verweis auf Speichern, können die `TextBox` Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="56f0d-135">Also add a handler for the office assignment `TextBox` control's `Init` event so that you can store a reference to the `TextBox` control.</span></span> <span data-ttu-id="56f0d-136">Sie müssen diesen Verweis verwenden, um dem Wert vom Benutzer eingegebenen zum Aktualisieren der zugeordneten Navigationseigenschaft Entität abzurufen.</span><span class="sxs-lookup"><span data-stu-id="56f0d-136">You'll use this reference to get the value the user entered in order to update the entity associated with the navigation property.</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample5.cs)]

<span data-ttu-id="56f0d-137">Verwenden Sie die `GridView` des Steuerelements `Updating` das zu aktualisierende Ereignis der `Location` Eigenschaft der zugeordneten `OfficeAssignment` Entität.</span><span class="sxs-lookup"><span data-stu-id="56f0d-137">You'll use the `GridView` control's `Updating` event to update the `Location` property of the associated `OfficeAssignment` entity.</span></span> <span data-ttu-id="56f0d-138">Fügen Sie den folgenden Ereignishandler für das `Updating` Ereignis:</span><span class="sxs-lookup"><span data-stu-id="56f0d-138">Add the following handler for the `Updating` event:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample6.cs)]

<span data-ttu-id="56f0d-139">Dieser Code ausgeführt wird, wenn der Benutzer klickt **Update** in einem `GridView` Zeile.</span><span class="sxs-lookup"><span data-stu-id="56f0d-139">This code is run when the user clicks **Update** in a `GridView` row.</span></span> <span data-ttu-id="56f0d-140">Der Code verwendet LINQ to Entities zum Abrufen der `OfficeAssignment` Entität, die mit dem aktuellen verknüpft ist `Person` Entität mithilfe der `PersonID` der ausgewählten Zeile aus der das Ereignisargument.</span><span class="sxs-lookup"><span data-stu-id="56f0d-140">The code uses LINQ to Entities to retrieve the `OfficeAssignment` entity that's associated with the current `Person` entity, using the `PersonID` of the selected row from the event argument.</span></span>

<span data-ttu-id="56f0d-141">Der Code führt dann eine der folgenden Aktionen je nach dem Wert in der `InstructorOfficeTextBox` Steuerelement:</span><span class="sxs-lookup"><span data-stu-id="56f0d-141">The code then takes one of the following actions depending on the value in the `InstructorOfficeTextBox` control:</span></span>

- <span data-ttu-id="56f0d-142">Wenn das Textfeld einen Wert ist, und es ist keine `OfficeAssignment` Entität zu aktualisieren, erstellt es einen.</span><span class="sxs-lookup"><span data-stu-id="56f0d-142">If the text box has a value and there's no `OfficeAssignment` entity to update, it creates one.</span></span>
- <span data-ttu-id="56f0d-143">Wenn das Textfeld einen Wert ist, und es ist ein `OfficeAssignment` -Entität aktualisiert die `Location` Eigenschaftswert.</span><span class="sxs-lookup"><span data-stu-id="56f0d-143">If the text box has a value and there's an `OfficeAssignment` entity, it updates the `Location` property value.</span></span>
- <span data-ttu-id="56f0d-144">Wenn das Textfeld leer ist, und eine `OfficeAssignment` Entität vorhanden ist, wird die Entität gelöscht.</span><span class="sxs-lookup"><span data-stu-id="56f0d-144">If the text box is empty and an `OfficeAssignment` entity exists, it deletes the entity.</span></span>

<span data-ttu-id="56f0d-145">Danach müssen die Änderungen in der Datenbank gespeichert.</span><span class="sxs-lookup"><span data-stu-id="56f0d-145">After this, it saves the changes to the database.</span></span> <span data-ttu-id="56f0d-146">Wenn eine Ausnahme auftritt, wird eine Fehlermeldung angezeigt.</span><span class="sxs-lookup"><span data-stu-id="56f0d-146">If an exception occurs, it displays an error message.</span></span>

<span data-ttu-id="56f0d-147">Führen Sie die Seite.</span><span class="sxs-lookup"><span data-stu-id="56f0d-147">Run the page.</span></span>

<span data-ttu-id="56f0d-148">[![Image02](the-entity-framework-and-aspnet-getting-started-part-4/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="56f0d-148">[![Image02](the-entity-framework-and-aspnet-getting-started-part-4/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image3.png)</span></span>

<span data-ttu-id="56f0d-149">Klicken Sie auf **bearbeiten** und ändern Sie alle Felder in Textfeldern.</span><span class="sxs-lookup"><span data-stu-id="56f0d-149">Click **Edit** and all fields change to text boxes.</span></span>

<span data-ttu-id="56f0d-150">[![Image03](the-entity-framework-and-aspnet-getting-started-part-4/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="56f0d-150">[![Image03](the-entity-framework-and-aspnet-getting-started-part-4/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image5.png)</span></span>

<span data-ttu-id="56f0d-151">Ändern Sie diese Werte, einschließlich **Bürozuweisung**.</span><span class="sxs-lookup"><span data-stu-id="56f0d-151">Change any of these values, including **Office Assignment**.</span></span> <span data-ttu-id="56f0d-152">Klicken Sie auf **Update** und sehen Sie die Änderungen in der Liste wiedergegeben.</span><span class="sxs-lookup"><span data-stu-id="56f0d-152">Click **Update** and you'll see the changes reflected in the list.</span></span>

## <a name="displaying-related-entities-in-a-separate-control"></a><span data-ttu-id="56f0d-153">Anzeigen von verknüpften Entitäten in einem separaten Steuerelement</span><span class="sxs-lookup"><span data-stu-id="56f0d-153">Displaying Related Entities in a Separate Control</span></span>

<span data-ttu-id="56f0d-154">Jede Dozenten kann werden folgende Themen behandelt einen oder mehrere Kurse, damit Sie hinzufügen, eine `EntityDataSource` Steuerelement und ein `GridView` Steuerelement zum Auflisten der Kurse zugeordnet, unabhängig davon, welche Dozenten in die Kursleiter ausgewählt ist `GridView` Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="56f0d-154">Each instructor can teach one or more courses, so you'll add an `EntityDataSource` control and a `GridView` control to list the courses associated with whichever instructor is selected in the instructors `GridView` control.</span></span> <span data-ttu-id="56f0d-155">Zum Erstellen einer Überschrift und der `EntityDataSource` für Kurse Entitäten zu steuern, fügen Sie das folgende Markup zwischen der Fehlermeldung `Label` -Steuerelement und das schließende `</div>` Tag:</span><span class="sxs-lookup"><span data-stu-id="56f0d-155">To create a heading and the `EntityDataSource` control for courses entities, add the following markup between the error message `Label` control and the closing `</div>` tag:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample7.aspx)]

<span data-ttu-id="56f0d-156">Die `Where` Parameter enthält den Wert des der `PersonID` der Kursleiter, deren Zeile, in ausgewählt ist, der `InstructorsGridView` Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="56f0d-156">The `Where` parameter contains the value of the `PersonID` of the instructor whose row is selected in the `InstructorsGridView` control.</span></span> <span data-ttu-id="56f0d-157">Die `Where` Eigenschaft enthält einen untergeordneten SELECT-Befehl, der alle zugeordneten ruft `Person` Entitäten aus einer `Course` Entität `People` Navigationseigenschaft und wählt die `Course` Entität nur, wenn eine der zugehörigen `Person`Entitäten enthält die ausgewählten `PersonID` Wert.</span><span class="sxs-lookup"><span data-stu-id="56f0d-157">The `Where` property contains a subselect command that gets all associated `Person` entities from a `Course` entity's `People` navigation property and selects the `Course` entity only if one of the associated `Person` entities contains the selected `PersonID` value.</span></span>

<span data-ttu-id="56f0d-158">Zum Erstellen der `GridView` Steuerelement. Fügen Sie das folgende Markup unmittelbar nach der `CoursesEntityDataSource` Steuerelement (vor der schließenden `</div>` Tag):</span><span class="sxs-lookup"><span data-stu-id="56f0d-158">To create the `GridView` control., add the following markup immediately following the `CoursesEntityDataSource` control (before the closing `</div>` tag):</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample8.aspx)]

<span data-ttu-id="56f0d-159">Da keine Kurse angezeigt werden, wenn keine Dozenten ausgewählt ist, ein `EmptyDataTemplate` Element enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="56f0d-159">Because no courses will be displayed if no instructor is selected, an `EmptyDataTemplate` element is included.</span></span>

<span data-ttu-id="56f0d-160">Führen Sie die Seite.</span><span class="sxs-lookup"><span data-stu-id="56f0d-160">Run the page.</span></span>

<span data-ttu-id="56f0d-161">[![Image04](the-entity-framework-and-aspnet-getting-started-part-4/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="56f0d-161">[![Image04](the-entity-framework-and-aspnet-getting-started-part-4/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image7.png)</span></span>

<span data-ttu-id="56f0d-162">Wählen einen Kursleiter, der einen oder mehrere Kurse zugewiesen hat, und dem Kurs oder Kurse in der Liste angezeigt.</span><span class="sxs-lookup"><span data-stu-id="56f0d-162">Select an instructor who has one or more courses assigned, and the course or courses appear in the list.</span></span> <span data-ttu-id="56f0d-163">(Hinweis: das Datenbankschema lässt mehrere Kurse in den Testdaten, die im Lieferumfang der Datenbank keine Dozenten tatsächlich hat mehr als einen Kurs.</span><span class="sxs-lookup"><span data-stu-id="56f0d-163">(Note: although the database schema allows multiple courses, in the test data supplied with the database no instructor actually has more than one course.</span></span> <span data-ttu-id="56f0d-164">Sie können mit der Datenbank Kurse hinzufügen, selbst mit dem **Server-Explorer** Fenster oder die *CoursesAdd.aspx* Seite, die Sie in einem späteren Lernprogramm hinzufügen.)</span><span class="sxs-lookup"><span data-stu-id="56f0d-164">You can add courses to the database yourself using the **Server Explorer** window or the *CoursesAdd.aspx* page, which you'll add in a later tutorial.)</span></span>

<span data-ttu-id="56f0d-165">[![Image05](the-entity-framework-and-aspnet-getting-started-part-4/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="56f0d-165">[![Image05](the-entity-framework-and-aspnet-getting-started-part-4/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image9.png)</span></span>

<span data-ttu-id="56f0d-166">Die `CoursesGridView` Steuerelement zeigt nur wenige Kurs Felder.</span><span class="sxs-lookup"><span data-stu-id="56f0d-166">The `CoursesGridView` control shows only a few course fields.</span></span> <span data-ttu-id="56f0d-167">Um alle Details für einen Kurs anzuzeigen, verwenden Sie eine `DetailsView` Steuerelement für den Kurs, die der Benutzer auswählt.</span><span class="sxs-lookup"><span data-stu-id="56f0d-167">To display all the details for a course, you'll use a `DetailsView` control for the course that the user selects.</span></span> <span data-ttu-id="56f0d-168">In *Instructors.aspx*, fügen Sie das folgende Markup nach dem schließenden `</div>` Tag (Stellen Sie sicher, dass Sie dieses Markup platzieren **nach** schließende Div-tag nicht vor):</span><span class="sxs-lookup"><span data-stu-id="56f0d-168">In *Instructors.aspx*, add the following markup after the closing `</div>` tag (make sure you place this markup **after** the closing div tag, not before it):</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample9.aspx)]

<span data-ttu-id="56f0d-169">Dieses Markup erstellt ein `EntityDataSource` Steuerelement gebunden ist, das die `Courses` Entitätenmenge.</span><span class="sxs-lookup"><span data-stu-id="56f0d-169">This markup creates an `EntityDataSource` control that's bound to the `Courses` entity set.</span></span> <span data-ttu-id="56f0d-170">Die `Where` Eigenschaft wählt einen Kurs mithilfe der `CourseID` Wert der ausgewählten Zeile in der Courses `GridView` Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="56f0d-170">The `Where` property selects a course using the `CourseID` value of the selected row in the courses `GridView` control.</span></span> <span data-ttu-id="56f0d-171">Das Markup gibt einen Handler für das `Selected` -Ereignis, das Sie später für die Anzeige von Student Qualitäten verwendet werden, die eine andere Ebene in der Hierarchie ist.</span><span class="sxs-lookup"><span data-stu-id="56f0d-171">The markup specifies a handler for the `Selected` event, which you'll use later for displaying student grades, which is another level lower in the hierarchy.</span></span>

<span data-ttu-id="56f0d-172">In *Instructors.aspx.cs*, erstellen Sie die folgenden Stub für die `CourseDetailsEntityDataSource_Selected` Methode.</span><span class="sxs-lookup"><span data-stu-id="56f0d-172">In *Instructors.aspx.cs*, create the following stub for the `CourseDetailsEntityDataSource_Selected` method.</span></span> <span data-ttu-id="56f0d-173">(Sie müssen diese Stub füllen Sie später in diesem Lernprogramm; vorerst Sie ihn benötigen, damit die Seite kompiliert und ausgeführt werden kann.)</span><span class="sxs-lookup"><span data-stu-id="56f0d-173">(You'll fill this stub out later in the tutorial; for now, you need it so that the page will compile and run.)</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample10.cs)]

<span data-ttu-id="56f0d-174">Führen Sie die Seite.</span><span class="sxs-lookup"><span data-stu-id="56f0d-174">Run the page.</span></span>

<span data-ttu-id="56f0d-175">[![Image06](the-entity-framework-and-aspnet-getting-started-part-4/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="56f0d-175">[![Image06](the-entity-framework-and-aspnet-getting-started-part-4/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image11.png)</span></span>

<span data-ttu-id="56f0d-176">Anfänglich stehen keine Kursdetails, da kein Kurs ausgewählt wird.</span><span class="sxs-lookup"><span data-stu-id="56f0d-176">Initially there are no course details because no course is selected.</span></span> <span data-ttu-id="56f0d-177">Wählen Sie einen Kursleiter, der einen Kurs zugewiesen hat, und wählen Sie dann einen Kurs, um die Details anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="56f0d-177">Select an instructor who has a course assigned, and then select a course to see the details.</span></span>

<span data-ttu-id="56f0d-178">[![Image07](the-entity-framework-and-aspnet-getting-started-part-4/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="56f0d-178">[![Image07](the-entity-framework-and-aspnet-getting-started-part-4/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image13.png)</span></span>

## <a name="using-the-entitydatasource-selected-event-to-display-related-data"></a><span data-ttu-id="56f0d-179">Mithilfe der EntityDataSource aktiviert Ereignis, um verknüpfte Daten anzeigen""</span><span class="sxs-lookup"><span data-stu-id="56f0d-179">Using the EntityDataSource "Selected" Event to Display Related Data</span></span>

<span data-ttu-id="56f0d-180">Schließlich möchten Sie alle registrierten Studenten und deren Bewertungen für den ausgewählten Kurs anzeigen.</span><span class="sxs-lookup"><span data-stu-id="56f0d-180">Finally, you want to show all of the enrolled students and their grades for the selected course.</span></span> <span data-ttu-id="56f0d-181">Zu diesem Zweck verwenden Sie die `Selected` -Ereignis für die `EntityDataSource` Steuerelement gebunden werden, um den Kurs `DetailsView`.</span><span class="sxs-lookup"><span data-stu-id="56f0d-181">To do this, you'll use the `Selected` event of the `EntityDataSource` control bound to the course `DetailsView`.</span></span>

<span data-ttu-id="56f0d-182">In *Instructors.aspx*, fügen Sie das folgende Markup nach dem `DetailsView` Steuerelement:</span><span class="sxs-lookup"><span data-stu-id="56f0d-182">In *Instructors.aspx*, add the following markup after the `DetailsView` control:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample11.aspx)]

<span data-ttu-id="56f0d-183">Dieses Markup erstellt einen `ListView` Steuerelement, das eine Liste der Schüler und deren Bewertungen für den ausgewählten Kurs anzeigt.</span><span class="sxs-lookup"><span data-stu-id="56f0d-183">This markup creates a `ListView` control that displays a list of students and their grades for the selected course.</span></span> <span data-ttu-id="56f0d-184">Keine Datenquelle wird angegeben, da Sie Databind das Steuerelement im Code müssen.</span><span class="sxs-lookup"><span data-stu-id="56f0d-184">No data source is specified because you'll databind the control in code.</span></span> <span data-ttu-id="56f0d-185">Die `EmptyDataTemplate` Element enthält eine Meldung angezeigt, wenn kein Kurs ausgewählt ist – in diesem Fall befinden sich keine Schüler angezeigt.</span><span class="sxs-lookup"><span data-stu-id="56f0d-185">The `EmptyDataTemplate` element provides a message to display when no course is selected—in that case, there are no students to display.</span></span> <span data-ttu-id="56f0d-186">Die `LayoutTemplate` Element erstellt eine HTML-Tabelle, um die Liste anzuzeigen und die `ItemTemplate` gibt die anzuzeigenden Spalten an.</span><span class="sxs-lookup"><span data-stu-id="56f0d-186">The `LayoutTemplate` element creates an HTML table to display the list, and the `ItemTemplate` specifies the columns to display.</span></span> <span data-ttu-id="56f0d-187">Studenten-ID und die Student Grade stammen aus den `StudentGrade` Entität und den Namen Student stammt aus der `Person` Entität, die das Entity Framework in verfügbar macht die `Person` Navigationseigenschaft der `StudentGrade` Entität.</span><span class="sxs-lookup"><span data-stu-id="56f0d-187">The student ID and the student grade are from the `StudentGrade` entity, and the student name is from the `Person` entity that the Entity Framework makes available in the `Person` navigation property of the `StudentGrade` entity.</span></span>

<span data-ttu-id="56f0d-188">In *Instructors.aspx.cs*, ersetzen Sie die Stub-Out `CourseDetailsEntityDataSource_Selected` -Methode durch folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="56f0d-188">In *Instructors.aspx.cs*, replace the stubbed-out `CourseDetailsEntityDataSource_Selected` method with the following code:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample12.cs)]

<span data-ttu-id="56f0d-189">Das Ereignisargument für dieses Ereignis enthält die ausgewählten Daten in Form einer Auflistung, die haben wird, um ein Element oder 0 (null) Elemente, wenn keine Auswahl getroffen wurde Wenn eine `Course` ausgewählt ist.</span><span class="sxs-lookup"><span data-stu-id="56f0d-189">The event argument for this event provides the selected data in the form of a collection, which will have zero items if nothing is selected or one item if a `Course` entity is selected.</span></span> <span data-ttu-id="56f0d-190">Wenn eine `Course` Entität ausgewählt ist, wird der Code verwendet die `First` Methode, um der Auflistung in ein einzelnes Objekt konvertiert.</span><span class="sxs-lookup"><span data-stu-id="56f0d-190">If a `Course` entity is selected, the code uses the `First` method to convert the collection to a single object.</span></span> <span data-ttu-id="56f0d-191">Anschließend ruft es `StudentGrade` Entitäten aus der Navigationseigenschaft konvertiert diese in einer Auflistung und bindet die `GradesListView` Steuerelement in der Auflistung.</span><span class="sxs-lookup"><span data-stu-id="56f0d-191">It then gets `StudentGrade` entities from the navigation property, converts them to a collection, and binds the `GradesListView` control to the collection.</span></span>

<span data-ttu-id="56f0d-192">Dies ist ausreichend Besoldungsgruppen angezeigt, aber Sie möchten sicherstellen, dass die Nachricht in der Vorlage für leere Daten erstmalig angezeigt wird, auf die Seite angezeigt wird, und bei jedem Kurs nicht ausgewählt ist.</span><span class="sxs-lookup"><span data-stu-id="56f0d-192">This is sufficient to display grades, but you want to make sure that the message in the empty data template is displayed the first time the page is displayed and whenever a course is not selected.</span></span> <span data-ttu-id="56f0d-193">Zu diesem Zweck erstellen Sie die folgende Methode, die an zwei Stellen heraus aufgerufen werden müssen:</span><span class="sxs-lookup"><span data-stu-id="56f0d-193">To do that, create the following method, which you'll call from two places:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample13.cs)]

<span data-ttu-id="56f0d-194">Rufen Sie diese neue Methode aus der `Page_Load` Methode, um die leere Daten zum ersten Mal angezeigt, die Seite wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="56f0d-194">Call this new method from the `Page_Load` method to display the empty data template the first time the page is displayed.</span></span> <span data-ttu-id="56f0d-195">Ein, und rufen sie über die `InstructorsGridView_SelectedIndexChanged` Methode, da das Ereignis ausgelöst wird, wenn ein Kursleiter ausgewählt ist, was bedeutet, dass neue Kurse werden in der Courses geladen `GridView` Steuerelement und keine noch ausgewählt ist.</span><span class="sxs-lookup"><span data-stu-id="56f0d-195">And call it from the `InstructorsGridView_SelectedIndexChanged` method because that event is raised when an instructor is selected, which means new courses are loaded into the courses `GridView` control and none is selected yet.</span></span> <span data-ttu-id="56f0d-196">Im folgenden sind die beiden Aufrufe aus:</span><span class="sxs-lookup"><span data-stu-id="56f0d-196">Here are the two calls:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample14.cs)]

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample15.cs)]

<span data-ttu-id="56f0d-197">Führen Sie die Seite.</span><span class="sxs-lookup"><span data-stu-id="56f0d-197">Run the page.</span></span>

<span data-ttu-id="56f0d-198">[![Image08](the-entity-framework-and-aspnet-getting-started-part-4/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="56f0d-198">[![Image08](the-entity-framework-and-aspnet-getting-started-part-4/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image15.png)</span></span>

<span data-ttu-id="56f0d-199">Wählen Sie einen Kursleiter, der einen Kurs zugewiesen wurde, und wählen Sie dann den Kurs.</span><span class="sxs-lookup"><span data-stu-id="56f0d-199">Select an instructor that has a course assigned, and then select the course.</span></span>

<span data-ttu-id="56f0d-200">[![Image09](the-entity-framework-and-aspnet-getting-started-part-4/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="56f0d-200">[![Image09](the-entity-framework-and-aspnet-getting-started-part-4/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image17.png)</span></span>

<span data-ttu-id="56f0d-201">Sie haben jetzt einige Verfahren zum Arbeiten mit verknüpften Daten angezeigt.</span><span class="sxs-lookup"><span data-stu-id="56f0d-201">You have now seen a few ways to work with related data.</span></span> <span data-ttu-id="56f0d-202">Im folgenden Lernprogramm erfahren Sie zum Hinzufügen von Beziehungen zwischen Entitäten, Beziehungen zu entfernen, und wie Sie eine neue Entität hinzufügen, die eine zu einer vorhandenen Entität Beziehung.</span><span class="sxs-lookup"><span data-stu-id="56f0d-202">In the following tutorial, you'll learn how to add relationships between existing entities, how to remove relationships, and how to add a new entity that has a relationship to an existing entity.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="56f0d-203">[Zurück](the-entity-framework-and-aspnet-getting-started-part-3.md)
> [Weiter](the-entity-framework-and-aspnet-getting-started-part-5.md)</span><span class="sxs-lookup"><span data-stu-id="56f0d-203">[Previous](the-entity-framework-and-aspnet-getting-started-part-3.md)
[Next](the-entity-framework-and-aspnet-getting-started-part-5.md)</span></span>
