---
title: ASP.NET Core-Modul
author: tdykstra
description: "Führt ASP.NET Core Modul (ANCM), ein IIS-Modul, in dem die Kestrel Webserver IIS- oder IIS Express als reverse-Proxy-Server verwenden kann."
keywords: ASP.NET Core, IIS, IIS Express,ASP.NET Core-Modul, UseIISIntegration
ms.author: tdykstra
manager: wpickett
ms.date: 08/03/2017
ms.topic: article
ms.assetid: 4661af33-34c5-4d71-93a0-8c7632f43580
ms.technology: aspnet
ms.prod: asp.net-core
uid: fundamentals/servers/aspnet-core-module
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: 5eef9405c0c3d219755d7cffa5d45c3df45ddb5c
ms.sourcegitcommit: 12e5194936b7e820efc5505a2d5d4f84e88eb5ef
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/11/2018
---
# <a name="introduction-to-aspnet-core-module"></a><span data-ttu-id="9cd29-104">Einführung in ASP.NET Core-Modul</span><span class="sxs-lookup"><span data-stu-id="9cd29-104">Introduction to ASP.NET Core Module</span></span>

<span data-ttu-id="9cd29-105">Durch [Tom Dykstra](https://github.com/tdykstra), [Rick Strahl](https://github.com/RickStrahl), und [Chris Ross](https://github.com/Tratcher)</span><span class="sxs-lookup"><span data-stu-id="9cd29-105">By [Tom Dykstra](https://github.com/tdykstra), [Rick Strahl](https://github.com/RickStrahl), and [Chris Ross](https://github.com/Tratcher)</span></span> 

<span data-ttu-id="9cd29-106">ASP.NET Core Modul (ANCM) können Sie ASP.NET Core Anwendungen hinter IIS ausführen mit IIS für was gut (Sicherheit, Verwaltbarkeit und viele weitere) ist und mit [Kestrel](kestrel.md) für was gut (schnellen), sondern ist und das Abrufen der Vorteile von beide Technologien gleichzeitig.</span><span class="sxs-lookup"><span data-stu-id="9cd29-106">ASP.NET Core Module (ANCM) lets you run ASP.NET Core applications behind IIS, using IIS for what it's good at (security, manageability, and lots more) and using [Kestrel](kestrel.md) for what it's good at (being really fast), and getting the benefits from both technologies at once.</span></span> <span data-ttu-id="9cd29-107">**ANCM funktioniert nur mit Kestrel; Es ist nicht kompatibel mit WebListener (in ASP.NET Core 1.x) oder HTTP.sys (in 2.x).**</span><span class="sxs-lookup"><span data-stu-id="9cd29-107">**ANCM works only with Kestrel; it isn't compatible with WebListener (in ASP.NET Core 1.x) or HTTP.sys (in 2.x).**</span></span> 

<span data-ttu-id="9cd29-108">Unterstützte Windows-Versionen:</span><span class="sxs-lookup"><span data-stu-id="9cd29-108">Supported Windows versions:</span></span>

* <span data-ttu-id="9cd29-109">Windows 7 und Windows Server 2008 R2 und höher</span><span class="sxs-lookup"><span data-stu-id="9cd29-109">Windows 7 and Windows Server 2008 R2 and later</span></span>

<span data-ttu-id="9cd29-110">[Anzeigen oder Herunterladen von Beispielcode](https://github.com/aspnet/Docs/tree/master/aspnetcore/fundamentals/servers/aspnet-core-module/sample) ([Vorgehensweise zum Herunterladen](xref:tutorials/index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="9cd29-110">[View or download sample code](https://github.com/aspnet/Docs/tree/master/aspnetcore/fundamentals/servers/aspnet-core-module/sample) ([how to download](xref:tutorials/index#how-to-download-a-sample))</span></span>

## <a name="what-aspnet-core-module-does"></a><span data-ttu-id="9cd29-111">Was bewirkt, dass ASP.NET Core-Modul</span><span class="sxs-lookup"><span data-stu-id="9cd29-111">What ASP.NET Core Module does</span></span>

<span data-ttu-id="9cd29-112">ANCM ist ein systemeigenes IIS-Modul, das in der IIS-Pipeline hooks und leitet den Datenverkehr an den Back-End-Anwendung ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="9cd29-112">ANCM is a native IIS module that hooks into the IIS pipeline and redirects traffic to the backend ASP.NET Core application.</span></span> <span data-ttu-id="9cd29-113">Die meisten anderen Modulen wie z. B. Windows-Authentifizierung, erhalten immer noch ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="9cd29-113">Most other modules, such as windows authentication, still get a chance to run.</span></span> <span data-ttu-id="9cd29-114">ANCM übernimmt nur die Kontrolle, wenn ein Handler für die Anforderung aktiviert ist, und Handlerzuordnung ist in der Anwendung definierten *"Web.config"* Datei.</span><span class="sxs-lookup"><span data-stu-id="9cd29-114">ANCM only takes control when a handler is selected for the request, and handler mapping is defined in the application *web.config* file.</span></span>

<span data-ttu-id="9cd29-115">Da ASP.NET Core-Anwendungen, die in einem Prozess Ausführen von IIS-Arbeitsprozess trennen, werden ANCM auch Management verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="9cd29-115">Because ASP.NET Core applications run in a process separate from the IIS worker process, ANCM also does process management.</span></span> <span data-ttu-id="9cd29-116">ANCM startet den Prozess für die ASP.NET Core-Anwendung aus, wenn die erste Anforderung eingeht und neu gestartet, wenn er abstürzt.</span><span class="sxs-lookup"><span data-stu-id="9cd29-116">ANCM starts the process for the ASP.NET Core application when the first request comes in and restarts it when it crashes.</span></span> <span data-ttu-id="9cd29-117">Dies ist im Prinzip das gleiche Verhalten wie klassischen ASP.NET-Anwendungen ausgeführten in-Process in IIS, und durch WAS (Windows Activation Service) verwaltet werden.</span><span class="sxs-lookup"><span data-stu-id="9cd29-117">This is essentially the same behavior as classic ASP.NET applications that run in-process in IIS and are managed by WAS (Windows Activation Service).</span></span>

<span data-ttu-id="9cd29-118">Hier wird ein Diagramm, das die Beziehung zwischen ANCM, IIS und ASP.NET Core Anwendungen veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="9cd29-118">Here's a diagram that illustrates the relationship between IIS, ANCM, and ASP.NET Core applications.</span></span>

![ASP.NET Core-Modul](aspnet-core-module/_static/ancm.png)

<span data-ttu-id="9cd29-120">Anforderungen aus dem Internet stammen, und drücken Kernelmodustreiber Http.Sys, der Sie in IIS auf dem primären Ports (80) oder SSL-Port (Port 443) weiterleitet.</span><span class="sxs-lookup"><span data-stu-id="9cd29-120">Requests come in from the Web and hit the kernel mode Http.Sys driver which routes them into IIS on the primary port (80) or SSL port (443).</span></span> <span data-ttu-id="9cd29-121">ANCM leitet die Anforderungen an die ASP.NET Core-Anwendung über die HTTP-Port für die Anwendung, die nicht 80/443 port ist konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="9cd29-121">ANCM forwards the requests to the ASP.NET Core application on the HTTP port configured for the application, which is not port 80/443.</span></span>

<span data-ttu-id="9cd29-122">Kestrel überwacht Datenverkehr aus ANCM.</span><span class="sxs-lookup"><span data-stu-id="9cd29-122">Kestrel listens for traffic coming from ANCM.</span></span>  <span data-ttu-id="9cd29-123">ANCM gibt den Port, über die Umgebungsvariable beim Start und die [UseIISIntegration](#call-useiisintegration) Methode konfiguriert den Server zum Lauschen an `http://localhost:{port}`.</span><span class="sxs-lookup"><span data-stu-id="9cd29-123">ANCM specifies the port via environment variable at startup, and the [UseIISIntegration](#call-useiisintegration) method configures the server to listen on `http://localhost:{port}`.</span></span> <span data-ttu-id="9cd29-124">Es gibt zusätzliche Überprüfungen, um Anfragen nicht ANCM abgelehnt werden.</span><span class="sxs-lookup"><span data-stu-id="9cd29-124">There are additional checks to reject requests not from ANCM.</span></span> <span data-ttu-id="9cd29-125">(ANCM unterstützt keine HTTPS weiterleiten, damit Anforderungen über HTTP weitergeleitet werden, selbst wenn von IIS über HTTPS erhalten hat.)</span><span class="sxs-lookup"><span data-stu-id="9cd29-125">(ANCM does not support HTTPS forwarding, so requests are forwarded over HTTP even if received by IIS over HTTPS.)</span></span>

<span data-ttu-id="9cd29-126">Kestrel ANCM ein Anforderungen übernommen und stellt diese in die Middleware-Pipeline von ASP.NET Core, dann verarbeitet sie und übergibt diese als `HttpContext` -Instanzen, die Anwendungslogik.</span><span class="sxs-lookup"><span data-stu-id="9cd29-126">Kestrel picks up requests from ANCM and pushes them into the ASP.NET Core middleware pipeline, which then handles them and passes them on as `HttpContext` instances to application logic.</span></span> <span data-ttu-id="9cd29-127">Die Anwendung Antworten werden dann zurück an IIS, welche Push-Vorgänge übergeben, die sie an den HTTP-Client zurück, die die Anforderungen initiiert.</span><span class="sxs-lookup"><span data-stu-id="9cd29-127">The application's responses are then passed back to IIS, which pushes them back out to the HTTP client that initiated the requests.</span></span>

<span data-ttu-id="9cd29-128">ANCM hat auch einigen andere Funktionen:</span><span class="sxs-lookup"><span data-stu-id="9cd29-128">ANCM has a few other functions as well:</span></span>

* <span data-ttu-id="9cd29-129">Legt die Umgebungsvariablen fest.</span><span class="sxs-lookup"><span data-stu-id="9cd29-129">Sets environment variables.</span></span>
* <span data-ttu-id="9cd29-130">Protokolle `stdout` auf Dateispeicher ausgegeben.</span><span class="sxs-lookup"><span data-stu-id="9cd29-130">Logs `stdout` output to file storage.</span></span>
* <span data-ttu-id="9cd29-131">Werden Windows-Authentifizierungstoken weitergeleitet.</span><span class="sxs-lookup"><span data-stu-id="9cd29-131">Forwards Windows authentication tokens.</span></span>

## <a name="how-to-use-ancm-in-aspnet-core-apps"></a><span data-ttu-id="9cd29-132">Gewusst wie: ANCM in ASP.NET Core-apps verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="9cd29-132">How to use ANCM in ASP.NET Core apps</span></span>

<span data-ttu-id="9cd29-133">Dieser Abschnitt enthält eine Übersicht über den Prozess zum Einrichten einer IIS-Server und ASP.NET Core-Anwendung.</span><span class="sxs-lookup"><span data-stu-id="9cd29-133">This section provides an overview of the process for setting up an IIS server and ASP.NET Core application.</span></span> <span data-ttu-id="9cd29-134">Ausführliche Anweisungen finden Sie unter [Host unter Windows mit IIS](xref:host-and-deploy/iis/index).</span><span class="sxs-lookup"><span data-stu-id="9cd29-134">For detailed instructions, see [Host on Windows with IIS](xref:host-and-deploy/iis/index).</span></span>

### <a name="install-ancm"></a><span data-ttu-id="9cd29-135">Installieren von ANCM</span><span class="sxs-lookup"><span data-stu-id="9cd29-135">Install ANCM</span></span>


<span data-ttu-id="9cd29-136">ASP.NET Core-Modul muss in IIS auf Ihren Servern und in IIS Express auf Ihrem Entwicklungscomputer installiert werden.</span><span class="sxs-lookup"><span data-stu-id="9cd29-136">The ASP.NET Core Module has to be installed in IIS on your servers and in IIS Express on your development machines.</span></span> <span data-ttu-id="9cd29-137">Bei Servern, ANCM enthalten ist, der [.NET Core Windows Server-Hosting-Bundle](https://aka.ms/dotnetcore-2-windowshosting).</span><span class="sxs-lookup"><span data-stu-id="9cd29-137">For servers, ANCM is included in the [.NET Core Windows Server Hosting bundle](https://aka.ms/dotnetcore-2-windowshosting).</span></span> <span data-ttu-id="9cd29-138">Für Entwicklungscomputern installiert Visual Studio automatisch ANCM in IIS Express und IIS, wenn sie bereits auf dem Computer installiert ist.</span><span class="sxs-lookup"><span data-stu-id="9cd29-138">For development machines, Visual Studio automatically installs ANCM in IIS Express, and in IIS if it is already installed on the machine.</span></span>

### <a name="install-the-iisintegration-nuget-package"></a><span data-ttu-id="9cd29-139">Installieren Sie das IISIntegration NuGet-Paket</span><span class="sxs-lookup"><span data-stu-id="9cd29-139">Install the IISIntegration NuGet package</span></span>

# <a name="aspnet-core-2xtabaspnetcore2x"></a>[<span data-ttu-id="9cd29-140">ASP.NET Core 2.x</span><span class="sxs-lookup"><span data-stu-id="9cd29-140">ASP.NET Core 2.x</span></span>](#tab/aspnetcore2x)

<span data-ttu-id="9cd29-141">Die [Microsoft.AspNetCore.Server.IISIntegration](https://www.nuget.org/packages/Microsoft.AspNetCore.Server.IISIntegration/) Paket ist in der ASP.NET Core Metapackages enthalten ([Microsoft.AspNetCore](https://www.nuget.org/packages/Microsoft.AspNetCore/) und [Microsoft.AspNetCore.All](xref:fundamentals/metapackage) ).</span><span class="sxs-lookup"><span data-stu-id="9cd29-141">The [Microsoft.AspNetCore.Server.IISIntegration](https://www.nuget.org/packages/Microsoft.AspNetCore.Server.IISIntegration/) package is included in the ASP.NET Core metapackages ([Microsoft.AspNetCore](https://www.nuget.org/packages/Microsoft.AspNetCore/) and [Microsoft.AspNetCore.All](xref:fundamentals/metapackage)).</span></span> <span data-ttu-id="9cd29-142">Wenn Sie eines der Metapackages nicht verwenden, installieren Sie `Microsoft.AspNetCore.Server.IISIntegration` getrennt.</span><span class="sxs-lookup"><span data-stu-id="9cd29-142">If you don't use one of the metapackages, install `Microsoft.AspNetCore.Server.IISIntegration` separately.</span></span> <span data-ttu-id="9cd29-143">Die `IISIntegration` Paket ist ein Interoperabilität Pack, das liest Umgebungsvariablen übertragen, indem Sie ANCM So richten Sie Ihre app ein.</span><span class="sxs-lookup"><span data-stu-id="9cd29-143">The `IISIntegration` package is an interoperability pack that reads environment variables broadcast by ANCM to set up your app.</span></span> <span data-ttu-id="9cd29-144">Die Umgebungsvariablen bieten Konfigurationsinformationen, z. B. den Port zu lauschen.</span><span class="sxs-lookup"><span data-stu-id="9cd29-144">The environment variables provide configuration information, such as the port to listen on.</span></span> 

# <a name="aspnet-core-1xtabaspnetcore1x"></a>[<span data-ttu-id="9cd29-145">ASP.NET Core 1.x</span><span class="sxs-lookup"><span data-stu-id="9cd29-145">ASP.NET Core 1.x</span></span>](#tab/aspnetcore1x)

<span data-ttu-id="9cd29-146">Installieren Sie in der Anwendung [Microsoft.AspNetCore.Server.IISIntegration](https://www.nuget.org/packages/Microsoft.AspNetCore.Server.IISIntegration/).</span><span class="sxs-lookup"><span data-stu-id="9cd29-146">In your application, install [Microsoft.AspNetCore.Server.IISIntegration](https://www.nuget.org/packages/Microsoft.AspNetCore.Server.IISIntegration/).</span></span> <span data-ttu-id="9cd29-147">Die `IISIntegration` Paket ist ein Interoperabilität Pack, das liest Umgebungsvariablen übertragen, indem Sie ANCM So richten Sie Ihre app ein.</span><span class="sxs-lookup"><span data-stu-id="9cd29-147">The `IISIntegration` package  is an interoperability pack that reads environment variables broadcast by ANCM to set up your app.</span></span> <span data-ttu-id="9cd29-148">Die Umgebungsvariablen bieten Konfigurationsinformationen, z. B. den Port zu lauschen.</span><span class="sxs-lookup"><span data-stu-id="9cd29-148">The environment variables provide configuration information, such as the port to listen on.</span></span> 

---

### <a name="call-useiisintegration"></a><span data-ttu-id="9cd29-149">Rufen Sie UseIISIntegration</span><span class="sxs-lookup"><span data-stu-id="9cd29-149">Call UseIISIntegration</span></span>

# <a name="aspnet-core-2xtabaspnetcore2x"></a>[<span data-ttu-id="9cd29-150">ASP.NET Core 2.x</span><span class="sxs-lookup"><span data-stu-id="9cd29-150">ASP.NET Core 2.x</span></span>](#tab/aspnetcore2x)

<span data-ttu-id="9cd29-151">Die `UseIISIntegration` Erweiterungsmethode auf [ `WebHostBuilder` ](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.hosting.webhostbuilder) wird automatisch aufgerufen, wenn Sie mit IIS ausführen.</span><span class="sxs-lookup"><span data-stu-id="9cd29-151">The `UseIISIntegration` extension method on [`WebHostBuilder`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.hosting.webhostbuilder) is called automatically when you run with IIS.</span></span>

<span data-ttu-id="9cd29-152">Wenn Sie noch nicht installiert und sind nicht eines der ASP.NET Core Metapackages verwenden die `Microsoft.AspNetCore.Server.IISIntegration` Paket, erhalten Sie einen Laufzeitfehler.</span><span class="sxs-lookup"><span data-stu-id="9cd29-152">If you aren't using one of the ASP.NET Core metapackages and haven't installed the  `Microsoft.AspNetCore.Server.IISIntegration` package, you get a runtime error.</span></span> <span data-ttu-id="9cd29-153">Beim Aufrufen `UseIISIntegration` explizit, Sie einen Fehler zur Kompilierzeit abzurufen, wenn das Paket nicht installiert ist.</span><span class="sxs-lookup"><span data-stu-id="9cd29-153">If you call `UseIISIntegration` explicitly, you get a compile time error if the package isn't installed.</span></span>

# <a name="aspnet-core-1xtabaspnetcore1x"></a>[<span data-ttu-id="9cd29-154">ASP.NET Core 1.x</span><span class="sxs-lookup"><span data-stu-id="9cd29-154">ASP.NET Core 1.x</span></span>](#tab/aspnetcore1x)

<span data-ttu-id="9cd29-155">In der Anwendungsverzeichnis `Main` -Methode, rufen die `UseIISIntegration` Erweiterungsmethode auf [ `WebHostBuilder` ](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.hosting.webhostbuilder).</span><span class="sxs-lookup"><span data-stu-id="9cd29-155">In your application's `Main` method, call the `UseIISIntegration` extension method on [`WebHostBuilder`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.hosting.webhostbuilder).</span></span> 

[!code-csharp[](aspnet-core-module/sample/Program.cs?name=snippet_Main&highlight=12)]

---

<span data-ttu-id="9cd29-156">Die `UseIISIntegration` Methode sucht nach den Umgebungsvariablen, die ANCM festlegt, und es keine-Ops, wenn sie nicht gefunden werden.</span><span class="sxs-lookup"><span data-stu-id="9cd29-156">The `UseIISIntegration` method looks for environment variables that ANCM sets, and it no-ops if they aren't found.</span></span> <span data-ttu-id="9cd29-157">Dieses Verhalten ermöglicht Szenarien wie Entwicklung und Tests auf MacOS oder Linux und die Bereitstellung auf einem Server mit IIS.</span><span class="sxs-lookup"><span data-stu-id="9cd29-157">This behavior facilitates scenarios like developing and testing on macOS or Linux and deploying to a server that runs IIS.</span></span> <span data-ttu-id="9cd29-158">Beim auf MacOS oder Linux ausgeführt wird, verhält sich wie der Webserver Kestrel; aber wenn die app für die IIS-Umgebung bereitgestellt wird, verwendet es automatisch ANCM und IIS.</span><span class="sxs-lookup"><span data-stu-id="9cd29-158">While running on macOS or Linux, Kestrel acts as the web server; but when the app is deployed to the IIS environment, it automatically uses ANCM and IIS.</span></span>

### <a name="ancm-port-binding-overrides-other-port-bindings"></a><span data-ttu-id="9cd29-159">Portbindung ANCM überschreibt andere portbindungen</span><span class="sxs-lookup"><span data-stu-id="9cd29-159">ANCM port binding overrides other port bindings</span></span>

# <a name="aspnet-core-2xtabaspnetcore2x"></a>[<span data-ttu-id="9cd29-160">ASP.NET Core 2.x</span><span class="sxs-lookup"><span data-stu-id="9cd29-160">ASP.NET Core 2.x</span></span>](#tab/aspnetcore2x)

<span data-ttu-id="9cd29-161">ANCM generiert einen dynamischen Port zuweisen an den Back-End-Prozess.</span><span class="sxs-lookup"><span data-stu-id="9cd29-161">ANCM generates a dynamic port to assign to the back-end process.</span></span> <span data-ttu-id="9cd29-162">Die `UseIISIntegration` -Methode übernimmt diese dynamischen Port und Kestrel für Lauschen konfiguriert `http://locahost:{dynamicPort}/`.</span><span class="sxs-lookup"><span data-stu-id="9cd29-162">The `UseIISIntegration` method picks up this dynamic port and configures Kestrel to listen on `http://locahost:{dynamicPort}/`.</span></span> <span data-ttu-id="9cd29-163">Dies überschreibt anderen URL-Konfigurationen, z. B. Aufrufe der `UseUrls` oder [des Kestrel Lauschen API](xref:fundamentals/servers/kestrel?tabs=aspnetcore2x#endpoint-configuration).</span><span class="sxs-lookup"><span data-stu-id="9cd29-163">This overrides other URL configurations, such as calls to `UseUrls` or [Kestrel's Listen API](xref:fundamentals/servers/kestrel?tabs=aspnetcore2x#endpoint-configuration).</span></span> <span data-ttu-id="9cd29-164">Aus diesem Grund Sie aufrufen müssen `UseUrls` oder des Kestrel `Listen` API, die bei der Verwendung von ANCM.</span><span class="sxs-lookup"><span data-stu-id="9cd29-164">Therefore, you don't need to call `UseUrls` or Kestrel's `Listen` API when you use ANCM.</span></span> <span data-ttu-id="9cd29-165">Wenn Sie aufrufen `UseUrls` oder `Listen`, Kestrel überwacht den Port, die Sie angeben, wenn Sie die app ohne IIS ausführen.</span><span class="sxs-lookup"><span data-stu-id="9cd29-165">If you do call `UseUrls` or `Listen`, Kestrel listens on the port you specify when you run the app without IIS.</span></span>

# <a name="aspnet-core-1xtabaspnetcore1x"></a>[<span data-ttu-id="9cd29-166">ASP.NET Core 1.x</span><span class="sxs-lookup"><span data-stu-id="9cd29-166">ASP.NET Core 1.x</span></span>](#tab/aspnetcore1x)

<span data-ttu-id="9cd29-167">ANCM generiert einen dynamischen Port zuweisen an den Back-End-Prozess.</span><span class="sxs-lookup"><span data-stu-id="9cd29-167">ANCM generates a dynamic port to assign to the back-end process.</span></span> <span data-ttu-id="9cd29-168">Die `UseIISIntegration` -Methode übernimmt diese dynamischen Port und Kestrel für Lauschen konfiguriert `http://locahost:{dynamicPort}/`.</span><span class="sxs-lookup"><span data-stu-id="9cd29-168">The `UseIISIntegration` method picks up this dynamic port and configures Kestrel to listen on `http://locahost:{dynamicPort}/`.</span></span> <span data-ttu-id="9cd29-169">Dies überschreibt anderen URL-Konfigurationen, z. B. Aufrufe der `UseUrls`.</span><span class="sxs-lookup"><span data-stu-id="9cd29-169">This overrides other URL configurations, such as calls to `UseUrls`.</span></span> <span data-ttu-id="9cd29-170">Aus diesem Grund Sie aufrufen müssen `UseUrls` bei Verwendung von ANCM.</span><span class="sxs-lookup"><span data-stu-id="9cd29-170">Therefore, you don't need to call `UseUrls` when you use ANCM.</span></span> <span data-ttu-id="9cd29-171">Wenn Sie aufrufen `UseUrls`, Kestrel überwacht den Port, die Sie angeben, wenn Sie die app ohne IIS ausführen.</span><span class="sxs-lookup"><span data-stu-id="9cd29-171">If you do call `UseUrls`, Kestrel listens on the port you specify when you run the app without IIS.</span></span>

<span data-ttu-id="9cd29-172">In ASP.NET Core 1.0, wenn Sie aufrufen `UseUrls`, rufen sie **vor** rufen Sie `UseIISIntegration` , damit die ANCM konfigurierte Port nicht überschrieben.</span><span class="sxs-lookup"><span data-stu-id="9cd29-172">In ASP.NET Core 1.0, if you call `UseUrls`, call it **before** you call `UseIISIntegration` so that the ANCM-configured port doesn't get overwritten.</span></span> <span data-ttu-id="9cd29-173">Diese Reihenfolge des Aufrufs angezeigt wird nicht in ASP.NET Core 1.1 erforderlich, weil die ANCM Einstellung überschreibt `UseUrls`.</span><span class="sxs-lookup"><span data-stu-id="9cd29-173">This calling order isn't required in ASP.NET Core 1.1, because the ANCM setting overrides `UseUrls`.</span></span>

---

### <a name="configure-ancm-options-in-webconfig"></a><span data-ttu-id="9cd29-174">ANCM-Optionen in der Datei "Web.config" Konfigurieren</span><span class="sxs-lookup"><span data-stu-id="9cd29-174">Configure ANCM options in Web.config</span></span>

<span data-ttu-id="9cd29-175">Konfiguration für ASP.NET Core-Modul befindet sich in der *"Web.config"* -Datei, die im Stammordner der Anwendung befindet.</span><span class="sxs-lookup"><span data-stu-id="9cd29-175">Configuration for the ASP.NET Core Module is stored in the *web.config* file that is located in the application's root folder.</span></span> <span data-ttu-id="9cd29-176">Einstellungen in dieser Datei zeigen Sie auf der Startbefehl und die Argumente, die die ASP.NET Core-app zu starten.</span><span class="sxs-lookup"><span data-stu-id="9cd29-176">Settings in this file point to the startup command and arguments that start your ASP.NET Core app.</span></span> <span data-ttu-id="9cd29-177">Beispiel für *"Web.config"* Code und eine Anleitung für Konfigurationsoptionen finden Sie unter [ASP.NET Core Konfiguration Modulverweis](xref:host-and-deploy/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="9cd29-177">For sample *web.config* code and guidance on configuration options, see [ASP.NET Core Module Configuration Reference](xref:host-and-deploy/aspnet-core-module).</span></span>

### <a name="run-with-iis-express-in-development"></a><span data-ttu-id="9cd29-178">Führen Sie in der Entwicklung mit IIS Express</span><span class="sxs-lookup"><span data-stu-id="9cd29-178">Run with IIS Express in development</span></span>

<span data-ttu-id="9cd29-179">IIS Express kann von Visual Studio unter Verwendung der durch die ASP.NET Core definierten Standardprofil gestartet werden.</span><span class="sxs-lookup"><span data-stu-id="9cd29-179">IIS Express can be launched by Visual Studio using the default profile defined by the ASP.NET Core templates.</span></span>

## <a name="proxy-configuration-uses-http-protocol-and-a-pairing-token"></a><span data-ttu-id="9cd29-180">Proxykonfiguration verwendet HTTP-Protokoll und ein ereignispaarbildung token</span><span class="sxs-lookup"><span data-stu-id="9cd29-180">Proxy configuration uses HTTP protocol and a pairing token</span></span>

<span data-ttu-id="9cd29-181">Der Proxy zwischen dem ANCM und Kestrel erstellten verwendet das HTTP-Protokoll.</span><span class="sxs-lookup"><span data-stu-id="9cd29-181">The proxy created between the ANCM and Kestrel uses the HTTP protocol.</span></span> <span data-ttu-id="9cd29-182">Mithilfe von HTTP ist zur Optimierung der Leistung, abgewickelt der Datenverkehr zwischen dem ANCM und Kestrel für einen Loopback-Adresse aus der Netzwerkschnittstelle.</span><span class="sxs-lookup"><span data-stu-id="9cd29-182">Using HTTP is a performance optimization where the traffic between the ANCM and Kestrel takes place on a loopback address off of the network interface.</span></span> <span data-ttu-id="9cd29-183">Es ist kein Risiko, dass Lauschangriffe den Datenverkehr zwischen dem ANCM und Kestrel von einem anderen Speicherort aus dem Server.</span><span class="sxs-lookup"><span data-stu-id="9cd29-183">There's no risk of eavesdropping the traffic between the ANCM and Kestrel from a location off of the server.</span></span>

<span data-ttu-id="9cd29-184">Ein ereignispaarbildung Token wird verwendet, um sicherzustellen, dass die Anfragen von Kestrel empfangen Proxyanforderungen von IIS wurden und nicht von einer anderen Quelle stammen.</span><span class="sxs-lookup"><span data-stu-id="9cd29-184">A pairing token is used to guarantee that the requests received by Kestrel were proxied by IIS and didn't come from some other source.</span></span> <span data-ttu-id="9cd29-185">Ereignispaarbildung Token erstellt und in einer Umgebungsvariablen festgelegt (`ASPNETCORE_TOKEN`) durch die ANCM.</span><span class="sxs-lookup"><span data-stu-id="9cd29-185">The pairing token is created and set into an environment variable (`ASPNETCORE_TOKEN`) by the ANCM.</span></span> <span data-ttu-id="9cd29-186">Ereignispaarbildung Token ist auch in einem Header festlegen (`MSAspNetCoreToken`) bei jeder Anforderung über einen Proxy.</span><span class="sxs-lookup"><span data-stu-id="9cd29-186">The pairing token is also set into a header (`MSAspNetCoreToken`) on every proxied request.</span></span> <span data-ttu-id="9cd29-187">IIS-Middleware überprüft anfordern, dass er empfängt, um sicherzustellen, dass der ereignispaarbildung token Headerwert den umgebungsvariablenwert entspricht.</span><span class="sxs-lookup"><span data-stu-id="9cd29-187">IIS Middleware checks each request it receives to confirm that the pairing token header value matches the environment variable value.</span></span> <span data-ttu-id="9cd29-188">Wenn die Tokenwerte nicht übereinstimmt, wird die Anforderung protokolliert und abgelehnt.</span><span class="sxs-lookup"><span data-stu-id="9cd29-188">If the token values are mismatched, the request is logged and rejected.</span></span> <span data-ttu-id="9cd29-189">Die ereignispaarbildung-token-Umgebungsvariable und den Datenverkehr zwischen dem ANCM und Kestrel sind nicht von einem anderen Speicherort aus dem Server zugegriffen werden kann.</span><span class="sxs-lookup"><span data-stu-id="9cd29-189">The pairing token environment variable and the traffic between the ANCM and Kestrel aren't accessible from a location off of the server.</span></span> <span data-ttu-id="9cd29-190">Ohne den ereignispaarbildung Tokenwert nicht Angreifer Anforderungen gesendet, die in der IIS-Middleware-Prüfung umgehen.</span><span class="sxs-lookup"><span data-stu-id="9cd29-190">Without knowing the pairing token value, an attacker can't submit requests that bypass the check in the IIS Middleware.</span></span>

## <a name="next-steps"></a><span data-ttu-id="9cd29-191">Nächste Schritte</span><span class="sxs-lookup"><span data-stu-id="9cd29-191">Next steps</span></span>

<span data-ttu-id="9cd29-192">Weitere Informationen finden Sie in den folgenden Ressourcen:</span><span class="sxs-lookup"><span data-stu-id="9cd29-192">For more information, see the following resources:</span></span>

* [<span data-ttu-id="9cd29-193">Beispiel-app für diesen Artikel</span><span class="sxs-lookup"><span data-stu-id="9cd29-193">Sample app for this article</span></span>](https://github.com/aspnet/Docs/tree/master/aspnetcore/fundamentals/servers/aspnet-core-module/sample)
* [<span data-ttu-id="9cd29-194">ASP.NET Core-Modul-Quellcode</span><span class="sxs-lookup"><span data-stu-id="9cd29-194">ASP.NET Core Module source code</span></span>](https://github.com/aspnet/AspNetCoreModule)
* [<span data-ttu-id="9cd29-195">ASP.NET Core-Modulkonfigurationsverweis</span><span class="sxs-lookup"><span data-stu-id="9cd29-195">ASP.NET Core Module Configuration Reference</span></span>](xref:host-and-deploy/aspnet-core-module)
* [<span data-ttu-id="9cd29-196">Hosten unter Windows mit IIS</span><span class="sxs-lookup"><span data-stu-id="9cd29-196">Host on Windows with IIS</span></span>](xref:host-and-deploy/iis/index)
