---
uid: web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/membership-and-administration
title: Mitgliedschaft und Administration | Microsoft Docs
author: Erikre
description: Diese Reihe von Lernprogrammen erfahren Sie die Grundlagen der Erstellung einer ASP.NET Web Forms-Anwendung mithilfe von ASP.NET 4.5 und Microsoft Visual Studio Express 2013 für wir...
ms.author: aspnetcontent
manager: wpickett
ms.date: 09/08/2014
ms.topic: article
ms.assetid: 732a2316-e49f-4f72-becd-0cd72f14457e
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/membership-and-administration
msc.type: authoredcontent
ms.openlocfilehash: 166bc642ea2083f455be0648e424f0b0ae3b082c
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/06/2018
---
<a name="membership-and-administration"></a><span data-ttu-id="6d68b-103">Mitgliedschaft und Verwaltung</span><span class="sxs-lookup"><span data-stu-id="6d68b-103">Membership and Administration</span></span>
====================
<span data-ttu-id="6d68b-104">by [Erik Reitan](https://github.com/Erikre)</span><span class="sxs-lookup"><span data-stu-id="6d68b-104">by [Erik Reitan](https://github.com/Erikre)</span></span>

<span data-ttu-id="6d68b-105">[Herunterladen des Wingtip Toys-Beispielprojekt (c#)](http://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) oder [(PDF) E-Book herunterladen](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span><span class="sxs-lookup"><span data-stu-id="6d68b-105">[Download Wingtip Toys Sample Project (C#)](http://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) or [Download E-book (PDF)](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span></span>

> <span data-ttu-id="6d68b-106">Diese Reihe von Lernprogrammen erfahren Sie die Grundlagen der Erstellung einer ASP.NET Web Forms-Anwendung mithilfe von ASP.NET 4.5 und Microsoft Visual Studio Express 2013 für Web.</span><span class="sxs-lookup"><span data-stu-id="6d68b-106">This tutorial series will teach you the basics of building an ASP.NET Web Forms application using ASP.NET 4.5 and Microsoft Visual Studio Express 2013 for Web.</span></span> <span data-ttu-id="6d68b-107">Eine Visual Studio 2013 [-Projekts mit C#-Quellcode](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) ist verfügbar, die diese Reihe von Lernprogrammen begleitet.</span><span class="sxs-lookup"><span data-stu-id="6d68b-107">A Visual Studio 2013 [project with C# source code](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) is available to accompany this tutorial series.</span></span>


<span data-ttu-id="6d68b-108">In diesem Lernprogramm wird gezeigt, wie beim Aktualisieren der Wingtip Toys-beispielanwendung für das Hinzufügen einer benutzerdefinierten Rolle und ASP.NET Identity verwenden.</span><span class="sxs-lookup"><span data-stu-id="6d68b-108">This tutorial shows you how to update the Wingtip Toys sample application to add a custom role and use ASP.NET Identity.</span></span> <span data-ttu-id="6d68b-109">Es zeigt auch, wie eine Seite "Verwaltung" implementiert, von dem der Benutzer mit einer benutzerdefinierten Rolle hinzufügen und Produkte aus der Website entfernen kann.</span><span class="sxs-lookup"><span data-stu-id="6d68b-109">It also shows you how to implement an administration page from which the user with a custom role can add and remove products from the website.</span></span>

<span data-ttu-id="6d68b-110">[ASP.NET Identity](../../../../identity/overview/getting-started/introduction-to-aspnet-identity.md) ist das Mitgliedschaftssystem, die zum Erstellen von ASP.NET Web-Anwendung verwendet und steht in ASP.NET 4.5.</span><span class="sxs-lookup"><span data-stu-id="6d68b-110">[ASP.NET Identity](../../../../identity/overview/getting-started/introduction-to-aspnet-identity.md) is the membership system used to build ASP.NET web application and is available in ASP.NET 4.5.</span></span> <span data-ttu-id="6d68b-111">ASP.NET Identity wird verwendet, in der Visual Studio 2013 Web Forms-Projektvorlage als auch die Vorlagen für [ASP.NET-MVC](../../../../mvc/index.md), [ASP.NET-Web-API](../../../../web-api/index.md), und [ASP.NET einseitigen Anwendung](../../../../single-page-application/index.md).</span><span class="sxs-lookup"><span data-stu-id="6d68b-111">ASP.NET Identity is used in the Visual Studio 2013 Web Forms project template, as well as the templates for [ASP.NET MVC](../../../../mvc/index.md), [ASP.NET Web API](../../../../web-api/index.md), and [ASP.NET Single Page Application](../../../../single-page-application/index.md).</span></span> <span data-ttu-id="6d68b-112">Sie können auch ausdrücklich installieren die ASP.NET Identity-System mithilfe von NuGet, wenn Sie mit einer leeren Webanwendung starten.</span><span class="sxs-lookup"><span data-stu-id="6d68b-112">You can also specifically install the ASP.NET Identity system using NuGet when you start with an empty Web application.</span></span> <span data-ttu-id="6d68b-113">In diesem Tutorial Reihen verwenden Sie jedoch die **Web Forms**Projecttemplate, die das ASP.NET Identity-System enthält.</span><span class="sxs-lookup"><span data-stu-id="6d68b-113">However, in this tutorial series you use the **Web Forms**projecttemplate, which includes the ASP.NET Identity system.</span></span> <span data-ttu-id="6d68b-114">ASP.NET Identity erleichtert die Anwendungsdaten benutzerspezifische Profildaten integriert.</span><span class="sxs-lookup"><span data-stu-id="6d68b-114">ASP.NET Identity makes it easy to integrate user-specific profile data with application data.</span></span> <span data-ttu-id="6d68b-115">Darüber hinaus können mit ASP.NET Identity der Persistenzmodell für Benutzerprofile in Ihrer Anwendung auswählen.</span><span class="sxs-lookup"><span data-stu-id="6d68b-115">Also, ASP.NET Identity allows you to choose the persistence model for user profiles in your application.</span></span> <span data-ttu-id="6d68b-116">Sie können die Daten in einer SQL Server-Datenbank oder einen anderen Datenspeicher speichern einschließlich *NoSQL* Datenspeicher wie z. B. Windows Azure-Speichertabellen.</span><span class="sxs-lookup"><span data-stu-id="6d68b-116">You can store the data in a SQL Server database or another data store, including *NoSQL* data stores such as Windows Azure Storage Tables.</span></span>

<span data-ttu-id="6d68b-117">Dieses Lernprogramm baut auf dem vorherigen Lernprogramm, mit dem Titel "Auschecken und Zahlung mit PayPal" in der Reihe von Lernprogrammen Wingtip Toys.</span><span class="sxs-lookup"><span data-stu-id="6d68b-117">This tutorial builds on the previous tutorial titled "Checkout and Payment with PayPal" in the Wingtip Toys tutorial series.</span></span>

## <a name="what-youll-learn"></a><span data-ttu-id="6d68b-118">Lernen Sie:</span><span class="sxs-lookup"><span data-stu-id="6d68b-118">What you'll learn:</span></span>

- <span data-ttu-id="6d68b-119">Wie Sie Code verwenden, um eine benutzerdefinierte Sicherheitsrolle und ein Benutzer der Anwendung hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="6d68b-119">How to use code to add a custom role and a user to the application.</span></span>
- <span data-ttu-id="6d68b-120">Wie Sie den Zugriff auf den Ordner Verwaltung und die Seite einschränken.</span><span class="sxs-lookup"><span data-stu-id="6d68b-120">How to restrict access to the administration folder and page.</span></span>
- <span data-ttu-id="6d68b-121">Wie Sie die Navigation für den Benutzer zu ermöglichen, zu der die benutzerdefinierte Rolle gehört.</span><span class="sxs-lookup"><span data-stu-id="6d68b-121">How to provide navigation for the user that belongs to the custom role.</span></span>
- <span data-ttu-id="6d68b-122">Vorgehensweise wurden die modellbindung verwenden Sie zum Auffüllen einer [DropDownList](https://msdn.microsoft.com/library/system.web.ui.webcontrols.dropdownlist(v=vs.110).aspx) -Steuerelement mit Produktkategorien.</span><span class="sxs-lookup"><span data-stu-id="6d68b-122">How to use model binding to populate a [DropDownList](https://msdn.microsoft.com/library/system.web.ui.webcontrols.dropdownlist(v=vs.110).aspx) control with product categories.</span></span>
- <span data-ttu-id="6d68b-123">Gewusst wie: Hochladen einer Datei in der Anwendung über die [FileUpload](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload(v=vs.110).aspx) Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="6d68b-123">How to upload a file to the web application using the [FileUpload](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload(v=vs.110).aspx) control.</span></span>
- <span data-ttu-id="6d68b-124">Wie Sie Validierungssteuerelemente, um die Validierung von Benutzereingaben zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="6d68b-124">How to use validation controls to implement input validation.</span></span>
- <span data-ttu-id="6d68b-125">Gewusst wie: Hinzufügen und Entfernen von Produkten aus der Anwendung.</span><span class="sxs-lookup"><span data-stu-id="6d68b-125">How to add and remove products from the application.</span></span>

## <a name="these-features-are-included-in-the-tutorial"></a><span data-ttu-id="6d68b-126">Diese Funktionen sind im Lernprogramm enthalten:</span><span class="sxs-lookup"><span data-stu-id="6d68b-126">These features are included in the tutorial:</span></span>

- <span data-ttu-id="6d68b-127">ASP.NET Identity</span><span class="sxs-lookup"><span data-stu-id="6d68b-127">ASP.NET Identity</span></span>
- <span data-ttu-id="6d68b-128">Konfiguration und Autorisierung</span><span class="sxs-lookup"><span data-stu-id="6d68b-128">Configuration and Authorization</span></span>
- <span data-ttu-id="6d68b-129">Modellbindung</span><span class="sxs-lookup"><span data-stu-id="6d68b-129">Model Binding</span></span>
- <span data-ttu-id="6d68b-130">Unaufdringlichen Überprüfung</span><span class="sxs-lookup"><span data-stu-id="6d68b-130">Unobtrusive Validation</span></span>

<span data-ttu-id="6d68b-131">ASP.NET Web Forms stellt Mitgliedschaft.</span><span class="sxs-lookup"><span data-stu-id="6d68b-131">ASP.NET Web Forms provides membership capabilities.</span></span> <span data-ttu-id="6d68b-132">Mithilfe der Standardvorlage müssen Sie die der integrierten Mitgliedschaftsfunktionen, die Sie sofort verwenden können, wenn die Anwendung ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="6d68b-132">By using the default template, you have built-in membership functionality that you can immediately use when the application runs.</span></span> <span data-ttu-id="6d68b-133">In diesem Lernprogramm wird gezeigt, wie mithilfe von ASP.NET Identity zum Hinzufügen einer benutzerdefinierten Rolle und weisen Sie einen Benutzer, die dieser Rolle.</span><span class="sxs-lookup"><span data-stu-id="6d68b-133">This tutorial shows you how to use ASP.NET Identity to add a custom role and assign a user to that role.</span></span> <span data-ttu-id="6d68b-134">Sie erfahren, wie den Zugriff auf den Ordner Verwaltung einschränken.</span><span class="sxs-lookup"><span data-stu-id="6d68b-134">You will learn how to restrict access to the administration folder.</span></span> <span data-ttu-id="6d68b-135">Sie fügen eine Seite in den Ordner Verwaltung, die ermöglicht es einem Benutzer mit einer benutzerdefinierten Rolle hinzufügen und Entfernen von Produkten und ein Produkt Vorschau anzuzeigen, nachdem er hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="6d68b-135">You'll add a page to the administration folder that allows a user with a custom role to add and remove products, and to preview a product after it has been added.</span></span>

## <a name="adding-a-custom-role"></a><span data-ttu-id="6d68b-136">Hinzufügen einer benutzerdefinierten Rolle</span><span class="sxs-lookup"><span data-stu-id="6d68b-136">Adding a Custom Role</span></span>

<span data-ttu-id="6d68b-137">Mithilfe von ASP.NET Identity, können Sie eine benutzerdefinierte Sicherheitsrolle hinzufügen und Zuweisen eines Benutzers zu dieser Rolle mithilfe von Code.</span><span class="sxs-lookup"><span data-stu-id="6d68b-137">Using ASP.NET Identity, you can add a custom role and assign a user to that role using code.</span></span>

1. <span data-ttu-id="6d68b-138">In **Projektmappen-Explorer**, mit der rechten Maustaste auf die *Logik* Ordner, und erstellen Sie eine neue Klasse.</span><span class="sxs-lookup"><span data-stu-id="6d68b-138">In **Solution Explorer**, right-click on the *Logic* folder and create a new class.</span></span>
2. <span data-ttu-id="6d68b-139">Benennen Sie die neue Klasse *RoleActions.cs*.</span><span class="sxs-lookup"><span data-stu-id="6d68b-139">Name the new class *RoleActions.cs*.</span></span>
3. <span data-ttu-id="6d68b-140">Ändern Sie den Code, sodass er wie folgt aussieht:</span><span class="sxs-lookup"><span data-stu-id="6d68b-140">Modify the code so that it appears as follows:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample1.cs?highlight=8)]
4. <span data-ttu-id="6d68b-141">In **Projektmappen-Explorer**öffnen die *Global.asax.cs* Datei.</span><span class="sxs-lookup"><span data-stu-id="6d68b-141">In **Solution Explorer**, open the *Global.asax.cs* file.</span></span>
5. <span data-ttu-id="6d68b-142">Ändern der *Global.asax.cs* Datei durch Hinzufügen des Codes in gelb hervorgehoben werden, sodass er wie folgt aussieht:</span><span class="sxs-lookup"><span data-stu-id="6d68b-142">Modify the *Global.asax.cs* file by adding the code highlighted in yellow so that it appears as follows:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample2.cs?highlight=11,26-28)]
6. <span data-ttu-id="6d68b-143">Beachten Sie, dass `AddUserAndRole` rot unterstrichen ist.</span><span class="sxs-lookup"><span data-stu-id="6d68b-143">Notice that `AddUserAndRole` is underlined in red.</span></span> <span data-ttu-id="6d68b-144">Doppelklicken Sie auf den AddUserAndRole-Code.</span><span class="sxs-lookup"><span data-stu-id="6d68b-144">Double-click the AddUserAndRole code.</span></span>  
   <span data-ttu-id="6d68b-145">Der Buchstabe "A" am Anfang der markierten Methode wird unterstrichen.</span><span class="sxs-lookup"><span data-stu-id="6d68b-145">The letter "A" at the beginning of the highlighted method will be underlined.</span></span>
7. <span data-ttu-id="6d68b-146">Zeigen Sie auf den Buchstaben "A", und klicken Sie auf der Benutzeroberfläche, die Sie zum Generieren eines Methodenstubs für ermöglicht die `AddUserAndRole` Methode.</span><span class="sxs-lookup"><span data-stu-id="6d68b-146">Hover over the letter "A" and click the UI that allows you to generate a method stub for the `AddUserAndRole` method.</span></span> 

    ![Mitgliedschaft und Advministration - Methodenstub generieren](membership-and-administration/_static/image1.png)
8. <span data-ttu-id="6d68b-148">Klicken Sie auf die Option mit dem Titel:</span><span class="sxs-lookup"><span data-stu-id="6d68b-148">Click the option titled:</span></span>  
    `Generate method stub for "AddUserAndRole" in "WingtipToys.Logic.RoleActions"`
9. <span data-ttu-id="6d68b-149">Öffnen der *RoleActions.cs* -Datei von der *Logik* Ordner.</span><span class="sxs-lookup"><span data-stu-id="6d68b-149">Open the *RoleActions.cs* file from the *Logic* folder.</span></span>  
   <span data-ttu-id="6d68b-150">Die `AddUserAndRole` Methode in der Klassendatei hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="6d68b-150">The `AddUserAndRole` method has been added to the class file.</span></span>
10. <span data-ttu-id="6d68b-151">Ändern der *RoleActions.cs* Datei durch das Entfernen der `NotImplementedeException` und Hinzufügen von Code in gelb hervorgehoben, damit er wie folgt aussieht:</span><span class="sxs-lookup"><span data-stu-id="6d68b-151">Modify the *RoleActions.cs* file by removing the `NotImplementedeException` and adding the code highlighted in yellow, so that it appears as follows:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample3.cs?highlight=5-7,15-51)]

<span data-ttu-id="6d68b-152">Der obige Code wird zuerst ein Datenbankkontext für die Mitgliedschaftsdatenbank.</span><span class="sxs-lookup"><span data-stu-id="6d68b-152">The above code first establishes a database context for the membership database.</span></span> <span data-ttu-id="6d68b-153">Die Mitgliedschaftsdatenbank wird auch als gespeichert ein *mdf* in der Datei die *App\_Daten* Ordner.</span><span class="sxs-lookup"><span data-stu-id="6d68b-153">The membership database is also stored as an *.mdf* file in the *App\_Data* folder.</span></span> <span data-ttu-id="6d68b-154">Sie werden können, um diese Datenbank anzuzeigen, sobald der erste Benutzer dieser Webanwendung angemeldet hat.</span><span class="sxs-lookup"><span data-stu-id="6d68b-154">You will be able to view this database once the first user has signed in to this web application.</span></span> 

> [!NOTE] 
> 
> <span data-ttu-id="6d68b-155">Wenn Sie die Daten der Benutzergruppenmitgliedschaft zusammen mit der Produktdaten speichern möchten, können Sie erwägen, mit dem gleichen **DbContext** , dass Sie zum Speichern von der Produktdaten im obigen Code verwendet.</span><span class="sxs-lookup"><span data-stu-id="6d68b-155">If you wish to store the membership data along with the product data, you can consider using the same **DbContext** that you used to store the product data in the above code.</span></span>


 <span data-ttu-id="6d68b-156">Die *interne* -Schlüsselwort ist einen Zugriffsmodifizierer für Typen (z. B. Klassen) und Typmembern (z. B. Methoden oder Eigenschaften).</span><span class="sxs-lookup"><span data-stu-id="6d68b-156">The *internal* keyword is an access modifier for types (such as classes) and type members (such as methods or properties).</span></span> <span data-ttu-id="6d68b-157">Interne Typen oder Member nur innerhalb der Dateien in der gleichen Assembly zugegriffen werden *(.dll* Datei).</span><span class="sxs-lookup"><span data-stu-id="6d68b-157">Internal types or members are accessible only within files contained in the same assembly *(.dll* file).</span></span> <span data-ttu-id="6d68b-158">Bei der Erstellung Ihrer Anwendung eine Assemblydatei *(DLL*) erstellt wird, enthält den Code, der ausgeführt wird, wenn Sie die Anwendung ausführen.</span><span class="sxs-lookup"><span data-stu-id="6d68b-158">When you build your application, an assembly file *(.dll*) is created that contains the code that is executed when you run your application.</span></span> 

<span data-ttu-id="6d68b-159">Ein `RoleStore` -Objekt, das Rollenverwaltung bereitstellt, wird basierend auf den Kontext der Datenbank erstellt.</span><span class="sxs-lookup"><span data-stu-id="6d68b-159">A `RoleStore` object, which provides role management, is created based on the database context.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="6d68b-160">Beachten Sie, dass bei der `RoleStore` -Objekt wird erstellt, verwendet eine generische `IdentityRole` Typ.</span><span class="sxs-lookup"><span data-stu-id="6d68b-160">Notice that when the `RoleStore` object is created it uses a Generic `IdentityRole` type.</span></span> <span data-ttu-id="6d68b-161">Dies bedeutet, dass die `RoleStore` darf nur enthalten `IdentityRole` Objekte.</span><span class="sxs-lookup"><span data-stu-id="6d68b-161">This means that the `RoleStore` is only allowed to contain `IdentityRole` objects.</span></span> <span data-ttu-id="6d68b-162">Außerdem werden durch Verwenden von Generika, Ressourcen im Arbeitsspeicher besser verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="6d68b-162">Also by using Generics, resources in memory are handled better.</span></span>


<span data-ttu-id="6d68b-163">Als Nächstes wird die `RoleManager` Objekt, das erstellt basierend auf der `RoleStore` -Objekt, das Sie gerade erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="6d68b-163">Next, the `RoleManager` object, is created based on the `RoleStore` object that you just created.</span></span> <span data-ttu-id="6d68b-164">die `RoleManager` Objekt stellt eine rollenbezogene API, die verwendet werden kann, automatisch zum Speichern der `RoleStore`.</span><span class="sxs-lookup"><span data-stu-id="6d68b-164">the `RoleManager` object exposes role related API which can be used to automatically save changes to the `RoleStore`.</span></span> <span data-ttu-id="6d68b-165">Die `RoleManager` darf nur enthalten `IdentityRole` Objekte, da der Code verwendet die `<IdentityRole>` generischen Typ.</span><span class="sxs-lookup"><span data-stu-id="6d68b-165">The `RoleManager` is only allowed to contain `IdentityRole` objects because the code uses the `<IdentityRole>` Generic type.</span></span>

<span data-ttu-id="6d68b-166">Rufen Sie die `RoleExists` Methode, um zu bestimmen, ob die Rolle "CanEdit" in der Mitgliedschaftsdatenbank vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="6d68b-166">You call the `RoleExists` method to determine if the "canEdit" role is present in the membership database.</span></span> <span data-ttu-id="6d68b-167">Wenn sie nicht der Fall ist, erstellen Sie die Rolle an.</span><span class="sxs-lookup"><span data-stu-id="6d68b-167">If it is not, you create the role.</span></span>

<span data-ttu-id="6d68b-168">Erstellen der `UserManager` Objekt anscheinend komplizierter als die `RoleManager` zu steuern, ist es jedoch nahezu identisch.</span><span class="sxs-lookup"><span data-stu-id="6d68b-168">Creating the `UserManager` object appears to be more complicated than the `RoleManager` control, however it is nearly the same.</span></span> <span data-ttu-id="6d68b-169">Es wird nur auf einer Zeile anstatt mehrere codiert.</span><span class="sxs-lookup"><span data-stu-id="6d68b-169">It is just coded on one line rather than several.</span></span> <span data-ttu-id="6d68b-170">Der Parameter, den Sie übergeben wird hier als ein neues Objekt, das in den Klammern enthaltenen instanziieren.</span><span class="sxs-lookup"><span data-stu-id="6d68b-170">Here, the parameter that you are passing is instantiating as a new object contained in the parenthesis.</span></span>

<span data-ttu-id="6d68b-171">Als Nächstes erstellen Sie den Benutzer "CanEditUser" durch Erstellen eines neuen `ApplicationUser` Objekt.</span><span class="sxs-lookup"><span data-stu-id="6d68b-171">Next you create the "canEditUser" user by creating a new `ApplicationUser` object.</span></span> <span data-ttu-id="6d68b-172">Klicken Sie dann, wenn Sie den Benutzer erstellen, fügen Sie den Benutzer der neuen Rolle.</span><span class="sxs-lookup"><span data-stu-id="6d68b-172">Then, if you successfully create the user, you add the user to the new role.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="6d68b-173">Die Fehlerbehandlung wird während des Lernprogramms "ASP.NET Fehlerbehandlung" weiter unten in diesem Lernprogramm Reihe aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="6d68b-173">The error handling will be updated during the "ASP.NET Error Handling" tutorial later in this tutorial series.</span></span>


<span data-ttu-id="6d68b-174">Das nächste Mal die Anwendung gestartet wird, wird der Benutzer mit dem Namen "CanEditUser" wie die Rolle mit dem Namen "CanEdit" der Anwendung hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="6d68b-174">The next time the application starts, the user named "canEditUser" will be added as the role named "canEdit" of the application.</span></span> <span data-ttu-id="6d68b-175">Weiter unten in diesem Lernprogramm werden Sie sich anmelden, als der Benutzer "CanEditUser", um zusätzliche Funktionen anzuzeigen, die Sie im Verlauf dieses Lernprogramms hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="6d68b-175">Later in this tutorial, you will login as the "canEditUser" user to display additional capabilities that you will added during this tutorial.</span></span> <span data-ttu-id="6d68b-176">API-Informationen zu ASP.NET Identity finden Sie unter der [Microsoft.AspNet.Identity-Namespace](https://msdn.microsoft.com/library/microsoft.aspnet.identity(v=vs.111).aspx).</span><span class="sxs-lookup"><span data-stu-id="6d68b-176">For API details about ASP.NET Identity, see the [Microsoft.AspNet.Identity Namespace](https://msdn.microsoft.com/library/microsoft.aspnet.identity(v=vs.111).aspx).</span></span> <span data-ttu-id="6d68b-177">Weitere Informationen zum Initialisieren des Systems ASP.NET Identity finden Sie unter der [AspnetIdentitySample](https://github.com/rustd/AspnetIdentitySample/blob/master/AspnetIdentitySample/App_Start/IdentityConfig.cs).</span><span class="sxs-lookup"><span data-stu-id="6d68b-177">For additional details about initializing the ASP.NET Identity system, see the [AspnetIdentitySample](https://github.com/rustd/AspnetIdentitySample/blob/master/AspnetIdentitySample/App_Start/IdentityConfig.cs).</span></span>

### <a name="restricting-access-to-the-administration-page"></a><span data-ttu-id="6d68b-178">Einschränken des Zugriffs auf die Seite "Verwaltung"</span><span class="sxs-lookup"><span data-stu-id="6d68b-178">Restricting Access to the Administration Page</span></span>

<span data-ttu-id="6d68b-179">Die beispielanwendung des Wingtip Toys kann anonyme Benutzer und angemeldete Benutzer zum Anzeigen und Produkte kaufen.</span><span class="sxs-lookup"><span data-stu-id="6d68b-179">The Wingtip Toys sample application allows both anonymous users and logged-in users to view and purchase products.</span></span> <span data-ttu-id="6d68b-180">Der angemeldete Benutzer mit der benutzerdefinierten "CanEdit" Rolle kann jedoch eine zugriffsbeschränkte Seite zum Hinzufügen und Entfernen von Produkten zugreifen.</span><span class="sxs-lookup"><span data-stu-id="6d68b-180">However, the logged-in user that has the custom "canEdit" role can access a restricted page in order to add and remove products.</span></span>

#### <a name="add-an-administration-folder-and-page"></a><span data-ttu-id="6d68b-181">Fügen Sie einen Ordner Verwaltung und Seite</span><span class="sxs-lookup"><span data-stu-id="6d68b-181">Add an Administration Folder and Page</span></span>

<span data-ttu-id="6d68b-182">Als Nächstes erstellen Sie einen Ordner namens *Admin* beispielanwendung für den "CanEditUser" Benutzer zur Rolle benutzerdefinierten der Wingtip Toys gehören.</span><span class="sxs-lookup"><span data-stu-id="6d68b-182">Next, you will create a folder named *Admin* for the "canEditUser" user belonging to the custom role of the Wingtip Toys sample application.</span></span>

1. <span data-ttu-id="6d68b-183">Mit der rechten Maustaste des Projektnamens (**Wingtip Toys**) in **Projektmappen-Explorer** , und wählen Sie **hinzufügen**  - &gt; **neuer Ordner**.</span><span class="sxs-lookup"><span data-stu-id="6d68b-183">Right-click the project name (**Wingtip Toys**) in **Solution Explorer** and select **Add** -&gt; **New Folder**.</span></span>
2. <span data-ttu-id="6d68b-184">Nennen Sie diesen Ordner *Admin*.</span><span class="sxs-lookup"><span data-stu-id="6d68b-184">Name the new folder *Admin*.</span></span>
3. <span data-ttu-id="6d68b-185">Mit der rechten Maustaste die *Admin* Ordner, und wählen Sie dann **hinzufügen**  - &gt; **neues Element**.</span><span class="sxs-lookup"><span data-stu-id="6d68b-185">Right-click the *Admin* folder and then select **Add** -&gt; **New Item**.</span></span>   
   <span data-ttu-id="6d68b-186">Das Dialogfeld **Neues Element hinzufügen** wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="6d68b-186">The **Add New Item** dialog box is displayed.</span></span>
4. <span data-ttu-id="6d68b-187">Wählen Sie die <strong>Visual C#-</strong> - &gt; <strong>Web</strong> Gruppe "Vorlagen" auf der linken Seite.</span><span class="sxs-lookup"><span data-stu-id="6d68b-187">Select the <strong>Visual C#</strong>-&gt; <strong>Web</strong> templates group on the left.</span></span> <span data-ttu-id="6d68b-188">Wählen Sie aus der Liste mittleren <strong>Webformular mit Gestaltungsvorlage</strong>, nennen Sie sie <em>AdminPage.aspx</em><strong>,</strong> und wählen Sie dann <strong>hinzufügen</strong>.</span><span class="sxs-lookup"><span data-stu-id="6d68b-188">From the middle list, select <strong>Web Form with Master Page</strong>,name it <em>AdminPage.aspx</em><strong>,</strong> and then select <strong>Add</strong>.</span></span>
5. <span data-ttu-id="6d68b-189">Wählen Sie die *Site.Master* als Masterseite, und wählen Sie dann **OK**.</span><span class="sxs-lookup"><span data-stu-id="6d68b-189">Select the *Site.Master* file as the master page, and then choose **OK**.</span></span>

#### <a name="add-a-webconfig-file"></a><span data-ttu-id="6d68b-190">Fügen Sie eine Datei "Web.config" hinzu.</span><span class="sxs-lookup"><span data-stu-id="6d68b-190">Add a Web.config File</span></span>

<span data-ttu-id="6d68b-191">Durch Hinzufügen einer *"Web.config"* Datei wird in der *Admin* Ordner, Sie können den Zugriff auf die Seite, die im Ordner enthaltenen.</span><span class="sxs-lookup"><span data-stu-id="6d68b-191">By adding a *Web.config* file to the *Admin* folder, you can restrict access to the page contained in the folder.</span></span>

1. <span data-ttu-id="6d68b-192">Mit der rechten Maustaste die *Admin* Ordner, und wählen **hinzufügen**  - &gt; **neues Element**.</span><span class="sxs-lookup"><span data-stu-id="6d68b-192">Right-click the *Admin* folder and select **Add** -&gt; **New Item**.</span></span>  
   <span data-ttu-id="6d68b-193">Das Dialogfeld **Neues Element hinzufügen** wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="6d68b-193">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="6d68b-194">Wählen Sie in der Liste der Visual c#-internetvorlagen, <strong>Webkonfigurationsdatei</strong>aus mittleren, akzeptieren Sie den Standardnamen der <em>"Web.config"</em><strong>,</strong> und wählen Sie dann auf <strong>Hinzufügen</strong>.</span><span class="sxs-lookup"><span data-stu-id="6d68b-194">From the list of Visual C# web templates, select <strong>Web Configuration File</strong>from the middle list, accept the default name of <em>Web.config</em><strong>,</strong> and then select <strong>Add</strong>.</span></span>
3. <span data-ttu-id="6d68b-195">Ersetzen Sie das vorhandene XML-Inhalt in die *"Web.config"* Datei durch Folgendes:</span><span class="sxs-lookup"><span data-stu-id="6d68b-195">Replace the existing XML content in the *Web.config* file with the following:</span></span>  

    [!code-xml[Main](membership-and-administration/samples/sample4.xml)]

<span data-ttu-id="6d68b-196">Speichern Sie die *"Web.config"* Datei.</span><span class="sxs-lookup"><span data-stu-id="6d68b-196">Save the *Web.config* file.</span></span> <span data-ttu-id="6d68b-197">Die *"Web.config"* Datei gibt an, dass nur Benutzerdaten, die zur Rolle "CanEdit" der Anwendung gehören kann greifen Sie auf der Seite, die in enthaltenen der *Admin* Ordner.</span><span class="sxs-lookup"><span data-stu-id="6d68b-197">The *Web.config* file specifies that only user belonging to the "canEdit" role of the application can access the page contained in the *Admin* folder.</span></span>

### <a name="including-custom-role-navigation"></a><span data-ttu-id="6d68b-198">Einschließlich benutzerdefinierte Rolle, die Navigation</span><span class="sxs-lookup"><span data-stu-id="6d68b-198">Including Custom Role Navigation</span></span>

<span data-ttu-id="6d68b-199">Um dem Benutzer die Rolle "benutzerdefinierten"CanEdit"" Navigieren Sie zum Bereich "Verwaltung" der Anwendung zu aktivieren, müssen Sie einen Link zum Hinzufügen der *Site.Master* Seite.</span><span class="sxs-lookup"><span data-stu-id="6d68b-199">To enable the user of the custom "canEdit" role to navigate to the administration section of the application, you must add a link to the *Site.Master* page.</span></span> <span data-ttu-id="6d68b-200">Nur Benutzer, die der Rolle "CanEdit" gehören, sehen die **Admin** verknüpfen und Zugriff auf den Bereich "Verwaltung".</span><span class="sxs-lookup"><span data-stu-id="6d68b-200">Only users that belong to the "canEdit" role will be able to see the **Admin** link and access the administration section.</span></span>

1. <span data-ttu-id="6d68b-201">Suchen Sie im Projektmappen-Explorer, und öffnen Sie die *Site.Master* Seite.</span><span class="sxs-lookup"><span data-stu-id="6d68b-201">In Solution Explorer, find and open the *Site.Master* page.</span></span>
2. <span data-ttu-id="6d68b-202">Um einen Link für den Benutzer der Rolle "CanEdit" zu erstellen, fügen Sie das Markup, das auf die folgenden ungeordnete gelb hervorgehoben `<ul>` Element, damit die Liste wird angezeigt, wie folgt:</span><span class="sxs-lookup"><span data-stu-id="6d68b-202">To create a link for the user of the "canEdit" role, add the markup highlighted in yellow to the following unordered list `<ul>` element so that the list appears as follows:</span></span>  

    [!code-html[Main](membership-and-administration/samples/sample5.html?highlight=2-3)]
3. <span data-ttu-id="6d68b-203">Öffnen der *Site.Master.cs* Datei.</span><span class="sxs-lookup"><span data-stu-id="6d68b-203">Open the *Site.Master.cs* file.</span></span> <span data-ttu-id="6d68b-204">Stellen Sie die **Admin** Link ist nur für den Benutzer "CanEditUser" durch Hinzufügen des Codes in gelb hervorgehoben angezeigt der `Page_Load` Handler.</span><span class="sxs-lookup"><span data-stu-id="6d68b-204">Make the **Admin** link visible only to the "canEditUser" user by adding the code highlighted in yellow to the `Page_Load` handler.</span></span> <span data-ttu-id="6d68b-205">Die `Page_Load` Handler wird wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="6d68b-205">The `Page_Load` handler will appear as follows:</span></span>   

    [!code-csharp[Main](membership-and-administration/samples/sample6.cs?highlight=3-6)]

<span data-ttu-id="6d68b-206">Beim Laden der Seite überprüft der Code an, ob der angemeldete Benutzer die Rolle des "CanEdit".</span><span class="sxs-lookup"><span data-stu-id="6d68b-206">When the page loads, the code checks whether the logged-in user has the role of "canEdit".</span></span> <span data-ttu-id="6d68b-207">Wenn der Benutzer gehört, für die Rolle "CanEdit" das Span-Element mit dem Link zu der *AdminPage.aspx* Seite (und daher den Link in der Folge) sichtbar gemacht.</span><span class="sxs-lookup"><span data-stu-id="6d68b-207">If the user belongs to the "canEdit" role, the span element containing the link to the *AdminPage.aspx* page (and consequently the link inside the span) is made visible.</span></span>

### <a name="enabling-product-administration"></a><span data-ttu-id="6d68b-208">Aktivieren der Product-Verwaltung</span><span class="sxs-lookup"><span data-stu-id="6d68b-208">Enabling Product Administration</span></span>

<span data-ttu-id="6d68b-209">Bisher haben Sie erstellt die Rolle "CanEdit" und ein "CanEditUser" Benutzer, einen Ordner für die Verwaltung und eine Seite "Verwaltung" hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="6d68b-209">So far, you have created the "canEdit" role and added an "canEditUser" user, an administration folder, and an administration page.</span></span> <span data-ttu-id="6d68b-210">Sie Zugriffsrechte für den Ordner Verwaltung und die Seite "festgelegt haben und die Anwendung einen Navigationslink für die Benutzer der Rolle"CanEdit"hinzugefügt haben.</span><span class="sxs-lookup"><span data-stu-id="6d68b-210">You have set access rights for the administration folder and page, and have added a navigation link for the user of the "canEdit" role to the application.</span></span> <span data-ttu-id="6d68b-211">Als Nächstes fügen Sie Markup für die *AdminPage.aspx* Seite und code in der *AdminPage.aspx.cs* Code-Behind-Datei, die dem Benutzer mit der Rolle "CanEdit" hinzufügen und Entfernen von Produkten ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="6d68b-211">Next, you will add markup to the *AdminPage.aspx* page and code to the *AdminPage.aspx.cs* code-behind file that will enable the user with the "canEdit" role to add and remove products.</span></span>

1. <span data-ttu-id="6d68b-212">In **Projektmappen-Explorer**öffnen die *AdminPage.aspx* -Datei von der *Admin* Ordner.</span><span class="sxs-lookup"><span data-stu-id="6d68b-212">In **Solution Explorer**, open the *AdminPage.aspx* file from the *Admin* folder.</span></span>
2. <span data-ttu-id="6d68b-213">Ersetzen Sie das vorhandene Markup durch Folgendes:</span><span class="sxs-lookup"><span data-stu-id="6d68b-213">Replace the existing markup with the following:</span></span>  

    [!code-aspx[Main](membership-and-administration/samples/sample7.aspx)]
3. <span data-ttu-id="6d68b-214">Öffnen Sie als Nächstes die *AdminPage.aspx.cs* Code-Behind-Datei mit der rechten Maustaste die *AdminPage.aspx* und auf **Code anzeigen**.</span><span class="sxs-lookup"><span data-stu-id="6d68b-214">Next, open the *AdminPage.aspx.cs* code-behind file by right-clicking the *AdminPage.aspx* and clicking **View Code**.</span></span>
4. <span data-ttu-id="6d68b-215">Ersetzen Sie den vorhandenen Code in der *AdminPage.aspx.cs* Code-Behind-Datei mit den folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="6d68b-215">Replace the existing code in the *AdminPage.aspx.cs* code-behind file with the following code:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample8.cs)]

<span data-ttu-id="6d68b-216">In den Code, der eingegebene für die *AdminPage.aspx.cs* Code-Behind-Datei, eine Klasse mit dem Namen `AddProducts` ist die eigentliche Arbeit der Produkte in der Datenbank hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="6d68b-216">In the code that you entered for the *AdminPage.aspx.cs* code-behind file, a class called `AddProducts` does the actual work of adding products to the database.</span></span> <span data-ttu-id="6d68b-217">Diese Klasse ist nicht noch vorhanden, damit Sie ihn jetzt erstellen werden.</span><span class="sxs-lookup"><span data-stu-id="6d68b-217">This class doesn't exist yet, so you will create it now.</span></span>

1. <span data-ttu-id="6d68b-218">In **Projektmappen-Explorer**, mit der rechten Maustaste die *Logik* Ordner, und wählen Sie dann **hinzufügen**  - &gt; **neues Element**.</span><span class="sxs-lookup"><span data-stu-id="6d68b-218">In **Solution Explorer**, right-click the *Logic* folder and then select **Add** -&gt; **New Item**.</span></span>   
   <span data-ttu-id="6d68b-219">Das Dialogfeld **Neues Element hinzufügen** wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="6d68b-219">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="6d68b-220">Wählen Sie die **Visual C#-**  - &gt; **Code** Gruppe "Vorlagen" auf der linken Seite.</span><span class="sxs-lookup"><span data-stu-id="6d68b-220">Select the **Visual C#** -&gt; **Code** templates group on the left.</span></span> <span data-ttu-id="6d68b-221">Aktivieren Sie das Kontrollkästchen **Klasse**aus der Mitte aus, und nennen Sie sie *AddProducts.cs*.</span><span class="sxs-lookup"><span data-stu-id="6d68b-221">Then, select **Class**from the middle list and name it *AddProducts.cs*.</span></span>   
   <span data-ttu-id="6d68b-222">Die neue Klassendatei wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="6d68b-222">The new class file is displayed.</span></span>
3. <span data-ttu-id="6d68b-223">Ersetzen Sie den vorhandenen Code durch folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="6d68b-223">Replace the existing code with the following:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample9.cs)]

<span data-ttu-id="6d68b-224">Die *AdminPage.aspx* ermöglicht es dem Benutzer zur Rolle "CanEdit" gehören zum Hinzufügen und Entfernen von Produkten.</span><span class="sxs-lookup"><span data-stu-id="6d68b-224">The *AdminPage.aspx* page allows the user belonging to the "canEdit" role to add and remove products.</span></span> <span data-ttu-id="6d68b-225">Wenn ein neues Produkt hinzugefügt wird, werden die Details zu dem Produkt überprüft, und klicken Sie dann in die Datenbank eingegeben.</span><span class="sxs-lookup"><span data-stu-id="6d68b-225">When a new product is added, the details about the product are validated and then entered into the database.</span></span> <span data-ttu-id="6d68b-226">Das neue Produkt ist für alle Benutzer der Webanwendung sofort verfügbar.</span><span class="sxs-lookup"><span data-stu-id="6d68b-226">The new product is immediately available to all users of the web application.</span></span>

#### <a name="unobtrusive-validation"></a><span data-ttu-id="6d68b-227">Unaufdringlichen Überprüfung</span><span class="sxs-lookup"><span data-stu-id="6d68b-227">Unobtrusive Validation</span></span>

<span data-ttu-id="6d68b-228">Die Produktdetails, die der Benutzer eingibt, auf die *AdminPage.aspx* Seite werden überprüft, über Validierungssteuerelemente (`RequiredFieldValidator` und `RegularExpressionValidator`).</span><span class="sxs-lookup"><span data-stu-id="6d68b-228">The product details that the user provides on the *AdminPage.aspx* page are validated using validation controls (`RequiredFieldValidator` and `RegularExpressionValidator`).</span></span> <span data-ttu-id="6d68b-229">Diese Steuerelemente verwenden automatisch unaufdringlichen Überprüfung.</span><span class="sxs-lookup"><span data-stu-id="6d68b-229">These controls automatically use unobtrusive validation.</span></span> <span data-ttu-id="6d68b-230">Unaufdringlichen Überprüfung ermöglicht die Validierungssteuerelemente mit JavaScript für die clientseitige Validierungslogik, dies, dass die Seite nicht mit einem Vorgang mit dem Server bedeutet überprüft werden erfordert.</span><span class="sxs-lookup"><span data-stu-id="6d68b-230">Unobtrusive validation allows the validation controls to use JavaScript for client-side validation logic, which means the page does not require a trip to the server to be validated.</span></span> <span data-ttu-id="6d68b-231">Standardmäßig unaufdringlichen Überprüfung enthalten ist, der *"Web.config"* dateibasierten auf die folgende Konfigurationseinstellung:</span><span class="sxs-lookup"><span data-stu-id="6d68b-231">By default, unobtrusive validation is included in the *Web.config* file based on the following configuration setting:</span></span>

[!code-xml[Main](membership-and-administration/samples/sample10.xml)]

#### <a name="regular-expressions"></a><span data-ttu-id="6d68b-232">Reguläre Ausdrücke</span><span class="sxs-lookup"><span data-stu-id="6d68b-232">Regular Expressions</span></span>

<span data-ttu-id="6d68b-233">Der Produktpreis auf die *AdminPage.aspx* Seite überprüft wird, mit einem **RegularExpressionValidator** Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="6d68b-233">The product price on the *AdminPage.aspx* page is validated using a **RegularExpressionValidator** control.</span></span> <span data-ttu-id="6d68b-234">Dieses Steuerelement überprüft, ob der Wert des zugeordneten Eingabesteuerelements (das Textfeld "AddProductPrice") das mit dem regulären Ausdruck angegebene Muster übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="6d68b-234">This control validates whether the value of the associated input control (the "AddProductPrice" TextBox) matches the pattern specified by the regular expression.</span></span> <span data-ttu-id="6d68b-235">Ein regulärer Ausdruck ist eine Mustervergleich-Notation, die ermöglicht es Ihnen, schnell zu finden und bestimmte Muster übereinstimmen.</span><span class="sxs-lookup"><span data-stu-id="6d68b-235">A regular expression is a pattern-matching notation that enables you to quickly find and match specific character patterns.</span></span> <span data-ttu-id="6d68b-236">Die **RegularExpressionValidator** Steuerelement enthält eine Eigenschaft namens `ValidationExpression` , enthält den regulären Ausdruck, der zum Preis-Eingabe überprüfen verwendet werden, wie unten dargestellt:</span><span class="sxs-lookup"><span data-stu-id="6d68b-236">The **RegularExpressionValidator** control includes a property named `ValidationExpression` that contains the regular expression used to validate price input, as shown below:</span></span>

[!code-aspx[Main](membership-and-administration/samples/sample11.aspx)]

#### <a name="fileupload-control"></a><span data-ttu-id="6d68b-237">FileUpload-Steuerelement</span><span class="sxs-lookup"><span data-stu-id="6d68b-237">FileUpload Control</span></span>

<span data-ttu-id="6d68b-238">Zusätzlich zu den Steuerelementen Eingabe und Überprüfung Hinzufügen der **FileUpload** die Steuerung an die *AdminPage.aspx* Seite.</span><span class="sxs-lookup"><span data-stu-id="6d68b-238">In addition to the input and validation controls, you added the **FileUpload** control to the *AdminPage.aspx* page.</span></span> <span data-ttu-id="6d68b-239">Dieses Steuerelement bietet die Möglichkeit zum Hochladen von Dateien.</span><span class="sxs-lookup"><span data-stu-id="6d68b-239">This control provides the capability to upload files.</span></span> <span data-ttu-id="6d68b-240">In diesem Fall sind Sie nur die Bilddateien hochgeladen werden erlauben.</span><span class="sxs-lookup"><span data-stu-id="6d68b-240">In this case, you are only allowing image files to be uploaded.</span></span> <span data-ttu-id="6d68b-241">In der CodeBehind-Datei (*AdminPage.aspx.cs*), wenn die `AddProductButton` geklickt wird, wird der Code überprüft die `HasFile` Eigenschaft der **FileUpload** Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="6d68b-241">In the code-behind file (*AdminPage.aspx.cs*), when the `AddProductButton` is clicked, the code checks the `HasFile` property of the **FileUpload** control.</span></span> <span data-ttu-id="6d68b-242">Wenn das Steuerelement verfügt über eine Datei, und wenn der Dateityp (auf der Grundlage der Dateierweiterung) zulässig ist, wird das Bild, um gespeichert die *Bilder* Ordner und die *Bilder/Daumen* Ordner der Anwendung.</span><span class="sxs-lookup"><span data-stu-id="6d68b-242">If the control has a file and if the file type (based on file extension) is allowed, the image is saved to the *Images* folder and the *Images/Thumbs* folder of the application.</span></span>

#### <a name="model-binding"></a><span data-ttu-id="6d68b-243">Modellbindung</span><span class="sxs-lookup"><span data-stu-id="6d68b-243">Model Binding</span></span>

<span data-ttu-id="6d68b-244">Weiter oben in diesem Lernprogramm verwendet Sie wurden die modellbindung zum Auffüllen einer **ListView** -Steuerelement, ein **FormsView** -Steuerelement, ein **GridView** -Steuerelement, und ein  **DetailView** Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="6d68b-244">Earlier in this tutorial series you used model binding to populate a **ListView** control, a **FormsView** control, a **GridView** control, and a **DetailView** control.</span></span> <span data-ttu-id="6d68b-245">In diesem Lernprogramm verwenden Sie wurden die modellbindung zum Auffüllen einer **DropDownList** -Steuerelement mit einer Liste von Produktkategorien.</span><span class="sxs-lookup"><span data-stu-id="6d68b-245">In this tutorial, you use model binding to populate a **DropDownList** control with a list of product categories.</span></span>

<span data-ttu-id="6d68b-246">Das Markup, das Sie hinzugefügt haben die *AdminPage.aspx* -Datei enthält eine **DropDownList** -Steuerelement namens `DropDownAddCategory`:</span><span class="sxs-lookup"><span data-stu-id="6d68b-246">The markup that you added to the *AdminPage.aspx* file contains a **DropDownList** control called `DropDownAddCategory`:</span></span>

[!code-aspx[Main](membership-and-administration/samples/sample12.aspx)]

<span data-ttu-id="6d68b-247">Sie wurden die modellbindung verwenden, um dies zu füllen **DropDownList** durch Festlegen der `ItemType` Attribut und der `SelectMethod` Attribut.</span><span class="sxs-lookup"><span data-stu-id="6d68b-247">You use model binding to populate this **DropDownList** by setting the `ItemType` attribute and the `SelectMethod` attribute.</span></span> <span data-ttu-id="6d68b-248">Die `ItemType` Attribut gibt an, dass Sie verwenden die `WingtipToys.Models.Category` eingeben, wenn das Steuerelement auffüllen.</span><span class="sxs-lookup"><span data-stu-id="6d68b-248">The `ItemType` attribute specifies that you use the `WingtipToys.Models.Category` type when populating the control.</span></span> <span data-ttu-id="6d68b-249">Sie erstellen dieses Typs zu Beginn dieser Reihe von Lernprogrammen definiert die `Category` Klasse (siehe unten).</span><span class="sxs-lookup"><span data-stu-id="6d68b-249">You defined this type at the beginning of this tutorial series by creating the `Category` class (shown below).</span></span> <span data-ttu-id="6d68b-250">Die `Category` Klasse befindet sich in der *Modelle* Ordner innerhalb der *Category.cs* Datei.</span><span class="sxs-lookup"><span data-stu-id="6d68b-250">The `Category` class is in the *Models* folder inside the *Category.cs* file.</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample13.cs)]

<span data-ttu-id="6d68b-251">Die `SelectMethod` Attribut von der **DropDownList** Steuerelement gibt an, dass Sie die `GetCategories` Methode (siehe unten), in der Code-Behind-Datei enthalten (*AdminPage.aspx.cs*).</span><span class="sxs-lookup"><span data-stu-id="6d68b-251">The `SelectMethod` attribute of the **DropDownList** control specifies that you use the `GetCategories` method (shown below) that is included in the code-behind file (*AdminPage.aspx.cs*).</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample14.cs)]

<span data-ttu-id="6d68b-252">Diese Methode gibt an, dass ein `IQueryable` Schnittstelle wird verwendet, um eine Abfrage auswerten einer `Category` Typ.</span><span class="sxs-lookup"><span data-stu-id="6d68b-252">This method specifies that an `IQueryable` interface is used to evaluate a query against a `Category` type.</span></span> <span data-ttu-id="6d68b-253">Der zurückgegebene Wert dient zum Auffüllen der **DropDownList** im Markup der Seite (*AdminPage.aspx*).</span><span class="sxs-lookup"><span data-stu-id="6d68b-253">The returned value is used to populate the **DropDownList** in the markup of the page (*AdminPage.aspx*).</span></span>

<span data-ttu-id="6d68b-254">Der Text angezeigt, für jedes Element in der Liste, durch Festlegen angegeben wird der `DataTextField` Attribut.</span><span class="sxs-lookup"><span data-stu-id="6d68b-254">The text displayed for each item in the list is specified by setting the `DataTextField` attribute.</span></span> <span data-ttu-id="6d68b-255">Die `DataTextField` -Attribut verwendet die `CategoryName` von der `Category` Klasse (siehe oben) zum Anzeigen der einzelnen Kategorien in der **DropDownList** Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="6d68b-255">The `DataTextField` attribute uses the `CategoryName` of the `Category` class (shown above) to display each category in the **DropDownList** control.</span></span> <span data-ttu-id="6d68b-256">Der tatsächliche Wert, der übergeben wird, wenn ein Element, in ausgewählt ist der **DropDownList** Steuerelement basiert auf der `DataValueField` Attribut.</span><span class="sxs-lookup"><span data-stu-id="6d68b-256">The actual value that is passed when an item is selected in the **DropDownList** control is based on the `DataValueField` attribute.</span></span> <span data-ttu-id="6d68b-257">Die `DataValueField` -Attributsatz zur der `CategoryID` in der Definition der `Category` Klasse (siehe oben).</span><span class="sxs-lookup"><span data-stu-id="6d68b-257">The `DataValueField` attribute is set to the `CategoryID` as define in the `Category` class (shown above).</span></span>

### <a name="how-the-application-will-work"></a><span data-ttu-id="6d68b-258">Wie funktioniert die Anwendung</span><span class="sxs-lookup"><span data-stu-id="6d68b-258">How the Application Will Work</span></span>

<span data-ttu-id="6d68b-259">Wenn der Benutzer zur Rolle "CanEdit" gehören zum ersten Mal zur Seite navigiert der `DropDownAddCategory` **DropDownList** Steuerelement wird aufgefüllt, wie oben beschrieben.</span><span class="sxs-lookup"><span data-stu-id="6d68b-259">When the user belonging to the "canEdit" role navigates to the page for the first time, the `DropDownAddCategory`**DropDownList** control is populated as described above.</span></span> <span data-ttu-id="6d68b-260">Die `DropDownRemoveProduct` **DropDownList** Steuerelement auch mit Produkten die gleiche Weise gefüllt wird.</span><span class="sxs-lookup"><span data-stu-id="6d68b-260">The `DropDownRemoveProduct`**DropDownList** control is also populated with products using the same approach.</span></span> <span data-ttu-id="6d68b-261">Der Benutzer zur Rolle "CanEdit" gehören wählt den Typ der Kategorie und fügt die Produktdetails hinzu (**Namen**, **Beschreibung**, **Preis**, und **Bilddatei**).</span><span class="sxs-lookup"><span data-stu-id="6d68b-261">The user belonging to the "canEdit" role selects the category type and adds product details (**Name**, **Description**, **Price**, and **Image File**).</span></span> <span data-ttu-id="6d68b-262">Klickt der Benutzer zur Rolle "CanEdit" gehören die **Produkt hinzufügen** Schaltfläche, die `AddProductButton_Click` -Ereignishandler ausgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="6d68b-262">When the user belonging to the "canEdit" role clicks the **Add Product** button, the `AddProductButton_Click` event handler is triggered.</span></span> <span data-ttu-id="6d68b-263">Die `AddProductButton_Click` -Ereignishandler im Code-Behind-Datei befindet (*AdminPage.aspx.cs*) überprüft die Image-Datei, um sicherzustellen, dass es die zulässigen Dateitypen entspricht *(GIF*, *PNG*, *JPEG*, oder *jpg*).</span><span class="sxs-lookup"><span data-stu-id="6d68b-263">The `AddProductButton_Click` event handler located in the code-behind file (*AdminPage.aspx.cs*) checks the image file to make sure it matches the allowed file types *(.gif*, *.png*, *.jpeg*, or *.jpg*).</span></span> <span data-ttu-id="6d68b-264">Anschließend wird die Abbilddatei in der Ordnerstruktur des Wingtip Toys-beispielanwendung gespeichert.</span><span class="sxs-lookup"><span data-stu-id="6d68b-264">Then, the image file is saved into a folder of the Wingtip Toys sample application.</span></span> <span data-ttu-id="6d68b-265">Als Nächstes wird das neue Produkt mit der Datenbank hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="6d68b-265">Next, the new product is added to the database.</span></span> <span data-ttu-id="6d68b-266">Zum Hinzufügen eines neuen Produkts, eine neue Instanz der Ausführen der `AddProducts` Klasse erstellt und mit dem Namen Produkte.</span><span class="sxs-lookup"><span data-stu-id="6d68b-266">To accomplish adding a new product, a new instance of the `AddProducts` class is created and named products.</span></span> <span data-ttu-id="6d68b-267">Die `AddProducts` -Klasse verfügt über eine Methode namens `AddProduct`, und die Produkte Objekt ruft diese Methode, um die Produkte in der Datenbank hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="6d68b-267">The `AddProducts` class has a method named `AddProduct`, and the products object calls this method to add products to the database.</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample15.cs)]

<span data-ttu-id="6d68b-268">Wenn der Code erfolgreich das neue Produkt mit der Datenbank hinzugefügt, die Seite wird erneut geladen, mit dem Wert der Abfragezeichenfolge `ProductAction=add`.</span><span class="sxs-lookup"><span data-stu-id="6d68b-268">If the code successfully adds the new product to the database, the page is reloaded with the query string value `ProductAction=add`.</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample16.cs)]

<span data-ttu-id="6d68b-269">Wenn die Seite erneut geladen wird, ist die Zeichenfolge der Abfrage in der URL enthalten.</span><span class="sxs-lookup"><span data-stu-id="6d68b-269">When the page reloads, the query string is included in the URL.</span></span> <span data-ttu-id="6d68b-270">Durch das erneute Laden der Seite ein, der Benutzer zur Rolle "CanEdit" gehören kann sofort sehen die Updates in der **DropDownList** auf steuert die *AdminPage.aspx* Seite.</span><span class="sxs-lookup"><span data-stu-id="6d68b-270">By reloading the page, the user belonging to the "canEdit" role can immediately see the updates in the **DropDownList** controls on the *AdminPage.aspx* page.</span></span> <span data-ttu-id="6d68b-271">Zudem kann dazu die Abfragezeichenfolge durch die URL die Seite eine Erfolgsmeldung an den Benutzer zur Rolle "CanEdit" gehören angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="6d68b-271">Also, by including the query string with the URL, the page can display a success message to the user belonging to the "canEdit" role.</span></span>

<span data-ttu-id="6d68b-272">Wenn die *AdminPage.aspx* Seite Neuladen, die `Page_Load` Ereignis aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="6d68b-272">When the *AdminPage.aspx* page reloads, the `Page_Load` event is called.</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample17.cs)]

<span data-ttu-id="6d68b-273">Die `Page_Load` -Ereignishandler den Wert der Abfragezeichenfolge überprüft und bestimmt, ob eine Erfolgsmeldung angezeigt.</span><span class="sxs-lookup"><span data-stu-id="6d68b-273">The `Page_Load` event handler checks the query string value and determines whether to show a success message.</span></span>

## <a name="running-the-application"></a><span data-ttu-id="6d68b-274">Ausführen der Anwendung</span><span class="sxs-lookup"><span data-stu-id="6d68b-274">Running the Application</span></span>

<span data-ttu-id="6d68b-275">Sie können die Anwendung jetzt sehen, wie Sie hinzufügen können, löschen und Aktualisieren von Elementen in den Warenkorb ausführen.</span><span class="sxs-lookup"><span data-stu-id="6d68b-275">You can run the application now to see how you can add, delete, and update items in the shopping cart.</span></span> <span data-ttu-id="6d68b-276">Die shopping Cart insgesamt wider, die Gesamtkosten für alle Elemente in den Einkaufswagen Sinn macht.</span><span class="sxs-lookup"><span data-stu-id="6d68b-276">The shopping cart total will reflect the total cost of all items in the shopping cart.</span></span>

1. <span data-ttu-id="6d68b-277">Drücken Sie im Projektmappen-Explorer **F5** zum Ausführen der Anwendung des Wingtip Toys-Beispiel.</span><span class="sxs-lookup"><span data-stu-id="6d68b-277">In Solution Explorer, press **F5** to run the Wingtip Toys sample application.</span></span>  
   <span data-ttu-id="6d68b-278">Der Browser wird geöffnet und zeigt die *"default.aspx"* Seite.</span><span class="sxs-lookup"><span data-stu-id="6d68b-278">The browser opens and shows the *Default.aspx* page.</span></span>
2. <span data-ttu-id="6d68b-279">Klicken Sie auf die **melden Sie sich** Link am oberen Rand der Seite.</span><span class="sxs-lookup"><span data-stu-id="6d68b-279">Click the **Log in** link at the top of the page.</span></span> 

    ![Mitgliedschaft und Administration - anmelden Link](membership-and-administration/_static/image2.png)

   <span data-ttu-id="6d68b-281">Die *"Login.aspx"* angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="6d68b-281">The *Login.aspx* page is displayed.</span></span>
3. <span data-ttu-id="6d68b-282">Verwenden Sie den folgenden Benutzernamen und Kennwort:</span><span class="sxs-lookup"><span data-stu-id="6d68b-282">Use the following user name and password:</span></span>  
   <span data-ttu-id="6d68b-283">Benutzername: canEditUser@wingtiptoys.com</span><span class="sxs-lookup"><span data-stu-id="6d68b-283">User name: canEditUser@wingtiptoys.com</span></span>  
   <span data-ttu-id="6d68b-284">Password: Pa$$word1</span><span class="sxs-lookup"><span data-stu-id="6d68b-284">Password: Pa$$word1</span></span> 

    ![Mitgliedschaft und Administration - Anmeldeseite](membership-and-administration/_static/image3.png)
4. <span data-ttu-id="6d68b-286">Klicken Sie auf die **melden Sie sich** Schaltfläche am unteren Rand der Seite.</span><span class="sxs-lookup"><span data-stu-id="6d68b-286">Click the **Log in** button near the bottom of the page.</span></span>
5. <span data-ttu-id="6d68b-287">Wählen Sie am Anfang der nächsten Seite die **Admin** Link zu navigieren der *AdminPage.aspx* Seite.</span><span class="sxs-lookup"><span data-stu-id="6d68b-287">At the top of the next page, select the **Admin** link to navigate to the *AdminPage.aspx* page.</span></span> 

    ![Mitgliedschaft und Administration - Admin-Link](membership-and-administration/_static/image4.png)
6. <span data-ttu-id="6d68b-289">Um die Validierung von Benutzereingaben zu testen, klicken Sie auf die **Produkt hinzufügen** Schaltfläche ohne Produktdetails.</span><span class="sxs-lookup"><span data-stu-id="6d68b-289">To test the input validation, click the **Add Product** button without adding any product details.</span></span> 

    ![Mitgliedschaft und Verwaltung – Seite "Administrator"](membership-and-administration/_static/image5.png)

   <span data-ttu-id="6d68b-291">Beachten Sie, dass das Pflichtfeld Nachrichten angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="6d68b-291">Notice that the required field messages are displayed.</span></span>
7. <span data-ttu-id="6d68b-292">Fügen Sie die Details für ein neues Produkt hinzu, und klicken Sie dann auf die **Produkt hinzufügen** Schaltfläche.</span><span class="sxs-lookup"><span data-stu-id="6d68b-292">Add the details for a new product, and then click the **Add Product** button.</span></span> 

    ![Fügen Sie Mitgliedschaft und Administration - Produkt hinzu.](membership-and-administration/_static/image6.png)
8. <span data-ttu-id="6d68b-294">Wählen Sie **Produkte** im oberen Navigationsmenü auf das neue Produkt anzuzeigen, die Sie hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="6d68b-294">Select **Products** from the top navigation menu to view the new product you added.</span></span> 

    ![Mitgliedschaft und Administration - neues Produkt anzeigen](membership-and-administration/_static/image7.png)
9. <span data-ttu-id="6d68b-296">Klicken Sie auf die **Admin** Link auf der Seite "Verwaltung" zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="6d68b-296">Click the **Admin** link to return to the administration page.</span></span>
10. <span data-ttu-id="6d68b-297">In der **Produkt entfernen** Abschnitt der Seite Wählen Sie das neue Produkt, die Sie hinzugefügt, in haben der **DropDownListBox**.</span><span class="sxs-lookup"><span data-stu-id="6d68b-297">In the **Remove Product** section of the page, select the new product you added in the **DropDownListBox**.</span></span>
11. <span data-ttu-id="6d68b-298">Klicken Sie auf die **Produkt entfernen** Schaltfläche, um das neue Produkt aus der Anwendung zu entfernen.</span><span class="sxs-lookup"><span data-stu-id="6d68b-298">Click the **Remove Product** button to remove the new product from the application.</span></span> 

    ![Mitgliedschaft und Administration - Produkt entfernen](membership-and-administration/_static/image8.png)
12. <span data-ttu-id="6d68b-300">Wählen Sie **Produkte** aus dem oberen Navigationsmenü, um zu bestätigen, dass das Produkt entfernt wurden.</span><span class="sxs-lookup"><span data-stu-id="6d68b-300">Select **Products** from the top navigation menu to confirm that the product has been removed.</span></span>
13. <span data-ttu-id="6d68b-301">Klicken Sie auf **Abmelden** Verwaltungsmodus vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="6d68b-301">Click **Log off** to exist administration mode.</span></span>   
    <span data-ttu-id="6d68b-302">Beachten Sie, die im oberen Navigationsbereich nicht mehr angezeigt wird der **Admin** Menüelement.</span><span class="sxs-lookup"><span data-stu-id="6d68b-302">Notice that the top navigation pane no longer shows the **Admin** menu item.</span></span>

## <a name="summary"></a><span data-ttu-id="6d68b-303">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="6d68b-303">Summary</span></span>

<span data-ttu-id="6d68b-304">In diesem Lernprogramm hinzugefügt, eine benutzerdefinierte Sicherheitsrolle und ein Benutzer, der für die benutzerdefinierte Rolle eingeschränkten Zugriff auf den Ordner Verwaltung und die Seite gehört und Navigation für den Benutzer zur Rolle benutzerdefinierten gehören bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="6d68b-304">In this tutorial, you added a custom role and a user belonging to the custom role, restricted access to the administration folder and page, and provided navigation for the user belonging to the custom role.</span></span> <span data-ttu-id="6d68b-305">Sie wurden die modellbindung zum Auffüllen verwendet eine **DropDownList** -Steuerelement mit Daten.</span><span class="sxs-lookup"><span data-stu-id="6d68b-305">You used model binding to populate a **DropDownList** control with data.</span></span> <span data-ttu-id="6d68b-306">Sie implementiert die **FileUpload** Steuerelement und Validierungssteuerelemente.</span><span class="sxs-lookup"><span data-stu-id="6d68b-306">You implemented the **FileUpload** control and validation controls.</span></span> <span data-ttu-id="6d68b-307">Darüber hinaus haben Sie gelernt, hinzufügen und Entfernen von Produkten aus einer Datenbank.</span><span class="sxs-lookup"><span data-stu-id="6d68b-307">Also, you have learned how to add and remove products from a database.</span></span> <span data-ttu-id="6d68b-308">In den nächsten Lernprogrammen erfahren Sie, wie ASP.NET-Routing implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="6d68b-308">In the next tutorial, you'll learn how to implement ASP.NET routing.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="6d68b-309">Zusätzliche Ressourcen</span><span class="sxs-lookup"><span data-stu-id="6d68b-309">Additional Resources</span></span>

<span data-ttu-id="6d68b-310">["Web.config" - Authorization-Element](https://msdn.microsoft.com/library/8d82143t(v=vs.100).aspx)</span><span class="sxs-lookup"><span data-stu-id="6d68b-310">[Web.config - authorization Element](https://msdn.microsoft.com/library/8d82143t(v=vs.100).aspx)</span></span>  
[<span data-ttu-id="6d68b-311">ASP.NET Identity</span><span class="sxs-lookup"><span data-stu-id="6d68b-311">ASP.NET Identity</span></span>](../../../../identity/overview/getting-started/introduction-to-aspnet-identity.md)  
[<span data-ttu-id="6d68b-312">Bereitstellen Sie eine sichere ASP.NET Web Forms-App Mitgliedschaft, OAuth und SQL-Datenbank auf einer Azure-Website</span><span class="sxs-lookup"><span data-stu-id="6d68b-312">Deploy a Secure ASP.NET Web Forms App with Membership, OAuth, and SQL Database to an Azure Web Site</span></span>](https://azure.microsoft.com/documentation/articles/web-sites-dotnet-deploy-aspnet-webforms-app-membership-oauth-sql-database/)  
[<span data-ttu-id="6d68b-313">Microsoft Azure - Testversion</span><span class="sxs-lookup"><span data-stu-id="6d68b-313">Microsoft Azure - Free Trial</span></span>](https://azure.microsoft.com/pricing/free-trial/)

> [!div class="step-by-step"]
> <span data-ttu-id="6d68b-314">[Zurück](checkout-and-payment-with-paypal.md)
> [Weiter](url-routing.md)</span><span class="sxs-lookup"><span data-stu-id="6d68b-314">[Previous](checkout-and-payment-with-paypal.md)
[Next](url-routing.md)</span></span>
