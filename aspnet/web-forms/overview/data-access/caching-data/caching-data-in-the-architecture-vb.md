---
uid: web-forms/overview/data-access/caching-data/caching-data-in-the-architecture-vb
title: Zwischenspeichern von Daten in der Architektur (VB) | Microsoft Docs
author: rick-anderson
description: Im vorherigen Lernprogramm haben wir gelernt anzuwendende Zwischenspeicherung auf der Präsentationsebene. In diesem Lernprogramm erfahren wir unsere geschichteten Architectu nutzen...
ms.author: aspnetcontent
manager: wpickett
ms.date: 05/30/2007
ms.topic: article
ms.assetid: 5e189dd7-f4f9-4f28-9b3a-6cb7d392e9c7
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/caching-data/caching-data-in-the-architecture-vb
msc.type: authoredcontent
ms.openlocfilehash: 08f83c129d589859723249becb818386bfff19bf
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/06/2018
---
<a name="caching-data-in-the-architecture-vb"></a><span data-ttu-id="b39de-104">Zwischenspeichern von Daten in der Architektur (VB)</span><span class="sxs-lookup"><span data-stu-id="b39de-104">Caching Data in the Architecture (VB)</span></span>
====================
<span data-ttu-id="b39de-105">durch [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="b39de-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="b39de-106">[Beispiel-App herunterladen](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_59_VB.exe) oder [PDF herunterladen](caching-data-in-the-architecture-vb/_static/datatutorial59vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="b39de-106">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_59_VB.exe) or [Download PDF](caching-data-in-the-architecture-vb/_static/datatutorial59vb1.pdf)</span></span>

> <span data-ttu-id="b39de-107">Im vorherigen Lernprogramm haben wir gelernt anzuwendende Zwischenspeicherung auf der Präsentationsebene.</span><span class="sxs-lookup"><span data-stu-id="b39de-107">In the previous tutorial we learned how to apply caching at the Presentation Layer.</span></span> <span data-ttu-id="b39de-108">In diesem Lernprogramm erfahren wir unsere Ebenen-Architektur zum Zwischenspeichern von Daten an die Geschäftslogikschicht nutzen.</span><span class="sxs-lookup"><span data-stu-id="b39de-108">In this tutorial we learn how to take advantage of our layered architecture to cache data at the Business Logic Layer.</span></span> <span data-ttu-id="b39de-109">Dies erfolgt durch Erweitern der Einbeziehung einer Ebene Caching-Architektur.</span><span class="sxs-lookup"><span data-stu-id="b39de-109">We do this by extending the architecture to include a Caching Layer.</span></span>


## <a name="introduction"></a><span data-ttu-id="b39de-110">Einführung</span><span class="sxs-lookup"><span data-stu-id="b39de-110">Introduction</span></span>

<span data-ttu-id="b39de-111">Wie wir im vorherigen Lernprogramm gesehen haben, ist das Zwischenspeichern der ObjectDataSource-s-Daten so einfach wie eine Reihe von Eigenschaften festlegen.</span><span class="sxs-lookup"><span data-stu-id="b39de-111">As we saw in the preceding tutorial, caching the ObjectDataSource s data is as simple as setting a couple of properties.</span></span> <span data-ttu-id="b39de-112">Leider gilt das ObjectDataSource Zwischenspeicherung auf der Präsentationsschicht, die Cachingrichtlinien für eng mit der ASP.NET-Seite verbindet.</span><span class="sxs-lookup"><span data-stu-id="b39de-112">Unfortunately, the ObjectDataSource applies caching at the Presentation Layer, which tightly couples the caching policies with the ASP.NET page.</span></span> <span data-ttu-id="b39de-113">Einer der Gründe für das Erstellen einer geschichteten Architektur ist solche Kupplungen unterbrochen werden können.</span><span class="sxs-lookup"><span data-stu-id="b39de-113">One of the reasons for creating a layered architecture is to allow such couplings to be broken.</span></span> <span data-ttu-id="b39de-114">Der Business Logic Layer werden z. B. die Geschäftslogik von der ASP.NET-Seiten aus aufzurufen, während der Datenzugriffsebene, die Daten Zugriffsdetails entkoppelt.</span><span class="sxs-lookup"><span data-stu-id="b39de-114">The Business Logic Layer, for instance, decouples the business logic from the ASP.NET pages, while the Data Access Layer decouples the data access details.</span></span> <span data-ttu-id="b39de-115">Durch diese Entkopplung von Business-Logik und die Daten Zugriffsdetails wird empfohlen, Teil, da es das System macht besser lesbar sind besser verwaltbar und flexibler zu ändern.</span><span class="sxs-lookup"><span data-stu-id="b39de-115">This decoupling of business logic and data access details is preferred, in part, because it makes the system more readable, more maintainable, and more flexible to change.</span></span> <span data-ttu-id="b39de-116">Darüber hinaus können für domänenwissen und Verteilung der Arbeit, die ein Entwickler arbeiten, bei dem t der Darstellungsschicht ist nicht mit der Datenbank s vertraut sein, um ihre Arbeitsmöglichkeiten müssen.</span><span class="sxs-lookup"><span data-stu-id="b39de-116">It also allows for domain knowledge and division of labor a developer working on the Presentation Layer doesn t need to be familiar with the database s details in order to do her job.</span></span> <span data-ttu-id="b39de-117">Die Cachingrichtlinie für von der Darstellungsschicht Entkopplung bietet ähnliche Vorteile.</span><span class="sxs-lookup"><span data-stu-id="b39de-117">Decoupling the caching policy from the Presentation Layer offers similar benefits.</span></span>

<span data-ttu-id="b39de-118">In diesem Lernprogramm werden wir unsere Architektur einschließen ergänzen eine *Zwischenspeichern Ebene* (oder kurz CL), die unsere Cacherichtlinie verwendet.</span><span class="sxs-lookup"><span data-stu-id="b39de-118">In this tutorial we will augment our architecture to include a *Caching Layer* (or CL for short) that employs our caching policy.</span></span> <span data-ttu-id="b39de-119">Der Caching-Ebene enthält eine `ProductsCL` Klasse, die Zugriff auf Produktinformationen mit Methoden wie z. B. eine `GetProducts()`, `GetProductsByCategoryID(categoryID)`und so weiter, dass beim Aufrufen, beim ersten Versuch zum Abrufen der Daten aus dem Cache wird.</span><span class="sxs-lookup"><span data-stu-id="b39de-119">The Caching Layer will include a `ProductsCL` class that provides access to product information with methods like `GetProducts()`, `GetProductsByCategoryID(categoryID)`, and so forth, that, when invoked, will first attempt to retrieve the data from the cache.</span></span> <span data-ttu-id="b39de-120">Wenn der Cache leer ist, werden diese Methoden der entsprechenden Aufrufen `ProductsBLL` Methode in der BLL, die wiederum die Daten von der DAL erhalten würden.</span><span class="sxs-lookup"><span data-stu-id="b39de-120">If the cache is empty, these methods will invoke the appropriate `ProductsBLL` method in the BLL, which would in turn get the data from the DAL.</span></span> <span data-ttu-id="b39de-121">Die `ProductsCL` Methoden zwischenspeichern, die vor der Rückgabe aus der BLL abgerufenen Daten.</span><span class="sxs-lookup"><span data-stu-id="b39de-121">The `ProductsCL` methods cache the data retrieved from the BLL before returning it.</span></span>

<span data-ttu-id="b39de-122">Wie in Abbildung 1 dargestellt, befindet sich die CL zwischen der Präsentations- und Geschäftsschichten-Logik ein.</span><span class="sxs-lookup"><span data-stu-id="b39de-122">As Figure 1 shows, the CL resides between the Presentation and Business Logic Layers.</span></span>


![Das Zwischenspeichern der Ebene (CL) ist eine andere Ebene unsere-Architektur](caching-data-in-the-architecture-vb/_static/image1.png)

<span data-ttu-id="b39de-124">**Abbildung 1**: das Zwischenspeichern der Ebene (CL) ist eine andere Ebene unsere-Architektur</span><span class="sxs-lookup"><span data-stu-id="b39de-124">**Figure 1**: The Caching Layer (CL) is Another Layer in Our Architecture</span></span>


## <a name="step-1-creating-the-caching-layer-classes"></a><span data-ttu-id="b39de-125">Schritt 1: Erstellen der Klassen für das Zwischenspeichern Ebene</span><span class="sxs-lookup"><span data-stu-id="b39de-125">Step 1: Creating the Caching Layer Classes</span></span>

<span data-ttu-id="b39de-126">In diesem Lernprogramm erstellen wir eine sehr einfache CL mit einer einzigen Klasse `ProductsCL` , die nur eine Handvoll Methoden besitzt.</span><span class="sxs-lookup"><span data-stu-id="b39de-126">In this tutorial we will create a very simple CL with a single class `ProductsCL` that has only a handful of methods.</span></span> <span data-ttu-id="b39de-127">Erstellen eine vollständige Caching-Ebene aus, für die gesamte Anwendung erstellen müsste `CategoriesCL`, `EmployeesCL`, und `SuppliersCL` Klassen und eine Methode in diesen Klassen Caching-Ebene für jede Datenmethode Zugriff oder Änderung in der BLL bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="b39de-127">Building a complete Caching Layer for the entire application would require creating `CategoriesCL`, `EmployeesCL`, and `SuppliersCL` classes, and providing a method in these Caching Layer classes for each data access or modification method in the BLL.</span></span> <span data-ttu-id="b39de-128">Im Idealfall sollte der Caching-Ebene als ein separates Klassenbibliotheksprojekt implementiert werden, wie bei der BLL und der DAL ist. Allerdings wird implementieren wir es als Klasse in der `App_Code` Ordner.</span><span class="sxs-lookup"><span data-stu-id="b39de-128">As with the BLL and DAL, the Caching Layer should ideally be implemented as a separate Class Library project; however, we will implement it as a class in the `App_Code` folder.</span></span>

<span data-ttu-id="b39de-129">Weitere ordnungsgemäß separaten CL-Klassen aus der DAL und BLL-Klasse, Let s erstellen einen neuen Unterordner in den `App_Code` Ordner.</span><span class="sxs-lookup"><span data-stu-id="b39de-129">To more cleanly separate the CL classes from the DAL and BLL classes, let s create a new subfolder in the `App_Code` folder.</span></span> <span data-ttu-id="b39de-130">Mit der rechten Maustaste auf die `App_Code` Ordner im Projektmappen-Explorer, wählen Sie die neuen Ordner, und nennen Sie diesen Ordner `CL`.</span><span class="sxs-lookup"><span data-stu-id="b39de-130">Right-click on the `App_Code` folder in the Solution Explorer, choose New Folder, and name the new folder `CL`.</span></span> <span data-ttu-id="b39de-131">Nach diesem Ordner erstellen, hinzufügen, eine neue Klasse namens `ProductsCL.vb`.</span><span class="sxs-lookup"><span data-stu-id="b39de-131">After creating this folder, add to it a new class named `ProductsCL.vb`.</span></span>


![Fügen Sie einen neuen Ordner namens CL und eine Klasse namens ProductsCL.vb hinzu](caching-data-in-the-architecture-vb/_static/image2.png)

<span data-ttu-id="b39de-133">**Abbildung 2**: Fügen Sie einen neuen Ordner namens `CL` und eine Klasse namens `ProductsCL.vb`</span><span class="sxs-lookup"><span data-stu-id="b39de-133">**Figure 2**: Add a New Folder Named `CL` and a Class Named `ProductsCL.vb`</span></span>


<span data-ttu-id="b39de-134">Die `ProductsCL` -Klasse sollten den gleichen Satz von Daten und Methoden, wie in der entsprechenden Business Logic Layer-Klasse enthalten (`ProductsBLL`).</span><span class="sxs-lookup"><span data-stu-id="b39de-134">The `ProductsCL` class should include the same set of data access and modification methods as found in its corresponding Business Logic Layer class (`ProductsBLL`).</span></span> <span data-ttu-id="b39de-135">Anstatt alle von diesen Methoden können s nur Build erstellen einige hier, um ein Gefühl für die Muster von CL verwendet.</span><span class="sxs-lookup"><span data-stu-id="b39de-135">Rather than creating all of these methods, let s just build a couple here to get a feel for the patterns used by the CL.</span></span> <span data-ttu-id="b39de-136">Insbesondere wir fügen die `GetProducts()` und `GetProductsByCategoryID(categoryID)` Methoden in Schritt 3 und ein `UpdateProduct` überladen, die in Schritt 4.</span><span class="sxs-lookup"><span data-stu-id="b39de-136">In particular, we'll add the `GetProducts()` and `GetProductsByCategoryID(categoryID)` methods in Step 3 and an `UpdateProduct` overload in Step 4.</span></span> <span data-ttu-id="b39de-137">Sie können die verbleibenden hinzufügen `ProductsCL` Methoden und `CategoriesCL`, `EmployeesCL`, und `SuppliersCL` Klassen nach Belieben.</span><span class="sxs-lookup"><span data-stu-id="b39de-137">You can add the remaining `ProductsCL` methods and `CategoriesCL`, `EmployeesCL`, and `SuppliersCL` classes at your leisure.</span></span>

## <a name="step-2-reading-and-writing-to-the-data-cache"></a><span data-ttu-id="b39de-138">Schritt 2: Lesen und Schreiben in den Datencache</span><span class="sxs-lookup"><span data-stu-id="b39de-138">Step 2: Reading and Writing to the Data Cache</span></span>

<span data-ttu-id="b39de-139">Die Funktion untersucht in dem vorherigen Lernprogramm intern Zwischenspeichern ObjectDataSource verwendet ASP.NET Datencache zum Speichern der Daten aus der BLL abgerufen.</span><span class="sxs-lookup"><span data-stu-id="b39de-139">The ObjectDataSource caching feature explored in the preceding tutorial internally uses the ASP.NET data cache to store the data retrieved from the BLL.</span></span> <span data-ttu-id="b39de-140">Der Datencache kann auch programmgesteuert von ASP.NET Seiten Code-Behind-Klassen oder von den Klassen in der s Webanwendungsarchitektur zugegriffen werden.</span><span class="sxs-lookup"><span data-stu-id="b39de-140">The data cache can also be accessed programmatically from ASP.NET pages code-behind classes or from the classes in the web application s architecture.</span></span> <span data-ttu-id="b39de-141">Zum Lesen und Schreiben für den Datencache von einer ASP.NET Seite s-Code-Behind-Klasse, verwenden Sie Folgendes Muster:</span><span class="sxs-lookup"><span data-stu-id="b39de-141">To read and write to the data cache from an ASP.NET page s code-behind class, use the following pattern:</span></span>


[!code-vb[Main](caching-data-in-the-architecture-vb/samples/sample1.vb)]

<span data-ttu-id="b39de-142">Die [ `Cache` Klasse](https://msdn.microsoft.com/library/system.web.caching.cache.aspx) s [ `Insert` Methode](https://msdn.microsoft.com/library/system.web.caching.cache.insert.aspx) bietet eine Reihe von Überladungen.</span><span class="sxs-lookup"><span data-stu-id="b39de-142">The [`Cache` class](https://msdn.microsoft.com/library/system.web.caching.cache.aspx) s [`Insert` method](https://msdn.microsoft.com/library/system.web.caching.cache.insert.aspx) has a number of overloads.</span></span> <span data-ttu-id="b39de-143">`Cache("key") = value` und `Cache.Insert(key, value)` sind Synonyme und sowohl der Cache mit dem angegebenen Schlüssel ohne einen definierten Ablauf ein Element hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="b39de-143">`Cache("key") = value` and `Cache.Insert(key, value)` are synonymous and both add an item to the cache using the specified key without a defined expiry.</span></span> <span data-ttu-id="b39de-144">In der Regel möchten wir eine Ablaufzeit an, beim Hinzufügen eines Elements zum Cache muss entweder als eine Abhängigkeit, die eine zeitbasierte Ablauf oder beides.</span><span class="sxs-lookup"><span data-stu-id="b39de-144">Typically, we want to specify an expiry when adding an item to the cache, either as a dependency, a time-based expiry, or both.</span></span> <span data-ttu-id="b39de-145">Verwenden Sie eine der anderen `Insert` s methodenüberladungen, Abhängigkeit oder zeitbasierte Ablaufinformationen bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="b39de-145">Use one of the other `Insert` method s overloads to provide dependency- or time-based expiry information.</span></span>

<span data-ttu-id="b39de-146">Die Caching-Ebene, die s-Methoden müssen zuerst zu überprüfen, wenn die angeforderten Daten im Cache befindet, und wenn dies der Fall ist, wird es von dort aus zurück.</span><span class="sxs-lookup"><span data-stu-id="b39de-146">The Caching Layer s methods need to first check if the requested data is in the cache and, if so, return it from there.</span></span> <span data-ttu-id="b39de-147">Wenn die angeforderten Daten nicht im Cache vorhanden ist, muss die entsprechende BLL-Methode aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="b39de-147">If the requested data is not in the cache, the appropriate BLL method needs to be invoked.</span></span> <span data-ttu-id="b39de-148">Der Rückgabewert sollte zwischengespeichert und dann zurückgegeben, wie das folgende Sequenzdiagramm zeigt.</span><span class="sxs-lookup"><span data-stu-id="b39de-148">Its return value should be cached and then returned, as the following sequence diagram illustrates.</span></span>


![Die Ebene Caching-s-Methoden Daten aus dem Cache zurückgibt, wenn es s verfügbar](caching-data-in-the-architecture-vb/_static/image3.png)

<span data-ttu-id="b39de-150">**Abbildung 3**: Methoden der Caching-Ebene Daten aus dem Cache zurückgibt, wenn es s verfügbar</span><span class="sxs-lookup"><span data-stu-id="b39de-150">**Figure 3**: The Caching Layer s Methods Return Data from the Cache if it s Available</span></span>


<span data-ttu-id="b39de-151">Die Sequenz, die in den in Abbildung 3 erfolgt in der CL-Klassen, die mit dem folgenden Muster:</span><span class="sxs-lookup"><span data-stu-id="b39de-151">The sequence depicted in Figure 3 is accomplished in the CL classes using the following pattern:</span></span>


[!code-vb[Main](caching-data-in-the-architecture-vb/samples/sample2.vb)]

<span data-ttu-id="b39de-152">Hier *Typ* ist der Typ der Daten im Cache gespeichert werden `Northwind.ProductsDataTable`, z. B. *Schlüssel* ist der Schlüssel, der das Element im Cache eindeutig identifiziert.</span><span class="sxs-lookup"><span data-stu-id="b39de-152">Here, *Type* is the type of data being stored in the cache `Northwind.ProductsDataTable`, for example while *key* is the key that uniquely identifies the cache item.</span></span> <span data-ttu-id="b39de-153">Wenn das Element mit dem angegebenen *Schlüssel* befindet sich nicht im Cache, klicken Sie dann *Instanz* werden `Nothing` und die Daten werden aus der entsprechenden BLL-Methode abgerufen und dem Cache hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="b39de-153">If the item with the specified *key* is not in the cache, then *instance* will be `Nothing` and the data will be retrieved from the appropriate BLL method and added to the cache.</span></span> <span data-ttu-id="b39de-154">Nach der Zeit `Return instance` erreicht ist, *Instanz* enthält einen Verweis auf die Daten aus dem Cache oder der BLL abgerufen.</span><span class="sxs-lookup"><span data-stu-id="b39de-154">By the time `Return instance` is reached, *instance* contains a reference to the data, either from the cache or pulled from the BLL.</span></span>

<span data-ttu-id="b39de-155">Achten Sie darauf, dass Sie die oben genannten Muster verwenden, beim Zugriff auf Daten aus dem Cache.</span><span class="sxs-lookup"><span data-stu-id="b39de-155">Be sure to use the above pattern when accessing data from the cache.</span></span> <span data-ttu-id="b39de-156">Das folgende Muster, das, auf den ersten Blick entspricht, sucht enthält einen feinen Unterschied, der eine Racebedingung führt.</span><span class="sxs-lookup"><span data-stu-id="b39de-156">The following pattern, which, at first glance, looks equivalent, contains a subtle difference that introduces a race condition.</span></span> <span data-ttu-id="b39de-157">Racebedingungen sind schwer zu debuggen, da sie selbst sporadisch Offenlegen und sind schwer zu reproduzieren.</span><span class="sxs-lookup"><span data-stu-id="b39de-157">Race conditions are difficult to debug because they reveal themselves sporadically and are difficult to reproduce.</span></span>


[!code-vb[Main](caching-data-in-the-architecture-vb/samples/sample3.vb)]

<span data-ttu-id="b39de-158">Der Unterschied in diesem zweiten, falsche Codeausschnitt ist, statt einen Verweis auf das zwischengespeicherte Element in einer lokalen Variablen speichern, wird der Datencache direkt in die Auswertung der Anweisung zugegriffen *und* in der `Return`.</span><span class="sxs-lookup"><span data-stu-id="b39de-158">The difference in this second, incorrect code snippet is that rather than storing a reference to the cached item in a local variable, the data cache is accessed directly in the conditional statement *and* in the `Return`.</span></span> <span data-ttu-id="b39de-159">Stellen Sie sich vor, wenn dieser Code erreicht wird, `Cache("key")` nicht `Nothing`, aber vor der `Return` -Anweisung erreicht wird, entfernt das System nach dem *Schlüssel* aus dem Cache.</span><span class="sxs-lookup"><span data-stu-id="b39de-159">Imagine that when this code is reached, `Cache("key")` is not `Nothing`, but before the `Return` statement is reached, the system evicts *key* from the cache.</span></span> <span data-ttu-id="b39de-160">In diesem seltenen Fall, wird der Code gibt `Nothing` anstatt ein Objekt vom erwarteten Typ.</span><span class="sxs-lookup"><span data-stu-id="b39de-160">In this rare case, the code will return `Nothing` rather than an object of the expected type.</span></span>

> [!NOTE]
> <span data-ttu-id="b39de-161">Der Datencache ist threadsicher, daher brauchen Sie einfache Lese- oder Schreibvorgänge Threadzugriff synchronisieren.</span><span class="sxs-lookup"><span data-stu-id="b39de-161">The data cache is thread-safe, so you don't need to synchronize thread access for simple reads or writes.</span></span> <span data-ttu-id="b39de-162">Jedoch, wenn Sie mehrere Vorgänge für Daten im Cache, der atomarisch sein müssen, sind Sie verantwortlich für die Implementierung einer Sperre oder eines anderen Mechanismus, um Threadsicherheit zu gewährleisten.</span><span class="sxs-lookup"><span data-stu-id="b39de-162">However, if you need to perform multiple operations on data in the cache that need to be atomic, you are responsible for implementing a lock or some other mechanism to ensure thread safety.</span></span> <span data-ttu-id="b39de-163">Finden Sie unter [synchronisiert den Zugriff auf die ASP.NET-Cache](http://www.ddj.com/184406369) für Weitere Informationen.</span><span class="sxs-lookup"><span data-stu-id="b39de-163">See [Synchronizing Access to the ASP.NET Cache](http://www.ddj.com/184406369) for more information.</span></span>


<span data-ttu-id="b39de-164">Ein Element kann programmgesteuert entfernt werden, aus dem Cache mithilfe der [ `Remove` Methode](https://msdn.microsoft.com/library/system.web.caching.cache.remove.aspx) wie folgt:</span><span class="sxs-lookup"><span data-stu-id="b39de-164">An item can be programmatically evicted from the data cache using the [`Remove` method](https://msdn.microsoft.com/library/system.web.caching.cache.remove.aspx) like so:</span></span>


[!code-vb[Main](caching-data-in-the-architecture-vb/samples/sample4.vb)]

## <a name="step-3-returning-product-information-from-theproductsclclass"></a><span data-ttu-id="b39de-165">Schritt 3: Zurückgeben von Produktinformationen aus der`ProductsCL`Klasse</span><span class="sxs-lookup"><span data-stu-id="b39de-165">Step 3: Returning Product Information from the`ProductsCL`Class</span></span>

<span data-ttu-id="b39de-166">Für dieses Lernprogramm s implementiert zwei Methoden für die Rückgabe von Produktinformationen aus kann die `ProductsCL` Klasse: `GetProducts()` und `GetProductsByCategoryID(categoryID)`.</span><span class="sxs-lookup"><span data-stu-id="b39de-166">For this tutorial let s implement two methods for returning product information from the `ProductsCL` class: `GetProducts()` and `GetProductsByCategoryID(categoryID)`.</span></span> <span data-ttu-id="b39de-167">Wie mit der `ProductsBL` Klasse in der Logik der Geschäftsebene der `GetProducts()` in der CL Methodenrückgabe Informationen für alle Produkte als eine `Northwind.ProductsDataTable` -Objekt, während `GetProductsByCategoryID(categoryID)` gibt alle Produkte aus einer angegebenen Kategorie.</span><span class="sxs-lookup"><span data-stu-id="b39de-167">Like with the `ProductsBL` class in the Business Logic Layer, the `GetProducts()` method in the CL returns information about all of the products as a `Northwind.ProductsDataTable` object, while `GetProductsByCategoryID(categoryID)` returns all of the products from a specified category.</span></span>

<span data-ttu-id="b39de-168">Der folgende Code zeigt einen Teil der Methoden in der `ProductsCL` Klasse:</span><span class="sxs-lookup"><span data-stu-id="b39de-168">The following code shows a portion of the methods in the `ProductsCL` class:</span></span>


[!code-vb[Main](caching-data-in-the-architecture-vb/samples/sample5.vb)]

<span data-ttu-id="b39de-169">Beachten Sie zunächst die `DataObject` und `DataObjectMethodAttribute` Attribute auf die Klassen und Methoden angewendet werden.</span><span class="sxs-lookup"><span data-stu-id="b39de-169">First, note the `DataObject` and `DataObjectMethodAttribute` attributes applied to the class and methods.</span></span> <span data-ttu-id="b39de-170">Diese Attribute enthalten Informationen zu den ObjectDataSource-s-Assistent, der angibt, welche Klassen und Methoden in den Schritten des Assistenten s angezeigt werden soll.</span><span class="sxs-lookup"><span data-stu-id="b39de-170">These attributes provide information to the ObjectDataSource s wizard, indicating what classes and methods should appear in the wizard s steps.</span></span> <span data-ttu-id="b39de-171">Da die CL-Klassen und Methoden aus einem ObjectDataSource in der Darstellungsschicht zugegriffen werden, hinzugefügt ich diese Attribute, um die entwurfszeitumgebung zu verbessern.</span><span class="sxs-lookup"><span data-stu-id="b39de-171">Since the CL classes and methods will be accessed from an ObjectDataSource in the Presentation Layer, I added these attributes to enhance the design-time experience.</span></span> <span data-ttu-id="b39de-172">Verweisen auf die [erstellen eine Geschäftslogikschicht](../introduction/creating-a-business-logic-layer-vb.md) Lernprogramm eine ausführlichere Beschreibung für diese Attribute und deren Auswirkungen.</span><span class="sxs-lookup"><span data-stu-id="b39de-172">Refer back to the [Creating a Business Logic Layer](../introduction/creating-a-business-logic-layer-vb.md) tutorial for a more thorough description on these attributes and their effects.</span></span>

<span data-ttu-id="b39de-173">In der `GetProducts()` und `GetProductsByCategoryID(categoryID)` Methoden, die vom zurückgegebenen Daten dem `GetCacheItem(key)` Methode eine lokale Variable zugewiesen wird.</span><span class="sxs-lookup"><span data-stu-id="b39de-173">In the `GetProducts()` and `GetProductsByCategoryID(categoryID)` methods, the data returned from the `GetCacheItem(key)` method is assigned to a local variable.</span></span> <span data-ttu-id="b39de-174">Die `GetCacheItem(key)` -Methode, die wir in Kürze untersucht werden, gibt ein bestimmtes Element aus dem Cache, die auf der Grundlage der angegebenen *Schlüssel*.</span><span class="sxs-lookup"><span data-stu-id="b39de-174">The `GetCacheItem(key)` method, which we'll examine shortly, returns a particular item from the cache based on the specified *key*.</span></span> <span data-ttu-id="b39de-175">Wenn keine solche Daten im Cache gefunden werden, wird Sie aus der entsprechenden abgerufen `ProductsBLL` class-Methode, und klicken Sie dann mit dem Cache hinzugefügt die `AddCacheItem(key, value)` Methode.</span><span class="sxs-lookup"><span data-stu-id="b39de-175">If no such data is found in cache, it is retrieved from the corresponding `ProductsBLL` class method and then added to the cache using the `AddCacheItem(key, value)` method.</span></span>

<span data-ttu-id="b39de-176">Die `GetCacheItem(key)` und `AddCacheItem(key, value)` Methoden Schnittstelle mit dem Datencache, lesen und Schreiben von Werten.</span><span class="sxs-lookup"><span data-stu-id="b39de-176">The `GetCacheItem(key)` and `AddCacheItem(key, value)` methods interface with the data cache, reading and writing values, respectively.</span></span> <span data-ttu-id="b39de-177">Die `GetCacheItem(key)` Methode ist die einfachere der zwei.</span><span class="sxs-lookup"><span data-stu-id="b39de-177">The `GetCacheItem(key)` method is the simpler of the two.</span></span> <span data-ttu-id="b39de-178">Einfach den Wert zurück, aus der Cache-Klasse, die mit dem übergebenen in *Schlüssel*:</span><span class="sxs-lookup"><span data-stu-id="b39de-178">It simply returns the value from the Cache class using the passed-in *key*:</span></span>


[!code-vb[Main](caching-data-in-the-architecture-vb/samples/sample6.vb)]

<span data-ttu-id="b39de-179">`GetCacheItem(key)` verwendet keinen *Schlüssel* Wert wie angegeben, sondern ruft die `GetCacheKey(key)` Methode, die zurückgibt der *Schlüssel* ProductsCache - vorangestellt.</span><span class="sxs-lookup"><span data-stu-id="b39de-179">`GetCacheItem(key)` does not use *key* value as supplied, but instead calls the `GetCacheKey(key)` method, which returns the *key* prepended with ProductsCache-.</span></span> <span data-ttu-id="b39de-180">Die `MasterCacheKeyArray`, das die Zeichenfolge ProductsCache, hält dient auch durch die `AddCacheItem(key, value)` -Methode, vorübergehend eingehendem.</span><span class="sxs-lookup"><span data-stu-id="b39de-180">The `MasterCacheKeyArray`, which holds the string ProductsCache, is also used by the `AddCacheItem(key, value)` method, as we'll see momentarily.</span></span>

<span data-ttu-id="b39de-181">Von einer ASP.NET Seite "s" Code-Behind-Klasse, kann der Datencache mit zugegriffen werden die `Page` Klasse s [ `Cache` Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.page.cache.aspx), und ermöglicht eine Syntax wie `Cache("key") = value`, wie in Schritt2 beschrieben.</span><span class="sxs-lookup"><span data-stu-id="b39de-181">From an ASP.NET page s code-behind class, the data cache can be accessed using the `Page` class s [`Cache` property](https://msdn.microsoft.com/library/system.web.ui.page.cache.aspx), and allows for syntax like `Cache("key") = value`, as discussed in Step 2.</span></span> <span data-ttu-id="b39de-182">Von einer Klasse in der Architektur der Datencache möglich, die entweder `HttpRuntime.Cache` oder `HttpContext.Current.Cache`.</span><span class="sxs-lookup"><span data-stu-id="b39de-182">From a class within the architecture, the data cache can be accessed using either `HttpRuntime.Cache` or `HttpContext.Current.Cache`.</span></span> <span data-ttu-id="b39de-183">[Peter Johnson](https://weblogs.asp.net/pjohnson/default.aspx)des Blogeintrag [HttpRuntime.Cache Vs. HttpContext.Current.Cache](https://weblogs.asp.net/pjohnson/httpruntime-cache-vs-httpcontext-current-cache) notes geringfügigen Leistungsvorteil in mit `HttpRuntime` anstelle von `HttpContext.Current`; folglich `ProductsCL` verwendet `HttpRuntime`.</span><span class="sxs-lookup"><span data-stu-id="b39de-183">[Peter Johnson](https://weblogs.asp.net/pjohnson/default.aspx)'s blog entry [HttpRuntime.Cache vs. HttpContext.Current.Cache](https://weblogs.asp.net/pjohnson/httpruntime-cache-vs-httpcontext-current-cache) notes the slight performance advantage in using `HttpRuntime` instead of `HttpContext.Current`; consequently, `ProductsCL` uses `HttpRuntime`.</span></span>

> [!NOTE]
> <span data-ttu-id="b39de-184">Wenn Ihre Architektur wird mithilfe von Klassenbibliotheksprojekte implementiert, dann Sie einen Verweis hinzufügen müssen der `System.Web` Assembly um verwenden die [ `HttpRuntime` ](https://msdn.microsoft.com/library/system.web.httpruntime.aspx) und [ `HttpContext` ](https://msdn.microsoft.com/library/system.web.httpcontext.aspx) Klassen.</span><span class="sxs-lookup"><span data-stu-id="b39de-184">If your architecture is implemented using Class Library projects then you will need to add a reference to the `System.Web` assembly in order to use the [`HttpRuntime`](https://msdn.microsoft.com/library/system.web.httpruntime.aspx) and [`HttpContext`](https://msdn.microsoft.com/library/system.web.httpcontext.aspx) classes.</span></span>


<span data-ttu-id="b39de-185">Wenn das Element nicht im Cache gefunden wurde die `ProductsCL` Klassenmethoden s rufen Sie die Daten aus der BLL und hinzuzufügen, den Cache mithilfe der `AddCacheItem(key, value)` Methode.</span><span class="sxs-lookup"><span data-stu-id="b39de-185">If the item is not found in the cache, the `ProductsCL` class s methods get the data from the BLL and add it to the cache using the `AddCacheItem(key, value)` method.</span></span> <span data-ttu-id="b39de-186">Hinzuzufügende *Wert* in den Cache können wir den folgenden Code, der ein Ablaufdatum 60 Sekunden Zeit verwendet:</span><span class="sxs-lookup"><span data-stu-id="b39de-186">To add *value* to the cache we could use the following code, which uses a 60 second time expiry:</span></span>


[!code-vb[Main](caching-data-in-the-architecture-vb/samples/sample7.vb)]

<span data-ttu-id="b39de-187">`DateTime.Now.AddSeconds(CacheDuration)` Gibt die Ablaufzeit zeitbasierte 60 Sekunden in der Zukunft While [ `System.Web.Caching.Cache.NoSlidingExpiration` ](https://msdn.microsoft.com/library/system.web.caching.cache.noslidingexpiration(vs.80).aspx) gibt es s keine Ablaufzeit an.</span><span class="sxs-lookup"><span data-stu-id="b39de-187">`DateTime.Now.AddSeconds(CacheDuration)` specifies the time-based expiry 60 seconds in the future while [`System.Web.Caching.Cache.NoSlidingExpiration`](https://msdn.microsoft.com/library/system.web.caching.cache.noslidingexpiration(vs.80).aspx) indicates that there s no sliding expiration.</span></span> <span data-ttu-id="b39de-188">Obwohl dies `Insert` methodenüberladung Eingabeparameter aufweisen, die für beide Absolute und gleitende Ablaufzeit, können Sie nur einen der beiden.</span><span class="sxs-lookup"><span data-stu-id="b39de-188">While this `Insert` method overload has input parameters for both an absolute and sliding expiry, you can only provide one of the two.</span></span> <span data-ttu-id="b39de-189">Wenn Sie versuchen, geben Sie einen absoluten Zeitpunkt und eine Zeitspanne, die `Insert` Methode löst eine `ArgumentException` Ausnahme.</span><span class="sxs-lookup"><span data-stu-id="b39de-189">If you attempt to specify both an absolute time and a time span, the `Insert` method will throw an `ArgumentException` exception.</span></span>

> [!NOTE]
> <span data-ttu-id="b39de-190">Diese Implementierung der `AddCacheItem(key, value)` Methode hat derzeit einige Nachteile.</span><span class="sxs-lookup"><span data-stu-id="b39de-190">This implementation of the `AddCacheItem(key, value)` method currently has some shortcomings.</span></span> <span data-ttu-id="b39de-191">Wir behandeln und beheben diese Probleme in Schritt 4.</span><span class="sxs-lookup"><span data-stu-id="b39de-191">We'll address and overcome these issues in Step 4.</span></span>


## <a name="step-4-invalidating-the-cache-when-the-data-is-modified-through-the-architecture"></a><span data-ttu-id="b39de-192">Schritt 4: Wenn die Daten der Cache wird ungültig gemacht ist über die Architektur geändert</span><span class="sxs-lookup"><span data-stu-id="b39de-192">Step 4: Invalidating the Cache When the Data is Modified Through the Architecture</span></span>

<span data-ttu-id="b39de-193">Zusammen mit Datenabrufmethoden muss der Caching-Ebene dieselben Methoden wie die BLL zum Einfügen, aktualisieren und Löschen von Daten enthalten.</span><span class="sxs-lookup"><span data-stu-id="b39de-193">Along with data retrieval methods, the Caching Layer needs to provide the same methods as the BLL for inserting, updating, and deleting data.</span></span> <span data-ttu-id="b39de-194">Die CL s Datenmethoden Änderung verändern sich nicht auf die zwischengespeicherten Daten, aber BLL s entsprechende Änderung Datenmethode aufrufen, und klicken Sie dann den Cache ungültig.</span><span class="sxs-lookup"><span data-stu-id="b39de-194">The CL s data modification methods do not modify the cached data, but rather call the BLL s corresponding data modification method and then invalidate the cache.</span></span> <span data-ttu-id="b39de-195">Wie wir im vorherigen Lernprogramm gesehen haben, ist dies dasselbe Verhalten, das das ObjectDataSource gilt, wenn die caching-Funktionen aktiviert sind und die zugehörige `Insert`, `Update`, oder `Delete` Methoden aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="b39de-195">As we saw in the preceding tutorial, this is the same behavior that the ObjectDataSource applies when its caching features are enabled and its `Insert`, `Update`, or `Delete` methods are invoked.</span></span>

<span data-ttu-id="b39de-196">Die folgenden `UpdateProduct` Überladung wird veranschaulicht, wie Methoden für die Änderung in der CL implementieren:</span><span class="sxs-lookup"><span data-stu-id="b39de-196">The following `UpdateProduct` overload illustrates how to implement the data modification methods in the CL:</span></span>


[!code-vb[Main](caching-data-in-the-architecture-vb/samples/sample8.vb)]

<span data-ttu-id="b39de-197">Die entsprechenden Datenänderung Business Logic Layer-Methode wird aufgerufen, aber bevor die Antwort zurückgegeben werden müssen wir den Cache für ungültig zu erklären.</span><span class="sxs-lookup"><span data-stu-id="b39de-197">The appropriate data modification Business Logic Layer method is invoked, but before its response is returned we need to invalidate the cache.</span></span> <span data-ttu-id="b39de-198">Leider ungültig ist nicht einfach, da die `ProductsCL` Klasse s `GetProducts()` und `GetProductsByCategoryID(categoryID)` Methoden jedes Elemente hinzufügen des Caches mit unterschiedlichen Schlüsseln und die `GetProductsByCategoryID(categoryID)` Methode fügt einen anderen Cacheelement, das für jeden eindeutigen *CategoryID*.</span><span class="sxs-lookup"><span data-stu-id="b39de-198">Unfortunately, invalidating the cache is not straightforward because the `ProductsCL` class s `GetProducts()` and `GetProductsByCategoryID(categoryID)` methods each add items to the cache with different keys, and the `GetProductsByCategoryID(categoryID)` method adds a different cache item for each unique *categoryID*.</span></span>

<span data-ttu-id="b39de-199">Wenn den Cache ungültig macht, müssen wir entfernen *alle* der Elemente, die durch hinzugefügt worden sein könnten die `ProductsCL` Klasse.</span><span class="sxs-lookup"><span data-stu-id="b39de-199">When invalidating the cache, we need to remove *all* of the items that may have been added by the `ProductsCL` class.</span></span> <span data-ttu-id="b39de-200">Dies geschieht durch das Zuordnen einer *Zwischenspeichern Abhängigkeit* mit der jedes Element im Cache in die `AddCacheItem(key, value)` Methode.</span><span class="sxs-lookup"><span data-stu-id="b39de-200">This can be accomplished by associating a *cache dependency* with the each item added to the cache in the `AddCacheItem(key, value)` method.</span></span> <span data-ttu-id="b39de-201">Im Allgemeinen kann eine Cacheabhängigkeit ein anderes Element im Cache eine Datei auf dem Dateisystem oder Daten aus einer Microsoft SQL Server-Datenbank sein.</span><span class="sxs-lookup"><span data-stu-id="b39de-201">In general, a cache dependency can be another item in the cache, a file on the file system, or data from a Microsoft SQL Server database.</span></span> <span data-ttu-id="b39de-202">Wenn die Abhängigkeit ändert oder aus dem Cache entfernt wird, werden automatisch den zugeordneten Cacheelementen aus dem Cache entfernt.</span><span class="sxs-lookup"><span data-stu-id="b39de-202">When the dependency changes or is removed from the cache, the cache items it is associated with are automatically evicted from the cache.</span></span> <span data-ttu-id="b39de-203">Dieses Lernprogramm möchten wir ein weiteres Element im Cache zu erstellen, die dient als über eine Cacheabhängigkeit für alle Elemente hinzugefügt, die `ProductsCL` Klasse.</span><span class="sxs-lookup"><span data-stu-id="b39de-203">For this tutorial, we want to create an additional item in the cache that serves as a cache dependency for all items added through the `ProductsCL` class.</span></span> <span data-ttu-id="b39de-204">Alle diese Elemente können auf diese Weise durch die Cacheabhängigkeit entfernen aus dem Cache entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="b39de-204">That way, all of these items can be removed from the cache by simply removing the cache dependency.</span></span>

<span data-ttu-id="b39de-205">Let-s-Update die `AddCacheItem(key, value)` Methode, damit jedes Element dem Cache hinzugefügt, durch diese Methode ist eine einzelne Cacheabhängigkeit zugeordnet:</span><span class="sxs-lookup"><span data-stu-id="b39de-205">Let s update the `AddCacheItem(key, value)` method so that each item added to the cache through this method is associated with a single cache dependency:</span></span>


[!code-vb[Main](caching-data-in-the-architecture-vb/samples/sample9.vb)]

<span data-ttu-id="b39de-206">`MasterCacheKeyArray` ist ein Array von Zeichenfolgen, die einen einzelnen Wert, ProductsCache enthält.</span><span class="sxs-lookup"><span data-stu-id="b39de-206">`MasterCacheKeyArray` is a string array that holds a single value, ProductsCache.</span></span> <span data-ttu-id="b39de-207">Zuerst wird ein Cacheelement, das dem Cache hinzugefügt und zugewiesen, das aktuelle Datum und die Uhrzeit.</span><span class="sxs-lookup"><span data-stu-id="b39de-207">First, a cache item is added to the cache and assigned the current date and time.</span></span> <span data-ttu-id="b39de-208">Wenn das Cacheelement, das bereits vorhanden ist, wird er aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="b39de-208">If the cache item already exists, it is updated.</span></span> <span data-ttu-id="b39de-209">Als Nächstes wird eine Cacheabhängigkeit erstellt.</span><span class="sxs-lookup"><span data-stu-id="b39de-209">Next, a cache dependency is created.</span></span> <span data-ttu-id="b39de-210">Die [ `CacheDependency` Klasse](https://msdn.microsoft.com/library/system.web.caching.cachedependency(VS.80).aspx) s Konstruktor verfügt über mehrere Überladungen, jedoch wird hier verwendet erwartet zwei `String` array Eingaben.</span><span class="sxs-lookup"><span data-stu-id="b39de-210">The [`CacheDependency` class](https://msdn.microsoft.com/library/system.web.caching.cachedependency(VS.80).aspx) s constructor has a number of overloads, but the one being used in here expects two `String` array inputs.</span></span> <span data-ttu-id="b39de-211">Die erste Vorlage gibt den Satz von Dateien als Abhängigkeit verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="b39de-211">The first one specifies the set of files to be used as dependencies.</span></span> <span data-ttu-id="b39de-212">Da wir Verschlüsselungskennwort t dateibasierten Abhängigkeiten, den Wert verwenden möchten `Nothing` wird für den ersten Eingabeparameter verwendet.</span><span class="sxs-lookup"><span data-stu-id="b39de-212">Since we don t want to use any file-based dependencies, a value of `Nothing` is used for the first input parameter.</span></span> <span data-ttu-id="b39de-213">Der zweite Eingabeparameter gibt die Menge der Cacheschlüssel, der als Abhängigkeit verwendet.</span><span class="sxs-lookup"><span data-stu-id="b39de-213">The second input parameter specifies the set of cache keys to use as dependencies.</span></span> <span data-ttu-id="b39de-214">Hier geben wir unsere einzige Abhängigkeit `MasterCacheKeyArray`.</span><span class="sxs-lookup"><span data-stu-id="b39de-214">Here we specify our single dependency, `MasterCacheKeyArray`.</span></span> <span data-ttu-id="b39de-215">Die `CacheDependency` wird dann in übergeben der `Insert` Methode.</span><span class="sxs-lookup"><span data-stu-id="b39de-215">The `CacheDependency` is then passed into the `Insert` method.</span></span>

<span data-ttu-id="b39de-216">Dank dieser Änderung auf `AddCacheItem(key, value)`, invaliding der Cache ist so einfach wie das Entfernen der Abhängigkeitsverhältnis.</span><span class="sxs-lookup"><span data-stu-id="b39de-216">With this modification to `AddCacheItem(key, value)`, invaliding the cache is as simple as removing the dependency.</span></span>


[!code-vb[Main](caching-data-in-the-architecture-vb/samples/sample10.vb)]

## <a name="step-5-calling-the-caching-layer-from-the-presentation-layer"></a><span data-ttu-id="b39de-217">Schritt 5: Aufrufen der Caching-Ebene aus der Darstellungsschicht</span><span class="sxs-lookup"><span data-stu-id="b39de-217">Step 5: Calling the Caching Layer from the Presentation Layer</span></span>

<span data-ttu-id="b39de-218">Die Ebene Caching-s-Klassen und Methoden können mit Daten arbeiten mit den Verfahren wir in diesen Lernprogrammen untersucht Ve verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="b39de-218">The Caching Layer s classes and methods can be used to work with data using the techniques we ve examined throughout these tutorials.</span></span> <span data-ttu-id="b39de-219">Zum Arbeiten mit zwischengespeicherten Daten zu veranschaulichen, speichern Sie die Änderungen an der `ProductsCL` Klasse, und öffnen Sie dann die `FromTheArchitecture.aspx` auf der Seite der `Caching` Ordner und fügen Sie eine GridView hinzu.</span><span class="sxs-lookup"><span data-stu-id="b39de-219">To illustrate working with cached data, save your changes to the `ProductsCL` class and then open the `FromTheArchitecture.aspx` page in the `Caching` folder and add a GridView.</span></span> <span data-ttu-id="b39de-220">Erstellen Sie eine neue ObjectDataSource aus den GridView s smart Tag.</span><span class="sxs-lookup"><span data-stu-id="b39de-220">From the GridView s smart tag, create a new ObjectDataSource.</span></span> <span data-ttu-id="b39de-221">Im ersten Schritt Assistenten s sollte die `ProductsCL` Klasse als eine der Optionen aus der Dropdown-Liste.</span><span class="sxs-lookup"><span data-stu-id="b39de-221">In the wizard s first step you should see the `ProductsCL` class as one of the options from the drop-down list.</span></span>


<span data-ttu-id="b39de-222">[![Die ProductsCL-Klasse ist in der Dropdownliste mit der Business-Objekt enthalten.](caching-data-in-the-architecture-vb/_static/image5.png)](caching-data-in-the-architecture-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="b39de-222">[![The ProductsCL Class is Included in the Business Object Drop-Down List](caching-data-in-the-architecture-vb/_static/image5.png)](caching-data-in-the-architecture-vb/_static/image4.png)</span></span>

<span data-ttu-id="b39de-223">**Abbildung 4**: die `ProductsCL` -Klasse in der Dropdownliste mit der Business-Objekt enthalten ist ([klicken Sie hier, um das Bild in voller Größe angezeigt](caching-data-in-the-architecture-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="b39de-223">**Figure 4**: The `ProductsCL` Class is Included in the Business Object Drop-Down List ([Click to view full-size image](caching-data-in-the-architecture-vb/_static/image6.png))</span></span>


<span data-ttu-id="b39de-224">Nach der Auswahl `ProductsCL`, klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="b39de-224">After selecting `ProductsCL`, click Next.</span></span> <span data-ttu-id="b39de-225">Die Dropdownliste in der Registerkarte "SELECT" verfügt über zwei Elemente - `GetProducts()` und `GetProductsByCategoryID(categoryID)` und die Registerkarte "UPDATE" wurde das einzige `UpdateProduct` überladen.</span><span class="sxs-lookup"><span data-stu-id="b39de-225">The drop-down list in the SELECT tab has two items - `GetProducts()` and `GetProductsByCategoryID(categoryID)` and the UPDATE tab has the sole `UpdateProduct` overload.</span></span> <span data-ttu-id="b39de-226">Wählen Sie die `GetProducts()` Methode aus der Registerkarte "SELECT" und die `UpdateProducts` Methode aus der Registerkarte "UPDATE" und klicken Sie auf Fertig stellen.</span><span class="sxs-lookup"><span data-stu-id="b39de-226">Choose the `GetProducts()` method from the SELECT tab and the `UpdateProducts` method from the UPDATE tab and click Finish.</span></span>


<span data-ttu-id="b39de-227">[![Die ProductsCL Klassenmethoden s sind in der Dropdown-Listen aufgeführt.](caching-data-in-the-architecture-vb/_static/image8.png)](caching-data-in-the-architecture-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="b39de-227">[![The ProductsCL Class s Methods are Listed in the Drop-Down Lists](caching-data-in-the-architecture-vb/_static/image8.png)](caching-data-in-the-architecture-vb/_static/image7.png)</span></span>

<span data-ttu-id="b39de-228">**Abbildung 5**: die `ProductsCL` Klassenmethoden s sind in der Dropdown-Listen aufgeführt ([klicken Sie hier, um das Bild in voller Größe angezeigt](caching-data-in-the-architecture-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="b39de-228">**Figure 5**: The `ProductsCL` Class s Methods are Listed in the Drop-Down Lists ([Click to view full-size image](caching-data-in-the-architecture-vb/_static/image9.png))</span></span>


<span data-ttu-id="b39de-229">Nach Abschluss des Assistenten wird Visual Studio das ObjectDataSource-s festgelegt `OldValuesParameterFormatString` Eigenschaft `original_{0}` und die entsprechenden Felder an die GridView hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="b39de-229">After completing the wizard, Visual Studio will set the ObjectDataSource s `OldValuesParameterFormatString` property to `original_{0}` and add the appropriate fields to the GridView.</span></span> <span data-ttu-id="b39de-230">Ändern der `OldValuesParameterFormatString` -Eigenschaft zurück auf den Standardwert `{0}`, und konfigurieren Sie die GridView zur Unterstützung von paging, Sortieren und bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="b39de-230">Change the `OldValuesParameterFormatString` property back to its default value, `{0}`, and configure the GridView to support paging, sorting, and editing.</span></span> <span data-ttu-id="b39de-231">Da die `UploadProducts` Überladung verwendet, die für die CL akzeptiert nur die bearbeitete Produktname s und Preis, beschränken die GridView, damit nur diese Felder bearbeitet werden.</span><span class="sxs-lookup"><span data-stu-id="b39de-231">Since the `UploadProducts` overload used by the CL accepts only the edited product s name and price, limit the GridView so that only these fields are editable.</span></span>

<span data-ttu-id="b39de-232">In dem vorherigen Lernprogramm definiert wir eine GridView, um Felder für die `ProductName`, `CategoryName`, und `UnitPrice` Felder.</span><span class="sxs-lookup"><span data-stu-id="b39de-232">In the preceding tutorial we defined a GridView to include fields for the `ProductName`, `CategoryName`, and `UnitPrice` fields.</span></span> <span data-ttu-id="b39de-233">Wahlweise können diese Formatierung und die Struktur zu replizieren, in diesem Fall, dass die deklarative s GridView und ObjectDataSource-Markup sollte ähnlich der folgenden aussehen:</span><span class="sxs-lookup"><span data-stu-id="b39de-233">Feel free to replicate this formatting and structure, in which case your GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](caching-data-in-the-architecture-vb/samples/sample11.aspx)]

<span data-ttu-id="b39de-234">Zu diesem Zeitpunkt haben wir eine Seite, die die Caching-Ebene verwendet.</span><span class="sxs-lookup"><span data-stu-id="b39de-234">At this point we have a page that uses the Caching Layer.</span></span> <span data-ttu-id="b39de-235">Um den Cache in Aktion sehen zu können, legen Sie Haltepunkte in der `ProductsCL` Klasse s `GetProducts()` und `UpdateProduct` Methoden.</span><span class="sxs-lookup"><span data-stu-id="b39de-235">To see the cache in action, set breakpoints in the `ProductsCL` class s `GetProducts()` and `UpdateProduct` methods.</span></span> <span data-ttu-id="b39de-236">Besuchen Sie die Seite in einem Browser und den Code schrittweise durchlaufen, wenn die Sortierung und paging, um die Daten anzuzeigen, aus dem Cache abgerufen.</span><span class="sxs-lookup"><span data-stu-id="b39de-236">Visit the page in a browser and step through the code when sorting and paging in order to see the data pulled from the cache.</span></span> <span data-ttu-id="b39de-237">Klicken Sie dann aktualisieren Sie einen Datensatz zu, und beachten Sie, dass der Cache für ungültig erklärt und folglich wird Abruf der BLL, wenn die Daten an die GridView gebunden ist.</span><span class="sxs-lookup"><span data-stu-id="b39de-237">Then update a record and note that the cache is invalidated and, consequently, it is retrieved from the BLL when the data is rebound to the GridView.</span></span>

> [!NOTE]
> <span data-ttu-id="b39de-238">Die Caching-Ebene, die gemäß des Downloads zu diesem Artikel ist nicht abgeschlossen.</span><span class="sxs-lookup"><span data-stu-id="b39de-238">The Caching Layer provided in the download accompanying this article is not complete.</span></span> <span data-ttu-id="b39de-239">Sie enthält nur eine Klasse `ProductsCL`, die nur eine Handvoll Methoden Sport.</span><span class="sxs-lookup"><span data-stu-id="b39de-239">It contains only one class, `ProductsCL`, which only sports a handful of methods.</span></span> <span data-ttu-id="b39de-240">Darüber hinaus nur eine ASP.NET-Seite verwendet die CL (`~/Caching/FromTheArchitecture.aspx`) alle anderen weiterhin die BLL verweisen Sie direkt auf.</span><span class="sxs-lookup"><span data-stu-id="b39de-240">Moreover, only a single ASP.NET page uses the CL (`~/Caching/FromTheArchitecture.aspx`) all others still reference the BLL directly.</span></span> <span data-ttu-id="b39de-241">Wenn Sie eine CL in Ihrer Anwendung verwenden möchten, alle Aufrufe von der Darstellungsschicht sollte rufen Sie CL, die dies erfordern würde die CL s-Klassen und Methoden behandelt diese Klassen und Methoden in der BLL aktuell von der Darstellungsschicht verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="b39de-241">If you plan on using a CL in your application, all calls from the Presentation Layer should go to the CL, which would require that the CL s classes and methods covered those classes and methods in the BLL currently used by the Presentation Layer.</span></span>


## <a name="summary"></a><span data-ttu-id="b39de-242">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="b39de-242">Summary</span></span>

<span data-ttu-id="b39de-243">Beim Zwischenspeichern auf dem Darstellungsschicht mit ASP.NET 2.0 s SqlDataSource und ObjectDataSource-Steuerelement angewendet werden kann, würde idealerweise Zwischenspeichern Zuständigkeiten auf einer separaten Schicht in der Architektur delegiert werden.</span><span class="sxs-lookup"><span data-stu-id="b39de-243">While caching can be applied at the Presentation Layer with ASP.NET 2.0 s SqlDataSource and ObjectDataSource controls, ideally caching responsibilities would be delegated to a separate layer in the architecture.</span></span> <span data-ttu-id="b39de-244">In diesem Lernprogramm haben wir eine Caching-Ebene, die zwischen der Präsentationsschicht und der Business Logic Layer befindet.</span><span class="sxs-lookup"><span data-stu-id="b39de-244">In this tutorial we created a Caching Layer that resides between the Presentation Layer and the Business Logic Layer.</span></span> <span data-ttu-id="b39de-245">Die Caching-Ebene muss den gleichen Satz von Klassen und Methoden, die in der BLL vorhanden sein und aus der Darstellungsschicht heißen enthalten.</span><span class="sxs-lookup"><span data-stu-id="b39de-245">The Caching Layer needs to provide the same set of classes and methods that exist in the BLL and are called from the Presentation Layer.</span></span>

<span data-ttu-id="b39de-246">Die Ebene Caching-Beispiele, die wir in diesem Handbuch und den vorherigen Lernprogrammen untersucht ausgestellt *reaktive laden*.</span><span class="sxs-lookup"><span data-stu-id="b39de-246">The Caching Layer examples we explored in this and the preceding tutorials exhibited *reactive loading*.</span></span> <span data-ttu-id="b39de-247">Mit reaktive laden, werden die Daten in den Cache geladen, nur, wenn eine für die Daten Anforderung und die Daten aus dem Cache nicht vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="b39de-247">With reactive loading, the data is loaded into the cache only when a request for the data is made and that data is missing from the cache.</span></span> <span data-ttu-id="b39de-248">Daten können auch sein *proaktiv geladenen* in den Cache eine Technik, die lädt die Daten in den Cache, bevor sie tatsächlich benötigt wird.</span><span class="sxs-lookup"><span data-stu-id="b39de-248">Data can also be *proactively loaded* into the cache, a technique that loads the data into the cache before it is actually needed.</span></span> <span data-ttu-id="b39de-249">In den nächsten Lernprogrammen sehen wir ein Beispiel für die proaktive loading, wenn wir betrachten wie statische Werte in den Cache beim Start der Anwendung gespeichert.</span><span class="sxs-lookup"><span data-stu-id="b39de-249">In the next tutorial we'll see an example of proactive loading when we look at how to store static values into the cache at application startup.</span></span>

<span data-ttu-id="b39de-250">Viel Spaß beim Programmieren!</span><span class="sxs-lookup"><span data-stu-id="b39de-250">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="b39de-251">Informationen zum Autor</span><span class="sxs-lookup"><span data-stu-id="b39de-251">About the Author</span></span>

<span data-ttu-id="b39de-252">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor von sieben ASP/ASP.NET-Büchern und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), Microsoft Web-Technologien seit 1998 arbeitet.</span><span class="sxs-lookup"><span data-stu-id="b39de-252">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="b39de-253">Scott fungiert als ein unabhängiger Berater, Trainer und Writer.</span><span class="sxs-lookup"><span data-stu-id="b39de-253">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="b39de-254">Sein neueste Buch wird [ *Sams Schulen selbst ASP.NET 2.0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="b39de-254">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="b39de-255">Er die erreicht werden kann, zur [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) oder über seinen Blog die finden Sie unter [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="b39de-255">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="b39de-256">Besonderen Dank an</span><span class="sxs-lookup"><span data-stu-id="b39de-256">Special Thanks To</span></span>

<span data-ttu-id="b39de-257">Diese Reihe von Lernprogrammen wurde durch viele nützliche Bearbeiter überprüft.</span><span class="sxs-lookup"><span data-stu-id="b39de-257">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="b39de-258">Lead Prüfer für dieses Lernprogramm wurde Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="b39de-258">Lead reviewer for this tutorial was Teresa Murphy.</span></span> <span data-ttu-id="b39de-259">Meine bevorstehende MSDN-Artikel Überprüfen von Interesse?</span><span class="sxs-lookup"><span data-stu-id="b39de-259">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="b39de-260">Wenn dies der Fall ist, löschen Sie mich zeilenweise [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="b39de-260">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="b39de-261">[Zurück](caching-data-with-the-objectdatasource-vb.md)
> [Weiter](caching-data-at-application-startup-vb.md)</span><span class="sxs-lookup"><span data-stu-id="b39de-261">[Previous](caching-data-with-the-objectdatasource-vb.md)
[Next](caching-data-at-application-startup-vb.md)</span></span>
