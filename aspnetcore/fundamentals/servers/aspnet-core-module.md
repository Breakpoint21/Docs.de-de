---
title: ASP.NET Core-Modul
author: tdykstra
description: "Dieser Artikel führt das ASP.NET Core-Modul (ANCM) ein. Dabei handelt es sich um ein IIS-Modul, mit dem der Kestrel-Webserver IIS oder IIS Express als Reverseproxyserver verwenden kann."
manager: wpickett
ms.author: tdykstra
ms.custom: H1Hack27Feb2017
ms.date: 08/03/2017
ms.prod: asp.net-core
ms.technology: aspnet
ms.topic: article
uid: fundamentals/servers/aspnet-core-module
ms.openlocfilehash: 4337bc42c5454d6a9634a396d9c89f3518af148b
ms.sourcegitcommit: a510f38930abc84c4b302029d019a34dfe76823b
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 01/30/2018
---
# <a name="introduction-to-aspnet-core-module"></a><span data-ttu-id="49c9a-103">Einführung in das ASP.NET Core-Modul</span><span class="sxs-lookup"><span data-stu-id="49c9a-103">Introduction to ASP.NET Core Module</span></span>

<span data-ttu-id="49c9a-104">Von [Tom Dykstra](https://github.com/tdykstra), [Rick Strahl](https://github.com/RickStrahl) und [Chris Ross](https://github.com/Tratcher)</span><span class="sxs-lookup"><span data-stu-id="49c9a-104">By [Tom Dykstra](https://github.com/tdykstra), [Rick Strahl](https://github.com/RickStrahl), and [Chris Ross](https://github.com/Tratcher)</span></span> 

<span data-ttu-id="49c9a-105">Mit dem ASP.NET Core-Modul (ANCM) können Sie ASP.NET Core-Anwendungen hinter IIS ausführen und IIS und [Kestrel](kestrel.md) für das nutzen, wofür sie jeweils gut sind (IIS: Sicherheit, Verwaltbarkeit; Kestrel: Schnelligkeit). Sie erhalten somit die Vorteile von beiden Technologien gleichzeitig.</span><span class="sxs-lookup"><span data-stu-id="49c9a-105">ASP.NET Core Module (ANCM) lets you run ASP.NET Core applications behind IIS, using IIS for what it's good at (security, manageability, and lots more) and using [Kestrel](kestrel.md) for what it's good at (being really fast), and getting the benefits from both technologies at once.</span></span> <span data-ttu-id="49c9a-106">**Das ANCM funktioniert nur mit Kestrel; es ist nicht mit WebListener (in ASP.NET Core 1.x) oder HTTP.sys (in 2.x) kompatibel.**</span><span class="sxs-lookup"><span data-stu-id="49c9a-106">**ANCM works only with Kestrel; it isn't compatible with WebListener (in ASP.NET Core 1.x) or HTTP.sys (in 2.x).**</span></span> 

<span data-ttu-id="49c9a-107">Unterstützte Windows-Versionen:</span><span class="sxs-lookup"><span data-stu-id="49c9a-107">Supported Windows versions:</span></span>

* <span data-ttu-id="49c9a-108">Windows 7 und Windows Server 2008 R2 und höher</span><span class="sxs-lookup"><span data-stu-id="49c9a-108">Windows 7 and Windows Server 2008 R2 and later</span></span>

<span data-ttu-id="49c9a-109">[Anzeigen oder Herunterladen von Beispielcode](https://github.com/aspnet/Docs/tree/master/aspnetcore/fundamentals/servers/aspnet-core-module/sample) ([Vorgehensweise zum Herunterladen](xref:tutorials/index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="49c9a-109">[View or download sample code](https://github.com/aspnet/Docs/tree/master/aspnetcore/fundamentals/servers/aspnet-core-module/sample) ([how to download](xref:tutorials/index#how-to-download-a-sample))</span></span>

## <a name="what-aspnet-core-module-does"></a><span data-ttu-id="49c9a-110">Funktionen vom ASP.NET Core-Modul</span><span class="sxs-lookup"><span data-stu-id="49c9a-110">What ASP.NET Core Module does</span></span>

<span data-ttu-id="49c9a-111">Das ANCM ist ein natives IIS-Modul, das sich in die IIS-Pipeline einklinkt und den Datenverkehr an die Back-End-Anwendung ASP.NET Core leitet.</span><span class="sxs-lookup"><span data-stu-id="49c9a-111">ANCM is a native IIS module that hooks into the IIS pipeline and redirects traffic to the backend ASP.NET Core application.</span></span> <span data-ttu-id="49c9a-112">Die meisten anderen Module, beispielsweise die Windows-Authentifizierung, können immer noch ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="49c9a-112">Most other modules, such as windows authentication, still get a chance to run.</span></span> <span data-ttu-id="49c9a-113">Das ANCM übernimmt nur die Kontrolle, wenn ein Handler für die Anforderung aktiviert und die Handlerzuordnung in der *Web.config*-Datei der Anwendung definiert ist.</span><span class="sxs-lookup"><span data-stu-id="49c9a-113">ANCM only takes control when a handler is selected for the request, and handler mapping is defined in the application *web.config* file.</span></span>

<span data-ttu-id="49c9a-114">Da ASP.NET Core-Anwendungen in einem Prozess getrennt vom IIS-Arbeitsprozess ausgeführt werden, führt das ANCM auch Prozessmanagement durch.</span><span class="sxs-lookup"><span data-stu-id="49c9a-114">Because ASP.NET Core applications run in a process separate from the IIS worker process, ANCM also does process management.</span></span> <span data-ttu-id="49c9a-115">Das ANCM startet den Prozess für die ASP.NET Core-Anwendung, wenn die erste Anforderung eingeht und startet ihn neu, wenn er abstürzt.</span><span class="sxs-lookup"><span data-stu-id="49c9a-115">ANCM starts the process for the ASP.NET Core application when the first request comes in and restarts it when it crashes.</span></span> <span data-ttu-id="49c9a-116">Dies ist im Prinzip das gleiche Verhalten wie in klassischen ASP.NET-Anwendungen, die prozessintern in IIS ausgeführt und durch WAS (Windows Activation Service) verwaltet werden.</span><span class="sxs-lookup"><span data-stu-id="49c9a-116">This is essentially the same behavior as classic ASP.NET applications that run in-process in IIS and are managed by WAS (Windows Activation Service).</span></span>

<span data-ttu-id="49c9a-117">Hier sehen Sie ein Diagramm, das die Beziehung zwischen IIS, ANCM und ASP.NET Core-Anwendungen veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="49c9a-117">Here's a diagram that illustrates the relationship between IIS, ANCM, and ASP.NET Core applications.</span></span>

![ASP.NET Core-Modul](aspnet-core-module/_static/ancm.png)

<span data-ttu-id="49c9a-119">Anforderungen gehen aus dem Internet auf den Kernelmodustreiber Http.Sys ein, der sie in IIS auf dem primären Port (80) oder dem SSL-Port (443) weiterleitet.</span><span class="sxs-lookup"><span data-stu-id="49c9a-119">Requests come in from the Web and hit the kernel mode Http.Sys driver which routes them into IIS on the primary port (80) or SSL port (443).</span></span> <span data-ttu-id="49c9a-120">Das ANCM leitet die Anforderungen an die ASP.NET Core-Anwendung auf dem HTTP-Port weiter, der für die Anwendung konfiguriert ist. Es handelt sich dabei nicht um Port 80/443.</span><span class="sxs-lookup"><span data-stu-id="49c9a-120">ANCM forwards the requests to the ASP.NET Core application on the HTTP port configured for the application, which isn't port 80/443.</span></span>

<span data-ttu-id="49c9a-121">Kestrel hört den Datenverkehr aus dem ANCM ab.</span><span class="sxs-lookup"><span data-stu-id="49c9a-121">Kestrel listens for traffic coming from ANCM.</span></span>  <span data-ttu-id="49c9a-122">Das ANCM gibt den Port über die Umgebungsvariable beim Start an. Die [UseIISIntegration](#call-useiisintegration)-Methode konfiguriert den Server zum Lauschen auf `http://localhost:{port}`.</span><span class="sxs-lookup"><span data-stu-id="49c9a-122">ANCM specifies the port via environment variable at startup, and the [UseIISIntegration](#call-useiisintegration) method configures the server to listen on `http://localhost:{port}`.</span></span> <span data-ttu-id="49c9a-123">Es gibt zusätzliche Überprüfungen, um Anfragen abzulehnen, die nicht vom ANCM kommen.</span><span class="sxs-lookup"><span data-stu-id="49c9a-123">There are additional checks to reject requests not from ANCM.</span></span> <span data-ttu-id="49c9a-124">(Das ANCM unterstützt die HTTPS-Weiterleitung nicht. Deshalb werden Anforderungen über HTTP weitergeleitet, selbst wenn sie von IIS über HTTPS empfangen wurden.)</span><span class="sxs-lookup"><span data-stu-id="49c9a-124">(ANCM doesn't support HTTPS forwarding, so requests are forwarded over HTTP even if received by IIS over HTTPS.)</span></span>

<span data-ttu-id="49c9a-125">Kestrel übernimmt ANCM-Anforderungen und überträgt sie per Push in die Middlewarepipeline von ASP.NET Core. Dort werden sie dann verarbeitet und als `HttpContext`-Instanzen an die Anwendungslogik übergeben.</span><span class="sxs-lookup"><span data-stu-id="49c9a-125">Kestrel picks up requests from ANCM and pushes them into the ASP.NET Core middleware pipeline, which then handles them and passes them on as `HttpContext` instances to application logic.</span></span> <span data-ttu-id="49c9a-126">Die Antworten der Anwendung werden dann an IIS zurückgegeben, wo sie per Push an den HTTP-Client zurückgegeben werden, der die Anforderungen initiiert hat.</span><span class="sxs-lookup"><span data-stu-id="49c9a-126">The application's responses are then passed back to IIS, which pushes them back out to the HTTP client that initiated the requests.</span></span>

<span data-ttu-id="49c9a-127">Das ANCM verfügt auch über einige andere Funktionen:</span><span class="sxs-lookup"><span data-stu-id="49c9a-127">ANCM has a few other functions as well:</span></span>

* <span data-ttu-id="49c9a-128">Legt Umgebungsvariablen fest.</span><span class="sxs-lookup"><span data-stu-id="49c9a-128">Sets environment variables.</span></span>
* <span data-ttu-id="49c9a-129">Protokolliert die `stdout`-Ausgabe im Dateispeicher.</span><span class="sxs-lookup"><span data-stu-id="49c9a-129">Logs `stdout` output to file storage.</span></span>
* <span data-ttu-id="49c9a-130">Leitet Windows-Authentifizierungstoken weiter.</span><span class="sxs-lookup"><span data-stu-id="49c9a-130">Forwards Windows authentication tokens.</span></span>

## <a name="how-to-use-ancm-in-aspnet-core-apps"></a><span data-ttu-id="49c9a-131">Vorgehensweise: Verwenden von ANCM in ASP.NET Core-Anwendungen</span><span class="sxs-lookup"><span data-stu-id="49c9a-131">How to use ANCM in ASP.NET Core apps</span></span>

<span data-ttu-id="49c9a-132">Dieser Abschnitt enthält eine Übersicht über den Prozess zum Einrichten eines IIS-Servers und einer ASP.NET Core-Anwendung.</span><span class="sxs-lookup"><span data-stu-id="49c9a-132">This section provides an overview of the process for setting up an IIS server and ASP.NET Core application.</span></span> <span data-ttu-id="49c9a-133">Ausführliche Anweisungen finden Sie unter [Hosten von ASP.NET Core unter Windows mit IIS](xref:host-and-deploy/iis/index).</span><span class="sxs-lookup"><span data-stu-id="49c9a-133">For detailed instructions, see [Host on Windows with IIS](xref:host-and-deploy/iis/index).</span></span>

### <a name="install-ancm"></a><span data-ttu-id="49c9a-134">Installieren von ANCM</span><span class="sxs-lookup"><span data-stu-id="49c9a-134">Install ANCM</span></span>


<span data-ttu-id="49c9a-135">Das ASP.NET Core-Modul muss in IIS auf Ihren Servern und in IIS Express auf Ihrem Entwicklungscomputer installiert werden.</span><span class="sxs-lookup"><span data-stu-id="49c9a-135">The ASP.NET Core Module has to be installed in IIS on your servers and in IIS Express on your development machines.</span></span> <span data-ttu-id="49c9a-136">Bei Servern ist ANCM im [.NET Core Windows Server Hosting-Paket](https://aka.ms/dotnetcore-2-windowshosting) enthalten.</span><span class="sxs-lookup"><span data-stu-id="49c9a-136">For servers, ANCM is included in the [.NET Core Windows Server Hosting bundle](https://aka.ms/dotnetcore-2-windowshosting).</span></span> <span data-ttu-id="49c9a-137">Bei Entwicklungscomputern installiert Visual Studio ANCM automatisch in IIS Express und IIS, wenn dies bereits auf dem Computer installiert ist.</span><span class="sxs-lookup"><span data-stu-id="49c9a-137">For development machines, Visual Studio automatically installs ANCM in IIS Express, and in IIS if it's already installed on the machine.</span></span>

### <a name="install-the-iisintegration-nuget-package"></a><span data-ttu-id="49c9a-138">Installieren des IISIntegration NuGet-Pakets</span><span class="sxs-lookup"><span data-stu-id="49c9a-138">Install the IISIntegration NuGet package</span></span>

# <a name="aspnet-core-2xtabaspnetcore2x"></a>[<span data-ttu-id="49c9a-139">ASP.NET Core 2.x</span><span class="sxs-lookup"><span data-stu-id="49c9a-139">ASP.NET Core 2.x</span></span>](#tab/aspnetcore2x)

<span data-ttu-id="49c9a-140">Das [Microsoft.AspNetCore.Server.IISIntegration](https://www.nuget.org/packages/Microsoft.AspNetCore.Server.IISIntegration/)-Paket ist in den ASP.NET Core-Metapaketen ([Microsoft.AspNetCore](https://www.nuget.org/packages/Microsoft.AspNetCore/) und [Microsoft.AspNetCore.All](xref:fundamentals/metapackage)) enthalten.</span><span class="sxs-lookup"><span data-stu-id="49c9a-140">The [Microsoft.AspNetCore.Server.IISIntegration](https://www.nuget.org/packages/Microsoft.AspNetCore.Server.IISIntegration/) package is included in the ASP.NET Core metapackages ([Microsoft.AspNetCore](https://www.nuget.org/packages/Microsoft.AspNetCore/) and [Microsoft.AspNetCore.All](xref:fundamentals/metapackage)).</span></span> <span data-ttu-id="49c9a-141">Wenn Sie eines der Metapakete nicht verwenden, installieren Sie `Microsoft.AspNetCore.Server.IISIntegration` getrennt.</span><span class="sxs-lookup"><span data-stu-id="49c9a-141">If you don't use one of the metapackages, install `Microsoft.AspNetCore.Server.IISIntegration` separately.</span></span> <span data-ttu-id="49c9a-142">Das `IISIntegration`-Paket ist ein interoperables Paket, das die Umgebungsvariablen liest, die von ANCM übertragen werden, um Ihre Anwendung einzurichten.</span><span class="sxs-lookup"><span data-stu-id="49c9a-142">The `IISIntegration` package is an interoperability pack that reads environment variables broadcast by ANCM to set up your app.</span></span> <span data-ttu-id="49c9a-143">Die Umgebungsvariablen bieten Konfigurationsinformationen, z.B. den Port, den es abzuhören gilt.</span><span class="sxs-lookup"><span data-stu-id="49c9a-143">The environment variables provide configuration information, such as the port to listen on.</span></span> 

# <a name="aspnet-core-1xtabaspnetcore1x"></a>[<span data-ttu-id="49c9a-144">ASP.NET Core 1.x</span><span class="sxs-lookup"><span data-stu-id="49c9a-144">ASP.NET Core 1.x</span></span>](#tab/aspnetcore1x)

<span data-ttu-id="49c9a-145">Installieren Sie [Microsoft.AspNetCore.Server.IISIntegration](https://www.nuget.org/packages/Microsoft.AspNetCore.Server.IISIntegration/) in Ihrer Anwendung.</span><span class="sxs-lookup"><span data-stu-id="49c9a-145">In your application, install [Microsoft.AspNetCore.Server.IISIntegration](https://www.nuget.org/packages/Microsoft.AspNetCore.Server.IISIntegration/).</span></span> <span data-ttu-id="49c9a-146">Das `IISIntegration`-Paket ist ein interoperables Paket, das die Umgebungsvariablen liest, die von ANCM übertragen werden, um Ihre Anwendung einzurichten.</span><span class="sxs-lookup"><span data-stu-id="49c9a-146">The `IISIntegration` package  is an interoperability pack that reads environment variables broadcast by ANCM to set up your app.</span></span> <span data-ttu-id="49c9a-147">Die Umgebungsvariablen bieten Konfigurationsinformationen, z.B. den Port, den es abzuhören gilt.</span><span class="sxs-lookup"><span data-stu-id="49c9a-147">The environment variables provide configuration information, such as the port to listen on.</span></span> 

---

### <a name="call-useiisintegration"></a><span data-ttu-id="49c9a-148">Aufrufen von UseIISIntegration</span><span class="sxs-lookup"><span data-stu-id="49c9a-148">Call UseIISIntegration</span></span>

# <a name="aspnet-core-2xtabaspnetcore2x"></a>[<span data-ttu-id="49c9a-149">ASP.NET Core 2.x</span><span class="sxs-lookup"><span data-stu-id="49c9a-149">ASP.NET Core 2.x</span></span>](#tab/aspnetcore2x)

<span data-ttu-id="49c9a-150">Die `UseIISIntegration`-Erweiterungsmethode auf [`WebHostBuilder`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.hosting.webhostbuilder) wird automatisch aufgerufen, wenn Sie sie mit IIS ausführen.</span><span class="sxs-lookup"><span data-stu-id="49c9a-150">The `UseIISIntegration` extension method on [`WebHostBuilder`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.hosting.webhostbuilder) is called automatically when you run with IIS.</span></span>

<span data-ttu-id="49c9a-151">Wenn Sie eines der ASP.NET Core-Metapakete nicht verwenden und das `Microsoft.AspNetCore.Server.IISIntegration`-Paket nicht installiert haben, dann erhalten Sie einen Laufzeitfehler.</span><span class="sxs-lookup"><span data-stu-id="49c9a-151">If you aren't using one of the ASP.NET Core metapackages and haven't installed the  `Microsoft.AspNetCore.Server.IISIntegration` package, you get a runtime error.</span></span> <span data-ttu-id="49c9a-152">Beim expliziten Aufrufen von `UseIISIntegration` erhalten Sie einen Kompilierzeitfehler, wenn das Paket nicht installiert ist.</span><span class="sxs-lookup"><span data-stu-id="49c9a-152">If you call `UseIISIntegration` explicitly, you get a compile time error if the package isn't installed.</span></span>

# <a name="aspnet-core-1xtabaspnetcore1x"></a>[<span data-ttu-id="49c9a-153">ASP.NET Core 1.x</span><span class="sxs-lookup"><span data-stu-id="49c9a-153">ASP.NET Core 1.x</span></span>](#tab/aspnetcore1x)

<span data-ttu-id="49c9a-154">Rufen Sie die `UseIISIntegration`-Erweiterungsmethode unter [`WebHostBuilder`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.hosting.webhostbuilder) in der `Main`-Methode Ihrer Anwendung auf.</span><span class="sxs-lookup"><span data-stu-id="49c9a-154">In your application's `Main` method, call the `UseIISIntegration` extension method on [`WebHostBuilder`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.hosting.webhostbuilder).</span></span> 

[!code-csharp[](aspnet-core-module/sample/Program.cs?name=snippet_Main&highlight=12)]

---

<span data-ttu-id="49c9a-155">Die `UseIISIntegration`-Methode sucht nach Umgebungsvariablen, die das ANCM festlegt. Es gibt keinen Vorgang, wenn sie nicht gefunden werden.</span><span class="sxs-lookup"><span data-stu-id="49c9a-155">The `UseIISIntegration` method looks for environment variables that ANCM sets, and it no-ops if they aren't found.</span></span> <span data-ttu-id="49c9a-156">Dieses Verhalten erleichtert Szenarios wie die Entwicklung und Tests auf MacOS oder Linux und die Bereitstellung auf einem Server mit IIS.</span><span class="sxs-lookup"><span data-stu-id="49c9a-156">This behavior facilitates scenarios like developing and testing on macOS or Linux and deploying to a server that runs IIS.</span></span> <span data-ttu-id="49c9a-157">Wenn Kestrel auf MacOS oder Linux ausgeführt wird, verhält es sich wie der Webserver. Wenn die Anwendung aber für die IIS-Umgebung bereitgestellt wird, verwendet sie automatisch ANCM und IIS.</span><span class="sxs-lookup"><span data-stu-id="49c9a-157">While running on macOS or Linux, Kestrel acts as the web server; but when the app is deployed to the IIS environment, it automatically uses ANCM and IIS.</span></span>

### <a name="ancm-port-binding-overrides-other-port-bindings"></a><span data-ttu-id="49c9a-158">Die ANCM-Portbindung überschreibt andere Portbindungen</span><span class="sxs-lookup"><span data-stu-id="49c9a-158">ANCM port binding overrides other port bindings</span></span>

# <a name="aspnet-core-2xtabaspnetcore2x"></a>[<span data-ttu-id="49c9a-159">ASP.NET Core 2.x</span><span class="sxs-lookup"><span data-stu-id="49c9a-159">ASP.NET Core 2.x</span></span>](#tab/aspnetcore2x)

<span data-ttu-id="49c9a-160">ANCM generiert einen dynamischen Port, der dem Back-End-Prozess zugewiesen wird.</span><span class="sxs-lookup"><span data-stu-id="49c9a-160">ANCM generates a dynamic port to assign to the back-end process.</span></span> <span data-ttu-id="49c9a-161">Die `UseIISIntegration`-Methode übernimmt diesen dynamischen Port und konfiguriert Kestrel zum Lauschen von `http://locahost:{dynamicPort}/`.</span><span class="sxs-lookup"><span data-stu-id="49c9a-161">The `UseIISIntegration` method picks up this dynamic port and configures Kestrel to listen on `http://locahost:{dynamicPort}/`.</span></span> <span data-ttu-id="49c9a-162">Dies überschreibt andere URL-Konfigurationen, z.B. Aufrufe von `UseUrls` oder [Kestrels Listen-API](xref:fundamentals/servers/kestrel?tabs=aspnetcore2x#endpoint-configuration).</span><span class="sxs-lookup"><span data-stu-id="49c9a-162">This overrides other URL configurations, such as calls to `UseUrls` or [Kestrel's Listen API](xref:fundamentals/servers/kestrel?tabs=aspnetcore2x#endpoint-configuration).</span></span> <span data-ttu-id="49c9a-163">Aus diesem Grund müssen Sie `UseUrls` oder Kestrels `Listen`-API bei der Verwendung von ANCM nicht aufrufen.</span><span class="sxs-lookup"><span data-stu-id="49c9a-163">Therefore, you don't need to call `UseUrls` or Kestrel's `Listen` API when you use ANCM.</span></span> <span data-ttu-id="49c9a-164">Wenn Sie `UseUrls` oder `Listen` aufrufen, hört Kestrel den Port ab, den Sie angeben, wenn Sie die Anwendung ohne IIS ausführen.</span><span class="sxs-lookup"><span data-stu-id="49c9a-164">If you do call `UseUrls` or `Listen`, Kestrel listens on the port you specify when you run the app without IIS.</span></span>

# <a name="aspnet-core-1xtabaspnetcore1x"></a>[<span data-ttu-id="49c9a-165">ASP.NET Core 1.x</span><span class="sxs-lookup"><span data-stu-id="49c9a-165">ASP.NET Core 1.x</span></span>](#tab/aspnetcore1x)

<span data-ttu-id="49c9a-166">ANCM generiert einen dynamischen Port, der dem Back-End-Prozess zugewiesen wird.</span><span class="sxs-lookup"><span data-stu-id="49c9a-166">ANCM generates a dynamic port to assign to the back-end process.</span></span> <span data-ttu-id="49c9a-167">Die `UseIISIntegration`-Methode übernimmt diesen dynamischen Port und konfiguriert Kestrel zum Lauschen von `http://locahost:{dynamicPort}/`.</span><span class="sxs-lookup"><span data-stu-id="49c9a-167">The `UseIISIntegration` method picks up this dynamic port and configures Kestrel to listen on `http://locahost:{dynamicPort}/`.</span></span> <span data-ttu-id="49c9a-168">Dies überschreibt andere URL-Konfigurationen, z.B. Aufrufe von `UseUrls`.</span><span class="sxs-lookup"><span data-stu-id="49c9a-168">This overrides other URL configurations, such as calls to `UseUrls`.</span></span> <span data-ttu-id="49c9a-169">Aus diesem Grund müssen Sie `UseUrls` bei der Verwendung von ANCM nicht aufrufen.</span><span class="sxs-lookup"><span data-stu-id="49c9a-169">Therefore, you don't need to call `UseUrls` when you use ANCM.</span></span> <span data-ttu-id="49c9a-170">Wenn Sie `UseUrls` aufrufen, hört Kestrel den Port ab, den Sie angeben, wenn Sie die App ohne IIS ausführen.</span><span class="sxs-lookup"><span data-stu-id="49c9a-170">If you do call `UseUrls`, Kestrel listens on the port you specify when you run the app without IIS.</span></span>

<span data-ttu-id="49c9a-171">Wenn Sie in ASP.NET Core 1.0 `UseUrls` aufrufen, dann rufen Sie es auf, **bevor** Sie `UseIISIntegration` aufrufen, damit der von ANCM konfigurierte Port nicht überschrieben wird.</span><span class="sxs-lookup"><span data-stu-id="49c9a-171">In ASP.NET Core 1.0, if you call `UseUrls`, call it **before** you call `UseIISIntegration` so that the ANCM-configured port doesn't get overwritten.</span></span> <span data-ttu-id="49c9a-172">Diese Aufrufreihenfolge ist in ASP.NET Core 1.1 nicht erforderlich, weil die ANCM-Einstellung `UseUrls` überschreibt.</span><span class="sxs-lookup"><span data-stu-id="49c9a-172">This calling order isn't required in ASP.NET Core 1.1, because the ANCM setting overrides `UseUrls`.</span></span>

---

### <a name="configure-ancm-options-in-webconfig"></a><span data-ttu-id="49c9a-173">Konfigurieren von ANCM-Optionen in „Web.config“</span><span class="sxs-lookup"><span data-stu-id="49c9a-173">Configure ANCM options in Web.config</span></span>

<span data-ttu-id="49c9a-174">Die Konfiguration für das ASP.NET Core-Modul ist in der *Web.config*-Datei gespeichert, die sich im Stammordner der Anwendung befindet.</span><span class="sxs-lookup"><span data-stu-id="49c9a-174">Configuration for the ASP.NET Core Module is stored in the *web.config* file that's located in the application's root folder.</span></span> <span data-ttu-id="49c9a-175">Die Einstellungen in dieser Datei zeigen auf den Startbefehl und die Argumente, die Ihre ASP.NET Core-Anwendung starten.</span><span class="sxs-lookup"><span data-stu-id="49c9a-175">Settings in this file point to the startup command and arguments that start your ASP.NET Core app.</span></span> <span data-ttu-id="49c9a-176">Beispiele für *Web.config*-Code und eine Anleitung für Konfigurationsoptionen finden Sie in der [Referenz zur ASP.NET Core-Modulkonfiguration](xref:host-and-deploy/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="49c9a-176">For sample *web.config* code and guidance on configuration options, see [ASP.NET Core Module Configuration Reference](xref:host-and-deploy/aspnet-core-module).</span></span>

### <a name="run-with-iis-express-in-development"></a><span data-ttu-id="49c9a-177">Ausführen mit IIS Express in der Entwicklung</span><span class="sxs-lookup"><span data-stu-id="49c9a-177">Run with IIS Express in development</span></span>

<span data-ttu-id="49c9a-178">IIS Express kann unter Verwendung des durch die ASP.NET Core-Vorlagen definierten Standardprofils von Visual Studio gestartet werden.</span><span class="sxs-lookup"><span data-stu-id="49c9a-178">IIS Express can be launched by Visual Studio using the default profile defined by the ASP.NET Core templates.</span></span>

## <a name="proxy-configuration-uses-http-protocol-and-a-pairing-token"></a><span data-ttu-id="49c9a-179">Die Proxykonfiguration verwendet das HTTP-Protokoll und ein Paarbildungstoken</span><span class="sxs-lookup"><span data-stu-id="49c9a-179">Proxy configuration uses HTTP protocol and a pairing token</span></span>

<span data-ttu-id="49c9a-180">Der Proxy, der zwischen dem ANCM und Kestrel erstellt wurde, verwendet das HTTP-Protokoll.</span><span class="sxs-lookup"><span data-stu-id="49c9a-180">The proxy created between the ANCM and Kestrel uses the HTTP protocol.</span></span> <span data-ttu-id="49c9a-181">Die HTTP-Nutzung ist eine Leistungsoptimierung, bei der der Datenverkehr zwischen dem ANCM und Kestrel in einer Loopbackadresse außerhalb der Netzwerkschnittstelle stattfindet.</span><span class="sxs-lookup"><span data-stu-id="49c9a-181">Using HTTP is a performance optimization where the traffic between the ANCM and Kestrel takes place on a loopback address off of the network interface.</span></span> <span data-ttu-id="49c9a-182">Es gibt kein Risiko für Lauschangriffe auf den Datenverkehr zwischen dem ANCM und Kestrel von einem Speicherort außerhalb des Servers.</span><span class="sxs-lookup"><span data-stu-id="49c9a-182">There's no risk of eavesdropping the traffic between the ANCM and Kestrel from a location off of the server.</span></span>

<span data-ttu-id="49c9a-183">Ein Paarbildungstoken wird verwendet, um sicherzustellen, dass die von Kestrel empfangenen Anfragen von IIS über einen Proxy gesendet wurden und nicht von einer anderen Quelle stammen.</span><span class="sxs-lookup"><span data-stu-id="49c9a-183">A pairing token is used to guarantee that the requests received by Kestrel were proxied by IIS and didn't come from some other source.</span></span> <span data-ttu-id="49c9a-184">Das Paarbildungstoken wurde durch das ANCM erstellt und in einer Umgebungsvariablen (`ASPNETCORE_TOKEN`) festgelegt.</span><span class="sxs-lookup"><span data-stu-id="49c9a-184">The pairing token is created and set into an environment variable (`ASPNETCORE_TOKEN`) by the ANCM.</span></span> <span data-ttu-id="49c9a-185">Das Paarbildungstoken ist auch bei jeder Proxyanforderung in einem Header (`MSAspNetCoreToken`) festgelegt.</span><span class="sxs-lookup"><span data-stu-id="49c9a-185">The pairing token is also set into a header (`MSAspNetCoreToken`) on every proxied request.</span></span> <span data-ttu-id="49c9a-186">IIS-Middleware überprüft jede erhaltene Anforderung, um sicherzustellen, dass der Headerwert des Paarbildungstokens dem Wert der Umgebungsvariablen entspricht.</span><span class="sxs-lookup"><span data-stu-id="49c9a-186">IIS Middleware checks each request it receives to confirm that the pairing token header value matches the environment variable value.</span></span> <span data-ttu-id="49c9a-187">Wenn die Tokenwerte nicht übereinstimmen, wird die Anforderung protokolliert und abgelehnt.</span><span class="sxs-lookup"><span data-stu-id="49c9a-187">If the token values are mismatched, the request is logged and rejected.</span></span> <span data-ttu-id="49c9a-188">Es kann nicht von einem Speicherort außerhalb des Servers auf die Umgebungsvariablen des Paarbildungstokens und den Datenverkehr zwischen dem ANCM und Kestrel zugegriffen werden.</span><span class="sxs-lookup"><span data-stu-id="49c9a-188">The pairing token environment variable and the traffic between the ANCM and Kestrel aren't accessible from a location off of the server.</span></span> <span data-ttu-id="49c9a-189">Wenn ein Angreifer den Wert des Paarbildungstokens nicht kennt, kann er keine Anforderungen einreichen, die die IIS-Middleware-Prüfung umgehen.</span><span class="sxs-lookup"><span data-stu-id="49c9a-189">Without knowing the pairing token value, an attacker can't submit requests that bypass the check in the IIS Middleware.</span></span>

## <a name="next-steps"></a><span data-ttu-id="49c9a-190">Nächste Schritte</span><span class="sxs-lookup"><span data-stu-id="49c9a-190">Next steps</span></span>

<span data-ttu-id="49c9a-191">Weitere Informationen finden Sie in den folgenden Ressourcen:</span><span class="sxs-lookup"><span data-stu-id="49c9a-191">For more information, see the following resources:</span></span>

* [<span data-ttu-id="49c9a-192">Beispiel-App zu diesem Artikel</span><span class="sxs-lookup"><span data-stu-id="49c9a-192">Sample app for this article</span></span>](https://github.com/aspnet/Docs/tree/master/aspnetcore/fundamentals/servers/aspnet-core-module/sample)
* [<span data-ttu-id="49c9a-193">ASP.NET Core-Modulquellcode</span><span class="sxs-lookup"><span data-stu-id="49c9a-193">ASP.NET Core Module source code</span></span>](https://github.com/aspnet/AspNetCoreModule)
* [<span data-ttu-id="49c9a-194">ASP.NET Core-Modulkonfigurationsverweis</span><span class="sxs-lookup"><span data-stu-id="49c9a-194">ASP.NET Core Module Configuration Reference</span></span>](xref:host-and-deploy/aspnet-core-module)
* [<span data-ttu-id="49c9a-195">Hosten unter Windows mit IIS</span><span class="sxs-lookup"><span data-stu-id="49c9a-195">Host on Windows with IIS</span></span>](xref:host-and-deploy/iis/index)
