---
uid: web-forms/overview/security/create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset
title: "Erstellen Sie eine sichere ASP.NET Web Forms-app mit benutzerregistrierung, e-Mail-Bestätigung und das Kennwort zurücksetzen (c#) | Microsoft Docs"
author: Erikre
description: "In diesem Lernprogramm wird gezeigt, wie zum Erstellen einer ASP.NET Web Forms-Apps mit benutzerregistrierung, e-Mail-Bestätigung und das Kennwort zurückzusetzen, verwenden das ASP.NET Identity-Element..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 10/02/2014
ms.topic: article
ms.assetid: 0a8d6044-5fab-4213-82d6-5618d5601358
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/security/create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset
msc.type: authoredcontent
ms.openlocfilehash: ed39295ed1bcaa924336a1faf52049e291abeadb
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/24/2018
---
<a name="create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset-c"></a><span data-ttu-id="4b410-103">Erstellen Sie eine sichere ASP.NET Web Forms-app mit benutzerregistrierung, e-Mail-Bestätigung und das Kennwort zurücksetzen (c#)</span><span class="sxs-lookup"><span data-stu-id="4b410-103">Create a secure ASP.NET Web Forms app with user registration, email confirmation and password reset (C#)</span></span>
====================
<span data-ttu-id="4b410-104">by [Erik Reitan](https://github.com/Erikre)</span><span class="sxs-lookup"><span data-stu-id="4b410-104">by [Erik Reitan](https://github.com/Erikre)</span></span>

> <span data-ttu-id="4b410-105">In diesem Lernprogramm wird gezeigt, wie eine ASP.NET Web Forms-Anwendung mit benutzerregistrierung, e-Mail-Bestätigung und das Kennwort zurückzusetzen, verwenden das Mitgliedschaftssystem ASP.NET Identity zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="4b410-105">This tutorial shows you how to build an ASP.NET Web Forms app with user registration, email confirmation and password reset using the ASP.NET Identity membership system.</span></span> <span data-ttu-id="4b410-106">Dieses Lernprogramm basiert auf andersons [MVC-Lernprogramm](../../../mvc/overview/security/create-an-aspnet-mvc-5-web-app-with-email-confirmation-and-password-reset.md).</span><span class="sxs-lookup"><span data-stu-id="4b410-106">This tutorial was based on Rick Anderson's [MVC tutorial](../../../mvc/overview/security/create-an-aspnet-mvc-5-web-app-with-email-confirmation-and-password-reset.md).</span></span>


## <a name="introduction"></a><span data-ttu-id="4b410-107">Einführung</span><span class="sxs-lookup"><span data-stu-id="4b410-107">Introduction</span></span>

<span data-ttu-id="4b410-108">Dieses Lernprogramm führt Sie durch die erforderlichen Schritte zum Erstellen einer ASP.NET Web Forms-Anwendung mithilfe von Visual Studio und ASP.NET 4.5 zum Erstellen einer sicheren Web Forms-app mit benutzerregistrierung, eine e-Mail-Bestätigung und das Kennwort zurücksetzen.</span><span class="sxs-lookup"><span data-stu-id="4b410-108">This tutorial guides you through the steps required to create an ASP.NET Web Forms application using Visual Studio and ASP.NET 4.5 to create a secure Web Forms app with user registration, email confirmation and password reset.</span></span>

### <a name="tutorial-tasks-and-information"></a><span data-ttu-id="4b410-109">Lernprogramm Aufgaben und Informationen:</span><span class="sxs-lookup"><span data-stu-id="4b410-109">Tutorial Tasks and Information:</span></span>

- [<span data-ttu-id="4b410-110">Erstellen Sie eine ASP.NET Web Forms-Anwendung</span><span class="sxs-lookup"><span data-stu-id="4b410-110">Create an ASP.NET Web Forms app</span></span>](#createWebForms)
- [<span data-ttu-id="4b410-111">Verknüpfen mit SendGrid</span><span class="sxs-lookup"><span data-stu-id="4b410-111">Hook Up SendGrid</span></span>](#SG)
- [<span data-ttu-id="4b410-112">E-Mail-Bestätigung vor dem Anmelden</span><span class="sxs-lookup"><span data-stu-id="4b410-112">Require Email Confirmation Before Log In</span></span>](#require)
- [<span data-ttu-id="4b410-113">Kennwortwiederherstellung und Zurücksetzen</span><span class="sxs-lookup"><span data-stu-id="4b410-113">Password Recovery and Reset</span></span>](#reset)
- [<span data-ttu-id="4b410-114">Senden von e-Mail-Bestätigungslink</span><span class="sxs-lookup"><span data-stu-id="4b410-114">Resend Email Confirmation Link</span></span>](#rsend)
- [<span data-ttu-id="4b410-115">Problembehandlung bei der App</span><span class="sxs-lookup"><span data-stu-id="4b410-115">Troubleshooting the App</span></span>](#dbg)
- <span data-ttu-id="4b410-116">[Additional Resources](#addRes) (Zusätzliche MSBuild-Ressourcen)</span><span class="sxs-lookup"><span data-stu-id="4b410-116">[Additional Resources](#addRes)</span></span>

<a id="createWebForms"></a>
## <a name="create-an-aspnet-web-forms-app"></a><span data-ttu-id="4b410-117">Erstellen einer ASP.NET Web Forms-App</span><span class="sxs-lookup"><span data-stu-id="4b410-117">Create an ASP.NET Web Forms App</span></span>

<span data-ttu-id="4b410-118">Starten, indem Sie installieren und Ausführen von [Visual Studio Express 2013 für Web](https://go.microsoft.com/fwlink/?LinkId=299058) oder [Visual Studio 2013](https://go.microsoft.com/fwlink/?LinkId=306566).</span><span class="sxs-lookup"><span data-stu-id="4b410-118">Start by installing and running [Visual Studio Express 2013 for Web](https://go.microsoft.com/fwlink/?LinkId=299058) or [Visual Studio 2013](https://go.microsoft.com/fwlink/?LinkId=306566).</span></span> <span data-ttu-id="4b410-119">Installieren Sie [Visual Studio 2013 Update 3](https://go.microsoft.com/fwlink/?LinkId=390465) oder höher sowie.</span><span class="sxs-lookup"><span data-stu-id="4b410-119">Install [Visual Studio 2013 Update 3](https://go.microsoft.com/fwlink/?LinkId=390465) or higher as well.</span></span>

> [!NOTE]
> <span data-ttu-id="4b410-120">Warnung: Sie installieren müssen [Visual Studio 2013 Update 3](https://go.microsoft.com/fwlink/?LinkId=390465) oder höher, um dieses Lernprogramm abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="4b410-120">Warning: You must install [Visual Studio 2013 Update 3](https://go.microsoft.com/fwlink/?LinkId=390465) or higher to complete this tutorial.</span></span>


1. <span data-ttu-id="4b410-121">Erstellen eines neuen Projekts (**Datei**  - &gt; **neues Projekt**), und wählen Sie die **ASP.NET-Webanwendung** Vorlage und die aktuelle .NET Framework die Version aus der **neues Projekt** (Dialogfeld).</span><span class="sxs-lookup"><span data-stu-id="4b410-121">Create a new project (**File** -&gt; **New Project**) and select the **ASP.NET Web Application** template and the latest .NET Framework version from the **New Project** dialog box.</span></span>
2. <span data-ttu-id="4b410-122">Aus der **neues ASP.NET-Projekt** wählen Sie im Dialogfeld die **Web Forms** Vorlage.</span><span class="sxs-lookup"><span data-stu-id="4b410-122">From the **New ASP.NET Project** dialog box, select the **Web Forms** template.</span></span> <span data-ttu-id="4b410-123">Lassen Sie die Standardauthentifizierung als **einzelne Benutzerkonten**.</span><span class="sxs-lookup"><span data-stu-id="4b410-123">Leave the default authentication as **Individual User Accounts**.</span></span> <span data-ttu-id="4b410-124">Wenn Sie die app in Azure hosten möchten, lassen Sie die **Host in der Cloud** Kontrollkästchen aktiviert.</span><span class="sxs-lookup"><span data-stu-id="4b410-124">If you'd like to host the app in Azure, leave the **Host in the cloud** check box checked.</span></span>   
 <span data-ttu-id="4b410-125">Klicken Sie auf **OK** zum Erstellen eines neuen Projekts.</span><span class="sxs-lookup"><span data-stu-id="4b410-125">Then, click **OK** to create the new project.</span></span>  
    <span data-ttu-id="4b410-126">![Neues ASP.NET-Projekt (Dialogfeld)](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="4b410-126">![New ASP.NET Project dialog box](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/_static/image1.png)</span></span>
3. <span data-ttu-id="4b410-127">Aktivieren Sie Secure Sockets Layer (SSL) für das Projekt ein.</span><span class="sxs-lookup"><span data-stu-id="4b410-127">Enable Secure Sockets Layer (SSL) for the project.</span></span> <span data-ttu-id="4b410-128">Führen Sie die Schritte zur Verfügung, in der **"SSL aktivieren", für das Projekt** Teil der [erste Schritte mit Web Forms Reihe von Lernprogrammen](../getting-started/getting-started-with-aspnet-45-web-forms/checkout-and-payment-with-paypal.md#SSLWebForms).</span><span class="sxs-lookup"><span data-stu-id="4b410-128">Follow the steps available in the **Enable SSL for the Project** section of the [Getting Started with Web Forms tutorial series](../getting-started/getting-started-with-aspnet-45-web-forms/checkout-and-payment-with-paypal.md#SSLWebForms).</span></span>
4. <span data-ttu-id="4b410-129">Führen Sie die app, klicken Sie auf die **registrieren** verknüpfen und einen neuen Benutzer registrieren.</span><span class="sxs-lookup"><span data-stu-id="4b410-129">Run the app, click the **Register** link and register a new user.</span></span> <span data-ttu-id="4b410-130">Die ausschließliche Überprüfung auf die e-Mail-Adresse zu diesem Zeitpunkt basiert auf der [[EmailAddress]](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.emailaddressattribute(v=vs.110).aspx) Attribut, um sicherzustellen, dass die e-Mail-Adresse wohlgeformt ist.</span><span class="sxs-lookup"><span data-stu-id="4b410-130">At this point, the only validation on the email is based on the [[EmailAddress]](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.emailaddressattribute(v=vs.110).aspx) attribute to ensure the email address is well-formed.</span></span> <span data-ttu-id="4b410-131">Ändern Sie den Code zum Hinzufügen von e-Mail-Bestätigung.</span><span class="sxs-lookup"><span data-stu-id="4b410-131">You will modify the code to add email confirmation.</span></span> <span data-ttu-id="4b410-132">Schließen Sie das Browserfenster.</span><span class="sxs-lookup"><span data-stu-id="4b410-132">Close the browser window.</span></span>
5. <span data-ttu-id="4b410-133">In **Server-Explorer** von Visual Studio (**Ansicht**  - &gt; **Server-Explorer**), navigieren Sie zu **Daten Connections\ DefaultConnection\Tables\AspNetUsers**, mit der rechten Maustaste, und wählen Sie **Tabellendefinition öffnen**.</span><span class="sxs-lookup"><span data-stu-id="4b410-133">In **Server Explorer** of Visual Studio (**View** -&gt; **Server Explorer**), navigate to **Data Connections\DefaultConnection\Tables\AspNetUsers**, right click and select **Open table definition**.</span></span> 

    <span data-ttu-id="4b410-134">Die folgende Abbildung zeigt die `AspNetUsers` Tabellenschema:</span><span class="sxs-lookup"><span data-stu-id="4b410-134">The following image shows the `AspNetUsers` table schema:</span></span>

    ![AspNetUsers Tabellenschema](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/_static/image2.png)
6. <span data-ttu-id="4b410-136">In **Server-Explorer**, mit der rechten Maustaste auf die **AspNetUsers** Tabelle, und wählen Sie **Tabellendaten anzeigen**.</span><span class="sxs-lookup"><span data-stu-id="4b410-136">In **Server Explorer**, right-click on the **AspNetUsers** table and select **Show Table Data**.</span></span>  
  
    ![Tabellendaten AspNetUsers](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/_static/image3.png)  
 <span data-ttu-id="4b410-138">Die e-Mail für den registrierten Benutzer hat zu diesem Zeitpunkt nicht bestätigt.</span><span class="sxs-lookup"><span data-stu-id="4b410-138">At this point the email for the registered user has not been confirmed.</span></span>
7. <span data-ttu-id="4b410-139">Klicken Sie auf die Zeile, und wählen Sie zum Löschen des Benutzers aus.</span><span class="sxs-lookup"><span data-stu-id="4b410-139">Click on the row and select delete to delete the user.</span></span> <span data-ttu-id="4b410-140">Sie fügen diese e-Mail erneut im nächsten Schritt hinzu und eine Bestätigungsnachricht an die e-Mail-Adresse senden.</span><span class="sxs-lookup"><span data-stu-id="4b410-140">You'll add this email again in the next step and send a confirmation message to the email address.</span></span>

## <a name="email-confirmation"></a><span data-ttu-id="4b410-141">E-Mail-Bestätigung</span><span class="sxs-lookup"><span data-stu-id="4b410-141">Email Confirmation</span></span>

<span data-ttu-id="4b410-142">Es wird empfohlen, die e-Mail-Adresse während der Registrierung eines neuen Benutzers zu überprüfen, sind sie nicht eine andere Person Identität zu bestätigen (d. h., sie noch nicht registriert mit einer anderen Person e-Mail-Adresse).</span><span class="sxs-lookup"><span data-stu-id="4b410-142">It's a best practice to confirm the email during the registration of a new user to verify they are not impersonating someone else (that is, they haven't registered with someone else's email).</span></span> <span data-ttu-id="4b410-143">Angenommen, Sie ein Diskussionsforum hatten, Sie möchten verhindern `"bob@cpandl.com"` aus der Registrierung als `"joe@contoso.com"`.</span><span class="sxs-lookup"><span data-stu-id="4b410-143">Suppose you had a discussion forum, you would want to prevent `"bob@cpandl.com"` from registering as `"joe@contoso.com"`.</span></span> <span data-ttu-id="4b410-144">Ohne e-Mail-Bestätigung `"joe@contoso.com"` konnten unerwünschte e-Mails von Ihrer app abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="4b410-144">Without email confirmation, `"joe@contoso.com"` could get unwanted email from your app.</span></span> <span data-ttu-id="4b410-145">Angenommen, Bob versehentlich als registriert `"bib@cpandl.com"` und hadn't bemerkt, er wäre kennwortwiederherstellung verwenden, da die app hat seine richtige e-Mail-Nachricht nicht.</span><span class="sxs-lookup"><span data-stu-id="4b410-145">Suppose Bob accidently registered as `"bib@cpandl.com"` and hadn't noticed it, he wouldn't be able to use password recovery because the app doesn't have his correct email.</span></span> <span data-ttu-id="4b410-146">E-Mail-Bestätigung enthält nur begrenzt Schutz von Bots und stellt keinen Schutz vor Spammern bestimmt.</span><span class="sxs-lookup"><span data-stu-id="4b410-146">Email confirmation provides only limited protection from bots and doesn't provide protection from determined spammers.</span></span>

<span data-ttu-id="4b410-147">In der Regel möchten verhindern, dass neue Benutzer keine Daten zu Ihrer Website bereitstellen, bevor sie von einer e-Mail, eine SMS oder einen anderen Mechanismus bestätigt wurden.</span><span class="sxs-lookup"><span data-stu-id="4b410-147">You generally want to prevent new users from posting any data to your website before they have been confirmed by either email, an SMS text message or another mechanism.</span></span> <span data-ttu-id="4b410-148">In den folgenden Abschnitten wird e-Mail-Bestätigung aktivieren und ändern Sie den Code, um zu verhindern, dass neu registrierte Benutzer anmelden, bis ihre e-Mails bestätigt wurde.</span><span class="sxs-lookup"><span data-stu-id="4b410-148">In the sections below, we will enable email confirmation and modify the code to prevent newly registered users from logging in until their email has been confirmed.</span></span> <span data-ttu-id="4b410-149">In diesem Lernprogramm verwenden Sie die e-Mail-Dienst SendGrid.</span><span class="sxs-lookup"><span data-stu-id="4b410-149">You'll use the email service SendGrid in this tutorial.</span></span>

<a id="SG"></a>
## <a name="hook-up-sendgrid"></a><span data-ttu-id="4b410-150">Verknüpfen mit SendGrid</span><span class="sxs-lookup"><span data-stu-id="4b410-150">Hook up SendGrid</span></span>

<span data-ttu-id="4b410-151">Obwohl dieses Lernprogramm zeigt nur zum Hinzufügen von e-Mail-Benachrichtigung über [SendGrid](http://sendgrid.com/), können Sie e-Mail-Nachrichten mithilfe von SMTP und andere Mechanismen senden (finden Sie unter [zusätzliche Ressourcen](#addRes)).</span><span class="sxs-lookup"><span data-stu-id="4b410-151">Although this tutorial only shows how to add email notification through [SendGrid](http://sendgrid.com/), you can send email using SMTP and other mechanisms (see [additional resources](#addRes)).</span></span>

1. <span data-ttu-id="4b410-152">Öffnen Sie in Visual Studio die **Package Manager Console** (**Tools**  - &gt; **NuGet-Paket-Manager**  - &gt; **Package Manager Console**), und geben Sie den folgenden Befehl aus:</span><span class="sxs-lookup"><span data-stu-id="4b410-152">In Visual Studio, open the **Package Manager Console** (**Tools** -&gt; **NuGet Package Manger** -&gt; **Package Manager Console**), and enter the following command:</span></span>  
    `Install-Package SendGrid`
2. <span data-ttu-id="4b410-153">Wechseln Sie zu der [Azure SendGrid-Registrierungsseite](https://azure.microsoft.com/gallery/store/sendgrid/sendgrid-azure/) und kostenlos SendGrid-Konto registrieren.</span><span class="sxs-lookup"><span data-stu-id="4b410-153">Go to the [Azure SendGrid sign-up page](https://azure.microsoft.com/gallery/store/sendgrid/sendgrid-azure/) and register for free SendGrid account.</span></span> <span data-ttu-id="4b410-154">Sie können auch registrieren Sie sich für ein kostenloses SendGrid-Konto direkt auf [SendGrids-Website](http://www.sendgrid.com).</span><span class="sxs-lookup"><span data-stu-id="4b410-154">You can also sign-up for a free SendGrid account directly on [SendGrid's site](http://www.sendgrid.com).</span></span>
3. <span data-ttu-id="4b410-155">Aus **Projektmappen-Explorer** öffnen Sie die *IdentityConfig.cs* in der Datei die *App\_starten* Ordner, und fügen Sie folgenden Code, um die gelbhervorgehoben`EmailService` Klasse so konfigurieren Sie **SendGrid**:</span><span class="sxs-lookup"><span data-stu-id="4b410-155">From **Solution Explorer** open the *IdentityConfig.cs* file in the *App\_Start* folder and add the following code highlighted in yellow to the `EmailService` class to configure **SendGrid**:</span></span>

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample1.cs?highlight=3,5,8-37)]
4. <span data-ttu-id="4b410-156">Darüber hinaus fügen Sie die folgenden `using` Anweisungen am Anfang der *IdentityConfig.cs* Datei:</span><span class="sxs-lookup"><span data-stu-id="4b410-156">Also, add the following `using` statements to the beginning of the *IdentityConfig.cs* file:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample2.cs?highlight=1-4)]
5. <span data-ttu-id="4b410-157">Um dieses Beispiel einfach zu halten, speichern Sie die e-Mail-Dienst-Kontowerte in der `appSettings` Teil der *"Web.config"* Datei.</span><span class="sxs-lookup"><span data-stu-id="4b410-157">To keep this sample simple, you'll store the email service account values in the `appSettings` section of the *web.config* file.</span></span> <span data-ttu-id="4b410-158">Fügen Sie die folgenden XML-Code in gelb hervorgehoben werden die *"Web.config"* Datei im Stammverzeichnis des Projekts:</span><span class="sxs-lookup"><span data-stu-id="4b410-158">Add the following XML highlighted in yellow to the *web.config* file at the root of your project:</span></span>

    [!code-xml[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample3.xml?highlight=2-5)]

    > [!WARNING]
    > <span data-ttu-id="4b410-159">Sicherheit – sensible Daten nie im Quellcode speichern.</span><span class="sxs-lookup"><span data-stu-id="4b410-159">Security - Never store sensitive data in your source code.</span></span> <span data-ttu-id="4b410-160">In diesem Beispiel wird das Konto und die Anmeldeinformationen werden gespeichert der **AppSetting** Teil der *"Web.config"* Datei.</span><span class="sxs-lookup"><span data-stu-id="4b410-160">In this example, the account and credentials are stored in the **appSetting** section of the *Web.config* file.</span></span> <span data-ttu-id="4b410-161">Sie können auf Azure sicher diese Werte speichern, auf die  **[konfigurieren](https://blogs.msdn.com/b/webdev/archive/2014/06/04/queuebackgroundworkitem-to-reliably-schedule-and-run-long-background-process-in-asp-net.aspx)**  Registerkarte im Azure-Portal.</span><span class="sxs-lookup"><span data-stu-id="4b410-161">On Azure, you can securely store these values on the **[Configure](https://blogs.msdn.com/b/webdev/archive/2014/06/04/queuebackgroundworkitem-to-reliably-schedule-and-run-long-background-process-in-asp-net.aspx)** tab in the Azure portal.</span></span> <span data-ttu-id="4b410-162">Weitere Informationen finden Sie im Thema andersons [bewährte Methoden für die Bereitstellung von Kennwörtern und andere sensible Daten für ASP.NET und Azure](https://go.microsoft.com/fwlink/?LinkId=513141).</span><span class="sxs-lookup"><span data-stu-id="4b410-162">For related information see Rick Anderson's topic titled [Best practices for deploying passwords and other sensitive data to ASP.NET and Azure](https://go.microsoft.com/fwlink/?LinkId=513141).</span></span>
6. <span data-ttu-id="4b410-163">Fügen Sie die e-Mail-Dienst-Werte, um widerzuspiegeln, dass die Werte der SendGrid-Authentifizierung (Benutzername und Kennwort), damit Sie erfolgreich können Ihre app Senden von e-Mails von.</span><span class="sxs-lookup"><span data-stu-id="4b410-163">Add the email service values to reflect your SendGrid authentication values (User Name and Password) so that you can successful send email from your app.</span></span> <span data-ttu-id="4b410-164">Achten Sie darauf, dass Sie Ihren SendGrid-Kontonamen statt auf die e-Mail-Adresse angegebene SendGrid verwenden.</span><span class="sxs-lookup"><span data-stu-id="4b410-164">Be sure to use your SendGrid account name rather than the email address you provided SendGrid.</span></span>

### <a name="enable-email-confirmation"></a><span data-ttu-id="4b410-165">Aktivieren von e-Mail-Bestätigung</span><span class="sxs-lookup"><span data-stu-id="4b410-165">Enable Email Confirmation</span></span>

 <span data-ttu-id="4b410-166">Um e-Mail-Bestätigung zu aktivieren, müssen Sie den Registrierungscode, der mithilfe der folgenden Schritte ändern.</span><span class="sxs-lookup"><span data-stu-id="4b410-166">To enable email confirmation, you'll modify the registration code using the following steps.</span></span>  
 

1. <span data-ttu-id="4b410-167">In der *Konto* Ordner die *Register.aspx.cs* CodeBehind und aktualisieren Sie die `CreateUser_Click` Methode, um die folgenden hervorgehobenen Änderungen zu aktivieren:</span><span class="sxs-lookup"><span data-stu-id="4b410-167">In the *Account* folder, open the *Register.aspx.cs* code-behind and update the `CreateUser_Click` method to enable the following highlighted changes:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample4.cs?highlight=9-11)]
2. <span data-ttu-id="4b410-168">In **Projektmappen-Explorer**, mit der rechten Maustaste *"default.aspx"* , und wählen Sie **als Startseite festlegen**.</span><span class="sxs-lookup"><span data-stu-id="4b410-168">In **Solution Explorer**, right-click *Default.aspx* and select **Set As Start Page**.</span></span>
3. <span data-ttu-id="4b410-169">Führen Sie die app durch Drücken von **F5.**</span><span class="sxs-lookup"><span data-stu-id="4b410-169">Run the app by pressing **F5.**</span></span> <span data-ttu-id="4b410-170">Nachdem die Seite angezeigt wird, klicken Sie auf die **registrieren** Link, um die Seite "Register" anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="4b410-170">After the page is displayed, click the **Register** link to display the Register page.</span></span>
4. <span data-ttu-id="4b410-171">Geben Sie Ihre e-Mail- und das Kennwort, und klicken Sie auf die **registrieren** Schaltfläche zum Senden einer e-Mail-Nachricht über SendGrid.</span><span class="sxs-lookup"><span data-stu-id="4b410-171">Enter your email and password, then click the **Register** button to send an email message via SendGrid.</span></span>  
 <span data-ttu-id="4b410-172">Der aktuelle Status des Projekts und Code ermöglicht dem Benutzer anmelden, nachdem sie das Registrierungsformular abgeschlossen, obwohl sie ihrem Konto bestätigt dies nicht getan haben.</span><span class="sxs-lookup"><span data-stu-id="4b410-172">The current state of your project and code will allow the user to log in once they complete the registration form, even though they haven't confirmed their account.</span></span>
5. <span data-ttu-id="4b410-173">Überprüfen Sie Ihr e-Mail-Konto, und klicken Sie auf den Link, um Ihre e-Mail-Adresse zu bestätigen.</span><span class="sxs-lookup"><span data-stu-id="4b410-173">Check your email account and click on the link to confirm your email.</span></span>  
 <span data-ttu-id="4b410-174">Nachdem Sie das Registrierungsformular senden, werden Sie angemeldet werden.</span><span class="sxs-lookup"><span data-stu-id="4b410-174">Once you submit the registration form, you will be logged in.</span></span>  
    ![Beispiel-Website - angemeldet](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/_static/image4.png)

<a id="require"></a>
## <a name="require-email-confirmation-before-log-in"></a><span data-ttu-id="4b410-176">E-Mail-Bestätigung vor dem Anmelden</span><span class="sxs-lookup"><span data-stu-id="4b410-176">Require Email Confirmation Before Log In</span></span>

<span data-ttu-id="4b410-177">Obwohl Sie das e-Mail-Konto bestätigt haben, würden an diesem Punkt müssen nicht auf klicken auf den Link, den Sie in der e-Mail zur Überprüfung um vollständig angemeldet werden.</span><span class="sxs-lookup"><span data-stu-id="4b410-177">Although you have confirmed the email account, at this point you would not need to click on the link contained in the verification email to be fully signed-in.</span></span> <span data-ttu-id="4b410-178">Im folgenden Abschnitt ändern Sie den Code, der neue Benutzer um eine bestätigte e-Mail-Adresse zu erhalten, bevor sie angemeldet sind (authentifiziert).</span><span class="sxs-lookup"><span data-stu-id="4b410-178">In the following section, you will modify the code requiring new users to have a confirmed email before they are logged in (authenticated).</span></span>

1. <span data-ttu-id="4b410-179">In **Projektmappen-Explorer** von Visual Studio aktualisiert die `CreateUser_Click` Ereignis in der *Register.aspx.cs* Code-Behind in enthaltenen der *Konten* Ordner mit der folgende hervorgehobene Änderungen vor:</span><span class="sxs-lookup"><span data-stu-id="4b410-179">In **Solution Explorer** of Visual Studio, update the `CreateUser_Click` event in the *Register.aspx.cs* code-behind contained in the *Accounts* folder with the following highlighted changes:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample5.cs?highlight=13-14,17-21)]
2. <span data-ttu-id="4b410-180">Update der `LogIn` Methode in der *Login.aspx.cs* CodeBehind mit den folgenden hervorgehobenen Änderungen:</span><span class="sxs-lookup"><span data-stu-id="4b410-180">Update the `LogIn` method in the *Login.aspx.cs* code-behind with the following highlighted changes:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample6.cs?highlight=9-19,45-46)]

### <a name="run-the-application"></a><span data-ttu-id="4b410-181">Ausführen der Anwendung</span><span class="sxs-lookup"><span data-stu-id="4b410-181">Run the Application</span></span>

 <span data-ttu-id="4b410-182">Nun, dass Sie den Code, um zu überprüfen, ob die e-Mail-Adresse des Benutzers bestätigt wurde implementiert haben, sehen Sie die Funktionalität sowohl die **registrieren** und **Anmeldung** Seiten.</span><span class="sxs-lookup"><span data-stu-id="4b410-182">Now that you have implemented the code to check whether a user's email address has been confirmed, you can check the functionality on both the **Register** and **Login** pages.</span></span> 

1. <span data-ttu-id="4b410-183">Löschen Sie alle Konten in der **AspNetUsers** Tabelle, die den e-Mail-Alias enthalten, Sie testen möchten.</span><span class="sxs-lookup"><span data-stu-id="4b410-183">Delete any accounts in the **AspNetUsers** table that contain the email alias you wish to test.</span></span>
2. <span data-ttu-id="4b410-184">Führen Sie die app (**F5**) und überprüfen Sie, ob Sie können nicht als ein Benutzer registrieren, wenn Sie Ihre e-Mail-Adresse bestätigt haben.</span><span class="sxs-lookup"><span data-stu-id="4b410-184">Run the app (**F5**) and verify you cannot register as a user until you have confirmed your email address.</span></span>
3. <span data-ttu-id="4b410-185">Vor dem bestätigen Ihr neuen Kontos über die e-Mail-Adresse, die gerade übermittelt wurde, versuchen Sie, sich mit dem neuen Konto anzumelden.</span><span class="sxs-lookup"><span data-stu-id="4b410-185">Before confirming your new account via the email that was just sent, attempt to log in with the new account.</span></span>  
 <span data-ttu-id="4b410-186">Sie sehen, dass Sie nicht anmelden können, und dass Sie ein bestätigte e-Mail-Konto benötigen.</span><span class="sxs-lookup"><span data-stu-id="4b410-186">You'll see that you are unable to log in and that you must have a confirmed email account.</span></span>
4. <span data-ttu-id="4b410-187">Nachdem Sie Ihre e-Mail-Adresse bestätigt haben, melden Sie sich an die app.</span><span class="sxs-lookup"><span data-stu-id="4b410-187">Once you confirm your email address, log in to the app.</span></span>

<a id="reset"></a>
## <a name="password-recovery-and-reset"></a><span data-ttu-id="4b410-188">Kennwortwiederherstellung und Zurücksetzen</span><span class="sxs-lookup"><span data-stu-id="4b410-188">Password Recovery and Reset</span></span>

1. <span data-ttu-id="4b410-189">In Visual Studio, entfernen Sie die Kommentarzeichen aus der `Forgot` Methode in der *Forgot.aspx.cs* Code-Behind in enthaltenen der *Konto* Ordner, damit die Methode angezeigt wird, wie folgt:</span><span class="sxs-lookup"><span data-stu-id="4b410-189">In Visual Studio, remove the comment characters from the `Forgot` method in the *Forgot.aspx.cs* code-behind contained in the *Account* folder, so that the method appears as follows:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample7.cs?highlight=16-18)]
2. <span data-ttu-id="4b410-190">Öffnen der *"Login.aspx"* Seite.</span><span class="sxs-lookup"><span data-stu-id="4b410-190">Open the *Login.aspx* page.</span></span> <span data-ttu-id="4b410-191">Ersetzen Sie das Markup gegen Ende der **LoginForm** Abschnitt wie unten markiert:</span><span class="sxs-lookup"><span data-stu-id="4b410-191">Replace the markup near the end of the **loginForm** section as highlighted below:</span></span> 

    [!code-aspx[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample8.aspx?highlight=52-53)]
3. <span data-ttu-id="4b410-192">Öffnen der *Login.aspx.cs* CodeBehind und kommentieren Sie die folgende Codezeile in gelb hervorgehoben der `Page_Load` Ereignishandler:</span><span class="sxs-lookup"><span data-stu-id="4b410-192">Open the *Login.aspx.cs* code-behind and uncomment the following line of code highlighted in yellow from the `Page_Load` event handler:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample9.cs?highlight=5)]
4. <span data-ttu-id="4b410-193">Führen Sie die app durch Drücken von **F5.**</span><span class="sxs-lookup"><span data-stu-id="4b410-193">Run the app by pressing **F5.**</span></span> <span data-ttu-id="4b410-194">Nachdem die Seite angezeigt wird, klicken Sie auf die **melden Sie sich** Link.</span><span class="sxs-lookup"><span data-stu-id="4b410-194">After the page is displayed, click the **Log in** link.</span></span>
5. <span data-ttu-id="4b410-195">Klicken Sie auf die **haben Sie Ihr Kennwort vergessen?** Link zum Anzeigen der **"Kennwort vergessen"** Seite.</span><span class="sxs-lookup"><span data-stu-id="4b410-195">Click the **Forgot your password?** link to display the **Forgot Password** page.</span></span>
6. <span data-ttu-id="4b410-196">Geben Sie Ihre e-Mail-Adresse ein, und klicken Sie auf die **Absenden** Schaltfläche, um eine e-Mail an Ihre Adresse senden, dem Sie Ihr Kennwort zurücksetzen können.</span><span class="sxs-lookup"><span data-stu-id="4b410-196">Enter your email address and click the **Submit** button to send an email to your address which will allow you to reset your password.</span></span>   
 <span data-ttu-id="4b410-197">Überprüfen Sie Ihr e-Mail-Konto, und klicken Sie auf den Link zum Anzeigen der **Kennwort zurücksetzen** Seite.</span><span class="sxs-lookup"><span data-stu-id="4b410-197">Check your email account and click on the link to display the **Reset Password** page.</span></span>
7. <span data-ttu-id="4b410-198">Auf der **Kennwort zurücksetzen** geben Ihre e-Mail, Kennwort und bestätigte Kennwort.</span><span class="sxs-lookup"><span data-stu-id="4b410-198">On the **Reset Password** page, enter your email, password, and confirmed password.</span></span> <span data-ttu-id="4b410-199">Drücken Sie anschließend die **zurücksetzen** Schaltfläche.</span><span class="sxs-lookup"><span data-stu-id="4b410-199">Then, press the **Reset** button.</span></span>  
 <span data-ttu-id="4b410-200">Wenn Sie Ihr Kennwort erfolgreich Zurücksetzen der **Kennwort geändert** Seite wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="4b410-200">When you successfully reset your password, the **Password Changed** page will be displayed.</span></span> <span data-ttu-id="4b410-201">Nun können Sie sich mit Ihrem neuen Kennwort anmelden.</span><span class="sxs-lookup"><span data-stu-id="4b410-201">Now you can log in with your new password.</span></span>

<a id="rsend"></a>
## <a name="resend-email-confirmation-link"></a><span data-ttu-id="4b410-202">Senden von e-Mail-Bestätigungslink</span><span class="sxs-lookup"><span data-stu-id="4b410-202">Resend Email Confirmation Link</span></span>

<span data-ttu-id="4b410-203">Sobald ein Benutzer ein neues lokales Konto erstellt, werden sie einen Link zur Bestätigung per e-Mail gesendet, den sie für erforderlich sind, verwenden, bevor sie sich anmelden können.</span><span class="sxs-lookup"><span data-stu-id="4b410-203">Once a user creates a new local account, they are emailed a confirmation link they are required to use before they can log on.</span></span> <span data-ttu-id="4b410-204">Wenn der Benutzer versehentlich der e-Mail zur kaufbestätigung löscht oder die e-Mail-Adresse nie eingeht, benötigen sie den Link zur Bestätigung erneut gesendet.</span><span class="sxs-lookup"><span data-stu-id="4b410-204">If the user accidently deletes the confirmation email, or the email never arrives, they will need the confirmation link sent again.</span></span> <span data-ttu-id="4b410-205">Die folgenden codeänderungen zeigen, wie dies zu ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="4b410-205">The following code changes show how to enable this.</span></span>

1. <span data-ttu-id="4b410-206">Öffnen Sie in Visual Studio die **Login.aspx.cs** CodeBehind und fügen Sie den folgenden Ereignishandler nach der `LogIn` Ereignishandler:</span><span class="sxs-lookup"><span data-stu-id="4b410-206">In Visual Studio, open the **Login.aspx.cs** code-behind and add the following event handler after the `LogIn` event handler:</span></span>   

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample10.cs)]
2. <span data-ttu-id="4b410-207">Ändern der `LogIn` -Ereignishandler in der *Login.aspx.cs* CodeBehind durch Ändern des Codes in gelb hervorgehoben werden wie folgt:</span><span class="sxs-lookup"><span data-stu-id="4b410-207">Modify the `LogIn` event handler in the *Login.aspx.cs* code-behind by changing the code highlighted in yellow as follows:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample11.cs?highlight=15-17)]
3. <span data-ttu-id="4b410-208">Update der *"Login.aspx"* Seite durch Hinzufügen des Codes in gelb hervorgehoben werden wie folgt:</span><span class="sxs-lookup"><span data-stu-id="4b410-208">Update the *Login.aspx* page by adding the code highlighted in yellow as follows:</span></span> 

    [!code-aspx[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample12.aspx?highlight=45-46)]
4. <span data-ttu-id="4b410-209">Löschen Sie alle Konten in der **AspNetUsers** Tabelle, die den e-Mail-Alias enthalten, Sie testen möchten.</span><span class="sxs-lookup"><span data-stu-id="4b410-209">Delete any accounts in the **AspNetUsers** table that contain the email alias you wish to test.</span></span>
5. <span data-ttu-id="4b410-210">Führen Sie die app (**F5**), und registrieren Sie Ihre e-Mail-Adresse.</span><span class="sxs-lookup"><span data-stu-id="4b410-210">Run the app (**F5**) and register your email address.</span></span>
6. <span data-ttu-id="4b410-211">Vor dem bestätigen Ihr neuen Kontos über die e-Mail-Adresse, die gerade übermittelt wurde, versuchen Sie, sich mit dem neuen Konto anzumelden.</span><span class="sxs-lookup"><span data-stu-id="4b410-211">Before confirming your new account via the email that was just sent, attempt to log in with the new account.</span></span>  
 <span data-ttu-id="4b410-212">Sie sehen, dass Sie nicht anmelden können, und dass Sie ein bestätigte e-Mail-Konto benötigen.</span><span class="sxs-lookup"><span data-stu-id="4b410-212">You'll see that you are unable to log in and that you must have a confirmed email account.</span></span> <span data-ttu-id="4b410-213">Darüber hinaus können Sie jetzt eine bestätigungsmeldung an Ihrem e-Mail-Konto erneut senden.</span><span class="sxs-lookup"><span data-stu-id="4b410-213">In addition, you can now resend a confirmation message to your email account.</span></span>
7. <span data-ttu-id="4b410-214">Geben Sie Ihre e-Mail-Adresse und das Kennwort ein, drücken Sie dann die **Bestätigung senden** Schaltfläche.</span><span class="sxs-lookup"><span data-stu-id="4b410-214">Enter your email address and password, then press the **Resend confirmation** button.</span></span>
8. <span data-ttu-id="4b410-215">Nachdem Sie Ihre e-Mail-Adresse auf Grundlage der neu gesendeten e-Mail-Nachricht bestätigt haben, melden Sie sich an die app.</span><span class="sxs-lookup"><span data-stu-id="4b410-215">Once you confirm your email address based on the newly sent email message, log in to the app.</span></span>

<a id="dbg"></a>
## <a name="troubleshooting-the-app"></a><span data-ttu-id="4b410-216">Problembehandlung bei der App</span><span class="sxs-lookup"><span data-stu-id="4b410-216">Troubleshooting the App</span></span>

<span data-ttu-id="4b410-217">Wenn Sie eine e-Mail mit den Link, um Ihre Anmeldeinformationen überprüfen nicht erhalten:</span><span class="sxs-lookup"><span data-stu-id="4b410-217">If you don't receive an email containing the link to verify your credentials:</span></span>

- <span data-ttu-id="4b410-218">Überprüfen Sie Ihren Junk oder Spam-Ordner.</span><span class="sxs-lookup"><span data-stu-id="4b410-218">Check your junk or spam folder.</span></span>
- <span data-ttu-id="4b410-219">Melden Sie sich bei Ihrem SendGrid-Konto, und klicken Sie auf die [-e-Mail von aktivitätsverknüpfungen](https://sendgrid.com/logs/index).</span><span class="sxs-lookup"><span data-stu-id="4b410-219">Log into your SendGrid account and click on the [Email Activity link](https://sendgrid.com/logs/index).</span></span>
- <span data-ttu-id="4b410-220">Stellen Sie sicher, dass Sie Ihren SendGrid-Benutzernamen Konto als verwendet eine *"Web.config"* Wert anstelle der e-Mail-Adresse für Ihr SendGrid-Konto.</span><span class="sxs-lookup"><span data-stu-id="4b410-220">Be certain you used your SendGrid user account name as a *Web.config* value rather than your SendGrid account email address.</span></span>

<a id="addRes"></a>
## <a name="additional-resources"></a><span data-ttu-id="4b410-221">Zusätzliche Ressourcen</span><span class="sxs-lookup"><span data-stu-id="4b410-221">Additional Resources</span></span>

- [<span data-ttu-id="4b410-222">Links zu ASP.NET Identity empfohlene Ressourcen</span><span class="sxs-lookup"><span data-stu-id="4b410-222">Links to ASP.NET Identity Recommended Resources</span></span>](../../../identity/overview/getting-started/aspnet-identity-recommended-resources.md)
- [<span data-ttu-id="4b410-223">Kontobestätigung und Kennwortwiederherstellung mit ASP.NET Identity</span><span class="sxs-lookup"><span data-stu-id="4b410-223">Account Confirmation and Password Recovery with ASP.NET Identity</span></span>](../../../identity/overview/features-api/account-confirmation-and-password-recovery-with-aspnet-identity.md)
- [<span data-ttu-id="4b410-224">ASP.NET Web Forms Reihe von Lernprogrammen - Hinzufügen einer OAuth 2.0-Anbieter</span><span class="sxs-lookup"><span data-stu-id="4b410-224">ASP.NET Web Forms tutorial series - Add an OAuth 2.0 Provider</span></span>](../getting-started/getting-started-with-aspnet-45-web-forms/checkout-and-payment-with-paypal.md#OAuthWebForms)
- [<span data-ttu-id="4b410-225">Bereitstellen von Mitgliedschaft, OAuth und SQL-Datenbank eine sichere ASP.NET Web Forms-App in Azure App Service</span><span class="sxs-lookup"><span data-stu-id="4b410-225">Deploy a Secure ASP.NET Web Forms App with Membership, OAuth, and SQL Database to Azure App Service</span></span>](https://azure.microsoft.com/documentation/articles/web-sites-dotnet-deploy-aspnet-webforms-app-membership-oauth-sql-database/)
- [<span data-ttu-id="4b410-226">ASP.NET Web Forms Reihe von Lernprogrammen - SSL für das Projekt aktivieren</span><span class="sxs-lookup"><span data-stu-id="4b410-226">ASP.NET Web Forms tutorial series - Enable SSL for the Project</span></span>](../getting-started/getting-started-with-aspnet-45-web-forms/checkout-and-payment-with-paypal.md#SSLWebForms)
