---
uid: mvc/overview/getting-started/getting-started-with-ef-using-mvc/implementing-inheritance-with-the-entity-framework-in-an-asp-net-mvc-application
title: Implementieren der Vererbung mit dem Entity Framework 6 in einer ASP.NET MVC 5-Anwendung (11 12) | Microsoft Docs
author: tdykstra
description: Die Contoso-University Beispielwebanwendung veranschaulicht, wie ASP.NET MVC 5-Anwendungen, die mit dem Entity Framework 6 Code First und Visual Studio erstellen...
ms.author: aspnetcontent
manager: wpickett
ms.date: 11/07/2014
ms.topic: article
ms.assetid: 08834147-77ec-454a-bb7a-d931d2a40dab
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/getting-started/getting-started-with-ef-using-mvc/implementing-inheritance-with-the-entity-framework-in-an-asp-net-mvc-application
msc.type: authoredcontent
ms.openlocfilehash: 1826659626106993d4796641492c62fcbd22a1b3
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/06/2018
ms.locfileid: "30873403"
---
<a name="implementing-inheritance-with-the-entity-framework-6-in-an-aspnet-mvc-5-application-11-of-12"></a><span data-ttu-id="c7c6e-103">Implementieren der Vererbung mit dem Entity Framework 6 in einer ASP.NET MVC 5-Anwendung (11 12)</span><span class="sxs-lookup"><span data-stu-id="c7c6e-103">Implementing Inheritance with the Entity Framework 6 in an ASP.NET MVC 5 Application (11 of 12)</span></span>
====================
<span data-ttu-id="c7c6e-104">durch [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="c7c6e-104">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

<span data-ttu-id="c7c6e-105">[Herunterladen des abgeschlossenen Projekts](http://code.msdn.microsoft.com/ASPNET-MVC-Application-b01a9fe8) oder [PDF herunterladen](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20Entity%20Framework%206%20Code%20First%20using%20MVC%205.pdf)</span><span class="sxs-lookup"><span data-stu-id="c7c6e-105">[Download Completed Project](http://code.msdn.microsoft.com/ASPNET-MVC-Application-b01a9fe8) or [Download PDF](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20Entity%20Framework%206%20Code%20First%20using%20MVC%205.pdf)</span></span>

> <span data-ttu-id="c7c6e-106">Die Contoso-University Beispielwebanwendung veranschaulicht, wie ASP.NET MVC 5-Anwendungen, die mit dem Entity Framework 6 Code First und Visual Studio 2013.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-106">The Contoso University sample web application demonstrates how to create ASP.NET MVC 5 applications using the Entity Framework 6 Code First and Visual Studio 2013.</span></span> <span data-ttu-id="c7c6e-107">Informationen zu dieser Tutorialreihe finden Sie im [ersten Tutorial der Reihe](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application.md).</span><span class="sxs-lookup"><span data-stu-id="c7c6e-107">For information about the tutorial series, see [the first tutorial in the series](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application.md).</span></span>


<span data-ttu-id="c7c6e-108">Im vorherigen Lernprogramm behandelt Sie Parallelitätsausnahmen.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-108">In the previous tutorial you handled concurrency exceptions.</span></span> <span data-ttu-id="c7c6e-109">In diesem Tutorial erfahren Sie, wie Sie die Vererbung in das Datenmodell implementieren können.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-109">This tutorial will show you how to implement inheritance in the data model.</span></span>

<span data-ttu-id="c7c6e-110">In einer objektorientierten Programmierung können [Vererbung](http://en.wikipedia.org/wiki/Inheritance_(object-oriented_programming)) zur Erleichterung [Wiederverwendung von code](http://en.wikipedia.org/wiki/Code_reuse).</span><span class="sxs-lookup"><span data-stu-id="c7c6e-110">In object-oriented programming, you can use [inheritance](http://en.wikipedia.org/wiki/Inheritance_(object-oriented_programming)) to facilitate [code reuse](http://en.wikipedia.org/wiki/Code_reuse).</span></span> <span data-ttu-id="c7c6e-111">In diesem Tutorial ändern Sie die Klassen `Instructor` und `Student` so, dass sie von einer `Person`-Basisklasse abgeleitet werden, die Eigenschaften wie `LastName` enthält. Diese Eigenschaften sind für Dozenten und Studenten gängig.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-111">In this tutorial, you'll change the `Instructor` and `Student` classes so that they derive from a `Person` base class which contains properties such as `LastName` that are common to both instructors and students.</span></span> <span data-ttu-id="c7c6e-112">Sie fügen keine Webseiten hinzu oder ändern diese, aber Sie werden Teile des Codes ändern. Diese Änderungen werden automatisch in der Datenbank widergespiegelt.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-112">You won't add or change any web pages, but you'll change some of the code and those changes will be automatically reflected in the database.</span></span>

## <a name="options-for-mapping-inheritance-to-database-tables"></a><span data-ttu-id="c7c6e-113">Optionen für die Zuordnung von Vererbung zu Datenbanktabellen</span><span class="sxs-lookup"><span data-stu-id="c7c6e-113">Options for mapping inheritance to database tables</span></span>

<span data-ttu-id="c7c6e-114">Die `Instructor` und `Student` Klassen in der `School` Datenmodell haben verschiedene Eigenschaften, die identisch sind:</span><span class="sxs-lookup"><span data-stu-id="c7c6e-114">The `Instructor` and `Student` classes in the `School` data model have several properties that are identical:</span></span>

![Student_and_Instructor_classes](implementing-inheritance-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image1.png)

<span data-ttu-id="c7c6e-116">Angenommen, Sie möchten den redundanten Code für die Eigenschaften löschen, die von den Entitäten `Instructor` und `Student` gemeinsam genutzt werden.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-116">Suppose you want to eliminate the redundant code for the properties that are shared by the `Instructor` and `Student` entities.</span></span> <span data-ttu-id="c7c6e-117">Oder Sie möchten einen Dienst schreiben, mit dem Namen formatiert werden können, ohne dass es eine Rolle spielt, ob der Name von einem Dozenten oder von einem Studenten stammt.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-117">Or you want to write a service that can format names without caring whether the name came from an instructor or a student.</span></span> <span data-ttu-id="c7c6e-118">Sie erstellen eine `Person` Basisklasse enthält nur diese Eigenschaften gemeinsam genutzt, muss sich die `Instructor` und `Student` Entitäten aus dieser Basisklasse erben, wie in der folgenden Abbildung gezeigt:</span><span class="sxs-lookup"><span data-stu-id="c7c6e-118">You could create a `Person` base class which contains only those shared properties, then make the `Instructor` and `Student` entities inherit from that base class, as shown in the following illustration:</span></span>

![Student_and_Instructor_classes_deriving_from_Person_class](implementing-inheritance-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image2.png)

<span data-ttu-id="c7c6e-120">Es gibt mehrere Möglichkeiten, wie diese Vererbungsstruktur in der Datenbank dargestellt werden kann.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-120">There are several ways this inheritance structure could be represented in the database.</span></span> <span data-ttu-id="c7c6e-121">Sie möglicherweise eine `Person` Tabelle Informationen zu Studenten und Lehrkräfte in einer einzelnen Tabelle enthält.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-121">You could have a `Person` table that includes information about both students and instructors in a single table.</span></span> <span data-ttu-id="c7c6e-122">Einige Spalten könnte gelten nur für Lehrkräfte (`HireDate`), einige nur für Studenten (`EnrollmentDate`), einige sowohl (`LastName`, `FirstName`).</span><span class="sxs-lookup"><span data-stu-id="c7c6e-122">Some of the columns could apply only to instructors (`HireDate`), some only to students (`EnrollmentDate`), some to both (`LastName`, `FirstName`).</span></span> <span data-ttu-id="c7c6e-123">In der Regel müssen eine *Unterscheidungseigenschaft* Spalte, um anzugeben, welche Typen von jeder Zeile darstellt.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-123">Typically, you'd have a *discriminator* column to indicate which type each row represents.</span></span> <span data-ttu-id="c7c6e-124">So kann die Unterscheidungsspalte beispielsweise „Instructor“ für Dozenten und „Student“ für Studenten enthalten.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-124">For example, the discriminator column might have "Instructor" for instructors and "Student" for students.</span></span>

![Tabelle pro hierarchy_example](implementing-inheritance-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image3.png)

<span data-ttu-id="c7c6e-126">Dieses Muster für eine Entität Vererbungsstruktur aus einer einzelnen Datenbanktabelle generiert heißt *Tabelle pro Hierarchie* Vererbung (TPH).</span><span class="sxs-lookup"><span data-stu-id="c7c6e-126">This pattern of generating an entity inheritance structure from a single database table is called *table-per-hierarchy* (TPH) inheritance.</span></span>

<span data-ttu-id="c7c6e-127">Alternativ kann die Datenbank so gestaltet werden, dass sie mehr wie die Vererbungsstruktur aussieht.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-127">An alternative is to make the database look more like the inheritance structure.</span></span> <span data-ttu-id="c7c6e-128">Sie könnte z. B. nur die Namensfelder besitzen, der `Person` Tabelle und über separate `Instructor` und `Student` Tabellen mit den Datumsfeldern.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-128">For example, you could have only the name fields in the `Person` table and have separate `Instructor` and `Student` tables with the date fields.</span></span>

![Tabelle pro type_inheritance](implementing-inheritance-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image4.png)

<span data-ttu-id="c7c6e-130">Dieses Muster versteht man eine Datenbanktabelle für jede Entitätsklasse aufgerufen *Tabelle pro Typ* Vererbung (TPT).</span><span class="sxs-lookup"><span data-stu-id="c7c6e-130">This pattern of making a database table for each entity class is called *table per type* (TPT) inheritance.</span></span>

<span data-ttu-id="c7c6e-131">Eine weitere Möglichkeit besteht darin, individuellen Tabellen alle nicht abstrakten Typen zuzuordnen.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-131">Yet another option is to map all non-abstract types to individual tables.</span></span> <span data-ttu-id="c7c6e-132">Alle Eigenschaften einer Klasse, einschließlich der geerbten Eigenschaften, werden Spalten der entsprechenden Tabelle zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-132">All properties of a class, including inherited properties, map to columns of the corresponding table.</span></span> <span data-ttu-id="c7c6e-133">Dieses Muster wird als TPC-Vererbung (TPC = Table per Concrete, Tabelle pro konkretem Typ) bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-133">This pattern is called Table-per-Concrete Class (TPC) inheritance.</span></span> <span data-ttu-id="c7c6e-134">TPC-Vererbung für implementiert, sollte die `Person`, `Student`, und `Instructor` Klassen wie oben gezeigt die `Student` und `Instructor` Tabellen sieht nach dem Implementieren der Vererbung als zum Zeitpunkt bevor unterscheidet.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-134">If you implemented TPC inheritance for the `Person`, `Student`, and `Instructor` classes as shown earlier, the `Student` and `Instructor` tables would look no different after implementing inheritance than they did before.</span></span>

<span data-ttu-id="c7c6e-135">TPC und TPH Muster der methodenvererbung aufgeführt übermittelt werden, im Allgemeinen eine bessere Leistung im Entity Framework als TPT Muster der methodenvererbung aufgeführt, weil TPT Muster komplexe Verknüpfungsabfragen führen können.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-135">TPC and TPH inheritance patterns generally deliver better performance in the Entity Framework than TPT inheritance patterns, because TPT patterns can result in complex join queries.</span></span>

<span data-ttu-id="c7c6e-136">Dieses Tutorial veranschaulicht die Implementierung der TPH-Vererbung.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-136">This tutorial demonstrates how to implement TPH inheritance.</span></span> <span data-ttu-id="c7c6e-137">TPH ist das Standardmuster für die Vererbung in Entity Framework, deshalb müssen Sie lediglich erstellen eine `Person` Klasse, ändern Sie die `Instructor` und `Student` Klassen ableiten `Person`, fügen Sie die neue Klasse, die `DbContext`, und erstellen Sie eine die Migration.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-137">TPH is the default inheritance pattern in the Entity Framework, so all you have to do is create a `Person` class, change the `Instructor` and `Student` classes to derive from `Person`, add the new class to the `DbContext`, and create a migration.</span></span> <span data-ttu-id="c7c6e-138">(Informationen dazu, wie Sie die anderen Vererbung Muster zu implementieren, finden Sie unter [der Tabelle pro Typ (TPT) Vererbungsmapping](https://msdn.microsoft.com/data/jj591617#2.5) und [Vererbungsmapping der Tabelle pro konkrete Klasse (TPC)](https://msdn.microsoft.com/data/jj591617#2.6) in der MSDN-Website Entity Framework-Dokumentation.)</span><span class="sxs-lookup"><span data-stu-id="c7c6e-138">(For information about how to implement the other inheritance patterns, see [Mapping the Table-Per-Type (TPT) Inheritance](https://msdn.microsoft.com/data/jj591617#2.5) and [Mapping the Table-Per-Concrete Class (TPC) Inheritance](https://msdn.microsoft.com/data/jj591617#2.6) in the MSDN Entity Framework documentation.)</span></span>

## <a name="create-the-person-class"></a><span data-ttu-id="c7c6e-139">Erstellen der Klasse „Person“</span><span class="sxs-lookup"><span data-stu-id="c7c6e-139">Create the Person class</span></span>

<span data-ttu-id="c7c6e-140">In der *Modelle* Ordner erstellen *Person.cs* , und Ersetzen Sie den Code durch den folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="c7c6e-140">In the *Models* folder, create *Person.cs* and replace the template code with the following code:</span></span>

[!code-csharp[Main](implementing-inheritance-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample1.cs)]

## <a name="make-student-and-instructor-classes-inherit-from-person"></a><span data-ttu-id="c7c6e-141">Veranlassen der Vererbung von der Klasse „Person“ an die Klassen „Student“ und „Instructor“</span><span class="sxs-lookup"><span data-stu-id="c7c6e-141">Make Student and Instructor classes inherit from Person</span></span>

<span data-ttu-id="c7c6e-142">In *Instructor.cs*, leiten Sie die `Instructor` -Klasse aus den `Person` Klasse, und entfernen Sie die Schlüssel und den Namen der Felder.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-142">In *Instructor.cs*, derive the `Instructor` class from the `Person` class and remove the key and name fields.</span></span> <span data-ttu-id="c7c6e-143">Der Code sieht aus wie im folgenden Beispiel:</span><span class="sxs-lookup"><span data-stu-id="c7c6e-143">The code will look like the following example:</span></span>

[!code-csharp[Main](implementing-inheritance-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample2.cs)]

<span data-ttu-id="c7c6e-144">Nehmen Sie ähnliche Änderungen an *Student.cs*.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-144">Make similar changes to *Student.cs*.</span></span> <span data-ttu-id="c7c6e-145">Die `Student` Klasse wird im folgenden Beispiel aussehen:</span><span class="sxs-lookup"><span data-stu-id="c7c6e-145">The `Student` class will look like the following example:</span></span>

[!code-csharp[Main](implementing-inheritance-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample3.cs)]

## <a name="add-the-person-entity-type-to-the-model"></a><span data-ttu-id="c7c6e-146">Den Typ der Person-Entität dem Modell hinzufügen</span><span class="sxs-lookup"><span data-stu-id="c7c6e-146">Add the Person Entity Type to the Model</span></span>

<span data-ttu-id="c7c6e-147">In *SchoolContext.cs*, Hinzufügen einer `DbSet` -Eigenschaft für die `Person` Entitätstyp:</span><span class="sxs-lookup"><span data-stu-id="c7c6e-147">In *SchoolContext.cs*, add a `DbSet` property for the `Person` entity type:</span></span>

[!code-csharp[Main](implementing-inheritance-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample4.cs)]

<span data-ttu-id="c7c6e-148">Das ist alles, was Entity Framework für die Konfiguration der „Tabelle pro Hierarchie“-Vererbung benötigt.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-148">This is all that the Entity Framework needs in order to configure table-per-hierarchy inheritance.</span></span> <span data-ttu-id="c7c6e-149">Wie Sie sehen werden, wenn die Datenbank aktualisiert wird, muss ein `Person` anstelle der Tabelle die `Student` und `Instructor` Tabellen.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-149">As you'll see, when the database is updated, it will have a `Person` table in place of the `Student` and `Instructor` tables.</span></span>

## <a name="create-and-update-a-migrations-file"></a><span data-ttu-id="c7c6e-150">Erstellen Sie und aktualisieren Sie eine Datei Migrationen</span><span class="sxs-lookup"><span data-stu-id="c7c6e-150">Create and Update a Migrations File</span></span>

<span data-ttu-id="c7c6e-151">Geben Sie in der Paket-Manager-Konsole (PMC) den folgenden Befehl ein:</span><span class="sxs-lookup"><span data-stu-id="c7c6e-151">In the Package Manager Console (PMC), enter the following command:</span></span>

`Add-Migration Inheritance`

<span data-ttu-id="c7c6e-152">Führen Sie die `Update-Database` Befehl in der Systemmonitor.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-152">Run the `Update-Database` command in the PMC.</span></span> <span data-ttu-id="c7c6e-153">An diesem Punkt schlägt der Befehl fehl, da wir die vorhandene Daten, die Migrationen weiß nicht, wie behandelt haben.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-153">The command will fail at this point because we have existing data that migrations doesn't know how to handle.</span></span> <span data-ttu-id="c7c6e-154">Sie erhalten eine Fehlermeldung wie den folgenden Ausdruck:</span><span class="sxs-lookup"><span data-stu-id="c7c6e-154">You get an error message like the following one:</span></span>

> <span data-ttu-id="c7c6e-155">*Objekt konnte nicht gelöscht werden "Dbo. Instructor ", da es durch eine FOREIGN KEY-Einschränkung verwiesen wird.*</span><span class="sxs-lookup"><span data-stu-id="c7c6e-155">*Could not drop object 'dbo.Instructor' because it is referenced by a FOREIGN KEY constraint.*</span></span>


<span data-ttu-id="c7c6e-156">Open *Migrationen\&Lt; Zeitstempel&gt;\_Inheritance.cs* , und Ersetzen Sie die `Up` -Methode durch folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="c7c6e-156">Open *Migrations\&lt;timestamp&gt;\_Inheritance.cs* and replace the `Up` method with the following code:</span></span>

[!code-csharp[Main](implementing-inheritance-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample5.cs)]

<span data-ttu-id="c7c6e-157">Dieser Code übernimmt folgende Tasks für Datenbankaktualisierungen:</span><span class="sxs-lookup"><span data-stu-id="c7c6e-157">This code takes care of the following database update tasks:</span></span>

- <span data-ttu-id="c7c6e-158">Er entfernt Fremdschlüsseleinschränkungen und -indizes, die auf die Tabelle „Student“ verweisen.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-158">Removes foreign key constraints and indexes that point to the Student table.</span></span>
- <span data-ttu-id="c7c6e-159">Er benennt die Tabelle „Instructor“ in „Person“ um und nimmt die Änderungen vor, die für das Speichern von Studentendaten erforderlich sind:</span><span class="sxs-lookup"><span data-stu-id="c7c6e-159">Renames the Instructor table as Person and makes changes needed for it to store Student data:</span></span>

    - <span data-ttu-id="c7c6e-160">Er fügt das EnrollmentDate für Studenten hinzu, bei dem NULL-Werte zugelassen sind.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-160">Adds nullable EnrollmentDate for students.</span></span>
    - <span data-ttu-id="c7c6e-161">Er fügt eine Unterscheidungsspalte hinzu, um anzugeben, ob eine Zeile für einen Studenten oder für einen Dozenten bestimmt ist.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-161">Adds Discriminator column to indicate whether a row is for a student or an instructor.</span></span>
    - <span data-ttu-id="c7c6e-162">Er legt fest, dass bei HireDate NULL-Werte zugelassen sind, da die Zeilen für Studenten keine Einstellungsdaten enthalten.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-162">Makes HireDate nullable since student rows won't have hire dates.</span></span>
    - <span data-ttu-id="c7c6e-163">Er fügt ein temporäres Feld hinzu, über das Fremdschlüssel aktualisiert werden sollen, die auf Studenten verweisen.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-163">Adds a temporary field that will be used to update foreign keys that point to students.</span></span> <span data-ttu-id="c7c6e-164">Beim Kopieren von Studenten in die Person-Tabelle erhalten sie neue primäre Schlüsselwerte.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-164">When you copy students into the Person table they'll get new primary key values.</span></span>
- <span data-ttu-id="c7c6e-165">Kopiert Daten aus der Tabelle „Student“ in die Tabelle „Person“.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-165">Copies data from the Student table into the Person table.</span></span> <span data-ttu-id="c7c6e-166">Dadurch werden Studenten neue Primärschlüsselwerte zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-166">This causes students to get assigned new primary key values.</span></span>
- <span data-ttu-id="c7c6e-167">Er legt Fremdschlüsselwerte fest, die auf Studenten verweisen.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-167">Fixes foreign key values that point to students.</span></span>
- <span data-ttu-id="c7c6e-168">Er erstellt Fremdschlüsseleinschränkungen und -indizes neu, die dann auf die Tabelle „Person“ verweisen.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-168">Re-creates foreign key constraints and indexes, now pointing them to the Person table.</span></span>

<span data-ttu-id="c7c6e-169">(Hätten Sie als Primärschlüsseltyp statt einem Integer die grafische Benutzeroberfläche verwendet haben, hätten die Primärschlüsselwerte für Studenten nicht geändert werden müssen, und mehrere dieser Schritte hätten ausgelassen werden können.)</span><span class="sxs-lookup"><span data-stu-id="c7c6e-169">(If you had used GUID instead of integer as the primary key type, the student primary key values wouldn't have to change, and several of these steps could have been omitted.)</span></span>

<span data-ttu-id="c7c6e-170">Führen Sie die `update-database` erneut aus.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-170">Run the `update-database` command again.</span></span>

<span data-ttu-id="c7c6e-171">(In einem Produktionssystem würden Sie entsprechende Änderungen an der Down-Methode vornehmen für den Fall, dass Sie jemals, zurückdatieren, um die frühere Datenbankversion verwenden.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-171">(In a production system you would make corresponding changes to the Down method in case you ever had to use that to go back to the previous database version.</span></span> <span data-ttu-id="c7c6e-172">Für dieses Lernprogramm wird nicht die Down-Methode verwenden Sie.)</span><span class="sxs-lookup"><span data-stu-id="c7c6e-172">For this tutorial you won't be using the Down method.)</span></span>

> [!NOTE]
> <span data-ttu-id="c7c6e-173">Es ist möglich, andere Fehlermeldungen erhalten, bei der Migration von Daten und festlegen, dass schemaänderungen.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-173">It's possible to get other errors when migrating data and making schema changes.</span></span> <span data-ttu-id="c7c6e-174">Wenn Sie Fehler bei der Migration erhalten Sie kann nicht aufgelöst, das Lernprogramm fort, indem Sie ändern die Verbindungszeichenfolge in der *"Web.config"* Datei oder durch Löschen der Datenbank.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-174">If you get migration errors you can't resolve, you can continue with the tutorial by changing the connection string in the *Web.config* file or by deleting the database.</span></span> <span data-ttu-id="c7c6e-175">Der einfachste Ansatz besteht darin, benennen Sie die Datenbank in der *"Web.config"* Datei.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-175">The simplest approach is to rename the database in the *Web.config* file.</span></span> <span data-ttu-id="c7c6e-176">Ändern Sie z. B. den Datenbanknamen in ContosoUniversity2, wie im folgenden Beispiel gezeigt:</span><span class="sxs-lookup"><span data-stu-id="c7c6e-176">For example, change the database name to ContosoUniversity2 as shown in the following example:</span></span>
> 
> [!code-xml[Main](implementing-inheritance-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample6.xml?highlight=2)]
> 
> <span data-ttu-id="c7c6e-177">Mit einer neuen Datenbank, es sind keine Daten zu migrieren, und die `update-database` Befehl ist weitaus höheren Wahrscheinlichkeit in ohne Fehler abgeschlossen werden.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-177">With a new database, there is no data to migrate, and the `update-database` command is much more likely to complete without errors.</span></span> <span data-ttu-id="c7c6e-178">Informationen zum Löschen der Datenbank finden Sie unter [Gewusst wie: Löschen einer Datenbank aus Visual Studio 2012](http://romiller.com/2013/05/17/how-to-drop-a-database-from-visual-studio-2012/).</span><span class="sxs-lookup"><span data-stu-id="c7c6e-178">For instructions on how to delete the database, see [How to Drop a Database from Visual Studio 2012](http://romiller.com/2013/05/17/how-to-drop-a-database-from-visual-studio-2012/).</span></span> <span data-ttu-id="c7c6e-179">Wenn Sie diesen Ansatz verwenden, um dieses Lernprogramm fortsetzen, überspringen Sie den Bereitstellungsschritt am Ende dieses Lernprogramms oder zu einer neuen Website und die Datenbank bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-179">If you take this approach in order to continue with the tutorial, skip the deployment step at the end of this tutorial or deploy to a new site and database.</span></span> <span data-ttu-id="c7c6e-180">Wenn Sie ein Update auf derselben Website, die, denen Sie bereits bereitstellen die Bereitstellung wurde haben, erhalten EF derselben Fehler, wenn sie Migrationen automatisch ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-180">If you deploy an update to the same site you've been deploying to already, EF will get the same error there when it runs migrations automatically.</span></span> <span data-ttu-id="c7c6e-181">Wenn Sie einen Migrationen Fehler beheben möchten, ist die beste Ressource eine der Entity Framework-Foren oder StackOverflow.com.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-181">If you want to troubleshoot a migrations error, the best resource is one of the Entity Framework forums or StackOverflow.com.</span></span>


## <a name="testing"></a><span data-ttu-id="c7c6e-182">Test</span><span class="sxs-lookup"><span data-stu-id="c7c6e-182">Testing</span></span>

<span data-ttu-id="c7c6e-183">Führen Sie den Standort aus, und wiederholen Sie den verschiedenen Seiten.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-183">Run the site and try various pages.</span></span> <span data-ttu-id="c7c6e-184">Alles funktioniert genauso wie vorher.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-184">Everything works the same as it did before.</span></span>

<span data-ttu-id="c7c6e-185">In **Server-Explorer** erweitern **Daten Connections\SchoolContext** und dann **Tabellen**, und Sie sehen, dass die **Student** und **Dozenten** Tabellen wurden durch ersetzt eine **Person** Tabelle.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-185">In **Server Explorer,** expand **Data Connections\SchoolContext** and then **Tables**, and you see that the **Student** and **Instructor** tables have been replaced by a **Person** table.</span></span> <span data-ttu-id="c7c6e-186">Erweitern Sie die **Person** Tabelle, und wird angezeigt, dass sie alle Spalten, die verwendet besitzt werden die **Student** und **Dozenten** Tabellen.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-186">Expand the **Person** table and you see that it has all of the columns that used to be in the **Student** and **Instructor** tables.</span></span>

![Server_Explorer_showing_Person_table](implementing-inheritance-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image5.png)

<span data-ttu-id="c7c6e-188">Klicken Sie mit der rechten Maustaste auf die Tabelle „Person“, und klicken Sie anschließend auf **Tabellendaten anzeigen**, um die Unterscheidungsspalte anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-188">Right-click the Person table, and then click **Show Table Data** to see the discriminator column.</span></span>

![](implementing-inheritance-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image6.png)

<span data-ttu-id="c7c6e-189">Das folgende Diagramm veranschaulicht die Struktur der neuen Datenbank "School":</span><span class="sxs-lookup"><span data-stu-id="c7c6e-189">The following diagram illustrates the structure of the new School database:</span></span>

![School_database_diagram](implementing-inheritance-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image7.png)

## <a name="deploy-to-azure"></a><span data-ttu-id="c7c6e-191">In Azure bereitstellen</span><span class="sxs-lookup"><span data-stu-id="c7c6e-191">Deploy to Azure</span></span>

<span data-ttu-id="c7c6e-192">In diesem Abschnitt müssen Sie das optionale abgeschlossener **Bereitstellen der app in Azure** im Abschnitt [Teil 3, sortieren, Filtern und Paging](sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application.md) dieser Reihe von Lernprogrammen.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-192">This section requires you to have completed the optional **Deploying the app to Azure** section in [Part 3, Sorting, Filtering, and Paging](sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application.md) of this tutorial series.</span></span> <span data-ttu-id="c7c6e-193">Wenn Sie Migrationen Fehler, die Sie aufgetreten durch Löschen der Datenbank in Ihrem lokalen Projekt behoben, überspringen Sie diesen Schritt; oder erstellen Sie eine neue Website und die Datenbank und in die neue Umgebung bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-193">If you had migrations errors that you resolved by deleting the database in your local project, skip this step; or create a new site and database, and deploy to the new environment.</span></span>

1. <span data-ttu-id="c7c6e-194">In Visual Studio mit der Maustaste des Projekts im **Projektmappen-Explorer** , und wählen Sie **veröffentlichen** aus dem Kontextmenü.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-194">In Visual Studio, right-click the project in **Solution Explorer** and select **Publish** from the context menu.</span></span>  
  
    ![Im Projektkontextmenü veröffentlichen](implementing-inheritance-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image8.png)
2. <span data-ttu-id="c7c6e-196">Klicken Sie auf **Veröffentlichen**.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-196">Click **Publish**.</span></span>  
  
    ![publish](implementing-inheritance-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image9.png)  
  
   <span data-ttu-id="c7c6e-198">Die Web-app wird in Ihrem Standardbrowser geöffnet.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-198">The Web app will open in your default browser.</span></span>
3. <span data-ttu-id="c7c6e-199">Testen der Anwendung, überprüfen Sie, ob sie funktioniert.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-199">Test the application to verify it's working.</span></span>

    <span data-ttu-id="c7c6e-200">Beim ersten einer Seite ausführen, auf die Datenbank zugreift, wird das Entity Framework ausgeführt aller die Migrationen `Up` Methoden erforderlich, um die Datenbank mit dem aktuellen Datenmodell auf dem neuesten Stand zu bringen.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-200">The first time you run a page that accesses the database, the Entity Framework runs all of the migrations `Up` methods required to bring the database up to date with the current data model.</span></span>

## <a name="summary"></a><span data-ttu-id="c7c6e-201">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="c7c6e-201">Summary</span></span>

<span data-ttu-id="c7c6e-202">Sie haben die „Tabelle pro Hierarchie“-Vererbung für die Klassen `Person`, `Student` und `Instructor` implementiert.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-202">You've implemented table-per-hierarchy inheritance for the `Person`, `Student`, and `Instructor` classes.</span></span> <span data-ttu-id="c7c6e-203">Weitere Informationen zu diesen und anderen Vererbung Strukturen finden Sie unter [TPT Vererbungsmuster](https://msdn.microsoft.com/data/jj618293) und [TPH Vererbungsmuster](https://msdn.microsoft.com/data/jj618292) auf MSDN.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-203">For more information about this and other inheritance structures, see [TPT Inheritance Pattern](https://msdn.microsoft.com/data/jj618293) and [TPH Inheritance Pattern](https://msdn.microsoft.com/data/jj618292) on MSDN.</span></span> <span data-ttu-id="c7c6e-204">Im nächsten Tutorial erfahren Sie, wie Sie eine Vielzahl von Entity Framework-Szenarios auf fortgeschrittenem Niveau verarbeiten können.</span><span class="sxs-lookup"><span data-stu-id="c7c6e-204">In the next tutorial you'll see how to handle a variety of relatively advanced Entity Framework scenarios.</span></span>

<span data-ttu-id="c7c6e-205">Links zu anderen Entity Framework-Ressourcen finden Sie in der [ASP.NET Data Access - Ressourcen empfohlen](../../../../whitepapers/aspnet-data-access-content-map.md).</span><span class="sxs-lookup"><span data-stu-id="c7c6e-205">Links to other Entity Framework resources can be found in the [ASP.NET Data Access - Recommended Resources](../../../../whitepapers/aspnet-data-access-content-map.md).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="c7c6e-206">[Zurück](handling-concurrency-with-the-entity-framework-in-an-asp-net-mvc-application.md)
> [Weiter](advanced-entity-framework-scenarios-for-an-mvc-web-application.md)</span><span class="sxs-lookup"><span data-stu-id="c7c6e-206">[Previous](handling-concurrency-with-the-entity-framework-in-an-asp-net-mvc-application.md)
[Next](advanced-entity-framework-scenarios-for-an-mvc-web-application.md)</span></span>
