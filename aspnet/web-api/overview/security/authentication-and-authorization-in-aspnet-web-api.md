---
uid: web-api/overview/security/authentication-and-authorization-in-aspnet-web-api
title: Authentifizierung und Autorisierung in ASP.NET Web-API | Microsoft Docs
author: MikeWasson
description: Bietet eine allgemeine Übersicht über die Authentifizierung und Autorisierung in ASP.NET Web-API.
ms.author: aspnetcontent
manager: wpickett
ms.date: 11/27/2012
ms.topic: article
ms.assetid: 6dfb51ea-9f4d-4e70-916c-8ef8344a88d6
ms.technology: dotnet-webapi
ms.prod: .net-framework
msc.legacyurl: /web-api/overview/security/authentication-and-authorization-in-aspnet-web-api
msc.type: authoredcontent
ms.openlocfilehash: 9d7cbb9505afb6461ba4c2087d57e9ea0da38ede
ms.sourcegitcommit: 7ac15eaae20b6d70e65f3650af050a7880115cbf
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/02/2018
---
<a name="authentication-and-authorization-in-aspnet-web-api"></a><span data-ttu-id="04e6b-103">Authentifizierung und Autorisierung in ASP.NET Web-API</span><span class="sxs-lookup"><span data-stu-id="04e6b-103">Authentication and Authorization in ASP.NET Web API</span></span>
====================
<span data-ttu-id="04e6b-104">durch [Mike Wasson](https://github.com/MikeWasson)</span><span class="sxs-lookup"><span data-stu-id="04e6b-104">by [Mike Wasson](https://github.com/MikeWasson)</span></span>

<span data-ttu-id="04e6b-105">Sie erstellt haben, eine Web-API, aber Sie möchten nun den Zugriff darauf steuern.</span><span class="sxs-lookup"><span data-stu-id="04e6b-105">You've created a web API, but now you want to control access to it.</span></span> <span data-ttu-id="04e6b-106">In dieser Reihe von Artikeln sehen wir uns einige Optionen für das Sichern einer Webs-API von nicht autorisierten Benutzern.</span><span class="sxs-lookup"><span data-stu-id="04e6b-106">In this series of articles, we'll look at some options for securing a web API from unauthorized users.</span></span> <span data-ttu-id="04e6b-107">Diese Reihe befasst sich mit Authentifizierung und Autorisierung.</span><span class="sxs-lookup"><span data-stu-id="04e6b-107">This series will cover both authentication and authorization.</span></span>

- <span data-ttu-id="04e6b-108">*Authentifizierung* ist die Identität des Benutzers kennen.</span><span class="sxs-lookup"><span data-stu-id="04e6b-108">*Authentication* is knowing the identity of the user.</span></span> <span data-ttu-id="04e6b-109">Beispielsweise Alice meldet sich mit ihrem Benutzernamen und Kennwort, und der Server das Kennwort zum Authentifizieren von Alice verwendet.</span><span class="sxs-lookup"><span data-stu-id="04e6b-109">For example, Alice logs in with her username and password, and the server uses the password to authenticate Alice.</span></span>
- <span data-ttu-id="04e6b-110">*Autorisierung* ist entscheiden, ob ein Benutzer zum Ausführen einer Aktion zulässig ist.</span><span class="sxs-lookup"><span data-stu-id="04e6b-110">*Authorization* is deciding whether a user is allowed to perform an action.</span></span> <span data-ttu-id="04e6b-111">Alice verfügt beispielsweise über die Berechtigung zum Abrufen einer Ressource, aber nicht erstellen, eine Ressource.</span><span class="sxs-lookup"><span data-stu-id="04e6b-111">For example, Alice has permission to get a resource but not create a resource.</span></span>

<span data-ttu-id="04e6b-112">Der erste Artikel in der Reihe bietet einen allgemeinen Überblick über die Authentifizierung und Autorisierung in ASP.NET Web-API.</span><span class="sxs-lookup"><span data-stu-id="04e6b-112">The first article in the series gives a general overview of authentication and authorization in ASP.NET Web API.</span></span> <span data-ttu-id="04e6b-113">Andere Themen beschreiben den allgemeinen Authentifizierungsszenarien für Web-API.</span><span class="sxs-lookup"><span data-stu-id="04e6b-113">Other topics describe common authentication scenarios for Web API.</span></span>

> [!NOTE]
> <span data-ttu-id="04e6b-114">Dank der Personen, die diese Reihe überprüft und wertvolles Feedback bereitgestellt: Rick Anderson Levi Broderick Barry Dorrans Tom Dykstra Hongmei Ge David Matson Daniel Roth, Tim Teebken.</span><span class="sxs-lookup"><span data-stu-id="04e6b-114">Thanks to the people who reviewed this series and provided valuable feedback: Rick Anderson, Levi Broderick, Barry Dorrans, Tom Dykstra, Hongmei Ge, David Matson, Daniel Roth, Tim Teebken.</span></span>


## <a name="authentication"></a><span data-ttu-id="04e6b-115">Authentifizierung</span><span class="sxs-lookup"><span data-stu-id="04e6b-115">Authentication</span></span>

<span data-ttu-id="04e6b-116">Web-API wird davon ausgegangen, dass die Authentifizierung auf dem Host erfolgt.</span><span class="sxs-lookup"><span data-stu-id="04e6b-116">Web API assumes that authentication happens in the host.</span></span> <span data-ttu-id="04e6b-117">Für das Webhosting ist der Host IIS, die HTTP-Module für die Authentifizierung verwendet.</span><span class="sxs-lookup"><span data-stu-id="04e6b-117">For web-hosting, the host is IIS, which uses HTTP modules for authentication.</span></span> <span data-ttu-id="04e6b-118">Sie können Ihr Projekt verwendet die Authentifizierungsmodule, die in IIS oder ASP.NET integriert konfigurieren, oder Sie können eigene HTTP-Modul für die benutzerdefinierte Authentifizierung schreiben.</span><span class="sxs-lookup"><span data-stu-id="04e6b-118">You can configure your project to use any of the authentication modules built in to IIS or ASP.NET, or write your own HTTP module to perform custom authentication.</span></span>

<span data-ttu-id="04e6b-119">Wenn der Host den Benutzer authentifiziert hat, erstellt er eine *principal*, also ein [IPrincipal](https://msdn.microsoft.com/library/System.Security.Principal.IPrincipal.aspx) -Objekt, das den Sicherheitskontext darstellt, in dem Code ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="04e6b-119">When the host authenticates the user, it creates a *principal*, which is an [IPrincipal](https://msdn.microsoft.com/library/System.Security.Principal.IPrincipal.aspx) object that represents the security context under which code is running.</span></span> <span data-ttu-id="04e6b-120">Der Host den Prinzipal für den aktuellen Thread festlegen anfügt **Thread.CurrentPrincipal**.</span><span class="sxs-lookup"><span data-stu-id="04e6b-120">The host attaches the principal to the current thread by setting **Thread.CurrentPrincipal**.</span></span> <span data-ttu-id="04e6b-121">Der Prinzipal enthält eine zugeordnete **Identität** Objekt, das Informationen über den Benutzer enthält.</span><span class="sxs-lookup"><span data-stu-id="04e6b-121">The principal contains an associated **Identity** object that contains information about the user.</span></span> <span data-ttu-id="04e6b-122">Wenn der Benutzer authentifiziert ist, die **Identity.IsAuthenticated** -Eigenschaft gibt **"true"**.</span><span class="sxs-lookup"><span data-stu-id="04e6b-122">If the user is authenticated, the **Identity.IsAuthenticated** property returns **true**.</span></span> <span data-ttu-id="04e6b-123">Für anonyme Anforderungen **IsAuthenticated** gibt **"false"**.</span><span class="sxs-lookup"><span data-stu-id="04e6b-123">For anonymous requests, **IsAuthenticated** returns **false**.</span></span> <span data-ttu-id="04e6b-124">Weitere Informationen zu Prinzipalen finden Sie unter [rollenbasierte Sicherheit](https://msdn.microsoft.com/library/shz8h065.aspx).</span><span class="sxs-lookup"><span data-stu-id="04e6b-124">For more information about principals, see [Role-Based Security](https://msdn.microsoft.com/library/shz8h065.aspx).</span></span>

### <a name="http-message-handlers-for-authentication"></a><span data-ttu-id="04e6b-125">HTTP-Meldungshandler für die Authentifizierung</span><span class="sxs-lookup"><span data-stu-id="04e6b-125">HTTP Message Handlers for Authentication</span></span>

<span data-ttu-id="04e6b-126">Anstatt den Host für die Authentifizierung zu verwenden, können Sie die Authentifizierungslogik Einfügen einer [HTTP-Nachrichtenhandler](../advanced/http-message-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="04e6b-126">Instead of using the host for authentication, you can put authentication logic into an [HTTP message handler](../advanced/http-message-handlers.md).</span></span> <span data-ttu-id="04e6b-127">In diesem Fall wird der Message-Handler überprüft die HTTP-Anforderung und legt den Prinzipal fest.</span><span class="sxs-lookup"><span data-stu-id="04e6b-127">In that case, the message handler examines the HTTP request and sets the principal.</span></span>

<span data-ttu-id="04e6b-128">Wann sollte Sie Meldungshandler für die Authentifizierung verwenden?</span><span class="sxs-lookup"><span data-stu-id="04e6b-128">When should you use message handlers for authentication?</span></span> <span data-ttu-id="04e6b-129">Hier sind einige Nachteile:</span><span class="sxs-lookup"><span data-stu-id="04e6b-129">Here are some tradeoffs:</span></span>

- <span data-ttu-id="04e6b-130">Ein HTTP-Modul sieht alle Anforderungen, die der ASP.NET-Pipeline durchlaufen.</span><span class="sxs-lookup"><span data-stu-id="04e6b-130">An HTTP module sees all requests that go through the ASP.NET pipeline.</span></span> <span data-ttu-id="04e6b-131">Message-Handler sieht nur Anforderungen, die Web-API weitergeleitet werden.</span><span class="sxs-lookup"><span data-stu-id="04e6b-131">A message handler only sees requests that are routed to Web API.</span></span>
- <span data-ttu-id="04e6b-132">Sie können pro Route-Meldungshandler festlegen, dadurch können Sie ein anderes Authentifizierungsschema zu einem bestimmten Arbeitsplan anwenden.</span><span class="sxs-lookup"><span data-stu-id="04e6b-132">You can set per-route message handlers, which lets you apply an authentication scheme to a specific route.</span></span>
- <span data-ttu-id="04e6b-133">HTTP-Module gelten speziell für IIS.</span><span class="sxs-lookup"><span data-stu-id="04e6b-133">HTTP modules are specific to IIS.</span></span> <span data-ttu-id="04e6b-134">Meldungshandler sind Unabhängigkeit von Host, damit diese mit Web-hosting und Selbsthosting verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="04e6b-134">Message handlers are host-agnostic, so they can be used with both web-hosting and self-hosting.</span></span>
- <span data-ttu-id="04e6b-135">HTTP-Module, die in IIS-Protokollierung, Überwachung und So weiter einbezogen werden.</span><span class="sxs-lookup"><span data-stu-id="04e6b-135">HTTP modules participate in IIS logging, auditing, and so on.</span></span>
- <span data-ttu-id="04e6b-136">HTTP-Module, die weiter oben in der Pipeline ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="04e6b-136">HTTP modules run earlier in the pipeline.</span></span> <span data-ttu-id="04e6b-137">Wenn Sie Authentifizierung in einer Message-Handler behandelt, der Prinzipal ist nicht abrufen oder Festlegen der bis der Handler ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="04e6b-137">If you handle authentication in a message handler, the principal does not get set until the handler runs.</span></span> <span data-ttu-id="04e6b-138">Darüber hinaus wiederhergestellt der Prinzipal, der vorherige Prinzipal, wenn die Antwort den Nachrichtenhandler verlässt.</span><span class="sxs-lookup"><span data-stu-id="04e6b-138">Moreover, the principal reverts back to the previous principal when the response leaves the message handler.</span></span>

<span data-ttu-id="04e6b-139">Wenn Sie Selbsthosting Unterstützung benötigen, ist ein HTTP-Modul im Allgemeinen eine bessere Option.</span><span class="sxs-lookup"><span data-stu-id="04e6b-139">Generally, if you don't need to support self-hosting, an HTTP module is a better option.</span></span> <span data-ttu-id="04e6b-140">Wenn Sie Selbsthosting unterstützen müssen, sollten Sie einen Meldungshandler.</span><span class="sxs-lookup"><span data-stu-id="04e6b-140">If you need to support self-hosting, consider a message handler.</span></span>

### <a name="setting-the-principal"></a><span data-ttu-id="04e6b-141">Den Prinzipal festlegen</span><span class="sxs-lookup"><span data-stu-id="04e6b-141">Setting the Principal</span></span>

<span data-ttu-id="04e6b-142">Wenn Ihre Anwendung eine benutzerdefinierte Authentifizierungslogik ausführt, müssen Sie den Prinzipal auf zwei Stellen festlegen:</span><span class="sxs-lookup"><span data-stu-id="04e6b-142">If your application performs any custom authentication logic, you must set the principal on two places:</span></span>

- <span data-ttu-id="04e6b-143">**Thread.CurrentPrincipal**.</span><span class="sxs-lookup"><span data-stu-id="04e6b-143">**Thread.CurrentPrincipal**.</span></span> <span data-ttu-id="04e6b-144">Diese Eigenschaft wird standardmäßig in .NET Prinzipal des Threads festlegen.</span><span class="sxs-lookup"><span data-stu-id="04e6b-144">This property is the standard way to set the thread's principal in .NET.</span></span>
- <span data-ttu-id="04e6b-145">**HttpContext.Current.User**.</span><span class="sxs-lookup"><span data-stu-id="04e6b-145">**HttpContext.Current.User**.</span></span> <span data-ttu-id="04e6b-146">Diese Eigenschaft ist spezifisch für ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="04e6b-146">This property is specific to ASP.NET.</span></span>

<span data-ttu-id="04e6b-147">Der folgende Code zeigt, wie Sie zum Festlegen des Prinzipals:</span><span class="sxs-lookup"><span data-stu-id="04e6b-147">The following code shows how to set the principal:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample1.cs)]

<span data-ttu-id="04e6b-148">Für das Webhosting, müssen Sie den Prinzipal an beiden Orten festlegen. Andernfalls kann der Sicherheitskontext inkonsistent werden.</span><span class="sxs-lookup"><span data-stu-id="04e6b-148">For web-hosting, you must set the principal in both places; otherwise the security context may become inconsistent.</span></span> <span data-ttu-id="04e6b-149">Für das Selbsthosting jedoch **HttpContext.Current** ist null.</span><span class="sxs-lookup"><span data-stu-id="04e6b-149">For self-hosting, however, **HttpContext.Current** is null.</span></span> <span data-ttu-id="04e6b-150">Um sicherzustellen, dass der Code ist die Unabhängigkeit von der Host, daher überprüfen, für Null-Zeichen vor dem Zuweisen **HttpContext.Current**, wie dargestellt.</span><span class="sxs-lookup"><span data-stu-id="04e6b-150">To ensure your code is host-agnostic, therefore, check for null before assigning to **HttpContext.Current**, as shown.</span></span>

## <a name="authorization"></a><span data-ttu-id="04e6b-151">Autorisierung</span><span class="sxs-lookup"><span data-stu-id="04e6b-151">Authorization</span></span>

<span data-ttu-id="04e6b-152">Autorisierung weiter unten in der Pipeline näher an den Controller.</span><span class="sxs-lookup"><span data-stu-id="04e6b-152">Authorization happens later in the pipeline, closer to the controller.</span></span> <span data-ttu-id="04e6b-153">Mit der Sie genauere Entscheidungen zu treffen, wenn Sie den Zugriff auf Ressourcen gewähren.</span><span class="sxs-lookup"><span data-stu-id="04e6b-153">That lets you make more granular choices when you grant access to resources.</span></span>

- <span data-ttu-id="04e6b-154">*Autorisierungsfilter* ausführen, bevor der Controlleraktion.</span><span class="sxs-lookup"><span data-stu-id="04e6b-154">*Authorization filters* run before the controller action.</span></span> <span data-ttu-id="04e6b-155">Wenn die Anforderung nicht autorisiert ist, der Filter gibt eine Fehlerantwort zurück und die Aktion wird nicht aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="04e6b-155">If the request is not authorized, the filter returns an error response, and the action is not invoked.</span></span>
- <span data-ttu-id="04e6b-156">Innerhalb einer Controlleraktion erhalten Sie den aktuellen Prinzipal aus der **ApiController.User** Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="04e6b-156">Within a controller action, you can get the current principal from the **ApiController.User** property.</span></span> <span data-ttu-id="04e6b-157">Beispielsweise können Sie filtern eine Liste der Ressourcen basierend auf den Benutzernamen, nur die Ressourcen, die für diesen Benutzer gehören zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="04e6b-157">For example, you might filter a list of resources based on the user name, returning only those resources that belong to that user.</span></span>

![](authentication-and-authorization-in-aspnet-web-api/_static/image1.png)

<a id="auth3"></a>
### <a name="using-the-authorize-attribute"></a><span data-ttu-id="04e6b-158">Mit dem [autorisieren]-Attribut</span><span class="sxs-lookup"><span data-stu-id="04e6b-158">Using the [Authorize] Attribute</span></span>

<span data-ttu-id="04e6b-159">Web-API bietet eine integrierte Autorisierungsfilter [AuthorizeAttribute](https://msdn.microsoft.com/library/system.web.http.authorizeattribute.aspx).</span><span class="sxs-lookup"><span data-stu-id="04e6b-159">Web API provides a built-in authorization filter, [AuthorizeAttribute](https://msdn.microsoft.com/library/system.web.http.authorizeattribute.aspx).</span></span> <span data-ttu-id="04e6b-160">Dieser Filter überprüft, ob der Benutzer authentifiziert ist.</span><span class="sxs-lookup"><span data-stu-id="04e6b-160">This filter checks whether the user is authenticated.</span></span> <span data-ttu-id="04e6b-161">Wenn dies nicht der Fall ist, wird die HTTP-Statuscode 401 (nicht autorisiert), ohne Aufrufen der Aktion zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="04e6b-161">If not, it returns HTTP status code 401 (Unauthorized), without invoking the action.</span></span>

<span data-ttu-id="04e6b-162">Sie können den Filter, die Global auf Controllerebene, oder klicken Sie auf der Ebene der einzelnen Aktionen anwenden.</span><span class="sxs-lookup"><span data-stu-id="04e6b-162">You can apply the filter globally, at the controller level, or at the level of individual actions.</span></span>

<span data-ttu-id="04e6b-163">**Global**: zum Einschränken des Zugriffs für alle Web-API-Controller Hinzufügen der **AuthorizeAttribute** Filter zur globalen Filterliste:</span><span class="sxs-lookup"><span data-stu-id="04e6b-163">**Globally**: To restrict access for every Web API controller, add the **AuthorizeAttribute** filter to the global filter list:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample2.cs)]

<span data-ttu-id="04e6b-164">**Controller**: zum Einschränken des Zugriffs für einen bestimmten Controller hinzufügen den Filter als ein Attribut mit dem Controller:</span><span class="sxs-lookup"><span data-stu-id="04e6b-164">**Controller**: To restrict access for a specific controller, add the filter as an attribute to the controller:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample3.cs)]

<span data-ttu-id="04e6b-165">**Aktion**: um den Zugriff auf bestimmte Aktionen einzuschränken, fügen Sie das Attribut zur Aktionsmethode:</span><span class="sxs-lookup"><span data-stu-id="04e6b-165">**Action**: To restrict access for specific actions, add the attribute to the action method:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample4.cs)]

<span data-ttu-id="04e6b-166">Alternativ können Sie den Controller einzuschränken und dann zulassen des anonymen Zugriffs auf bestimmte Aktionen mithilfe der `[AllowAnonymous]` Attribut.</span><span class="sxs-lookup"><span data-stu-id="04e6b-166">Alternatively, you can restrict the controller and then allow anonymous access to specific actions, by using the `[AllowAnonymous]` attribute.</span></span> <span data-ttu-id="04e6b-167">Im folgenden Beispiel die `Post` Methode ist eingeschränkt, aber die `Get` -Methode erlaubt anonymen Zugriff.</span><span class="sxs-lookup"><span data-stu-id="04e6b-167">In the following example, the `Post` method is restricted, but the `Get` method allows anonymous access.</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample5.cs)]

<span data-ttu-id="04e6b-168">In den vorherigen Beispielen kann der Filter alle authentifizierten Benutzer auf die eingeschränkten Methoden zugreifen. nur anonyme Benutzer werden beibehalten. Sie können auch den Zugriff auf bestimmte Benutzer oder Benutzer zu bestimmten Rollen einschränken:</span><span class="sxs-lookup"><span data-stu-id="04e6b-168">In the previous examples, the filter allows any authenticated user to access the restricted methods; only anonymous users are kept out. You can also limit access to specific users or to users in specific roles:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample6.cs)]

> [!NOTE]
> <span data-ttu-id="04e6b-169">Die **AuthorizeAttribute** Filter für Web-API-Controller befindet sich der **System.Web.Http** Namespace.</span><span class="sxs-lookup"><span data-stu-id="04e6b-169">The **AuthorizeAttribute** filter for Web API controllers is located in the **System.Web.Http** namespace.</span></span> <span data-ttu-id="04e6b-170">Es ist ein ähnlich wie Filter für MVC-Controller im die **System.Web.Mvc** Namespace, der mit der Web-API-Controller nicht kompatibel ist.</span><span class="sxs-lookup"><span data-stu-id="04e6b-170">There is a similar filter for MVC controllers in the **System.Web.Mvc** namespace, which is not compatible with Web API controllers.</span></span>


### <a name="custom-authorization-filters"></a><span data-ttu-id="04e6b-171">Benutzerdefinierte Autorisierungsfilter</span><span class="sxs-lookup"><span data-stu-id="04e6b-171">Custom Authorization Filters</span></span>

<span data-ttu-id="04e6b-172">Leiten Sie zum Schreiben eines benutzerdefinierten Autorisierungs-Filters aus einem der folgenden Typen:</span><span class="sxs-lookup"><span data-stu-id="04e6b-172">To write a custom authorization filter, derive from one of these types:</span></span>

- <span data-ttu-id="04e6b-173">**AuthorizeAttribute**.</span><span class="sxs-lookup"><span data-stu-id="04e6b-173">**AuthorizeAttribute**.</span></span> <span data-ttu-id="04e6b-174">Erweitern Sie diese Klasse zum Ausführen von Autorisierungslogik basierend auf den aktuellen Benutzer sowie die Rollen des Benutzers.</span><span class="sxs-lookup"><span data-stu-id="04e6b-174">Extend this class to perform authorization logic based on the current user and the user's roles.</span></span>
- <span data-ttu-id="04e6b-175">**AuthorizationFilterAttribute**.</span><span class="sxs-lookup"><span data-stu-id="04e6b-175">**AuthorizationFilterAttribute**.</span></span> <span data-ttu-id="04e6b-176">Erweitern Sie diese Klasse zum synchronen Autorisierungslogik ausführen, die nicht unbedingt auf den aktuellen Benutzer oder Rolle basiert.</span><span class="sxs-lookup"><span data-stu-id="04e6b-176">Extend this class to perform synchronous authorization logic that is not necessarily based on the current user or role.</span></span>
- <span data-ttu-id="04e6b-177">**IAuthorizationFilter**.</span><span class="sxs-lookup"><span data-stu-id="04e6b-177">**IAuthorizationFilter**.</span></span> <span data-ttu-id="04e6b-178">Diese Schnittstelle zum Ausführen von asynchronen Autorisierungslogik zu implementieren; Angenommen, Ihre Autorisierungslogik asynchrone e/a- oder Netzwerk aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="04e6b-178">Implement this interface to perform asynchronous authorization logic; for example, if your authorization logic makes asynchronous I/O or network calls.</span></span> <span data-ttu-id="04e6b-179">(Wenn die Autorisierungslogik CPU-gebunden ist, ist die Ableitung einfacher **AuthorizationFilterAttribute**, da keine müssen Sie eine asynchrone Methode zu schreiben.)</span><span class="sxs-lookup"><span data-stu-id="04e6b-179">(If your authorization logic is CPU-bound, it is simpler to derive from **AuthorizationFilterAttribute**, because then you don't need to write an asynchronous method.)</span></span>

<span data-ttu-id="04e6b-180">Das folgende Diagramm zeigt die Klassenhierarchie für das **AuthorizeAttribute** Klasse.</span><span class="sxs-lookup"><span data-stu-id="04e6b-180">The following diagram shows the class hierarchy for the **AuthorizeAttribute** class.</span></span>

![](authentication-and-authorization-in-aspnet-web-api/_static/image2.png)

### <a name="authorization-inside-a-controller-action"></a><span data-ttu-id="04e6b-181">Autorisierung in eine Controlleraktion</span><span class="sxs-lookup"><span data-stu-id="04e6b-181">Authorization Inside a Controller Action</span></span>

<span data-ttu-id="04e6b-182">In einigen Fällen können Sie eine Anforderung zum fortsetzen, aber ändern Sie das Verhalten basierend auf dem Prinzipal ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="04e6b-182">In some cases, you might allow a request to proceed, but change the behavior based on the principal.</span></span> <span data-ttu-id="04e6b-183">Beispielsweise kann die Informationen, die Sie zurückgeben abhängig von der Rolle des Benutzers ändern.</span><span class="sxs-lookup"><span data-stu-id="04e6b-183">For example, the information that you return might change depending on the user's role.</span></span> <span data-ttu-id="04e6b-184">Innerhalb einer Controllermethode erhalten Sie den aktuellen Prinzipal aus der **ApiController.User** Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="04e6b-184">Within a controller method, you can get the current principle from the **ApiController.User** property.</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample7.cs)]
