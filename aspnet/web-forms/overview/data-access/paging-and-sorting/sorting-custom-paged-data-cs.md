---
uid: web-forms/overview/data-access/paging-and-sorting/sorting-custom-paged-data-cs
title: Benutzerdefinierte Sortierung von ausgelagerten Daten (c#) | Microsoft Docs
author: rick-anderson
description: Im vorherigen Lernprogramm haben wir gelernt, benutzerdefiniertes Paging implementieren, wenn Daten auf einer Webseite presentating. In diesem Lernprogramm sehen, wie das vorherige erweitern...
ms.author: aspnetcontent
manager: wpickett
ms.date: 08/15/2006
ms.topic: article
ms.assetid: 778baa4e-4af8-4665-947e-7a01d1a4dff2
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting/sorting-custom-paged-data-cs
msc.type: authoredcontent
ms.openlocfilehash: a71405bc84304bf7c47f400dfa9886208316d223
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/24/2018
---
<a name="sorting-custom-paged-data-c"></a><span data-ttu-id="b89c5-104">Benutzerdefinierte Sortierung von ausgelagerten Daten (c#)</span><span class="sxs-lookup"><span data-stu-id="b89c5-104">Sorting Custom Paged Data (C#)</span></span>
====================
<span data-ttu-id="b89c5-105">durch [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="b89c5-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="b89c5-106">[Beispiel-App herunterladen](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_26_CS.exe) oder [PDF herunterladen](sorting-custom-paged-data-cs/_static/datatutorial26cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="b89c5-106">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_26_CS.exe) or [Download PDF](sorting-custom-paged-data-cs/_static/datatutorial26cs1.pdf)</span></span>

> <span data-ttu-id="b89c5-107">Im vorherigen Lernprogramm haben wir gelernt, benutzerdefiniertes Paging implementieren, wenn Daten auf einer Webseite presentating.</span><span class="sxs-lookup"><span data-stu-id="b89c5-107">In the previous tutorial we learned how to implement custom paging when presentating data on a web page.</span></span> <span data-ttu-id="b89c5-108">In diesem Lernprogramm sehen wir das vorige Beispiel Unterstützung für das benutzerdefiniertes Paging sortieren zu erweitern.</span><span class="sxs-lookup"><span data-stu-id="b89c5-108">In this tutorial we see how to extend the preceding example to include support for sorting custom paging.</span></span>


## <a name="introduction"></a><span data-ttu-id="b89c5-109">Einführung</span><span class="sxs-lookup"><span data-stu-id="b89c5-109">Introduction</span></span>

<span data-ttu-id="b89c5-110">Im Vergleich zu Standardpaging, benutzerdefiniertes Paging kann die Leistung von Paging durch Daten verbessern, indem Größenordnung, benutzerdefinierte paging die de facto Paging Implementierungsauswahl beim paging durch große Mengen von Daten vornehmen.</span><span class="sxs-lookup"><span data-stu-id="b89c5-110">Compared to default paging, custom paging can improve the performance of paging through data by several orders of magnitude, making custom paging the de facto paging implementation choice when paging through large amounts of data.</span></span> <span data-ttu-id="b89c5-111">Implementieren benutzerdefiniertes Paging ist komplizierter als das standardmäßige paging, jedoch vor allem beim Hinzufügen einer Sortierung aus der Mischung implementieren.</span><span class="sxs-lookup"><span data-stu-id="b89c5-111">Implementing custom paging is more involved than implementing default paging, however, especially when adding sorting to the mix.</span></span> <span data-ttu-id="b89c5-112">In diesem Lernprogramm fügen wir das Beispiel aus dem vorherigen Unterstützung für die Sortierung einschließen erweitern *und* benutzerdefiniertes Paging.</span><span class="sxs-lookup"><span data-stu-id="b89c5-112">In this tutorial we'll extend the example from the preceding one to include support for sorting *and* custom paging.</span></span>

> [!NOTE]
> <span data-ttu-id="b89c5-113">Da dieses Lernprogramm auf der vorherigen Abfrage, aufbaut, vor dem Anfang erkundet So kopieren Sie die deklarative Syntax innerhalb der `<asp:Content>` Element aus dem vorherigen Lernprogramm s-Webseite (`EfficientPaging.aspx`) und fügen Sie ihn zwischen den `<asp:Content>` Element in der `SortParameter.aspx` Seite.</span><span class="sxs-lookup"><span data-stu-id="b89c5-113">Since this tutorial builds upon the preceding one, before beginning take a moment to copy the declarative syntax within the `<asp:Content>` element from the preceding tutorial s web page (`EfficientPaging.aspx`) and paste it between the `<asp:Content>` element in the `SortParameter.aspx` page.</span></span> <span data-ttu-id="b89c5-114">Verweisen Sie zurück zu Schritt 1 von der [Validierungssteuerelemente hinzufügen, bearbeiten und Einfügen von Schnittstellen](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md) Lernprogramm für eine ausführlichere Erläuterung zur Replikation von der Funktionalität von einer ASP.NET-Seite in einen anderen.</span><span class="sxs-lookup"><span data-stu-id="b89c5-114">Refer back to Step 1 of the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md) tutorial for a more detailed discussion on replicating the functionality of one ASP.NET page to another.</span></span>


## <a name="step-1-reexamining-the-custom-paging-technique"></a><span data-ttu-id="b89c5-115">Schritt 1: Überprüfen das benutzerdefinierte Paging-Verfahren</span><span class="sxs-lookup"><span data-stu-id="b89c5-115">Step 1: Reexamining the Custom Paging Technique</span></span>

<span data-ttu-id="b89c5-116">Für das benutzerdefinierte Paging ordnungsgemäß funktioniert, müssen wir einige Verfahren implementieren, die effizient eine bestimmte Teilmenge der Datensätze, die anhand der Parameter Zeilenindex starten und die maximale Anzahl an Zeilen ziehen können.</span><span class="sxs-lookup"><span data-stu-id="b89c5-116">For custom paging to work properly, we must implement some technique that can efficiently grab a particular subset of records given the Start Row Index and Maximum Rows parameters.</span></span> <span data-ttu-id="b89c5-117">Es gibt eine Handvoll Techniken, die verwendet werden kann, um dieses Ziel zu erreichen.</span><span class="sxs-lookup"><span data-stu-id="b89c5-117">There are a handful of techniques that can be used to achieve this aim.</span></span> <span data-ttu-id="b89c5-118">In dem vorherigen Lernprogramm erläutert, dies mithilfe von Microsoft SQLServer 2005 s neue `ROW_NUMBER()` rangfolgefunktion.</span><span class="sxs-lookup"><span data-stu-id="b89c5-118">In the preceding tutorial we looked at accomplishing this using Microsoft SQL Server 2005 s new `ROW_NUMBER()` ranking function.</span></span> <span data-ttu-id="b89c5-119">Kurz gesagt, der `ROW_NUMBER()` rangfolgefunktion weist Sie eine Zeilennummer an den einzelnen Zeilen zurückgegeben, die von einer Abfrage, die nach einer angegebenen Sortierreihenfolge geordnet ist.</span><span class="sxs-lookup"><span data-stu-id="b89c5-119">In short, the `ROW_NUMBER()` ranking function assigns a row number to each row returned by a query that is ranked by a specified sort order.</span></span> <span data-ttu-id="b89c5-120">Anschließend wird die entsprechenden Teilmenge der Datensätze durch Rückgabe eines bestimmten Bereichs der nummerierten Ergebnisse abgerufen.</span><span class="sxs-lookup"><span data-stu-id="b89c5-120">The appropriate subset of records is then obtained by returning a particular section of the numbered results.</span></span> <span data-ttu-id="b89c5-121">Die folgende Abfrage veranschaulicht, wie Sie diese Technik zum Zurückgeben dieser Produkte 11 bis 20 nummeriert, wenn nach Rangfolge der Ergebnisse in alphabetischer Reihenfolge sortiert werden. die `ProductName`:</span><span class="sxs-lookup"><span data-stu-id="b89c5-121">The following query illustrates how to use this technique to return those products numbered 11 through 20 when ranking the results ordered alphabetically by the `ProductName`:</span></span>


[!code-sql[Main](sorting-custom-paged-data-cs/samples/sample1.sql)]

<span data-ttu-id="b89c5-122">Dieses Verfahren eignet sich insbesondere für Paging mithilfe einer bestimmten Sortierreihenfolge (`ProductName` alphabetisch sortiert, in diesem Fall), aber die Abfrage muss geändert werden, um die Ergebnisse sortiert nach einem anderen Sortierungsausdruck anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="b89c5-122">This technique works well for paging using a specific sort order (`ProductName` sorted alphabetically, in this case), but the query needs to be modified to show the results sorted by a different sort expression.</span></span> <span data-ttu-id="b89c5-123">Im Idealfall könnte die oben dargestellte Abfrage umgeschrieben werden, um mithilfe eines Parameters in der `OVER` -Klausel wie folgt:</span><span class="sxs-lookup"><span data-stu-id="b89c5-123">Ideally, the above query could be rewritten to use a parameter in the `OVER` clause, like so:</span></span>


[!code-sql[Main](sorting-custom-paged-data-cs/samples/sample2.sql)]

<span data-ttu-id="b89c5-124">Leider parametrisiert `ORDER BY` Klauseln sind nicht zulässig.</span><span class="sxs-lookup"><span data-stu-id="b89c5-124">Unfortunately, parameterized `ORDER BY` clauses are not allowed.</span></span> <span data-ttu-id="b89c5-125">Stattdessen müssen wir erstellen, eine gespeicherte Prozedur, die akzeptiert eine `@sortExpression` input-Parameter, aber verwendet eine der folgenden problemumgehungen:</span><span class="sxs-lookup"><span data-stu-id="b89c5-125">Instead, we must create a stored procedure that accepts a `@sortExpression` input parameter, but uses one of the following workarounds:</span></span>

- <span data-ttu-id="b89c5-126">Schreiben Sie hartcodierte Abfragen für jeden der von Sortierungsausdrücken, die verwendet werden kann; Verwenden Sie dann `IF/ELSE` T-SQL-Anweisungen, um zu bestimmen, welche die auszuführende Abfrage.</span><span class="sxs-lookup"><span data-stu-id="b89c5-126">Write hard-coded queries for each of the sort expressions that may be used; then, use `IF/ELSE` T-SQL statements to determine which query to execute.</span></span>
- <span data-ttu-id="b89c5-127">Verwenden einer `CASE` Anweisung dynamische bereitstellen `ORDER BY` Ausdrücke basierend auf der `@sortExpressio` n Eingabeparameter; finden Sie unter der wird verwendet, um dynamisch Sortieren von Abfrageergebnissen Abschnitt in [Power von SQL `CASE` Anweisungen](http://www.4guysfromrolla.com/webtech/102704-1.shtml) Weitere Informationen.</span><span class="sxs-lookup"><span data-stu-id="b89c5-127">Use a `CASE` statement to provide dynamic `ORDER BY` expressions based on the `@sortExpressio` n input parameter; see the Used to Dynamically Sort Query Results section in [The Power of SQL `CASE` Statements](http://www.4guysfromrolla.com/webtech/102704-1.shtml) for more information.</span></span>
- <span data-ttu-id="b89c5-128">Erstellen Sie die entsprechende Abfrage als Zeichenfolge in der gespeicherten Prozedur, und verwenden Sie dann [der `sp_executesql` gespeicherte Systemprozedur](https://msdn.microsoft.com/library/ms188001.aspx) zum Ausführen der dynamischen Abfrage.</span><span class="sxs-lookup"><span data-stu-id="b89c5-128">Craft the appropriate query as a string in the stored procedure and then use [the `sp_executesql` system stored procedure](https://msdn.microsoft.com/library/ms188001.aspx) to execute the dynamic query.</span></span>

<span data-ttu-id="b89c5-129">Jede der folgenden Vorgehensweisen verfügt über einige Nachteile.</span><span class="sxs-lookup"><span data-stu-id="b89c5-129">Each of these workarounds has some drawbacks.</span></span> <span data-ttu-id="b89c5-130">Die erste Option ist nicht als verwaltbar als die anderen beiden benötigt wird, dass Sie eine Abfrage für jeden möglichen Sortierungsausdruck erstellen.</span><span class="sxs-lookup"><span data-stu-id="b89c5-130">The first option is not as maintainable as the other two as it requires that you create a query for each possible sort expression.</span></span> <span data-ttu-id="b89c5-131">Aus diesem Grund, wenn Sie später entscheiden, um die GridView neue, sortierbar Felder hinzuzufügen auch müssen Sie zurückgehen und Aktualisieren der gespeicherten Prozedur.</span><span class="sxs-lookup"><span data-stu-id="b89c5-131">Therefore, if later you decide to add new, sortable fields to the GridView you will also need to go back and update the stored procedure.</span></span> <span data-ttu-id="b89c5-132">Der zweite Ansatz weist einige Besonderheiten, die einführen von leistungsbeeinträchtigungen beim Sortieren nach keine Zeichenfolgenmethoden Datenbankspalten und verwaltbarkeit dasselbe wie das erste auch noch dadurch erschwert.</span><span class="sxs-lookup"><span data-stu-id="b89c5-132">The second approach has some subtleties that introduce performance concerns when sorting by non-string database columns and also suffers from the same maintainability issues as the first.</span></span> <span data-ttu-id="b89c5-133">Und die dritte Option, dynamische SQL-Anweisungen, die verwendet, bietet das Risiko für einen SQL-Injection-Angriff auf, wenn ein Angreifer die gespeicherte Prozedur übergeben werden, in der Eingabe von eingabeparameterwerten ihrer Wahl ausführen kann.</span><span class="sxs-lookup"><span data-stu-id="b89c5-133">And the third choice, which uses dynamic SQL, introduces the risk for a SQL injection attack if an attacker is able to execute the stored procedure passing in the input parameter values of their choosing.</span></span>

<span data-ttu-id="b89c5-134">Während keiner dieser Ansätze perfekt ist, finde ich die dritte Option das beste aus den drei.</span><span class="sxs-lookup"><span data-stu-id="b89c5-134">While none of these approaches is perfect, I think the third option is the best of the three.</span></span> <span data-ttu-id="b89c5-135">Mit der Verwendung von dynamischem SQL bietet es sich um ein Maß an Flexibilität, die durch die beiden anderen nicht der Fall ist.</span><span class="sxs-lookup"><span data-stu-id="b89c5-135">With its use of dynamic SQL, it offers a level of flexibility the other two do not.</span></span> <span data-ttu-id="b89c5-136">Darüber hinaus kann ein SQL-Injection-Angriff nur ausgenutzt werden, wenn ein Angreifer die gespeicherte Prozedur übergeben, die in den Eingabeparametern seiner Wahl ausführen kann.</span><span class="sxs-lookup"><span data-stu-id="b89c5-136">Furthermore, a SQL injection attack can only be exploited if an attacker is able to execute the stored procedure passing in the input parameters of his choice.</span></span> <span data-ttu-id="b89c5-137">Da die DAL parametrisierte Abfragen verwendet, schützt ADO.NET diese Parameter, die gesendet werden, auf die Datenbank über die Architektur Dies bedeutet, dass die SQL-Injection-Angriff Sicherheitslücke nur vorhanden ist, wenn der Angreifer die gespeicherte Prozedur direkt ausgeführt werden kann.</span><span class="sxs-lookup"><span data-stu-id="b89c5-137">Since the DAL uses parameterized queries, ADO.NET will protect those parameters that are sent to the database through the architecture, meaning that the SQL injection attack vulnerability only exists if the attacker can directly execute the stored procedure.</span></span>

<span data-ttu-id="b89c5-138">Um diese Funktionalität zu implementieren, erstellen Sie eine neue gespeicherte Prozedur in der Northwind-Datenbank mit dem Namen `GetProductsPagedAndSorted`.</span><span class="sxs-lookup"><span data-stu-id="b89c5-138">To implement this functionality, create a new stored procedure in the Northwind database named `GetProductsPagedAndSorted`.</span></span> <span data-ttu-id="b89c5-139">Diese gespeicherte Prozedur sollte drei Eingabeparameter akzeptieren: `@sortExpression`, Eingabeparameter vom Typ `nvarchar(100`), der angibt, wie die Ergebnisse sortiert werden soll, und wird direkt nach dem eingefügten der `ORDER BY` Text in der `OVER` -Klausel und `@startRowIndex` und `@maximumRows`, die denselben beiden ganzzahligen Eingabeparameter aus der `GetProductsPaged` gespeicherte Prozedur, die in dem vorherigen Lernprogramm untersucht.</span><span class="sxs-lookup"><span data-stu-id="b89c5-139">This stored procedure should accept three input parameters: `@sortExpression`, an input parameter of type `nvarchar(100`) that specifies how the results should be sorted and is injected directly after the `ORDER BY` text in the `OVER` clause; and `@startRowIndex` and `@maximumRows`, the same two integer input parameters from the `GetProductsPaged` stored procedure examined in the preceding tutorial.</span></span> <span data-ttu-id="b89c5-140">Erstellen der `GetProductsPagedAndSorted` gespeicherte Prozedur mithilfe des folgenden Skripts:</span><span class="sxs-lookup"><span data-stu-id="b89c5-140">Create the `GetProductsPagedAndSorted` stored procedure using the following script:</span></span>


[!code-sql[Main](sorting-custom-paged-data-cs/samples/sample3.sql)]

<span data-ttu-id="b89c5-141">Die gespeicherte Prozedur startet, indem sichergestellt wird, die einen Wert für die `@sortExpression` Parameter wurde angegeben.</span><span class="sxs-lookup"><span data-stu-id="b89c5-141">The stored procedure starts by ensuring that a value for the `@sortExpression` parameter has been specified.</span></span> <span data-ttu-id="b89c5-142">Wenn es nicht vorhanden ist, die Ergebnisse werden mit dem höchsten `ProductID`.</span><span class="sxs-lookup"><span data-stu-id="b89c5-142">If it is missing, the results are ranked by `ProductID`.</span></span> <span data-ttu-id="b89c5-143">Als Nächstes wird die dynamische SQL-Abfrage erstellt.</span><span class="sxs-lookup"><span data-stu-id="b89c5-143">Next, the dynamic SQL query is constructed.</span></span> <span data-ttu-id="b89c5-144">Beachten Sie, dass die dynamische SQL-Abfrage hier von den unserer vorherigen Abfragen verwendet geringfügig, um alle Zeilen aus Produkttabelle abzurufen.</span><span class="sxs-lookup"><span data-stu-id="b89c5-144">Note that the dynamic SQL query here differs slightly from our previous queries used to retrieve all rows from the Products table.</span></span> <span data-ttu-id="b89c5-145">In vorherigen Beispielen wir jede s zugeordneten Produktkategorie s und Lieferanten s-Namen, die mit einer Unterabfrage abgerufen.</span><span class="sxs-lookup"><span data-stu-id="b89c5-145">In prior examples, we obtained each product s associated category s and supplier s names using a subquery.</span></span> <span data-ttu-id="b89c5-146">Diese Entscheidung wurde getroffen haben, wieder in die [erstellen eine Datenzugriffsschicht](../introduction/creating-a-data-access-layer-cs.md) Lernprogramm und erfolgte anstelle `JOIN` s weil TableAdapter zugeordnete einfügen nicht automatisch erstellt aktualisieren und Löschen von Methoden für eine solche Abfragen.</span><span class="sxs-lookup"><span data-stu-id="b89c5-146">This decision was made back in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-cs.md) tutorial and was done in lieu of using `JOIN` s because the TableAdapter cannot automatically create the associated insert, update, and delete methods for such queries.</span></span> <span data-ttu-id="b89c5-147">Die `GetProductsPagedAndSorted` gespeicherte Prozedur, allerdings muss verwenden `JOIN` s für die Ergebnisse nach Namen der Kategorie oder Lieferanten sortiert werden.</span><span class="sxs-lookup"><span data-stu-id="b89c5-147">The `GetProductsPagedAndSorted` stored procedure, however, must use `JOIN` s for the results to be ordered by the category or supplier names.</span></span>

<span data-ttu-id="b89c5-148">Diese dynamischen Abfrage durch Verketten der statische Abfrage Teile aufgebaut ist und die `@sortExpression`, `@startRowIndex`, und `@maximumRows` Parameter.</span><span class="sxs-lookup"><span data-stu-id="b89c5-148">This dynamic query is built up by concatenating the static query portions and the `@sortExpression`, `@startRowIndex`, and `@maximumRows` parameters.</span></span> <span data-ttu-id="b89c5-149">Da `@startRowIndex` und `@maximumRows` ganzzahligen Parameter, sie müssen in Nvarchars um ordnungsgemäß verkettet werden, konvertiert werden.</span><span class="sxs-lookup"><span data-stu-id="b89c5-149">Since `@startRowIndex` and `@maximumRows` are integer parameters, they must be converted into nvarchars in order to be correctly concatenated.</span></span> <span data-ttu-id="b89c5-150">Sobald diese dynamischen SQL-Abfrage erstellt wurde, wird Sie über ausgeführt `sp_executesql`.</span><span class="sxs-lookup"><span data-stu-id="b89c5-150">Once this dynamic SQL query has been constructed, it is executed via `sp_executesql`.</span></span>

<span data-ttu-id="b89c5-151">So testen Sie diese gespeicherte Prozedur mit verschiedenen Werten für erkundet die `@sortExpression`, `@startRowIndex`, und `@maximumRows` Parameter.</span><span class="sxs-lookup"><span data-stu-id="b89c5-151">Take a moment to test this stored procedure with different values for the `@sortExpression`, `@startRowIndex`, and `@maximumRows` parameters.</span></span> <span data-ttu-id="b89c5-152">Klicken Sie im Server-Explorer mit der rechten Maustaste auf den Namen der gespeicherten Prozedur, und wählen Sie Execute.</span><span class="sxs-lookup"><span data-stu-id="b89c5-152">From the Server Explorer, right-click on the stored procedure name and choose Execute.</span></span> <span data-ttu-id="b89c5-153">Hierdurch wird das Dialogfeld für die gespeicherte Ausführungsprozedur angezeigt, in dem Sie die Eingabeparameter eingeben können (siehe Abbildung 1).</span><span class="sxs-lookup"><span data-stu-id="b89c5-153">This will bring up the Run Stored Procedure dialog box into which you can enter the input parameters (see Figure 1).</span></span> <span data-ttu-id="b89c5-154">Verwenden Sie zum Sortieren der Ergebnisse von den Kategorienamen CategoryName für die `@sortExpression` Parameterwert; nach dem Lieferanten s Firmennamen sortieren, CompanyName verwenden.</span><span class="sxs-lookup"><span data-stu-id="b89c5-154">To sort the results by the category name, use CategoryName for the `@sortExpression` parameter value; to sort by the supplier s company name, use CompanyName.</span></span> <span data-ttu-id="b89c5-155">Klicken Sie nachdem Sie die Parameterwerte haben auf "OK".</span><span class="sxs-lookup"><span data-stu-id="b89c5-155">After providing the parameters values, click OK.</span></span> <span data-ttu-id="b89c5-156">Die Ergebnisse werden im Ausgabefenster angezeigt.</span><span class="sxs-lookup"><span data-stu-id="b89c5-156">The results are displayed in the Output window.</span></span> <span data-ttu-id="b89c5-157">Abbildung 2 zeigt die Ergebnisse, wenn 11 bis 20 Produkte zurückgeben geordnet werden, wenn durch die Reihenfolge der `UnitPrice` in absteigender Reihenfolge.</span><span class="sxs-lookup"><span data-stu-id="b89c5-157">Figure 2 shows the results when returning products ranked 11 through 20 when ordering by the `UnitPrice` in descending order.</span></span>


![Probieren Sie verschiedene Werte für die gespeicherte Prozedur s drei Eingabeparameter](sorting-custom-paged-data-cs/_static/image1.png)

<span data-ttu-id="b89c5-159">**Abbildung 1**: Probieren Sie verschiedene Werte für die gespeicherte Prozedur s drei Eingabeparameter</span><span class="sxs-lookup"><span data-stu-id="b89c5-159">**Figure 1**: Try Different Values for the Stored Procedure s Three Input Parameters</span></span>


<span data-ttu-id="b89c5-160">[![Die gespeicherte Prozedur s werden die Ergebnisse im Ausgabefenster angezeigt.](sorting-custom-paged-data-cs/_static/image3.png)](sorting-custom-paged-data-cs/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="b89c5-160">[![The Stored Procedure s Results are Shown in the Output Window](sorting-custom-paged-data-cs/_static/image3.png)](sorting-custom-paged-data-cs/_static/image2.png)</span></span>

<span data-ttu-id="b89c5-161">**Abbildung 2**: die gespeicherte Prozedur s die Ergebnisse werden im Ausgabefenster angezeigt ([klicken Sie hier, um das Bild in voller Größe angezeigt](sorting-custom-paged-data-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="b89c5-161">**Figure 2**: The Stored Procedure s Results are Shown in the Output Window ([Click to view full-size image](sorting-custom-paged-data-cs/_static/image4.png))</span></span>


> [!NOTE]
> <span data-ttu-id="b89c5-162">Wenn die Ergebnisse mit der angegebenen Rangfolge `ORDER BY` Spalte in der `OVER` -Klausel, SQL Server muss die Ergebnisse zu sortieren.</span><span class="sxs-lookup"><span data-stu-id="b89c5-162">When ranking the results by the specified `ORDER BY` column in the `OVER` clause, SQL Server must sort the results.</span></span> <span data-ttu-id="b89c5-163">Dies ist ein schneller Vorgang, wenn es ein gruppierter Index über die Spalte(n), die die Ergebnisse werden ist nach sortiert wird oder wenn es einem abdeckenden index jedoch andernfalls mehr teuer sein kann.</span><span class="sxs-lookup"><span data-stu-id="b89c5-163">This is a quick operation if there is a clustered index over the column(s) the results are being ordered by or if there is a covering index, but can be more costly otherwise.</span></span> <span data-ttu-id="b89c5-164">Zum Verbessern der Leistung für ausreichend große Abfragen erwägen Sie einen nicht gruppierten Index für die Spalte mit der die Ergebnisse geordnet sind.</span><span class="sxs-lookup"><span data-stu-id="b89c5-164">To improve performance for sufficiently large queries, consider adding a non-clustered index for the column by which the results are ordered by.</span></span> <span data-ttu-id="b89c5-165">Verweisen auf [Rangfolge Funktionen und Leistung in SQL Server 2005](http://www.sql-server-performance.com/ak_ranking_functions.asp) Weitere Details.</span><span class="sxs-lookup"><span data-stu-id="b89c5-165">Refer to [Ranking Functions and Performance in SQL Server 2005](http://www.sql-server-performance.com/ak_ranking_functions.asp) for more details.</span></span>


## <a name="step-2-augmenting-the-data-access-and-business-logic-layers"></a><span data-ttu-id="b89c5-166">Schritt 2: Erweitern der Datenzugriff und Geschäftsschichten-Logik</span><span class="sxs-lookup"><span data-stu-id="b89c5-166">Step 2: Augmenting the Data Access and Business Logic Layers</span></span>

<span data-ttu-id="b89c5-167">Mit der `GetProductsPagedAndSorted` gespeicherte Prozedur erstellt, im nächsten Schritt zum Ausführen dieser gespeicherten Prozedur über unsere Anwendungsarchitektur systemverarbeitungsaufwand ist.</span><span class="sxs-lookup"><span data-stu-id="b89c5-167">With the `GetProductsPagedAndSorted` stored procedure created, our next step is to provide a means to execute that stored procedure through our application architecture.</span></span> <span data-ttu-id="b89c5-168">Dies umfasst sowohl die DAL und BLL eine geeignete Methode hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="b89c5-168">This entails adding an appropriate method to both the DAL and BLL.</span></span> <span data-ttu-id="b89c5-169">Lassen Sie s durch Hinzufügen einer Methode zur DAL starten.</span><span class="sxs-lookup"><span data-stu-id="b89c5-169">Let s start by adding a method to the DAL.</span></span> <span data-ttu-id="b89c5-170">Öffnen der `Northwind.xsd` typisierte DataSet mit der rechten Maustaste auf die `ProductsTableAdapter`, und wählen Sie aus dem Kontextmenü die Option der Abfrage hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="b89c5-170">Open the `Northwind.xsd` Typed DataSet, right-click on the `ProductsTableAdapter`, and choose the Add Query option from the context menu.</span></span> <span data-ttu-id="b89c5-171">Wie wir im vorherigen Lernprogramm möchten wir so konfigurieren Sie diese neue DAL-Methode, um eine vorhandene gespeicherte Prozedur - verwenden `GetProductsPagedAndSorted`, in diesem Fall.</span><span class="sxs-lookup"><span data-stu-id="b89c5-171">As we did in the preceding tutorial, we want to configure this new DAL method to use an existing stored procedure - `GetProductsPagedAndSorted`, in this case.</span></span> <span data-ttu-id="b89c5-172">Starten Sie an, dass Sie die neue TableAdapter-Methode, um eine vorhandene gespeicherte Prozedur verwenden möchten.</span><span class="sxs-lookup"><span data-stu-id="b89c5-172">Start by indicating that you want the new TableAdapter method to use an existing stored procedure.</span></span>


![Wählen Sie eine vorhandene gespeicherte Prozedur verwenden](sorting-custom-paged-data-cs/_static/image5.png)

<span data-ttu-id="b89c5-174">**Abbildung 3**: Wählen Sie eine vorhandene gespeicherte Prozedur verwenden</span><span class="sxs-lookup"><span data-stu-id="b89c5-174">**Figure 3**: Choose to Use an Existing Stored Procedure</span></span>


<span data-ttu-id="b89c5-175">Wählen Sie zum Angeben der gespeicherten Prozedur verwendet die `GetProductsPagedAndSorted` gespeicherte Prozedur aus der Dropdown-Liste auf dem nächsten Bildschirm.</span><span class="sxs-lookup"><span data-stu-id="b89c5-175">To specify the stored procedure to use, select the `GetProductsPagedAndSorted` stored procedure from the drop-down list in the next screen.</span></span>


![Verwenden Sie die GetProductsPagedAndSorted gespeicherte Prozedur](sorting-custom-paged-data-cs/_static/image6.png)

<span data-ttu-id="b89c5-177">**Abbildung 4**: Verwenden der GetProductsPagedAndSorted gespeicherte Prozedur</span><span class="sxs-lookup"><span data-stu-id="b89c5-177">**Figure 4**: Use the GetProductsPagedAndSorted Stored Procedure</span></span>


<span data-ttu-id="b89c5-178">Diese gespeicherte Prozedur gibt eine Gruppe von Datensätzen, seine Ergebnisse also auf dem nächsten Bildschirm geben, dass Tabellendaten zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="b89c5-178">This stored procedure returns a set of records as its results so, in the next screen, indicate that it returns tabular data.</span></span>


![Um anzugeben Sie, dass die gespeicherte Prozedur Tabellendaten zurückgibt](sorting-custom-paged-data-cs/_static/image7.png)

<span data-ttu-id="b89c5-180">**Abbildung 5**: anzugeben, dass die gespeicherte Prozedur Tabellendaten zurückgibt</span><span class="sxs-lookup"><span data-stu-id="b89c5-180">**Figure 5**: Indicate that the Stored Procedure Returns Tabular Data</span></span>


<span data-ttu-id="b89c5-181">Erstellen Sie abschließend DAL-Methoden, die beide die Füllung verwenden einer "DataTable" und Zurückgeben einer DataTable-Muster, benennen die Methoden `FillPagedAndSorted` und `GetProductsPagedAndSorted`zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="b89c5-181">Finally, create DAL methods that use both the Fill a DataTable and Return a DataTable patterns, naming the methods `FillPagedAndSorted` and `GetProductsPagedAndSorted`, respectively.</span></span>


![Wählen Sie die Methodennamen](sorting-custom-paged-data-cs/_static/image8.png)

<span data-ttu-id="b89c5-183">**Abbildung 6**: Wählen Sie die Methodennamen</span><span class="sxs-lookup"><span data-stu-id="b89c5-183">**Figure 6**: Choose the Methods Names</span></span>


<span data-ttu-id="b89c5-184">Jetzt, dass wir Ve erweiterte DAL, wir re kann jetzt die BLL aktivieren.</span><span class="sxs-lookup"><span data-stu-id="b89c5-184">Now that we ve extended the DAL, we re ready to turn to the BLL.</span></span> <span data-ttu-id="b89c5-185">Öffnen der `ProductsBLL` Klassendatei, und fügen Sie eine neue Methode `GetProductsPagedAndSorted`.</span><span class="sxs-lookup"><span data-stu-id="b89c5-185">Open the `ProductsBLL` class file and add a new method, `GetProductsPagedAndSorted`.</span></span> <span data-ttu-id="b89c5-186">Diese Methode muss drei Eingabeparameter akzeptieren `sortExpression`, `startRowIndex`, und `maximumRows` sollte einfach nach unten in der DAL s Aufrufen `GetProductsPagedAndSorted` -Methode, wie folgt:</span><span class="sxs-lookup"><span data-stu-id="b89c5-186">This method needs to accept three input parameters `sortExpression`, `startRowIndex`, and `maximumRows` and should simply call down into the DAL s `GetProductsPagedAndSorted` method, like so:</span></span>


[!code-csharp[Main](sorting-custom-paged-data-cs/samples/sample4.cs)]

## <a name="step-3-configuring-the-objectdatasource-to-pass-in-the-sortexpression-parameter"></a><span data-ttu-id="b89c5-187">Schritt 3: Konfigurieren der ObjectDataSource erfolgreich im Parameters SortExpression</span><span class="sxs-lookup"><span data-stu-id="b89c5-187">Step 3: Configuring the ObjectDataSource to Pass in the SortExpression Parameter</span></span>

<span data-ttu-id="b89c5-188">HAVING ergänzt, die DAL und BLL erfolgen, die genutzt werden die `GetProductsPagedAndSorted` gespeicherte Prozedur, die alle, die verbleibt, wird "ObjectDataSource" Konfigurieren der `SortParameter.aspx` Seite zur Verwendung der neuen BLL-Methode und übergeben der `SortExpression` Parameter basierend auf der Spalte, die der Benutzer angefordert hat, um die Ergebnisse nach zu sortieren.</span><span class="sxs-lookup"><span data-stu-id="b89c5-188">Having augmented the DAL and BLL to include methods that utilize the `GetProductsPagedAndSorted` stored procedure, all that remains is to configure the ObjectDataSource in the `SortParameter.aspx` page to use the new BLL method and to pass in the `SortExpression` parameter based on the column that the user has requested to sort the results by.</span></span>

<span data-ttu-id="b89c5-189">Als erstes ändern die s ObjectDataSource `SelectMethod` aus `GetProductsPaged` auf `GetProductsPagedAndSorted`.</span><span class="sxs-lookup"><span data-stu-id="b89c5-189">Start by changing the ObjectDataSource s `SelectMethod` from `GetProductsPaged` to `GetProductsPagedAndSorted`.</span></span> <span data-ttu-id="b89c5-190">Dies kann mithilfe des Assistenten konfigurieren von Datenquellen über das Eigenschaftenfenster oder direkt über die deklarative Syntax erfolgen.</span><span class="sxs-lookup"><span data-stu-id="b89c5-190">This can be done through the Configure Data Source wizard, from the Properties window, or directly through the declarative syntax.</span></span> <span data-ttu-id="b89c5-191">Wir als Nächstes geben Sie einen Wert für das ObjectDataSource-s [ `SortParameterName` Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.sortparametername.aspx).</span><span class="sxs-lookup"><span data-stu-id="b89c5-191">Next, we need to provide a value for the ObjectDataSource s [`SortParameterName` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.sortparametername.aspx).</span></span> <span data-ttu-id="b89c5-192">Wenn diese Eigenschaft festgelegt ist, versucht das ObjectDataSource Übergabe in die GridView s `SortExpression` Eigenschaft, um die `SelectMethod`.</span><span class="sxs-lookup"><span data-stu-id="b89c5-192">If this property is set, the ObjectDataSource attempts to pass in the GridView s `SortExpression` property to the `SelectMethod`.</span></span> <span data-ttu-id="b89c5-193">Insbesondere sucht das ObjectDataSource für einen Eingabeparameter, dessen Name gleich dem Wert von ist, der `SortParameterName` Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="b89c5-193">In particular, the ObjectDataSource looks for an input parameter whose name is equal to the value of the `SortParameterName` property.</span></span> <span data-ttu-id="b89c5-194">Seit der BLL s `GetProductsPagedAndSorted` Methode hat den Expression-Eingabeparameter sortieren mit dem Namen `sortExpression`, legen Sie die s ObjectDataSource `SortExpression` SortExpression Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="b89c5-194">Since the BLL s `GetProductsPagedAndSorted` method has the sort expression input parameter named `sortExpression`, set the ObjectDataSource s `SortExpression` property to sortExpression .</span></span>

<span data-ttu-id="b89c5-195">Nach diesen beiden Änderungen durchführen, sollte das ObjectDataSource-s-Deklarationssyntax etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="b89c5-195">After making these two changes, the ObjectDataSource s declarative syntax should look similar to the following:</span></span>


[!code-aspx[Main](sorting-custom-paged-data-cs/samples/sample5.aspx)]

> [!NOTE]
> <span data-ttu-id="b89c5-196">Wie stellen Sie sicher, dass das ObjectDataSource verwendet wird, mit dem vorherigen Lernprogramm *nicht* SortExpression, StartRowIndex oder MaximumRows Eingabeparameter in seiner SelectParameters-Auflistung enthalten.</span><span class="sxs-lookup"><span data-stu-id="b89c5-196">As with the preceding tutorial, ensure that the ObjectDataSource does *not* include the sortExpression, startRowIndex, or maximumRows input parameters in its SelectParameters collection.</span></span>


<span data-ttu-id="b89c5-197">Zum Aktivieren der Sortierung in die GridView einfach das Kontrollkästchen Sortieren aktivieren im GridView s Smarttag, die die GridView s festlegt `AllowSorting` Eigenschaft `true` und verursacht den Headertext für jede Spalte als LinkButton gerendert werden soll.</span><span class="sxs-lookup"><span data-stu-id="b89c5-197">To enable sorting in the GridView, simply check the Enable Sorting checkbox in the GridView s smart tag, which sets the GridView s `AllowSorting` property to `true` and causing the header text for each column to be rendered as a LinkButton.</span></span> <span data-ttu-id="b89c5-198">Wenn der Endbenutzer auf einem des Headers LinkButtons klickt, erfolgt ein Postback und ablaufen, müssen die folgenden Schritte aus:</span><span class="sxs-lookup"><span data-stu-id="b89c5-198">When the end user clicks on one of the header LinkButtons, a postback ensues and the following steps transpire:</span></span>

1. <span data-ttu-id="b89c5-199">Die GridView Updates seine [ `SortExpression` Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sortexpression.aspx) auf den Wert von der `SortExpression` des Felds, dessen Header Link geklickt wurde,</span><span class="sxs-lookup"><span data-stu-id="b89c5-199">The GridView updates its [`SortExpression` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sortexpression.aspx) to the value of the `SortExpression` of the field whose header link was clicked</span></span>
2. <span data-ttu-id="b89c5-200">Das ObjectDataSource ruft die BLL s `GetProductsPagedAndSorted` -Methode auf und übergibt die GridView-s `SortExpression` Eigenschaft als Wert für die Methode s `sortExpression` input-Parameter (zusammen mit dem entsprechenden `startRowIndex` und `maximumRows` Werte für Eingabeparameter)</span><span class="sxs-lookup"><span data-stu-id="b89c5-200">The ObjectDataSource invokes the BLL s `GetProductsPagedAndSorted` method, passing in the GridView s `SortExpression` property as the value for the method s `sortExpression` input parameter (along with the appropriate `startRowIndex` and `maximumRows` input parameter values)</span></span>
3. <span data-ttu-id="b89c5-201">Die BLL Ruft die DAL s `GetProductsPagedAndSorted` Methode</span><span class="sxs-lookup"><span data-stu-id="b89c5-201">The BLL invokes the DAL s `GetProductsPagedAndSorted` method</span></span>
4. <span data-ttu-id="b89c5-202">Die DAL führt die `GetProductsPagedAndSorted` gespeicherte Prozedur übergeben, der `@sortExpression` Parameter (zusammen mit der `@startRowIndex` und `@maximumRows` Werte für Eingabeparameter)</span><span class="sxs-lookup"><span data-stu-id="b89c5-202">The DAL executes the `GetProductsPagedAndSorted` stored procedure, passing in the `@sortExpression` parameter (along with the `@startRowIndex` and `@maximumRows` input parameter values)</span></span>
5. <span data-ttu-id="b89c5-203">Die gespeicherte Prozedur gibt die entsprechenden Teilmenge der Daten an die BLL, das an das ObjectDataSource zurückgegeben; Diese Daten ist dann an die GridView gebunden, in HTML gerendert und an den Endbenutzer</span><span class="sxs-lookup"><span data-stu-id="b89c5-203">The stored procedure returns the appropriate subset of data to the BLL, which returns it to the ObjectDataSource; this data is then bound to the GridView, rendered into HTML, and sent down to the end user</span></span>

<span data-ttu-id="b89c5-204">Abbildung 7 zeigt die erste Seite der Ergebnisse sortiert nach der `UnitPrice` in aufsteigender Reihenfolge.</span><span class="sxs-lookup"><span data-stu-id="b89c5-204">Figure 7 shows the first page of results when sorted by the `UnitPrice` in ascending order.</span></span>


<span data-ttu-id="b89c5-205">[![Die Ergebnisse sind nach den Einzelpreis sortiert.](sorting-custom-paged-data-cs/_static/image10.png)](sorting-custom-paged-data-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="b89c5-205">[![The Results are Sorted by the UnitPrice](sorting-custom-paged-data-cs/_static/image10.png)](sorting-custom-paged-data-cs/_static/image9.png)</span></span>

<span data-ttu-id="b89c5-206">**Abbildung 7**: die Ergebnisse werden anhand der Einzelpreis sortiert ([klicken Sie hier, um das Bild in voller Größe angezeigt](sorting-custom-paged-data-cs/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="b89c5-206">**Figure 7**: The Results are Sorted by the UnitPrice ([Click to view full-size image](sorting-custom-paged-data-cs/_static/image11.png))</span></span>


<span data-ttu-id="b89c5-207">Während die aktuelle Implementierung ordnungsgemäß sortieren Sie die Ergebnisse nach Produktname, Kategoriename, Menge pro Einheit und Preis pro Einheit kann, versuchen Sie zum Sortieren der Ergebnisse der Lieferant die Name-Ergebnisse in einer Laufzeitausnahme (siehe Abbildung 8).</span><span class="sxs-lookup"><span data-stu-id="b89c5-207">While the current implementation can correctly sort the results by product name, category name, quantity per unit, and unit price, attempting to order the results by the supplier name results in a runtime exception (see Figure 8).</span></span>


![Es wird versucht, zum Sortieren der Ergebnisse durch die Ergebnisse der Lieferanten in der folgenden Common Language Runtime-Ausnahme](sorting-custom-paged-data-cs/_static/image12.png)

<span data-ttu-id="b89c5-209">**Abbildung 8**: Versuch zum Sortieren der Ergebnisse durch die Ergebnisse der Lieferanten in der folgenden Common Language Runtime-Ausnahme</span><span class="sxs-lookup"><span data-stu-id="b89c5-209">**Figure 8**: Attempting to Sort the Results by the Supplier Results in the Following Runtime Exception</span></span>


<span data-ttu-id="b89c5-210">Diese Ausnahme tritt auf, weil die `SortExpression` der GridView s `SupplierName` BoundField festgelegt ist, um `SupplierName`.</span><span class="sxs-lookup"><span data-stu-id="b89c5-210">This exception occurs because the `SortExpression` of the GridView s `SupplierName` BoundField is set to `SupplierName`.</span></span> <span data-ttu-id="b89c5-211">Mit dem Namen des Lieferanten s jedoch in der `Suppliers` Tabelle aufgerufen wird `CompanyName` wir wurden als Alias der Name dieser Spalte als `SupplierName`.</span><span class="sxs-lookup"><span data-stu-id="b89c5-211">However, the supplier s name in the `Suppliers` table is actually called `CompanyName` we have been aliased this column name as `SupplierName`.</span></span> <span data-ttu-id="b89c5-212">Allerdings die `OVER` -Klausel, indem Sie die `ROW_NUMBER()` Funktion kann nicht den Alias und den tatsächlichen Spaltennamen verwendet.</span><span class="sxs-lookup"><span data-stu-id="b89c5-212">However, the `OVER` clause used by the `ROW_NUMBER()` function cannot use the alias and must use the actual column name.</span></span> <span data-ttu-id="b89c5-213">Ändern Sie deshalb die `SupplierName` BoundField-s `SortExpression` aus Lieferantenname CompanyName (siehe Abbildung 9).</span><span class="sxs-lookup"><span data-stu-id="b89c5-213">Therefore, change the `SupplierName` BoundField s `SortExpression` from SupplierName to CompanyName (see Figure 9).</span></span> <span data-ttu-id="b89c5-214">Wie in Abbildung 10 gezeigt, können nach dieser Änderung die Ergebnisse vom Lieferanten sortiert.</span><span class="sxs-lookup"><span data-stu-id="b89c5-214">As Figure 10 shows, after this change the results can be sorted by the supplier.</span></span>


![Lieferantenname BoundField-s SortExpression CompanyName ändern](sorting-custom-paged-data-cs/_static/image13.png)

<span data-ttu-id="b89c5-216">**Abbildung 9**: Lieferantenname BoundField-s SortExpression CompanyName ändern</span><span class="sxs-lookup"><span data-stu-id="b89c5-216">**Figure 9**: Change the SupplierName BoundField s SortExpression to CompanyName</span></span>


<span data-ttu-id="b89c5-217">[![Die Ergebnisse können jetzt Lieferant sortiert werden](sorting-custom-paged-data-cs/_static/image15.png)](sorting-custom-paged-data-cs/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="b89c5-217">[![The Results Can Now Be Sorted by Supplier](sorting-custom-paged-data-cs/_static/image15.png)](sorting-custom-paged-data-cs/_static/image14.png)</span></span>

<span data-ttu-id="b89c5-218">**Abbildung 10**: die Ergebnisse können jetzt sortiert werden vom Lieferanten ([klicken Sie hier, um das Bild in voller Größe angezeigt](sorting-custom-paged-data-cs/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="b89c5-218">**Figure 10**: The Results Can Now Be Sorted by Supplier ([Click to view full-size image](sorting-custom-paged-data-cs/_static/image16.png))</span></span>


## <a name="summary"></a><span data-ttu-id="b89c5-219">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="b89c5-219">Summary</span></span>

<span data-ttu-id="b89c5-220">Das benutzerdefinierte Paging-Implementierung, die wir im vorherigen Lernprogramm untersucht erforderlich, dass die Reihenfolge, wurden die Ergebnisse sortiert werden, zur Entwurfszeit angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="b89c5-220">The custom paging implementation we examined in the preceding tutorial required that the order by which the results were to be sorted be specified at design time.</span></span> <span data-ttu-id="b89c5-221">Kurz gesagt, bedeutet dies, dass das benutzerdefinierte Paging-Implementierung, die wir implementiert keine, zur gleichen Zeit Sortierfunktionen konnte.</span><span class="sxs-lookup"><span data-stu-id="b89c5-221">In short, this meant that the custom paging implementation we implemented could not, at the same time, provide sorting capabilities.</span></span> <span data-ttu-id="b89c5-222">In diesem Lernprogramm überwand wir diese Einschränkung durch die Erweiterung von der gespeicherten Prozedur aus dem ersten einschließen einer `@sortExpression` Eingabeparameter mit dem die Ergebnisse sortiert werden können.</span><span class="sxs-lookup"><span data-stu-id="b89c5-222">In this tutorial we overcame this limitation by extending the stored procedure from the first to include a `@sortExpression` input parameter by which the results could be sorted.</span></span>

<span data-ttu-id="b89c5-223">Nach dem Erstellen dieser Prozedur und erstellen neue Methoden in der DAL und BLL gespeichert, wir können eine GridView implementieren, die beide sortieren angeboten und benutzerdefinierte paging durch Konfigurieren der ObjectDataSource GridView s aktuelle übergeben `SortExpression` Eigenschaft, um die BLL `SelectMethod`.</span><span class="sxs-lookup"><span data-stu-id="b89c5-223">After creating this stored procedure and creating new methods in the DAL and BLL, we were able to implement a GridView that offered both sorting and custom paging by configuring the ObjectDataSource to pass in the GridView s current `SortExpression` property to the BLL `SelectMethod`.</span></span>

<span data-ttu-id="b89c5-224">Viel Spaß beim Programmieren!</span><span class="sxs-lookup"><span data-stu-id="b89c5-224">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="b89c5-225">Informationen zum Autor</span><span class="sxs-lookup"><span data-stu-id="b89c5-225">About the Author</span></span>

<span data-ttu-id="b89c5-226">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor von sieben ASP/ASP.NET-Büchern und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), Microsoft Web-Technologien seit 1998 arbeitet.</span><span class="sxs-lookup"><span data-stu-id="b89c5-226">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="b89c5-227">Scott fungiert als ein unabhängiger Berater, Trainer und Writer.</span><span class="sxs-lookup"><span data-stu-id="b89c5-227">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="b89c5-228">Sein neueste Buch wird [ *Sams Schulen selbst ASP.NET 2.0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="b89c5-228">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="b89c5-229">Er die erreicht werden kann, zur [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) oder über seinen Blog die finden Sie unter [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="b89c5-229">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="b89c5-230">Besonderen Dank an</span><span class="sxs-lookup"><span data-stu-id="b89c5-230">Special Thanks To</span></span>

<span data-ttu-id="b89c5-231">Diese Reihe von Lernprogrammen wurde durch viele nützliche Bearbeiter überprüft.</span><span class="sxs-lookup"><span data-stu-id="b89c5-231">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="b89c5-232">Lead Prüfer für dieses Lernprogramm wurde Carlos Santos.</span><span class="sxs-lookup"><span data-stu-id="b89c5-232">Lead reviewer for this tutorial was Carlos Santos.</span></span> <span data-ttu-id="b89c5-233">Meine bevorstehende MSDN-Artikel Überprüfen von Interesse?</span><span class="sxs-lookup"><span data-stu-id="b89c5-233">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="b89c5-234">Wenn dies der Fall ist, löschen Sie mich zeilenweise [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="b89c5-234">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="b89c5-235">[Zurück](efficiently-paging-through-large-amounts-of-data-cs.md)
[Weiter](creating-a-customized-sorting-user-interface-cs.md)</span><span class="sxs-lookup"><span data-stu-id="b89c5-235">[Previous](efficiently-paging-through-large-amounts-of-data-cs.md)
[Next](creating-a-customized-sorting-user-interface-cs.md)</span></span>
