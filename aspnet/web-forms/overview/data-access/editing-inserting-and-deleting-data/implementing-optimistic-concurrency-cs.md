---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/implementing-optimistic-concurrency-cs
title: "Implementieren der vollständigen Parallelität (c#) | Microsoft Docs"
author: rick-anderson
description: "Für eine Webanwendung, die mehrere Benutzer Daten bearbeiten kann, besteht das Risiko, dass zwei Benutzer gleichzeitig dieselben Daten bearbeiten werden möglicherweise zur Verfügung. In diesem Tutori..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/17/2006
ms.topic: article
ms.assetid: 56e15b33-93b8-43ad-8e19-44c6647ea05c
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/implementing-optimistic-concurrency-cs
msc.type: authoredcontent
ms.openlocfilehash: a19e6c320838849e10d2aa397a23a0ee906bac22
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/24/2018
---
<a name="implementing-optimistic-concurrency-c"></a><span data-ttu-id="b23c3-104">Implementieren der vollständigen Parallelität (c#)</span><span class="sxs-lookup"><span data-stu-id="b23c3-104">Implementing Optimistic Concurrency (C#)</span></span>
====================
<span data-ttu-id="b23c3-105">durch [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="b23c3-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="b23c3-106">[Beispiel-App herunterladen](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_21_CS.exe) oder [PDF herunterladen](implementing-optimistic-concurrency-cs/_static/datatutorial21cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="b23c3-106">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_21_CS.exe) or [Download PDF](implementing-optimistic-concurrency-cs/_static/datatutorial21cs1.pdf)</span></span>

> <span data-ttu-id="b23c3-107">Für eine Webanwendung, die mehrere Benutzer Daten bearbeiten kann, besteht das Risiko, dass zwei Benutzer gleichzeitig dieselben Daten bearbeiten werden möglicherweise zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="b23c3-107">For a web application that allows multiple users to edit data, there is the risk that two users may be editing the same data at the same time.</span></span> <span data-ttu-id="b23c3-108">In diesem Lernprogramm implementieren wir Steuerung durch vollständige Parallelität, um dieses Risiko zu behandeln.</span><span class="sxs-lookup"><span data-stu-id="b23c3-108">In this tutorial we'll implement optimistic concurrency control to handle this risk.</span></span>


## <a name="introduction"></a><span data-ttu-id="b23c3-109">Einführung</span><span class="sxs-lookup"><span data-stu-id="b23c3-109">Introduction</span></span>

<span data-ttu-id="b23c3-110">Für Webanwendungen, die nur Benutzer Daten anzeigen können, oder für Benutzer, die nur einen einzigen Benutzer enthalten, wer Daten ändern kann, besteht keine Gefahr von zwei gleichzeitigen Benutzern versehentliches Überschreiben von einer anderen Änderungen.</span><span class="sxs-lookup"><span data-stu-id="b23c3-110">For web applications that only allow users to view data, or for those that include only a single user who can modify data, there's no threat of two concurrent users accidentally overwriting one another's changes.</span></span> <span data-ttu-id="b23c3-111">Für Webanwendungen, die mehrere Benutzer zu aktualisieren oder Löschen von Daten ermöglichen, besteht jedoch das Potenzial für einen Benutzer Änderungen mit einem anderen gleichzeitigen Benutzer miteinander in Konflikt geraten.</span><span class="sxs-lookup"><span data-stu-id="b23c3-111">For web applications that allow multiple users to update or delete data, however, there's the potential for one user's modifications to clash with another concurrent user's.</span></span> <span data-ttu-id="b23c3-112">Ohne jede Parallelität Richtlinie vorhanden Wenn zwei Benutzer gleichzeitig einen einzelnen Datensatz bearbeiten werden der Benutzer, die Änderungen ein Commit ausgeführt, wird zuletzt die vom ersten vorgenommenen Änderungen überschrieben.</span><span class="sxs-lookup"><span data-stu-id="b23c3-112">Without any concurrency policy in place, when two users are simultaneously editing a single record, the user who commits her changes last will override the changes made by the first.</span></span>

<span data-ttu-id="b23c3-113">Angenommen Sie, dass zwei Benutzer, Jisun und Sam, sowohl eine Seite in der vorliegenden Anwendung anzeigten, die zulässig Besucher aktualisieren und löschen die Produkte über ein GridView-Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="b23c3-113">For example, imagine that two users, Jisun and Sam, were both visiting a page in our application that allowed visitors to update and delete the products through a GridView control.</span></span> <span data-ttu-id="b23c3-114">Beide klicken Sie auf die Schaltfläche "Bearbeiten", in der GridView ungefähr zur selben Zeit.</span><span class="sxs-lookup"><span data-stu-id="b23c3-114">Both click the Edit button in the GridView around the same time.</span></span> <span data-ttu-id="b23c3-115">Jisun ändert sich der Name des Produkts in "Chai Tee" und klickt auf die Schaltfläche "Aktualisieren".</span><span class="sxs-lookup"><span data-stu-id="b23c3-115">Jisun changes the product name to "Chai Tea" and clicks the Update button.</span></span> <span data-ttu-id="b23c3-116">Das Ergebnis ist ein `UPDATE` -Anweisung, die an die Datenbank gesendet wird, die festlegt *alle* das Produkt aktualisierbaren Felder (obwohl Jisun nur für ein Feld aktualisiert `ProductName`).</span><span class="sxs-lookup"><span data-stu-id="b23c3-116">The net result is an `UPDATE` statement that is sent to the database, which sets *all* of the product's updateable fields (even though Jisun only updated one field, `ProductName`).</span></span> <span data-ttu-id="b23c3-117">Zu diesem Zeitpunkt weist die Datenbank die Werte "Chai Tee," die Kategorie Getränke Lieferanten Exotic Liquids für dieses bestimmte Produkt und so weiter.</span><span class="sxs-lookup"><span data-stu-id="b23c3-117">At this point in time, the database has the values "Chai Tea," the category Beverages, the supplier Exotic Liquids, and so on for this particular product.</span></span> <span data-ttu-id="b23c3-118">Allerdings zeigt GridView Sam Bildschirm als "Chai" weiterhin den Produktnamen in der bearbeitbaren GridView-Zeile.</span><span class="sxs-lookup"><span data-stu-id="b23c3-118">However, the GridView on Sam's screen still shows the product name in the editable GridView row as "Chai".</span></span> <span data-ttu-id="b23c3-119">Einige Sekunden nach Jisuns Änderungen ein Commit ausgeführt wurde, wurden Sam aktualisiert die Kategorie "Gewürze" und klickt auf Update.</span><span class="sxs-lookup"><span data-stu-id="b23c3-119">A few seconds after Jisun's changes have been committed, Sam updates the category to Condiments and clicks Update.</span></span> <span data-ttu-id="b23c3-120">Dies führt zu einer `UPDATE` Anweisung gesendet, um die Datenbank, die den Produktnamen, "Chai" legt die `CategoryID` zu den entsprechenden Getränke Kategorie-ID und So weiter.</span><span class="sxs-lookup"><span data-stu-id="b23c3-120">This results in an `UPDATE` statement sent to the database that sets the product name to "Chai," the `CategoryID` to the corresponding Beverages category ID, and so on.</span></span> <span data-ttu-id="b23c3-121">Der Jisun Änderungen an den Produktnamen wurde überschrieben.</span><span class="sxs-lookup"><span data-stu-id="b23c3-121">Jisun's changes to the product name have been overwritten.</span></span> <span data-ttu-id="b23c3-122">Abbildung 1 zeigt grafisch dieser Serie von Ereignissen.</span><span class="sxs-lookup"><span data-stu-id="b23c3-122">Figure 1 graphically depicts this series of events.</span></span>


<span data-ttu-id="b23c3-123">[![Wenn zwei Benutzer gleichzeitig einen Datensatz zu aktualisieren ändert es s Potenzial für einen Benutzer zum Überschreiben von anderen](implementing-optimistic-concurrency-cs/_static/image2.png)](implementing-optimistic-concurrency-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="b23c3-123">[![When Two Users Simultaneously Update a Record There s Potential for One User s Changes to Overwrite the Other s](implementing-optimistic-concurrency-cs/_static/image2.png)](implementing-optimistic-concurrency-cs/_static/image1.png)</span></span>

<span data-ttu-id="b23c3-124">**Abbildung 1**: Wenn zwei Benutzer gleichzeitig Update ein Datensatz vorhanden s Potenzial für einen Benutzer geändert wird, überschreiben die anderen s ([klicken Sie hier, um das Bild in voller Größe angezeigt](implementing-optimistic-concurrency-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="b23c3-124">**Figure 1**: When Two Users Simultaneously Update a Record There s Potential for One User s Changes to Overwrite the Other s ([Click to view full-size image](implementing-optimistic-concurrency-cs/_static/image3.png))</span></span>


<span data-ttu-id="b23c3-125">Auf ähnliche Weise, wenn zwei Benutzer eine Seite besuchen, ein Benutzer möglicherweise in einem Datensatz aktualisieren, wenn sie von einem anderen Benutzer gelöscht wird.</span><span class="sxs-lookup"><span data-stu-id="b23c3-125">Similarly, when two users are visiting a page, one user might be in the midst of updating a record when it is deleted by another user.</span></span> <span data-ttu-id="b23c3-126">Alternativ dazu können Sie zwischen, wenn ein Benutzer eine Seite geladen wird, und wenn sie auf die Schaltfläche "löschen" klicken, ein anderer Benutzer den Inhalt für diesen Datensatz geändert worden sein.</span><span class="sxs-lookup"><span data-stu-id="b23c3-126">Or, between when a user loads a page and when they click the Delete button, another user may have modified the contents of that record.</span></span>

<span data-ttu-id="b23c3-127">Es gibt drei [parallelitätssteuerung](http://en.wikipedia.org/wiki/Concurrency_control) Strategien zur Verfügung:</span><span class="sxs-lookup"><span data-stu-id="b23c3-127">There are three [concurrency control](http://en.wikipedia.org/wiki/Concurrency_control) strategies available:</span></span>

- <span data-ttu-id="b23c3-128">**Nichts Unternehmen** -ist gleichzeitiger Benutzer denselben Datensatz ändern, können Sie die letzten Commits win (das Standardverhalten)</span><span class="sxs-lookup"><span data-stu-id="b23c3-128">**Do Nothing** -if concurrent users are modifying the same record, let the last commit win (the default behavior)</span></span>
- <span data-ttu-id="b23c3-129">[**Vollständige Parallelität** ](http://en.wikipedia.org/wiki/Optimistic_concurrency_control) -gehen davon aus, die besteht möglicherweise Parallelität Konflikt hin und wieder, den Großteil der Zeit, die solche Konflikte auftreten, wird nicht; daher, wenn ein Konflikt einfach informieren Sie den Benutzer, die ihre Änderungen kann nicht gespeichert werden, weil ein anderer Benutzer die gleichen Daten geändert hat</span><span class="sxs-lookup"><span data-stu-id="b23c3-129">[**Optimistic Concurrency**](http://en.wikipedia.org/wiki/Optimistic_concurrency_control) - assume that while there may be concurrency conflicts every now and then, the vast majority of the time such conflicts won't arise; therefore, if a conflict does arise, simply inform the user that their changes can't be saved because another user has modified the same data</span></span>
- <span data-ttu-id="b23c3-130">**Die eingeschränkte Parallelität** -Parallelitätskonflikte sind inzwischen und, dass der Benutzer wird nicht toleriert wird nicht angewiesen, ihre Änderungen wurden nicht gespeichert, aufgrund gleichzeitiger Aktivität eines anderen Benutzers angenommen; daher, wenn ein Benutzer Aktualisieren eines Datensatzes startet, Sie sperren , um anderen Benutzern bearbeiten oder löschen diesen Datensatz aus, bis der Benutzer die Änderungen ein Commit zu verhindern</span><span class="sxs-lookup"><span data-stu-id="b23c3-130">**Pessimistic Concurrency** - assume that concurrency conflicts are commonplace and that users won't tolerate being told their changes weren't saved due to another user's concurrent activity; therefore, when one user starts updating a record, lock it, thereby preventing any other users from editing or deleting that record until the user commits their modifications</span></span>

<span data-ttu-id="b23c3-131">Alle unsere Lernprogramme verwendet bisher haben Parallelität Auflösung Standardstrategie - nämlich haben wir den letzten Schreibvorgang gewinnen können.</span><span class="sxs-lookup"><span data-stu-id="b23c3-131">All of our tutorials thus far have used the default concurrency resolution strategy - namely, we've let the last write win.</span></span> <span data-ttu-id="b23c3-132">In diesem Lernprogramm untersuchen wir zum Implementieren der Steuerung durch vollständige Parallelität.</span><span class="sxs-lookup"><span data-stu-id="b23c3-132">In this tutorial we'll examine how to implement optimistic concurrency control.</span></span>

> [!NOTE]
> <span data-ttu-id="b23c3-133">Es wird nicht durch eingeschränkte Parallelität Beispiele in diesem Lernprogramm Reihe betrachten.</span><span class="sxs-lookup"><span data-stu-id="b23c3-133">We won't look at pessimistic concurrency examples in this tutorial series.</span></span> <span data-ttu-id="b23c3-134">Die eingeschränkte Parallelität wird selten verwendet werden, weil z. B. gesperrt wurde, nicht ordnungsgemäß aufgegeben, kann verhindern, dass andere Benutzer aktualisieren von Daten.</span><span class="sxs-lookup"><span data-stu-id="b23c3-134">Pessimistic concurrency is rarely used because such locks, if not properly relinquished, can prevent other users from updating data.</span></span> <span data-ttu-id="b23c3-135">Z. B. wenn ein Benutzer einen Datensatz für die Bearbeitung gesperrt, und klicken Sie dann für den Tag vor dem entsperren verlässt, wird kein anderer Benutzer werden diesen Datensatz zu aktualisieren, bis der ursprünglichen Benutzer zurückgibt und seine standortupdates kann.</span><span class="sxs-lookup"><span data-stu-id="b23c3-135">For example, if a user locks a record for editing and then leaves for the day before unlocking it, no other user will be able to update that record until the original user returns and completes his update.</span></span> <span data-ttu-id="b23c3-136">Aus diesem Grund in Situationen, in denen die eingeschränkte Parallelität verwendet wird, besteht in der Regel ein Timeout, die erreicht wird, bricht die Sperre ab.</span><span class="sxs-lookup"><span data-stu-id="b23c3-136">Therefore, in situations where pessimistic concurrency is used, there's typically a timeout that, if reached, cancels the lock.</span></span> <span data-ttu-id="b23c3-137">Sales Ticket-Websites, die Sperren einen bestimmten sitzen-Speicherort für kurze Zeit, während der Benutzer mit der Order-ausgeführt wird, ist ein Beispiel der Steuerung durch eingeschränkte Parallelität.</span><span class="sxs-lookup"><span data-stu-id="b23c3-137">Ticket sales websites, which lock a particular seating location for short period while the user completes the order process, is an example of pessimistic concurrency control.</span></span>


## <a name="step-1-looking-at-how-optimistic-concurrency-is-implemented"></a><span data-ttu-id="b23c3-138">Schritt 1: Ansehen wie vollständige Parallelität wird implementiert.</span><span class="sxs-lookup"><span data-stu-id="b23c3-138">Step 1: Looking at How Optimistic Concurrency is Implemented</span></span>

<span data-ttu-id="b23c3-139">Steuerung durch vollständige Parallelität funktioniert, indem Sie sicherstellen, dass der Datensatz aktualisiert oder gelöscht werden die gleichen Werte wie beim Aktualisieren oder Löschen von Prozess gestartet.</span><span class="sxs-lookup"><span data-stu-id="b23c3-139">Optimistic concurrency control works by ensuring that the record being updated or deleted has the same values as it did when the updating or deleting process started.</span></span> <span data-ttu-id="b23c3-140">Beim Klicken auf die Schaltfläche "Bearbeiten", in einem bearbeitbaren GridView "" sind die Werte des Datensatzes beispielsweise aus der Datenbank gelesen und in die Textfelder und anderen Websteuerelementen angezeigt.</span><span class="sxs-lookup"><span data-stu-id="b23c3-140">For example, when clicking the Edit button in an editable GridView, the record's values are read from the database and displayed in TextBoxes and other Web controls.</span></span> <span data-ttu-id="b23c3-141">Diese ursprünglichen Werte werden durch die GridView gespeichert.</span><span class="sxs-lookup"><span data-stu-id="b23c3-141">These original values are saved by the GridView.</span></span> <span data-ttu-id="b23c3-142">Später, nachdem der Benutzer mit der ihre Änderungen und klickt auf die Schaltfläche "Aktualisieren", werden die ursprünglichen Werte sowie die neuen Werte der Geschäftslogikschicht und klicken Sie dann auf der Datenzugriffsebene gesendet.</span><span class="sxs-lookup"><span data-stu-id="b23c3-142">Later, after the user makes her changes and clicks the Update button, the original values plus the new values are sent to the Business Logic Layer, and then down to the Data Access Layer.</span></span> <span data-ttu-id="b23c3-143">Die Datenzugriffsebene muss es sich um eine SQL-Anweisung ausgeben, die nur den Datensatz aktualisiert wird, wenn die ursprünglichen Werte, die der Benutzer bearbeiten gestartet, die Werte noch in der Datenbank identisch sind.</span><span class="sxs-lookup"><span data-stu-id="b23c3-143">The Data Access Layer must issue a SQL statement that will only update the record if the original values that the user started editing are identical to the values still in the database.</span></span> <span data-ttu-id="b23c3-144">Abbildung 2 zeigt diese Abfolge von Ereignissen.</span><span class="sxs-lookup"><span data-stu-id="b23c3-144">Figure 2 depicts this sequence of events.</span></span>


<span data-ttu-id="b23c3-145">[![Für die Update- oder Delete erfolgreich ausgeführt werden soll müssen die ursprünglichen Werte der aktuellen Datenbankwerte gleich sein.](implementing-optimistic-concurrency-cs/_static/image5.png)](implementing-optimistic-concurrency-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="b23c3-145">[![For the Update or Delete to Succeed, the Original Values Must Be Equal to the Current Database Values](implementing-optimistic-concurrency-cs/_static/image5.png)](implementing-optimistic-concurrency-cs/_static/image4.png)</span></span>

<span data-ttu-id="b23c3-146">**Abbildung 2**: für die Update- oder Delete SUCCEED, die ursprünglichen Werte müssen werden gleich der aktuellen Datenbankwerte ([klicken Sie hier, um das Bild in voller Größe angezeigt](implementing-optimistic-concurrency-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="b23c3-146">**Figure 2**: For the Update or Delete to Succeed, the Original Values Must Be Equal to the Current Database Values ([Click to view full-size image](implementing-optimistic-concurrency-cs/_static/image6.png))</span></span>


<span data-ttu-id="b23c3-147">Es gibt verschiedene Ansätze zum Implementieren der vollständigen Parallelität (finden Sie unter [Peter A. Bromberg](http://peterbromberg.net/)des [Optmistic Parallelität aktualisieren Logik](http://www.eggheadcafe.com/articles/20050719.asp) für einen kurzen Blick auf eine Reihe von Optionen).</span><span class="sxs-lookup"><span data-stu-id="b23c3-147">There are various approaches to implementing optimistic concurrency (see [Peter A. Bromberg](http://peterbromberg.net/)'s [Optmistic Concurrency Updating Logic](http://www.eggheadcafe.com/articles/20050719.asp) for a brief look at a number of options).</span></span> <span data-ttu-id="b23c3-148">ADO.NET typisierte DataSet stellt eine Implementierung, die mit nur der Takt des ein Kontrollkästchen konfiguriert werden kann.</span><span class="sxs-lookup"><span data-stu-id="b23c3-148">The ADO.NET Typed DataSet provides one implementation that can be configured with just the tick of a checkbox.</span></span> <span data-ttu-id="b23c3-149">Aktivieren vollständigen Parallelität für ein TableAdapter in das typisierte DataSet TableAdapters ergänzt `UPDATE` und `DELETE` Anweisungen, die einen Vergleich aller von den ursprünglichen Werten in der `WHERE` Klausel.</span><span class="sxs-lookup"><span data-stu-id="b23c3-149">Enabling optimistic concurrency for a TableAdapter in the Typed DataSet augments the TableAdapter's `UPDATE` and `DELETE` statements to include a comparison of all of the original values in the `WHERE` clause.</span></span> <span data-ttu-id="b23c3-150">Die folgenden `UPDATE` -Anweisung aktualisiert z. B. den Namen und den Preis eines Produkts nur, wenn die aktuellen Datenbankwerte die Werte gleich, die ursprünglich abgerufen wurden sind, wenn den Datensatz in die GridView zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="b23c3-150">The following `UPDATE` statement, for example, updates the name and price of a product only if the current database values are equal to the values that were originally retrieved when updating the record in the GridView.</span></span> <span data-ttu-id="b23c3-151">Die `@ProductName` und `@UnitPrice` Parameter enthalten die neuen Werten, die durch den Benutzer eingegeben werden, während `@original_ProductName` und `@original_UnitPrice` enthalten die Werte, die ursprünglich in die GridView geladen wurden, wenn auf die Schaltfläche "Bearbeiten" geklickt wurde:</span><span class="sxs-lookup"><span data-stu-id="b23c3-151">The `@ProductName` and `@UnitPrice` parameters contain the new values entered by the user, whereas `@original_ProductName` and `@original_UnitPrice` contain the values that were originally loaded into the GridView when the Edit button was clicked:</span></span>


[!code-sql[Main](implementing-optimistic-concurrency-cs/samples/sample1.sql)]

> [!NOTE]
> <span data-ttu-id="b23c3-152">Dies `UPDATE` Anweisung wurde zur besseren Lesbarkeit vereinfacht.</span><span class="sxs-lookup"><span data-stu-id="b23c3-152">This `UPDATE` statement has been simplified for readability.</span></span> <span data-ttu-id="b23c3-153">In der Praxis die `UnitPrice` Einchecken der `WHERE` Klausel wäre komplizierter seit `UnitPrice` darf `NULL` s und es wird überprüft, wenn `NULL = NULL` gibt immer "false" zurück (Sie müssen stattdessen `IS NULL`).</span><span class="sxs-lookup"><span data-stu-id="b23c3-153">In practice, the `UnitPrice` check in the `WHERE` clause would be more involved since `UnitPrice` can contain `NULL` s and checking if `NULL = NULL` always returns False (instead you must use `IS NULL`).</span></span>


<span data-ttu-id="b23c3-154">Zusätzlich zur Verwendung einer anderen zugrunde liegenden `UPDATE` -Anweisung, konfigurieren einen TableAdapter verwenden optimistische Parallelität ändert auch die Signatur von seiner DB direkte Methoden.</span><span class="sxs-lookup"><span data-stu-id="b23c3-154">In addition to using a different underlying `UPDATE` statement, configuring a TableAdapter to use optimistic concurrency also modifies the signature of its DB direct methods.</span></span> <span data-ttu-id="b23c3-155">Aus unserem ersten Lernprogramm, wissen Sie bereits [ *erstellen eine Datenzugriffsschicht*](../introduction/creating-a-data-access-layer-cs.md), die direkte DB-Methoden sind solche, die eine Liste von skalaren akzeptiert Werte als Eingabeparameter (statt einer stark typisierten DataRow oder DataTable-Instanz).</span><span class="sxs-lookup"><span data-stu-id="b23c3-155">Recall from our first tutorial, [*Creating a Data Access Layer*](../introduction/creating-a-data-access-layer-cs.md), that DB direct methods were those that accepts a list of scalar values as input parameters (rather than a strongly-typed DataRow or DataTable instance).</span></span> <span data-ttu-id="b23c3-156">Bei Verwendung von Parallelität, die direkte DB `Update()` und `Delete()` erfolgen Eingabeparameter für die ursprünglichen Werte ebenfalls.</span><span class="sxs-lookup"><span data-stu-id="b23c3-156">When using optimistic concurrency, the DB direct `Update()` and `Delete()` methods include input parameters for the original values as well.</span></span> <span data-ttu-id="b23c3-157">Darüber hinaus aktualisieren Sie den Code in die BLL für die Verwendung des Batchs Muster (die `Update()` methodenüberladungen, die Skalarwerte, anstatt DataRows und DataTables akzeptieren) muss ebenfalls geändert werden.</span><span class="sxs-lookup"><span data-stu-id="b23c3-157">Moreover, the code in the BLL for using the batch update pattern (the `Update()` method overloads that accept DataRows and DataTables rather than scalar values) must be changed as well.</span></span>

<span data-ttu-id="b23c3-158">Stattdessen als Erweitern unsere vorhandenen DAL TableAdapters auf vollständige Parallelität (das Ändern der BLL aufnehmen einer würde), wir verwenden stattdessen Erstellen eines neuen typisierten Datasets mit dem Namen `NorthwindOptimisticConcurrency`, an denen wir Hinzufügen einer `Products` TableAdapter, vollständigen Parallelität wird verwendet.</span><span class="sxs-lookup"><span data-stu-id="b23c3-158">Rather than extend our existing DAL's TableAdapters to use optimistic concurrency (which would necessitate changing the BLL to accommodate), let's instead create a new Typed DataSet named `NorthwindOptimisticConcurrency`, to which we'll add a `Products` TableAdapter that uses optimistic concurrency.</span></span> <span data-ttu-id="b23c3-159">Nach, die wir erstellen eine `ProductsOptimisticConcurrencyBLL` Business Logic Layer-Klasse, die die entsprechenden Änderungen an der vollständige Parallelität DAL unterstützen verfügt.</span><span class="sxs-lookup"><span data-stu-id="b23c3-159">Following that, we'll create a `ProductsOptimisticConcurrencyBLL` Business Logic Layer class that has the appropriate modifications to support the optimistic concurrency DAL.</span></span> <span data-ttu-id="b23c3-160">Nachdem diese-standortserverinstanz angeordnet wurden, müssen wir die ASP.NET-Seite zu erstellen sind.</span><span class="sxs-lookup"><span data-stu-id="b23c3-160">Once this groundwork has been laid, we'll be ready to create the ASP.NET page.</span></span>

## <a name="step-2-creating-a-data-access-layer-that-supports-optimistic-concurrency"></a><span data-ttu-id="b23c3-161">Schritt 2: Erstellen eine Datenzugriffsschicht, unterstützt optimistische Parallelität</span><span class="sxs-lookup"><span data-stu-id="b23c3-161">Step 2: Creating a Data Access Layer That Supports Optimistic Concurrency</span></span>

<span data-ttu-id="b23c3-162">Um einen neuen typisierte DataSet zu erstellen, mit der Maustaste auf die `DAL` Ordner innerhalb der `App_Code` Ordner, und fügen Sie ein neues DataSet mit dem Namen `NorthwindOptimisticConcurrency`.</span><span class="sxs-lookup"><span data-stu-id="b23c3-162">To create a new Typed DataSet, right-click on the `DAL` folder within the `App_Code` folder and add a new DataSet named `NorthwindOptimisticConcurrency`.</span></span> <span data-ttu-id="b23c3-163">Wie wir im ersten Lernprogramm gesehen haben, wird dadurch das typisierte DataSet, wird der TableAdapter-Konfigurations-Assistent automatisch gestartet also einen neuen TableAdapter hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="b23c3-163">As we saw in the first tutorial, doing so will add a new TableAdapter to the Typed DataSet, automatically launching the TableAdapter Configuration Wizard.</span></span> <span data-ttu-id="b23c3-164">Im ersten Bildschirm wir aufgefordert, geben Sie die Datenbank, um eine Verbindung mit herstellen: Herstellen einer Verbindung mit der gleichen Datenbank Northwind mithilfe der `NORTHWNDConnectionString` Festlegen von `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="b23c3-164">In the first screen, we're prompted to specify the database to connect to - connect to the same Northwind database using the `NORTHWNDConnectionString` setting from `Web.config`.</span></span>


<span data-ttu-id="b23c3-165">[![Herstellen einer Verbindung mit der gleichen Northwind-Datenbank](implementing-optimistic-concurrency-cs/_static/image8.png)](implementing-optimistic-concurrency-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="b23c3-165">[![Connect to the Same Northwind Database](implementing-optimistic-concurrency-cs/_static/image8.png)](implementing-optimistic-concurrency-cs/_static/image7.png)</span></span>

<span data-ttu-id="b23c3-166">**Abbildung 3**: Herstellen einer Verbindung mit der gleichen Northwind-Datenbank ([klicken Sie hier, um das Bild in voller Größe angezeigt](implementing-optimistic-concurrency-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="b23c3-166">**Figure 3**: Connect to the Same Northwind Database ([Click to view full-size image](implementing-optimistic-concurrency-cs/_static/image9.png))</span></span>


<span data-ttu-id="b23c3-167">Wir werden als Nächstes aufgefordert, wie sich die Daten abzufragen: über eine Ad-hoc-SQL-Anweisung eine neue gespeicherte Prozedur oder eine vorhandene gespeicherte Prozedur.</span><span class="sxs-lookup"><span data-stu-id="b23c3-167">Next, we are prompted as to how to query the data: through an ad-hoc SQL statement, a new stored procedure, or an existing stored procedure.</span></span> <span data-ttu-id="b23c3-168">Da wir in unserer ursprünglichen DAL Ad-hoc-SQL-Abfragen verwendet, verwenden Sie diese Option hier ebenfalls.</span><span class="sxs-lookup"><span data-stu-id="b23c3-168">Since we used ad-hoc SQL queries in our original DAL, use this option here as well.</span></span>


<span data-ttu-id="b23c3-169">[![Geben Sie die Daten zum Abrufen mithilfe einer Ad-hoc-SQL-Anweisung](implementing-optimistic-concurrency-cs/_static/image11.png)](implementing-optimistic-concurrency-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="b23c3-169">[![Specify the Data to Retrieve Using an Ad-Hoc SQL Statement](implementing-optimistic-concurrency-cs/_static/image11.png)](implementing-optimistic-concurrency-cs/_static/image10.png)</span></span>

<span data-ttu-id="b23c3-170">**Abbildung 4**: Geben Sie die Daten abgerufen, die mit Ad-hoc-SQL-Anweisungen ([klicken Sie hier, um das Bild in voller Größe angezeigt](implementing-optimistic-concurrency-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="b23c3-170">**Figure 4**: Specify the Data to Retrieve Using an Ad-Hoc SQL Statement ([Click to view full-size image](implementing-optimistic-concurrency-cs/_static/image12.png))</span></span>


<span data-ttu-id="b23c3-171">Geben Sie die SQL-Abfrage zu verwenden, um Produktinformationen abzurufen, auf dem folgenden Bildschirm.</span><span class="sxs-lookup"><span data-stu-id="b23c3-171">On the following screen, enter the SQL query to use to retrieve the product information.</span></span> <span data-ttu-id="b23c3-172">Verwenden wir die genaue dieselbe SQL-Abfrage, die verwendet werden, für die `Products` TableAdapter aus unserem ursprünglichen DAL, die alle zurückgibt der `Product` Spalten zusammen mit den Namen für das Produkt Supplier "und" Kategorie:</span><span class="sxs-lookup"><span data-stu-id="b23c3-172">Let's use the exact same SQL query used for the `Products` TableAdapter from our original DAL, which returns all of the `Product` columns along with the product's supplier and category names:</span></span>


[!code-sql[Main](implementing-optimistic-concurrency-cs/samples/sample2.sql)]


<span data-ttu-id="b23c3-173">[![Verwenden Sie die gleiche SQL-Abfrage aus dem TableAdapter Produkte in der ursprünglichen DAL](implementing-optimistic-concurrency-cs/_static/image14.png)](implementing-optimistic-concurrency-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="b23c3-173">[![Use the Same SQL Query from the Products TableAdapter in the Original DAL](implementing-optimistic-concurrency-cs/_static/image14.png)](implementing-optimistic-concurrency-cs/_static/image13.png)</span></span>

<span data-ttu-id="b23c3-174">**Abbildung 5**: Verwenden Sie die gleiche SQL-Abfrage aus der `Products` TableAdapter im ursprünglichen DAL ([klicken Sie hier, um das Bild in voller Größe angezeigt](implementing-optimistic-concurrency-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="b23c3-174">**Figure 5**: Use the Same SQL Query from the `Products` TableAdapter in the Original DAL ([Click to view full-size image](implementing-optimistic-concurrency-cs/_static/image15.png))</span></span>


<span data-ttu-id="b23c3-175">Vor dem Verschieben auf dem nächsten Bildschirm, klicken Sie auf die Schaltfläche "Erweiterte Optionen".</span><span class="sxs-lookup"><span data-stu-id="b23c3-175">Before moving onto the next screen, click the Advanced Options button.</span></span> <span data-ttu-id="b23c3-176">Damit diese TableAdapter beschäftigen-Steuerung durch vollständige Parallelität, einfach das Kontrollkästchen Sie "Vollständige Parallelität verwenden".</span><span class="sxs-lookup"><span data-stu-id="b23c3-176">To have this TableAdapter employ optimistic concurrency control, simply check the "Use optimistic concurrency" checkbox.</span></span>


<span data-ttu-id="b23c3-177">[![Aktivieren der Steuerung durch vollständige Parallelität durch Überprüfen der &quot;vollständige Parallelität verwenden&quot; Kontrollkästchen](implementing-optimistic-concurrency-cs/_static/image17.png)](implementing-optimistic-concurrency-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="b23c3-177">[![Enable Optimistic Concurrency Control by Checking the &quot;Use optimistic concurrency&quot; CheckBox](implementing-optimistic-concurrency-cs/_static/image17.png)](implementing-optimistic-concurrency-cs/_static/image16.png)</span></span>

<span data-ttu-id="b23c3-178">**Abbildung 6**: Aktivieren Sie Steuerung durch vollständige Parallelität durch Aktivieren des Kontrollkästchens "Verwenden der vollständigen Parallelität" ([klicken Sie hier, um das Bild in voller Größe angezeigt](implementing-optimistic-concurrency-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="b23c3-178">**Figure 6**: Enable Optimistic Concurrency Control by Checking the "Use optimistic concurrency" CheckBox ([Click to view full-size image](implementing-optimistic-concurrency-cs/_static/image18.png))</span></span>


<span data-ttu-id="b23c3-179">Schließlich anzugeben Sie, dass der TableAdapter den Datenzugriffsmuster verwenden soll, die sowohl DataTable füllen und DataTable zurückgeben; auch Geben Sie an, dass die direkte DB-Methoden erstellt werden soll.</span><span class="sxs-lookup"><span data-stu-id="b23c3-179">Lastly, indicate that the TableAdapter should use the data access patterns that both fill a DataTable and return a DataTable; also indicate that the DB direct methods should be created.</span></span> <span data-ttu-id="b23c3-180">Ändern Sie dem Methodennamen für die Rückgabe einer DataTable-Muster von GetData auf GetProducts, um den Benennungskonventionen widerspiegeln, die wir in unserer ursprünglichen DAL verwendet.</span><span class="sxs-lookup"><span data-stu-id="b23c3-180">Change the method name for the Return a DataTable pattern from GetData to GetProducts, so as to mirror the naming conventions we used in our original DAL.</span></span>


<span data-ttu-id="b23c3-181">[![Nutzen alle Datenzugriffsmuster TableAdapter haben](implementing-optimistic-concurrency-cs/_static/image20.png)](implementing-optimistic-concurrency-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="b23c3-181">[![Have the TableAdapter Utilize All Data Access Patterns](implementing-optimistic-concurrency-cs/_static/image20.png)](implementing-optimistic-concurrency-cs/_static/image19.png)</span></span>

<span data-ttu-id="b23c3-182">**Abbildung 7**: haben Sie die TableAdapter nutzen alle Datenzugriffsmuster ([klicken Sie hier, um das Bild in voller Größe angezeigt](implementing-optimistic-concurrency-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="b23c3-182">**Figure 7**: Have the TableAdapter Utilize All Data Access Patterns ([Click to view full-size image](implementing-optimistic-concurrency-cs/_static/image21.png))</span></span>


<span data-ttu-id="b23c3-183">Nach Abschluss des Assistenten, der DataSet-Designer umfasst einen stark typisierten `Products` DataTable und TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="b23c3-183">After completing the wizard, the DataSet Designer will include a strongly-typed `Products` DataTable and TableAdapter.</span></span> <span data-ttu-id="b23c3-184">Erkundet DataTable aus umbenennen `Products` zu `ProductsOptimisticConcurrency`, wozu Sie verwenden können, indem Sie mit der rechten Maustaste auf die Titelleiste der Datentabelle und Umbenennen aus dem Kontextmenü auswählen.</span><span class="sxs-lookup"><span data-stu-id="b23c3-184">Take a moment to rename the DataTable from `Products` to `ProductsOptimisticConcurrency`, which you can do by right-clicking on the DataTable's title bar and choosing Rename from the context menu.</span></span>


<span data-ttu-id="b23c3-185">[![Eine DataTable und TableAdapter wurden mit dem typisierten DataSet hinzugefügt](implementing-optimistic-concurrency-cs/_static/image23.png)](implementing-optimistic-concurrency-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="b23c3-185">[![A DataTable and TableAdapter Have Been Added to the Typed DataSet](implementing-optimistic-concurrency-cs/_static/image23.png)](implementing-optimistic-concurrency-cs/_static/image22.png)</span></span>

<span data-ttu-id="b23c3-186">**Abbildung 8**: ein DataTable und TableAdapter hinzugefügt wurden, die typisierte DataSet ([klicken Sie hier, um das Bild in voller Größe angezeigt](implementing-optimistic-concurrency-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="b23c3-186">**Figure 8**: A DataTable and TableAdapter Have Been Added to the Typed DataSet ([Click to view full-size image](implementing-optimistic-concurrency-cs/_static/image24.png))</span></span>


<span data-ttu-id="b23c3-187">Um die Unterschiede zwischen finden Sie unter der `UPDATE` und `DELETE` Abfragen zwischen den `ProductsOptimisticConcurrency` TableAdapter (der vollständigen Parallelität verwendet) und die Produkte TableAdapter (die keine), klicken Sie auf den TableAdapter, und wechseln Sie zu dem Eigenschaftenfenster.</span><span class="sxs-lookup"><span data-stu-id="b23c3-187">To see the differences between the `UPDATE` and `DELETE` queries between the `ProductsOptimisticConcurrency` TableAdapter (which uses optimistic concurrency) and the Products TableAdapter (which doesn't), click on the TableAdapter and go to the Properties window.</span></span> <span data-ttu-id="b23c3-188">In der `DeleteCommand` und `UpdateCommand` Eigenschaften `CommandText` Untereigenschaften sehen Sie die aktuelle SQL-Syntax, die an die Datenbank gesendet wird, wenn der DAL Update- oder Delete-bezogenen Methoden aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="b23c3-188">In the `DeleteCommand` and `UpdateCommand` properties' `CommandText` subproperties you can see the actual SQL syntax that is sent to the database when the DAL's update or delete-related methods are invoked.</span></span> <span data-ttu-id="b23c3-189">Für die `ProductsOptimisticConcurrency` TableAdapter die `DELETE` -Anweisung verwendet wird:</span><span class="sxs-lookup"><span data-stu-id="b23c3-189">For the `ProductsOptimisticConcurrency` TableAdapter the `DELETE` statement used is:</span></span>


[!code-sql[Main](implementing-optimistic-concurrency-cs/samples/sample3.sql)]

<span data-ttu-id="b23c3-190">Während der `DELETE` -Anweisung für den TableAdapter Produkt in unserem ursprünglichen DAL ist viel einfacher:</span><span class="sxs-lookup"><span data-stu-id="b23c3-190">Whereas the `DELETE` statement for the Product TableAdapter in our original DAL is the much simpler:</span></span>


[!code-sql[Main](implementing-optimistic-concurrency-cs/samples/sample4.sql)]

<span data-ttu-id="b23c3-191">Wie Sie sehen können, die `WHERE` -Klausel in der `DELETE` -Anweisung für den TableAdapter, die vollständigen Parallelität verwendet, enthält einen Vergleich zwischen den einzelnen der `Product` Tabelle vorhandenen Spaltenwerte und die ursprünglichen Werte zum Zeitpunkt der GridView (oder DetailsView oder FormView) wurde zuletzt aufgefüllt.</span><span class="sxs-lookup"><span data-stu-id="b23c3-191">As you can see, the `WHERE` clause in the `DELETE` statement for the TableAdapter that uses optimistic concurrency includes a comparison between each of the `Product` table's existing column values and the original values at the time the GridView (or DetailsView or FormView) was last populated.</span></span> <span data-ttu-id="b23c3-192">Seit alle Felder außer `ProductID`, `ProductName`, und `Discontinued` können `NULL` -Werte, zusätzliche Parameter und Überprüfungen werden eingeschlossen, um ordnungsgemäß zu vergleichen `NULL` Werte in der `WHERE` Klausel.</span><span class="sxs-lookup"><span data-stu-id="b23c3-192">Since all fields other than `ProductID`, `ProductName`, and `Discontinued` can have `NULL` values, additional parameters and checks are included to correctly compare `NULL` values in the `WHERE` clause.</span></span>

<span data-ttu-id="b23c3-193">Wir wird keine zusätzlichen DataTables auf das vollständige nebenläufigkeitsfähigen DataSet für dieses Lernprogramm hinzufügen werden wie unsere ASP.NET-Seite nur erhalten, aktualisieren und Löschen von Produktinformationen.</span><span class="sxs-lookup"><span data-stu-id="b23c3-193">We won't be adding any additional DataTables to the optimistic concurrency-enabled DataSet for this tutorial, as our ASP.NET page will only provide updating and deleting product information.</span></span> <span data-ttu-id="b23c3-194">Wir noch müssen jedoch zum Hinzufügen der `GetProductByProductID(productID)` Methode, um die `ProductsOptimisticConcurrency` TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="b23c3-194">However, we do still need to add the `GetProductByProductID(productID)` method to the `ProductsOptimisticConcurrency` TableAdapter.</span></span>

<span data-ttu-id="b23c3-195">Um dies zu erreichen, Maustaste auf die Titelleiste des TableAdapter (Bereich rechts oben die `Fill` und `GetProducts` Methodennamen), und wählen Sie im Kontextmenü der Abfrage hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="b23c3-195">To accomplish this, right-click on the TableAdapter's title bar (the area right above the `Fill` and `GetProducts` method names) and choose Add Query from the context menu.</span></span> <span data-ttu-id="b23c3-196">TableAdapter-Abfragekonfigurations-Assistent wird gestartet.</span><span class="sxs-lookup"><span data-stu-id="b23c3-196">This will launch the TableAdapter Query Configuration Wizard.</span></span> <span data-ttu-id="b23c3-197">Wie entscheiden Sie sich mit der Erstkonfiguration des TableAdapter zum Erstellen der `GetProductByProductID(productID)` Methode, die mit Ad-hoc-SQL-Anweisungen (siehe Abbildung 4).</span><span class="sxs-lookup"><span data-stu-id="b23c3-197">As with our TableAdapter's initial configuration, opt to create the `GetProductByProductID(productID)` method using an ad-hoc SQL statement (see Figure 4).</span></span> <span data-ttu-id="b23c3-198">Da die `GetProductByProductID(productID)` Methode gibt Informationen über ein bestimmtes Produkt zurück, um anzugeben, dass diese Abfrage ist ein `SELECT` Abfragetyp, die Zeilen zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="b23c3-198">Since the `GetProductByProductID(productID)` method returns information about a particular product, indicate that this query is a `SELECT` query type that returns rows.</span></span>


<span data-ttu-id="b23c3-199">[![Markieren Sie den Abfragetyp als eine &quot;auswählen, welche die Zeilen zurückgibt&quot;](implementing-optimistic-concurrency-cs/_static/image26.png)](implementing-optimistic-concurrency-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="b23c3-199">[![Mark the Query Type as a &quot;SELECT which returns rows&quot;](implementing-optimistic-concurrency-cs/_static/image26.png)](implementing-optimistic-concurrency-cs/_static/image25.png)</span></span>

<span data-ttu-id="b23c3-200">**Abbildung 9**: Markieren Sie den Abfragetyp als eine "`SELECT` die Zeilen zurückgibt" ([klicken Sie hier, um das Bild in voller Größe angezeigt](implementing-optimistic-concurrency-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="b23c3-200">**Figure 9**: Mark the Query Type as a "`SELECT` which returns rows" ([Click to view full-size image](implementing-optimistic-concurrency-cs/_static/image27.png))</span></span>


<span data-ttu-id="b23c3-201">Auf dem nächsten Bildschirm sind wir für die SQL-Abfrage verwenden, mit dem TableAdapter-Standardabfrage vorab geladenen aufgefordert.</span><span class="sxs-lookup"><span data-stu-id="b23c3-201">On the next screen we're prompted for the SQL query to use, with the TableAdapter's default query pre-loaded.</span></span> <span data-ttu-id="b23c3-202">Erweitern Sie die vorhandene Abfrage aus, um die-Klausel `WHERE ProductID = @ProductID`, wie in Abbildung 10.</span><span class="sxs-lookup"><span data-stu-id="b23c3-202">Augment the existing query to include the clause `WHERE ProductID = @ProductID`, as shown in Figure 10.</span></span>


<span data-ttu-id="b23c3-203">[![Hinzufügen eine WHERE-Klausel, um die vorab geladenen Abfrage einen bestimmtes Produktdatensatz zurückgeben](implementing-optimistic-concurrency-cs/_static/image29.png)](implementing-optimistic-concurrency-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="b23c3-203">[![Add a WHERE Clause to the Pre-Loaded Query to Return a Specific Product Record](implementing-optimistic-concurrency-cs/_static/image29.png)](implementing-optimistic-concurrency-cs/_static/image28.png)</span></span>

<span data-ttu-id="b23c3-204">**Abbildung 10**: Hinzufügen einer `WHERE` -Klausel, um die Pre-Loaded Abfrage einem bestimmten Produktdatensatz zurückgeben ([klicken Sie hier, um das Bild in voller Größe angezeigt](implementing-optimistic-concurrency-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="b23c3-204">**Figure 10**: Add a `WHERE` Clause to the Pre-Loaded Query to Return a Specific Product Record ([Click to view full-size image](implementing-optimistic-concurrency-cs/_static/image30.png))</span></span>


<span data-ttu-id="b23c3-205">Abschließend ändern Sie die generierte Methode Objektnamen `FillByProductID` und `GetProductByProductID`.</span><span class="sxs-lookup"><span data-stu-id="b23c3-205">Finally, change the generated method names to `FillByProductID` and `GetProductByProductID`.</span></span>


<span data-ttu-id="b23c3-206">[![Benennen Sie die Methoden FillByProductID und GetProductByProductID](implementing-optimistic-concurrency-cs/_static/image32.png)](implementing-optimistic-concurrency-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="b23c3-206">[![Rename the Methods to FillByProductID and GetProductByProductID](implementing-optimistic-concurrency-cs/_static/image32.png)](implementing-optimistic-concurrency-cs/_static/image31.png)</span></span>

<span data-ttu-id="b23c3-207">**Abbildung 11**: Benennen Sie die Methoden zum `FillByProductID` und `GetProductByProductID` ([klicken Sie hier, um das Bild in voller Größe angezeigt](implementing-optimistic-concurrency-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="b23c3-207">**Figure 11**: Rename the Methods to `FillByProductID` and `GetProductByProductID` ([Click to view full-size image](implementing-optimistic-concurrency-cs/_static/image33.png))</span></span>


<span data-ttu-id="b23c3-208">Mit dieser Assistent abgeschlossen wurde, enthält die TableAdapter jetzt zwei Methoden zum Abrufen von Daten: `GetProducts()`, welche gibt *alle* Produkte; und `GetProductByProductID(productID)`, wobei das angegebene Produkt zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="b23c3-208">With this wizard complete, the TableAdapter now contains two methods for retrieving data: `GetProducts()`, which returns *all* products; and `GetProductByProductID(productID)`, which returns the specified product.</span></span>

## <a name="step-3-creating-a-business-logic-layer-for-the-optimistic-concurrency-enabled-dal"></a><span data-ttu-id="b23c3-209">Schritt 3: Erstellen eine Geschäftslogikschicht für optimistische Parallelität aktiviert DAL</span><span class="sxs-lookup"><span data-stu-id="b23c3-209">Step 3: Creating a Business Logic Layer for the Optimistic Concurrency-Enabled DAL</span></span>

<span data-ttu-id="b23c3-210">Unsere vorhandene `ProductsBLL` -Klasse verfügt über die Beispiele für die Verwendung der BatchUpdate und die direkte DB-Muster.</span><span class="sxs-lookup"><span data-stu-id="b23c3-210">Our existing `ProductsBLL` class has examples of using both the batch update and DB direct patterns.</span></span> <span data-ttu-id="b23c3-211">Die `AddProduct` Methode und `UpdateProduct` beide Überladungen verwenden updatemusters Batch übergeben einer `ProductRow` Instanz mit dem TableAdapter-Aktualisierungsmethode.</span><span class="sxs-lookup"><span data-stu-id="b23c3-211">The `AddProduct` method and `UpdateProduct` overloads both use the batch update pattern, passing in a `ProductRow` instance to the TableAdapter's Update method.</span></span> <span data-ttu-id="b23c3-212">Die `DeleteProduct` -Methode, verwendet das DB-direct-Muster, des TableAdapter aufrufen, andererseits, `Delete(productID)` Methode.</span><span class="sxs-lookup"><span data-stu-id="b23c3-212">The `DeleteProduct` method, on the other hand, uses the DB direct pattern, calling the TableAdapter's `Delete(productID)` method.</span></span>

<span data-ttu-id="b23c3-213">Mit dem neuen `ProductsOptimisticConcurrency` TableAdapter, die DB direkte Methoden erfordern jetzt auch die ursprünglichen Werte übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="b23c3-213">With the new `ProductsOptimisticConcurrency` TableAdapter, the DB direct methods now require that the original values also be passed in.</span></span> <span data-ttu-id="b23c3-214">Z. B. die `Delete` Methode jetzt erwartet zehn Eingabeparameter entgegen: die ursprüngliche `ProductID`, `ProductName`, `SupplierID`, `CategoryID`, `QuantityPerUnit`, `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, `ReorderLevel`, und `Discontinued`.</span><span class="sxs-lookup"><span data-stu-id="b23c3-214">For example, the `Delete` method now expects ten input parameters: the original `ProductID`, `ProductName`, `SupplierID`, `CategoryID`, `QuantityPerUnit`, `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, `ReorderLevel`, and `Discontinued`.</span></span> <span data-ttu-id="b23c3-215">Er verwendet diese zusätzliche Eingabeparameter-Werte in `WHERE` -Klausel der `DELETE` Anweisung an die Datenbank gesendet werden, nur den angegebenen Datensatz löschen, wenn die aktuellen Werte für die Datenbank bis zu der ursprünglichen ereignislebensdauern zuordnen.</span><span class="sxs-lookup"><span data-stu-id="b23c3-215">It uses these additional input parameters' values in `WHERE` clause of the `DELETE` statement sent to the database, only deleting the specified record if the database's current values map up to the original ones.</span></span>

<span data-ttu-id="b23c3-216">Während die Methodensignatur für die TableAdapter `Update` in updatemusters Batch verwendete Methode nicht geändert wurde, hat der Codes erforderlich, um die ursprünglichen und neuen Werte zu zeichnen.</span><span class="sxs-lookup"><span data-stu-id="b23c3-216">While the method signature for the TableAdapter's `Update` method used in the batch update pattern hasn't changed, the code needed to record the original and new values has.</span></span> <span data-ttu-id="b23c3-217">Aus diesem Grund statt versuchen, verwenden die optimistische Parallelität aktiviert DAL mit unserem vorhandenen `ProductsBLL` Klasse, erstellen wir eine neue Business Logic Layer-Klasse zum Arbeiten mit unserem neuen DAL.</span><span class="sxs-lookup"><span data-stu-id="b23c3-217">Therefore, rather than attempt to use the optimistic concurrency-enabled DAL with our existing `ProductsBLL` class, let's create a new Business Logic Layer class for working with our new DAL.</span></span>

<span data-ttu-id="b23c3-218">Fügen Sie eine Klasse mit dem Namen `ProductsOptimisticConcurrencyBLL` auf die `BLL` Ordner innerhalb der `App_Code` Ordner.</span><span class="sxs-lookup"><span data-stu-id="b23c3-218">Add a class named `ProductsOptimisticConcurrencyBLL` to the `BLL` folder within the `App_Code` folder.</span></span>


![Fügen Sie in den Ordner BLL die ProductsOptimisticConcurrencyBLL-Klasse](implementing-optimistic-concurrency-cs/_static/image34.png)

<span data-ttu-id="b23c3-220">**Abbildung 12**: Hinzufügen der `ProductsOptimisticConcurrencyBLL` Klasse, um den Ordner BLL</span><span class="sxs-lookup"><span data-stu-id="b23c3-220">**Figure 12**: Add the `ProductsOptimisticConcurrencyBLL` Class to the BLL Folder</span></span>


<span data-ttu-id="b23c3-221">Fügen Sie den folgenden Code in die `ProductsOptimisticConcurrencyBLL` Klasse:</span><span class="sxs-lookup"><span data-stu-id="b23c3-221">Next, add the following code to the `ProductsOptimisticConcurrencyBLL` class:</span></span>


[!code-csharp[Main](implementing-optimistic-concurrency-cs/samples/sample5.cs)]

<span data-ttu-id="b23c3-222">Beachten Sie die Verwendung `NorthwindOptimisticConcurrencyTableAdapters` Anweisung über den Beginn der Klassendeklaration.</span><span class="sxs-lookup"><span data-stu-id="b23c3-222">Note the using `NorthwindOptimisticConcurrencyTableAdapters` statement above the start of the class declaration.</span></span> <span data-ttu-id="b23c3-223">Die `NorthwindOptimisticConcurrencyTableAdapters` -Namespace enthält die `ProductsOptimisticConcurrencyTableAdapter` Klasse, die die DAL Methoden bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="b23c3-223">The `NorthwindOptimisticConcurrencyTableAdapters` namespace contains the `ProductsOptimisticConcurrencyTableAdapter` class, which provides the DAL's methods.</span></span> <span data-ttu-id="b23c3-224">Auch vor der Klassendeklaration finden Sie die `System.ComponentModel.DataObject` -Attribut, das weist Visual Studio für diese Klasse in der Dropdownliste das ObjectDataSource-Assistenten zu schließen.</span><span class="sxs-lookup"><span data-stu-id="b23c3-224">Also before the class declaration you'll find the `System.ComponentModel.DataObject` attribute, which instructs Visual Studio to include this class in the ObjectDataSource wizard's drop-down list.</span></span>

<span data-ttu-id="b23c3-225">Die `ProductsOptimisticConcurrencyBLL`des `Adapter` Eigenschaft ermöglicht den schnellen Zugriff auf eine Instanz der `ProductsOptimisticConcurrencyTableAdapter` Klasse, und folgt dem Muster in den ursprünglichen BLL-Klassen verwendet (`ProductsBLL`, `CategoriesBLL`usw.).</span><span class="sxs-lookup"><span data-stu-id="b23c3-225">The `ProductsOptimisticConcurrencyBLL`'s `Adapter` property provides quick access to an instance of the `ProductsOptimisticConcurrencyTableAdapter` class, and follows the pattern used in our original BLL classes (`ProductsBLL`, `CategoriesBLL`, and so on).</span></span> <span data-ttu-id="b23c3-226">Schließlich die `GetProducts()` Methode ruft einfach nach unten in der DAL `GetProducts()` -Methode und gibt eine `ProductsOptimisticConcurrencyDataTable` -Objekt aufgefüllt wird, mit einer `ProductsOptimisticConcurrencyRow` -Instanz für jede Produktdatensatz in der Datenbank.</span><span class="sxs-lookup"><span data-stu-id="b23c3-226">Finally, the `GetProducts()` method simply calls down into the DAL's `GetProducts()` method and returns a `ProductsOptimisticConcurrencyDataTable` object populated with a `ProductsOptimisticConcurrencyRow` instance for each product record in the database.</span></span>

## <a name="deleting-a-product-using-the-db-direct-pattern-with-optimistic-concurrency"></a><span data-ttu-id="b23c3-227">Löschen eines Produkts unter Verwendung des DB-Direct-Musters mit vollständiger Parallelität</span><span class="sxs-lookup"><span data-stu-id="b23c3-227">Deleting a Product Using the DB Direct Pattern with Optimistic Concurrency</span></span>

<span data-ttu-id="b23c3-228">Wenn das direkte DB-Muster für eine DAL verwenden, die vollständigen Parallelität verwendet, müssen die Methoden die neuen und ursprünglichen Werte übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="b23c3-228">When using the DB direct pattern against a DAL that uses optimistic concurrency, the methods must be passed the new and original values.</span></span> <span data-ttu-id="b23c3-229">Zum Löschen, es sind keine neuen Werte, daher müssen nur die ursprünglichen Werte übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="b23c3-229">For deleting, there are no new values, so only the original values need be passed in.</span></span> <span data-ttu-id="b23c3-230">In unserem BLL müssen, werden alle von der ursprünglichen Parameter als Eingabeparameter akzeptiert.</span><span class="sxs-lookup"><span data-stu-id="b23c3-230">In our BLL, then, we must accept all of the original parameters as input parameters.</span></span> <span data-ttu-id="b23c3-231">Wir haben die `DeleteProduct` Methode in der `ProductsOptimisticConcurrencyBLL` Klasse verwenden, die direkte DB-Methode.</span><span class="sxs-lookup"><span data-stu-id="b23c3-231">Let's have the `DeleteProduct` method in the `ProductsOptimisticConcurrencyBLL` class use the DB direct method.</span></span> <span data-ttu-id="b23c3-232">Dies bedeutet, dass diese Methode muss alle zehn Produkt Datenfelder als Eingabeparameter, und diese an die DAL übergeben, wie im folgenden Code gezeigt:</span><span class="sxs-lookup"><span data-stu-id="b23c3-232">This means that this method needs to take in all ten product data fields as input parameters, and pass these to the DAL, as shown in the following code:</span></span>


[!code-csharp[Main](implementing-optimistic-concurrency-cs/samples/sample6.cs)]

<span data-ttu-id="b23c3-233">Wenn die ursprünglichen Werte – diese Werte, die zuletzt in der GridView (oder DetailsView oder FormView) geladen wurden - unterscheiden sich von den Werten in der Datenbank, klickt der Benutzer die Schaltfläche "löschen" die `WHERE` -Klausel wird nicht mit Datenbank-Datensatz und keine Datensätze überein sind betroffen.</span><span class="sxs-lookup"><span data-stu-id="b23c3-233">If the original values - those values that were last loaded into the GridView (or DetailsView or FormView) - differ from the values in the database when the user clicks the Delete button the `WHERE` clause won't match up with any database record and no records will be affected.</span></span> <span data-ttu-id="b23c3-234">Daher TableAdapters `Delete` Methode zurück `0` und der BLL `DeleteProduct` Methode zurück `false`.</span><span class="sxs-lookup"><span data-stu-id="b23c3-234">Hence, the TableAdapter's `Delete` method will return `0` and the BLL's `DeleteProduct` method will return `false`.</span></span>

## <a name="updating-a-product-using-the-batch-update-pattern-with-optimistic-concurrency"></a><span data-ttu-id="b23c3-235">Aktualisieren eines Produkts unter Verwendung des Batch-Update-Musters mit vollständiger Parallelität</span><span class="sxs-lookup"><span data-stu-id="b23c3-235">Updating a Product Using the Batch Update Pattern with Optimistic Concurrency</span></span>

<span data-ttu-id="b23c3-236">Wie oben erwähnt von des TableAdapters `Update` Methode für die Batch-updatemuster hat die gleiche Methodensignatur unabhängig davon, ob die vollständige Parallelität verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="b23c3-236">As noted earlier, the TableAdapter's `Update` method for the batch update pattern has the same method signature regardless of whether or not optimistic concurrency is employed.</span></span> <span data-ttu-id="b23c3-237">Nämlich die `Update` Methode erwartet DataRow, ein Array von DataRows, einer "DataTable" oder ein typisiertes DataSet.</span><span class="sxs-lookup"><span data-stu-id="b23c3-237">Namely, the `Update` method expects a DataRow, an array of DataRows, a DataTable, or a Typed DataSet.</span></span> <span data-ttu-id="b23c3-238">Es sind keine zusätzlichen Eingabeparameter für die ursprünglichen Werte angeben.</span><span class="sxs-lookup"><span data-stu-id="b23c3-238">There are no additional input parameters for specifying the original values.</span></span> <span data-ttu-id="b23c3-239">Dies ist möglich, da die DataTable die ursprünglichen und geänderten Werte für die DataRow(s) der nachverfolgt.</span><span class="sxs-lookup"><span data-stu-id="b23c3-239">This is possible because the DataTable keeps track of the original and modified values for its DataRow(s).</span></span> <span data-ttu-id="b23c3-240">Wenn die DAL ausgibt seine `UPDATE` -Anweisung, die `@original_ColumnName` Parameter werden mit der ursprünglichen Werte der DataRow aufgefüllt, während die `@ColumnName` Parameter sind mit den DataRow geänderten Werten aufgefüllt.</span><span class="sxs-lookup"><span data-stu-id="b23c3-240">When the DAL issues its `UPDATE` statement, the `@original_ColumnName` parameters are populated with the DataRow's original values, whereas the `@ColumnName` parameters are populated with the DataRow's modified values.</span></span>

<span data-ttu-id="b23c3-241">In der `ProductsBLL` -Klasse (die unsere ursprüngliche, nicht durch vollständige Parallelität DAL), Verwendung der Batch-updatemuster um Produktinformationen unsere Code führt die folgende Abfolge von Ereignissen zu aktualisieren:</span><span class="sxs-lookup"><span data-stu-id="b23c3-241">In the `ProductsBLL` class (which uses our original, non-optimistic concurrency DAL), when using the batch update pattern to update product information our code performs the following sequence of events:</span></span>

1. <span data-ttu-id="b23c3-242">Lesen die aktuelle Datenbank Produktinformationen in einen `ProductRow` -Instanz mit des TableAdapters `GetProductByProductID(productID)` Methode</span><span class="sxs-lookup"><span data-stu-id="b23c3-242">Read the current database product information into a `ProductRow` instance using the TableAdapter's `GetProductByProductID(productID)` method</span></span>
2. <span data-ttu-id="b23c3-243">Weisen Sie die neuen Werten zu den `ProductRow` -Instanz aus Schritt 1</span><span class="sxs-lookup"><span data-stu-id="b23c3-243">Assign the new values to the `ProductRow` instance from Step 1</span></span>
3. <span data-ttu-id="b23c3-244">Rufen Sie die `Update` -Methode auf und übergibt die `ProductRow` Instanz</span><span class="sxs-lookup"><span data-stu-id="b23c3-244">Call the TableAdapter's `Update` method, passing in the `ProductRow` instance</span></span>

<span data-ttu-id="b23c3-245">Diese Abfolge von Schritten, jedoch wird nicht ordnungsgemäß durch vollständige Parallelität unterstützen, da die `ProductRow` aufgefüllt, die Schritt 1 wird aufgefüllt, direkt aus der Datenbank, was bedeutet, dass die ursprünglichen Werte von DataRow verwendet, die derzeit im vorhanden sind die Datenbank und nicht die, die an die GridView zu Beginn der Bearbeitung verbunden waren.</span><span class="sxs-lookup"><span data-stu-id="b23c3-245">This sequence of steps, however, won't correctly support optimistic concurrency because the `ProductRow` populated in Step 1 is populated directly from the database, meaning that the original values used by the DataRow are those that currently exist in the database, and not those that were bound to the GridView at the start of the editing process.</span></span> <span data-ttu-id="b23c3-246">Stattdessen verwenden eine optimistische Parallelität-DAL aktiviert, es müssen zum Ändern der `UpdateProduct` -methodenüberladungen verwenden Sie die folgenden Schritte aus:</span><span class="sxs-lookup"><span data-stu-id="b23c3-246">Instead, when using an optimistic concurrency-enabled DAL, we need to alter the `UpdateProduct` method overloads to use the following steps:</span></span>

1. <span data-ttu-id="b23c3-247">Lesen die aktuelle Datenbank Produktinformationen in einen `ProductsOptimisticConcurrencyRow` -Instanz mit des TableAdapters `GetProductByProductID(productID)` Methode</span><span class="sxs-lookup"><span data-stu-id="b23c3-247">Read the current database product information into a `ProductsOptimisticConcurrencyRow` instance using the TableAdapter's `GetProductByProductID(productID)` method</span></span>
2. <span data-ttu-id="b23c3-248">Weisen Sie die *ursprünglichen* -Werte in der `ProductsOptimisticConcurrencyRow` -Instanz aus Schritt 1</span><span class="sxs-lookup"><span data-stu-id="b23c3-248">Assign the *original* values to the `ProductsOptimisticConcurrencyRow` instance from Step 1</span></span>
3. <span data-ttu-id="b23c3-249">Rufen Sie die `ProductsOptimisticConcurrencyRow` Instanz `AcceptChanges()` -Methode, die DataRow wird angewiesen, dass die aktuellen Werte der "ursprünglichen" ereignislebensdauern sind</span><span class="sxs-lookup"><span data-stu-id="b23c3-249">Call the `ProductsOptimisticConcurrencyRow` instance's `AcceptChanges()` method, which instructs the DataRow that its current values are the "original" ones</span></span>
4. <span data-ttu-id="b23c3-250">Weisen Sie die *neue* -Werte in der `ProductsOptimisticConcurrencyRow` Instanz</span><span class="sxs-lookup"><span data-stu-id="b23c3-250">Assign the *new* values to the `ProductsOptimisticConcurrencyRow` instance</span></span>
5. <span data-ttu-id="b23c3-251">Rufen Sie die `Update` -Methode auf und übergibt die `ProductsOptimisticConcurrencyRow` Instanz</span><span class="sxs-lookup"><span data-stu-id="b23c3-251">Call the TableAdapter's `Update` method, passing in the `ProductsOptimisticConcurrencyRow` instance</span></span>

<span data-ttu-id="b23c3-252">Schritt 1-Lesevorgänge in allen von der aktuellen Datenbankwerte für das angegebene Produkt-Datensatz.</span><span class="sxs-lookup"><span data-stu-id="b23c3-252">Step 1 reads in all of the current database values for the specified product record.</span></span> <span data-ttu-id="b23c3-253">Dieser Schritt ist überflüssig, in der `UpdateProduct` Überladung, die aktualisiert *alle* der Product-Spalten (als diese Werte werden überschrieben in Schritt2), aber ist wichtig für eine dieser Überladungen, in denen nur eine Teilmenge der Spaltenwerte als übergeben, Eingabeparameter.</span><span class="sxs-lookup"><span data-stu-id="b23c3-253">This step is superfluous in the `UpdateProduct` overload that updates *all* of the product columns (as these values are overwritten in Step 2), but is essential for those overloads where only a subset of the column values are passed in as input parameters.</span></span> <span data-ttu-id="b23c3-254">Nachdem die ursprünglichen Werte zugewiesen wurden die `ProductsOptimisticConcurrencyRow` -Instanz, die `AcceptChanges()` Methode wird aufgerufen, die die aktuellen DataRow-Werte als ursprüngliche Werte zu verwendende markiert die `@original_ColumnName` Parameter in der `UPDATE` Anweisung.</span><span class="sxs-lookup"><span data-stu-id="b23c3-254">Once the original values have been assigned to the `ProductsOptimisticConcurrencyRow` instance, the `AcceptChanges()` method is called, which marks the current DataRow values as the original values to be used in the `@original_ColumnName` parameters in the `UPDATE` statement.</span></span> <span data-ttu-id="b23c3-255">Als Nächstes werden die neuen Parameterwerte zugewiesen, um die `ProductsOptimisticConcurrencyRow` und schließlich die `Update` Methode aufgerufen wird, in der DataRow übergeben.</span><span class="sxs-lookup"><span data-stu-id="b23c3-255">Next, the new parameter values are assigned to the `ProductsOptimisticConcurrencyRow` and, finally, the `Update` method is invoked, passing in the DataRow.</span></span>

<span data-ttu-id="b23c3-256">Der folgende code zeigt die `UpdateProduct` Überladung, die alle Produktdaten akzeptiert Felder als Eingabeparameter.</span><span class="sxs-lookup"><span data-stu-id="b23c3-256">The following code shows the `UpdateProduct` overload that accepts all product data fields as input parameters.</span></span> <span data-ttu-id="b23c3-257">Während nicht hier gezeigt die `ProductsOptimisticConcurrencyBLL` Klasse, die im Download enthalten, für dieses Lernprogramm auch enthält eine `UpdateProduct` Überladung, die nur der Product Name und der Preis als Eingabeparameter akzeptiert.</span><span class="sxs-lookup"><span data-stu-id="b23c3-257">While not shown here, the `ProductsOptimisticConcurrencyBLL` class included in the download for this tutorial also contains an `UpdateProduct` overload that accepts just the product's name and price as input parameters.</span></span>


[!code-csharp[Main](implementing-optimistic-concurrency-cs/samples/sample7.cs)]

## <a name="step-4-passing-the-original-and-new-values-from-the-aspnet-page-to-the-bll-methods"></a><span data-ttu-id="b23c3-258">Schritt 4: Übergeben die ursprünglichen und neuen Werte von der ASP.NET-Seite an die BLL-Methode</span><span class="sxs-lookup"><span data-stu-id="b23c3-258">Step 4: Passing the Original and New Values From the ASP.NET Page to the BLL Methods</span></span>

<span data-ttu-id="b23c3-259">Die DAL und BLL abgeschlossen übrig bleibt eine ASP.NET-Seite zu erstellen, die die vollständige Parallelität-Logik, die in das System integriert genutzt werden können.</span><span class="sxs-lookup"><span data-stu-id="b23c3-259">With the DAL and BLL complete, all that remains is to create an ASP.NET page that can utilize the optimistic concurrency logic built in to the system.</span></span> <span data-ttu-id="b23c3-260">Insbesondere müssen die Daten (GridView, DetailsView oder FormView)-Websteuerelement daran denken, dass die ursprünglichen Werte und die ObjectDataSource beide Sätze von Werten an die Geschäftslogikschicht übergeben werden müssen.</span><span class="sxs-lookup"><span data-stu-id="b23c3-260">Specifically, the data Web control (the GridView, DetailsView, or FormView) must remember its original values and the ObjectDataSource must pass both sets of values to the Business Logic Layer.</span></span> <span data-ttu-id="b23c3-261">Darüber hinaus muss die ASP.NET-Seite konfiguriert werden, um parallelitätsverletzungen Datenbindungsvorgängen erfolgreich behandelt.</span><span class="sxs-lookup"><span data-stu-id="b23c3-261">Furthermore, the ASP.NET page must be configured to gracefully handle concurrency violations.</span></span>

<span data-ttu-id="b23c3-262">Öffnen Sie zunächst die `OptimisticConcurrency.aspx` auf der Seite der `EditInsertDelete` Ordner und das Hinzufügen einer GridView in den Designer, Festlegen seiner `ID` Eigenschaft `ProductsGrid`.</span><span class="sxs-lookup"><span data-stu-id="b23c3-262">Start by opening the `OptimisticConcurrency.aspx` page in the `EditInsertDelete` folder and adding a GridView to the Designer, setting its `ID` property to `ProductsGrid`.</span></span> <span data-ttu-id="b23c3-263">Erstellen Sie eine neue ObjectDataSource mit dem Namen aus der GridView Smarttag, wahlweise `ProductsOptimisticConcurrencyDataSource`.</span><span class="sxs-lookup"><span data-stu-id="b23c3-263">From the GridView's smart tag, opt to create a new ObjectDataSource named `ProductsOptimisticConcurrencyDataSource`.</span></span> <span data-ttu-id="b23c3-264">Da soll diese ObjectDataSource die DAL verwenden, die vollständige Parallelität unterstützt, konfigurieren Sie ihn, verwenden Sie die `ProductsOptimisticConcurrencyBLL` Objekt.</span><span class="sxs-lookup"><span data-stu-id="b23c3-264">Since we want this ObjectDataSource to use the DAL that supports optimistic concurrency, configure it to use the `ProductsOptimisticConcurrencyBLL` object.</span></span>


<span data-ttu-id="b23c3-265">[![Haben Sie die Verwendung ObjectDataSource ProductsOptimisticConcurrencyBLL-Objekt](implementing-optimistic-concurrency-cs/_static/image36.png)](implementing-optimistic-concurrency-cs/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="b23c3-265">[![Have the ObjectDataSource Use the ProductsOptimisticConcurrencyBLL Object](implementing-optimistic-concurrency-cs/_static/image36.png)](implementing-optimistic-concurrency-cs/_static/image35.png)</span></span>

<span data-ttu-id="b23c3-266">**Abbildung 13**: haben Sie die Verwendung ObjectDataSource der `ProductsOptimisticConcurrencyBLL` Objekt ([klicken Sie hier, um das Bild in voller Größe angezeigt](implementing-optimistic-concurrency-cs/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="b23c3-266">**Figure 13**: Have the ObjectDataSource Use the `ProductsOptimisticConcurrencyBLL` Object ([Click to view full-size image](implementing-optimistic-concurrency-cs/_static/image37.png))</span></span>


<span data-ttu-id="b23c3-267">Wählen Sie die `GetProducts`, `UpdateProduct`, und `DeleteProduct` Methoden aus den Dropdownlisten im Assistenten.</span><span class="sxs-lookup"><span data-stu-id="b23c3-267">Choose the `GetProducts`, `UpdateProduct`, and `DeleteProduct` methods from drop-down lists in the wizard.</span></span> <span data-ttu-id="b23c3-268">Verwenden Sie die Überladung, die das Produkt Datenfelder akzeptiert, bei der UpdateProduct-Methode.</span><span class="sxs-lookup"><span data-stu-id="b23c3-268">For the UpdateProduct method, use the overload that accepts all of the product's data fields.</span></span>

## <a name="configuring-the-objectdatasource-controls-properties"></a><span data-ttu-id="b23c3-269">Konfigurieren von Eigenschaften für das ObjectDataSource-Steuerelement</span><span class="sxs-lookup"><span data-stu-id="b23c3-269">Configuring the ObjectDataSource Control's Properties</span></span>

<span data-ttu-id="b23c3-270">Nach Abschluss des Assistenten, sollte das ObjectDataSource deklarative Markup wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="b23c3-270">After completing the wizard, the ObjectDataSource's declarative markup should look like the following:</span></span>


[!code-aspx[Main](implementing-optimistic-concurrency-cs/samples/sample8.aspx)]

<span data-ttu-id="b23c3-271">Wie Sie sehen können, die `DeleteParameters` Auflistung enthält ein `Parameter` Instanz für jeden der zehn Eingabeparameter in der `ProductsOptimisticConcurrencyBLL` Klasse `DeleteProduct` Methode.</span><span class="sxs-lookup"><span data-stu-id="b23c3-271">As you can see, the `DeleteParameters` collection contains a `Parameter` instance for each of the ten input parameters in the `ProductsOptimisticConcurrencyBLL` class's `DeleteProduct` method.</span></span> <span data-ttu-id="b23c3-272">Entsprechend der `UpdateParameters` Auflistung enthält ein `Parameter` Instanz für jede der Eingabeparameter im `UpdateProduct`.</span><span class="sxs-lookup"><span data-stu-id="b23c3-272">Likewise, the `UpdateParameters` collection contains a `Parameter` instance for each of the input parameters in `UpdateProduct`.</span></span>

<span data-ttu-id="b23c3-273">Für die vorherigen Lernprogrammen, die Änderung von Daten beteiligt, entfernen Sie das ObjectDataSource `OldValuesParameterFormatString` Eigenschaft an diesem Punkt, da diese Eigenschaft gibt an, dass die BLL-Methode die alten (oder ursprüngliche) Werte übergeben werden muss, sowie die neuen Werte erwartet.</span><span class="sxs-lookup"><span data-stu-id="b23c3-273">For those previous tutorials that involved data modification, we'd remove the ObjectDataSource's `OldValuesParameterFormatString` property at this point, since this property indicates that the BLL method expects the old (or original) values to be passed in as well as the new values.</span></span> <span data-ttu-id="b23c3-274">Darüber hinaus gibt Wert dieser Eigenschaft die Namen der Eingabeparameter für die ursprünglichen Werte an.</span><span class="sxs-lookup"><span data-stu-id="b23c3-274">Furthermore, this property value indicates the input parameter names for the original values.</span></span> <span data-ttu-id="b23c3-275">Da wir in den ursprünglichen Werten in der BLL übergeben, *nicht* dieser Eigenschaft entfernen.</span><span class="sxs-lookup"><span data-stu-id="b23c3-275">Since we are passing in the original values into the BLL, do *not* remove this property.</span></span>

> [!NOTE]
> <span data-ttu-id="b23c3-276">Der Wert, der die `OldValuesParameterFormatString` Eigenschaft muss den input Parameternamen in der BLL, bei denen die ursprünglichen Werte zuordnen.</span><span class="sxs-lookup"><span data-stu-id="b23c3-276">The value of the `OldValuesParameterFormatString` property must map to the input parameter names in the BLL that expect the original values.</span></span> <span data-ttu-id="b23c3-277">Da wir diese Parameter mit dem Namen `original_productName`, `original_supplierID`usw., lassen Sie die `OldValuesParameterFormatString` Eigenschaftswert als `original_{0}`.</span><span class="sxs-lookup"><span data-stu-id="b23c3-277">Since we named these parameters `original_productName`, `original_supplierID`, and so on, you can leave the `OldValuesParameterFormatString` property value as `original_{0}`.</span></span> <span data-ttu-id="b23c3-278">Wäre, allerdings BLL Methoden Eingabeparameter Namen wie `old_productName`, `old_supplierID`usw., müssen Sie beim Aktualisieren der `OldValuesParameterFormatString` Eigenschaft `old_{0}`.</span><span class="sxs-lookup"><span data-stu-id="b23c3-278">If, however, the BLL methods' input parameters had names like `old_productName`, `old_supplierID`, and so on, you'd need to update the `OldValuesParameterFormatString` property to `old_{0}`.</span></span>


<span data-ttu-id="b23c3-279">Es ist eine abschließende Eigenschaft-Einstellung, die in der Reihenfolge für das ObjectDataSource auf die ursprünglichen Werte ordnungsgemäß an die BLL-Methoden übergeben vorgenommen werden muss.</span><span class="sxs-lookup"><span data-stu-id="b23c3-279">There's one final property setting that needs to be made in order for the ObjectDataSource to correctly pass the original values to the BLL methods.</span></span> <span data-ttu-id="b23c3-280">Das ObjectDataSource hat eine [ConflictDetection-Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.conflictdetection.aspx) , können zugewiesen [einen von zwei Werten](https://msdn.microsoft.com/library/system.web.ui.conflictoptions.aspx):</span><span class="sxs-lookup"><span data-stu-id="b23c3-280">The ObjectDataSource has a [ConflictDetection property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.conflictdetection.aspx) that can be assigned to [one of two values](https://msdn.microsoft.com/library/system.web.ui.conflictoptions.aspx):</span></span>

- <span data-ttu-id="b23c3-281">`OverwriteChanges`-Der Standardwert; die ursprünglichen Werte werden keine an der ursprünglichen Eingabeparameter BLL Methoden gesendet werden.</span><span class="sxs-lookup"><span data-stu-id="b23c3-281">`OverwriteChanges` - the default value; does not send the original values to the BLL methods' original input parameters</span></span>
- <span data-ttu-id="b23c3-282">`CompareAllValues`-die ursprünglichen Werte, die Methoden für BLL sendet. Wählen Sie diese Option aus, wenn Sie vollständigen Parallelität verwenden</span><span class="sxs-lookup"><span data-stu-id="b23c3-282">`CompareAllValues` - does send the original values to the BLL methods; choose this option when using optimistic concurrency</span></span>

<span data-ttu-id="b23c3-283">Erkundet festzulegende der `ConflictDetection` Eigenschaft `CompareAllValues`.</span><span class="sxs-lookup"><span data-stu-id="b23c3-283">Take a moment to set the `ConflictDetection` property to `CompareAllValues`.</span></span>

## <a name="configuring-the-gridviews-properties-and-fields"></a><span data-ttu-id="b23c3-284">Konfigurieren von Eigenschaften und Felder der GridView</span><span class="sxs-lookup"><span data-stu-id="b23c3-284">Configuring the GridView's Properties and Fields</span></span>

<span data-ttu-id="b23c3-285">Mit der ObjectDataSource Eigenschaften ordnungsgemäß konfiguriert werfen wir die GridView einrichten.</span><span class="sxs-lookup"><span data-stu-id="b23c3-285">With the ObjectDataSource's properties properly configured, let's turn our attention to setting up the GridView.</span></span> <span data-ttu-id="b23c3-286">Da wir die GridView zu unterstützen, bearbeiten und löschen möchten, klicken Sie zunächst auf die Kontrollkästchen aktivieren Sie bearbeiten und löschen aktivieren aus der GridView Smarttag.</span><span class="sxs-lookup"><span data-stu-id="b23c3-286">First, since we want the GridView to support editing and deleting, click the Enable Editing and Enable Deleting checkboxes from the GridView's smart tag.</span></span> <span data-ttu-id="b23c3-287">Dadurch wird eine CommandField hinzugefügt, deren `ShowEditButton` und `ShowDeleteButton` festgelegt `true`.</span><span class="sxs-lookup"><span data-stu-id="b23c3-287">This will add a CommandField whose `ShowEditButton` and `ShowDeleteButton` are both set to `true`.</span></span>

<span data-ttu-id="b23c3-288">Bei der Bindung an die `ProductsOptimisticConcurrencyDataSource` ObjectDataSource, GridView enthält ein Feld für die einzelnen Datenfelder des Produkts.</span><span class="sxs-lookup"><span data-stu-id="b23c3-288">When bound to the `ProductsOptimisticConcurrencyDataSource` ObjectDataSource, the GridView contains a field for each of the product's data fields.</span></span> <span data-ttu-id="b23c3-289">Während eine solchen GridView bearbeitet werden kann, sieht die benutzerumgebung gar nichts jedoch akzeptabel.</span><span class="sxs-lookup"><span data-stu-id="b23c3-289">While such a GridView can be edited, the user experience is anything but acceptable.</span></span> <span data-ttu-id="b23c3-290">Die `CategoryID` und `SupplierID` BoundFields rendert als Textfelder ein, da der Benutzer die entsprechende Kategorie und der Lieferant als ID-Nummern eingeben.</span><span class="sxs-lookup"><span data-stu-id="b23c3-290">The `CategoryID` and `SupplierID` BoundFields will render as TextBoxes, requiring the user to enter the appropriate category and supplier as ID numbers.</span></span> <span data-ttu-id="b23c3-291">Es werden keine Formatierung für numerische Felder und keine Validierungssteuerelemente, stellen Sie sicher, dass das Produkt Anwendungsname angegeben wurde und Einzelpreis Einheiten im Lager, Einheiten Order-und neu anordnen Ebenenwerte beide entsprechenden numerischen Werte sind und größer als oder gleich 0 (null).</span><span class="sxs-lookup"><span data-stu-id="b23c3-291">There will be no formatting for the numeric fields and no validation controls to ensure that the product's name has been supplied and that the unit price, units in stock, units on order, and reorder level values are both proper numeric values and are greater than or equal to zero.</span></span>

<span data-ttu-id="b23c3-292">Wie in erläutert die *Validierungssteuerelemente hinzufügen, bearbeiten und Einfügen von Schnittstellen* und *Anpassen der Benutzeroberfläche für die Änderung der Daten* Lernprogramme, die Benutzeroberfläche kann angepasst werden durch Ersetzen die BoundFields mit von TemplateFields.</span><span class="sxs-lookup"><span data-stu-id="b23c3-292">As we discussed in the *Adding Validation Controls to the Editing and Inserting Interfaces* and *Customizing the Data Modification Interface* tutorials, the user interface can be customized by replacing the BoundFields with TemplateFields.</span></span> <span data-ttu-id="b23c3-293">Ich wurde diese GridView und die Bearbeitung-Schnittstelle auf folgende Weise verändert:</span><span class="sxs-lookup"><span data-stu-id="b23c3-293">I've modified this GridView and its editing interface in the following ways:</span></span>

- <span data-ttu-id="b23c3-294">Entfernt die `ProductID`, `SupplierName`, und `CategoryName` BoundFields</span><span class="sxs-lookup"><span data-stu-id="b23c3-294">Removed the `ProductID`, `SupplierName`, and `CategoryName` BoundFields</span></span>
- <span data-ttu-id="b23c3-295">Konvertiert die `ProductName` BoundField in ein TemplateField und ein RequiredFieldValidation-Steuerelement hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="b23c3-295">Converted the `ProductName` BoundField to a TemplateField and added a RequiredFieldValidation control.</span></span>
- <span data-ttu-id="b23c3-296">Konvertiert die `CategoryID` und `SupplierID` BoundFields auf von TemplateFields, und die Bearbeitung Schnittstelle für die Textfelder ein, anstatt DropDownLists verwenden angepasst.</span><span class="sxs-lookup"><span data-stu-id="b23c3-296">Converted the `CategoryID` and `SupplierID` BoundFields to TemplateFields, and adjusted the editing interface to use DropDownLists rather than TextBoxes.</span></span> <span data-ttu-id="b23c3-297">In diesen von TemplateFields `ItemTemplates`, `CategoryName` und `SupplierName` Datenfelder angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="b23c3-297">In these TemplateFields' `ItemTemplates`, the `CategoryName` and `SupplierName` data fields are displayed.</span></span>
- <span data-ttu-id="b23c3-298">Konvertiert die `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, und `ReorderLevel` BoundFields von TemplateFields und hinzugefügten CompareValidator-Steuerelemente.</span><span class="sxs-lookup"><span data-stu-id="b23c3-298">Converted the `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, and `ReorderLevel` BoundFields to TemplateFields and added CompareValidator controls.</span></span>

<span data-ttu-id="b23c3-299">Da wir wie diese Aufgaben im vorherigen Lernprogrammen bereits überprüft haben, kann ich Sende nur hier die endgültige deklarative Syntax auflisten und lassen Sie die Implementierung als Methode.</span><span class="sxs-lookup"><span data-stu-id="b23c3-299">Since we've already examined how to accomplish these tasks in previous tutorials, I'll just list the final declarative syntax here and leave the implementation as practice.</span></span>


[!code-aspx[Main](implementing-optimistic-concurrency-cs/samples/sample9.aspx)]

<span data-ttu-id="b23c3-300">Wir sind sehr nahe, dass ein voll funktionsfähiges Beispiel.</span><span class="sxs-lookup"><span data-stu-id="b23c3-300">We're very close to having a fully-working example.</span></span> <span data-ttu-id="b23c3-301">Es gibt jedoch einige Besonderheiten, die sich verzeichnen und uns Probleme verursachen.</span><span class="sxs-lookup"><span data-stu-id="b23c3-301">However, there are a few subtleties that will creep up and cause us problems.</span></span> <span data-ttu-id="b23c3-302">Darüber hinaus brauchen wir noch eine Schnittstelle, die den Benutzer benachrichtigt werden, wenn eine parallelitätsverletzung aufgetreten ist.</span><span class="sxs-lookup"><span data-stu-id="b23c3-302">Additionally, we still need some interface that alerts the user when a concurrency violation has occurred.</span></span>

> [!NOTE]
> <span data-ttu-id="b23c3-303">Damit ein Daten-Websteuerelement, übergeben Sie die ursprünglichen Werte ordnungsgemäß an das ObjectDataSource (die dann an die BLL übergeben werden), ist es von entscheidender Bedeutung, die der GridView `EnableViewState` -Eigenschaftensatz auf `true` (Standard).</span><span class="sxs-lookup"><span data-stu-id="b23c3-303">In order for a data Web control to correctly pass the original values to the ObjectDataSource (which are then passed to the BLL), it's vital that the GridView's `EnableViewState` property is set to `true` (the default).</span></span> <span data-ttu-id="b23c3-304">Wenn Sie den Ansichtszustand deaktivieren, werden die ursprünglichen Werte auf Postback verloren gegangen.</span><span class="sxs-lookup"><span data-stu-id="b23c3-304">If you disable view state, the original values are lost on postback.</span></span>


## <a name="passing-the-correct-original-values-to-the-objectdatasource"></a><span data-ttu-id="b23c3-305">Übergeben die richtigen ursprüngliche Werte an das ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="b23c3-305">Passing the Correct Original Values to the ObjectDataSource</span></span>

<span data-ttu-id="b23c3-306">Es gibt eine Reihe von Problemen bei der Art die GridView konfiguriert wurde.</span><span class="sxs-lookup"><span data-stu-id="b23c3-306">There are a couple of problems with the way the GridView has been configured.</span></span> <span data-ttu-id="b23c3-307">Wenn das ObjectDataSource `ConflictDetection` -Eigenschaftensatz auf `CompareAllValues` (wie besehen unsere), wenn das ObjectDataSource `Update()` oder `Delete()` Methoden werden aufgerufen, indem die GridView (oder DetailsView oder FormView), wird das ObjectDataSource versucht, so kopieren Sie die GridView ursprünglichen Werte in die entsprechenden `Parameter` Instanzen.</span><span class="sxs-lookup"><span data-stu-id="b23c3-307">If the ObjectDataSource's `ConflictDetection` property is set to `CompareAllValues` (as is ours), when the ObjectDataSource's `Update()` or `Delete()` methods are invoked by the GridView (or DetailsView or FormView), the ObjectDataSource attempts to copy the GridView's original values into its appropriate `Parameter` instances.</span></span> <span data-ttu-id="b23c3-308">Verweisen Sie zurück in Abbildung 2 für eine grafische Darstellung dieses Prozesses.</span><span class="sxs-lookup"><span data-stu-id="b23c3-308">Refer back to Figure 2 for a graphical representation of this process.</span></span>

<span data-ttu-id="b23c3-309">Insbesondere werden die GridView ursprünglichen Werte der Werte in den Anweisungen für die bidirektionale Datenbindung zugewiesen, jedes Mal die Daten an die GridView gebunden werden.</span><span class="sxs-lookup"><span data-stu-id="b23c3-309">Specifically, the GridView's original values are assigned the values in the two-way databinding statements each time the data is bound to the GridView.</span></span> <span data-ttu-id="b23c3-310">Daher ist es wichtig, dass die erforderlichen ursprünglichen Werte, die alle über die bidirektionale Datenbindung erfasst werden und dass sie in einem konvertierbar Format bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="b23c3-310">Therefore, it's essential that the required original values all are captured via two-way databinding and that they are provided in a convertible format.</span></span>

<span data-ttu-id="b23c3-311">Nehmen Sie einen Moment Zeit, besuchen unsere-Seite in einem Browser, um anzuzeigen, warum dies wichtig ist.</span><span class="sxs-lookup"><span data-stu-id="b23c3-311">To see why this is important, take a moment to visit our page in a browser.</span></span> <span data-ttu-id="b23c3-312">Wie erwartet, werden die GridView jedes Produkt mit einer Schaltfläche "Bearbeiten und löschen" in der äußersten linken Spalte aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="b23c3-312">As expected, the GridView lists each product with an Edit and Delete button in the leftmost column.</span></span>


<span data-ttu-id="b23c3-313">[![Produkte werden in einem GridView aufgelistet.](implementing-optimistic-concurrency-cs/_static/image39.png)](implementing-optimistic-concurrency-cs/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="b23c3-313">[![The Products are Listed in a GridView](implementing-optimistic-concurrency-cs/_static/image39.png)](implementing-optimistic-concurrency-cs/_static/image38.png)</span></span>

<span data-ttu-id="b23c3-314">**Abbildung 14**: die Produkte werden in einem GridView aufgelistet ([klicken Sie hier, um das Bild in voller Größe angezeigt](implementing-optimistic-concurrency-cs/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="b23c3-314">**Figure 14**: The Products are Listed in a GridView ([Click to view full-size image](implementing-optimistic-concurrency-cs/_static/image40.png))</span></span>


<span data-ttu-id="b23c3-315">Wenn Sie die Schaltfläche "löschen" für jedes Produkt auf eine `FormatException` ausgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="b23c3-315">If you click the Delete button for any product, a `FormatException` is thrown.</span></span>


<span data-ttu-id="b23c3-316">[![Bei dem Versuch, Produkt Ergebnisse in eine FormatException löschen](implementing-optimistic-concurrency-cs/_static/image42.png)](implementing-optimistic-concurrency-cs/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="b23c3-316">[![Attempting to Delete Any Product Results in a FormatException](implementing-optimistic-concurrency-cs/_static/image42.png)](implementing-optimistic-concurrency-cs/_static/image41.png)</span></span>

<span data-ttu-id="b23c3-317">**Abbildung 15**: Versuch Löschen beliebiger Produkt Ergebnisse in einem `FormatException` ([klicken Sie hier, um das Bild in voller Größe angezeigt](implementing-optimistic-concurrency-cs/_static/image43.png))</span><span class="sxs-lookup"><span data-stu-id="b23c3-317">**Figure 15**: Attempting to Delete Any Product Results in a `FormatException` ([Click to view full-size image](implementing-optimistic-concurrency-cs/_static/image43.png))</span></span>


<span data-ttu-id="b23c3-318">Die `FormatException` wird ausgelöst, wenn das ObjectDataSource versucht wird, lesen Sie in der ursprünglichen `UnitPrice` Wert.</span><span class="sxs-lookup"><span data-stu-id="b23c3-318">The `FormatException` is raised when the ObjectDataSource attempts to read in the original `UnitPrice` value.</span></span> <span data-ttu-id="b23c3-319">Da die `ItemTemplate` hat die `UnitPrice` als Währung formatiert (`<%# Bind("UnitPrice", "{0:C}") %>`), er enthält ein Währungssymbol, z. B. $19,95.</span><span class="sxs-lookup"><span data-stu-id="b23c3-319">Since the `ItemTemplate` has the `UnitPrice` formatted as a currency (`<%# Bind("UnitPrice", "{0:C}") %>`), it includes a currency symbol, like $19.95.</span></span> <span data-ttu-id="b23c3-320">Die `FormatException` auftritt, die das ObjectDataSource versucht wird, konvertiert diese Zeichenfolge in eine `decimal`.</span><span class="sxs-lookup"><span data-stu-id="b23c3-320">The `FormatException` occurs as the ObjectDataSource attempts to convert this string into a `decimal`.</span></span> <span data-ttu-id="b23c3-321">Um dieses Problem zu umgehen, haben wir eine Reihe von Optionen an:</span><span class="sxs-lookup"><span data-stu-id="b23c3-321">To circumvent this problem, we have a number of options:</span></span>

- <span data-ttu-id="b23c3-322">Entfernen Sie das Währungsformat aus der `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="b23c3-322">Remove the currency formatting from the `ItemTemplate`.</span></span> <span data-ttu-id="b23c3-323">D. h. anstatt `<%# Bind("UnitPrice", "{0:C}") %>`, verwenden Sie einfach `<%# Bind("UnitPrice") %>`.</span><span class="sxs-lookup"><span data-stu-id="b23c3-323">That is, instead of using `<%# Bind("UnitPrice", "{0:C}") %>`, simply use `<%# Bind("UnitPrice") %>`.</span></span> <span data-ttu-id="b23c3-324">Der Nachteil dieses ist, dass der Preis nicht mehr formatiert ist.</span><span class="sxs-lookup"><span data-stu-id="b23c3-324">The downside of this is that the price is no longer formatted.</span></span>
- <span data-ttu-id="b23c3-325">Anzeigen der `UnitPrice` formatiert als Währung in der `ItemTemplate`, verwenden jedoch den `Eval` Schlüsselwort, um dies zu erreichen.</span><span class="sxs-lookup"><span data-stu-id="b23c3-325">Display the `UnitPrice` formatted as a currency in the `ItemTemplate`, but use the `Eval` keyword to accomplish this.</span></span> <span data-ttu-id="b23c3-326">Bedenken Sie, dass `Eval` unidirektionale Databinding ausführt.</span><span class="sxs-lookup"><span data-stu-id="b23c3-326">Recall that `Eval` performs one-way databinding.</span></span> <span data-ttu-id="b23c3-327">Wir müssen angeben der `UnitPrice` Wert für die ursprünglichen Werte, damit wir noch, dass eine bidirektionale Databinding-Anweisung in benötigen der `ItemTemplate`, aber dies platziert werden kann, in einem Label-Steuerelement, dessen `Visible` -Eigenschaftensatz auf `false`.</span><span class="sxs-lookup"><span data-stu-id="b23c3-327">We still need to provide the `UnitPrice` value for the original values, so we'll still need a two-way databinding statement in the `ItemTemplate`, but this can be placed in a Label Web control whose `Visible` property is set to `false`.</span></span> <span data-ttu-id="b23c3-328">Wir konnten das folgende Markup in ItemTemplate verwenden:</span><span class="sxs-lookup"><span data-stu-id="b23c3-328">We could use the following markup in the ItemTemplate:</span></span>


[!code-aspx[Main](implementing-optimistic-concurrency-cs/samples/sample10.aspx)]

- <span data-ttu-id="b23c3-329">Entfernen Sie das Währungsformat aus der `ItemTemplate`mit `<%# Bind("UnitPrice") %>`.</span><span class="sxs-lookup"><span data-stu-id="b23c3-329">Remove the currency formatting from the `ItemTemplate`, using `<%# Bind("UnitPrice") %>`.</span></span> <span data-ttu-id="b23c3-330">In der GridView `RowDataBound` -Ereignishandler, programmgesteuert auf den Zugriff steuern die Bezeichnung Web, anhand derer die `UnitPrice` Wert angezeigt wird, und legen Sie dessen `Text` Eigenschaft, um die formatierte Version.</span><span class="sxs-lookup"><span data-stu-id="b23c3-330">In the GridView's `RowDataBound` event handler, programmatically access the Label Web control within which the `UnitPrice` value is displayed and set its `Text` property to the formatted version.</span></span>
- <span data-ttu-id="b23c3-331">Lassen Sie die `UnitPrice` als Währung formatiert.</span><span class="sxs-lookup"><span data-stu-id="b23c3-331">Leave the `UnitPrice` formatted as a currency.</span></span> <span data-ttu-id="b23c3-332">In der GridView `RowDeleting` Ereignishandler, ersetzen Sie die vorhandene ursprüngliche `UnitPrice` Wert ($19,95) mit einem tatsächlichen Dezimalwert `Decimal.Parse`.</span><span class="sxs-lookup"><span data-stu-id="b23c3-332">In the GridView's `RowDeleting` event handler, replace the existing original `UnitPrice` value ($19.95) with an actual decimal value using `Decimal.Parse`.</span></span> <span data-ttu-id="b23c3-333">Wurde erläutert, wie in etwas Ähnliches zu erreichen der `RowUpdating` -Ereignishandler in der [ *Behandlung von BLL- und DAL-Ebene Ausnahmen auf einer ASP.NET-Seite* ](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md) Lernprogramm.</span><span class="sxs-lookup"><span data-stu-id="b23c3-333">We saw how to accomplish something similar in the `RowUpdating` event handler in the [*Handling BLL- and DAL-Level Exceptions in an ASP.NET Page*](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md) tutorial.</span></span>

<span data-ttu-id="b23c3-334">Meine ich ausgewählt haben, fahren Sie mit den zweiten Ansatz, beispielsweise Hinzufügen einer ausgeblendeten Bezeichnung Web-Steuerelement, dessen `Text` Eigenschaft ist für bidirektionale gebundenen die unformatierten Daten `UnitPrice` Wert.</span><span class="sxs-lookup"><span data-stu-id="b23c3-334">For my example I chose to go with the second approach, adding a hidden Label Web control whose `Text` property is two-way data bound to the unformatted `UnitPrice` value.</span></span>

<span data-ttu-id="b23c3-335">Versuchen Sie nach der Lösung dieses Problems erneut auf die Schaltfläche "löschen" für jedes Produkt klicken.</span><span class="sxs-lookup"><span data-stu-id="b23c3-335">After solving this problem, try clicking the Delete button for any product again.</span></span> <span data-ttu-id="b23c3-336">Sie erhalten diesmal ein `InvalidOperationException` wann das ObjectDataSource zum Aufrufen der BLL `UpdateProduct` Methode.</span><span class="sxs-lookup"><span data-stu-id="b23c3-336">This time you'll get an `InvalidOperationException` when the ObjectDataSource attempts to invoke the BLL's `UpdateProduct` method.</span></span>


<span data-ttu-id="b23c3-337">[![Das ObjectDataSource kann eine Methode mit dem Eingabeparameter finden, die sie senden möchte](implementing-optimistic-concurrency-cs/_static/image45.png)](implementing-optimistic-concurrency-cs/_static/image44.png)</span><span class="sxs-lookup"><span data-stu-id="b23c3-337">[![The ObjectDataSource Cannot Find a Method with the Input Parameters it Wants to Send](implementing-optimistic-concurrency-cs/_static/image45.png)](implementing-optimistic-concurrency-cs/_static/image44.png)</span></span>

<span data-ttu-id="b23c3-338">**Abbildung 16**: das ObjectDataSource wurde eine Methode mit der Input-Parameter, die sie senden möchte nicht gefunden ([klicken Sie hier, um das Bild in voller Größe angezeigt](implementing-optimistic-concurrency-cs/_static/image46.png))</span><span class="sxs-lookup"><span data-stu-id="b23c3-338">**Figure 16**: The ObjectDataSource Cannot Find a Method with the Input Parameters it Wants to Send ([Click to view full-size image](implementing-optimistic-concurrency-cs/_static/image46.png))</span></span>


<span data-ttu-id="b23c3-339">Betrachten die Meldung der Ausnahme aus, es ist klar, dass das ObjectDataSource eine BLL aufrufen möchte `DeleteProduct` Methode, die enthält `original_CategoryName` und `original_SupplierName` Eingabeparameter.</span><span class="sxs-lookup"><span data-stu-id="b23c3-339">Looking at the exception's message, it's clear that the ObjectDataSource wants to invoke a BLL `DeleteProduct` method that includes `original_CategoryName` and `original_SupplierName` input parameters.</span></span> <span data-ttu-id="b23c3-340">Grund hierfür ist die `ItemTemplate` s für die `CategoryID` und `SupplierID` von TemplateFields derzeit Anweisungen enthalten, die bidirektionale Bindung mit der `CategoryName` und `SupplierName` Datenfelder.</span><span class="sxs-lookup"><span data-stu-id="b23c3-340">This is because the `ItemTemplate` s for the `CategoryID` and `SupplierID` TemplateFields currently contain two-way Bind statements with the `CategoryName` and `SupplierName` data fields.</span></span> <span data-ttu-id="b23c3-341">Stattdessen müssen wir enthalten `Bind` -Anweisungen mit der `CategoryID` und `SupplierID` Datenfelder.</span><span class="sxs-lookup"><span data-stu-id="b23c3-341">Instead, we need to include `Bind` statements with the `CategoryID` and `SupplierID` data fields.</span></span> <span data-ttu-id="b23c3-342">Um dies zu erreichen, ersetzen Sie die vorhandenen Bind-Anweisungen mit `Eval` -Anweisungen, und fügen Sie dann auf ausgeblendete Label-Steuerelemente, deren `Text` Eigenschaften gebunden sind, um die `CategoryID` und `SupplierID` Datenfelder, die wie gezeigt, über die bidirektionale Datenbindung, Im folgenden:</span><span class="sxs-lookup"><span data-stu-id="b23c3-342">To accomplish this, replace the existing Bind statements with `Eval` statements, and then add hidden Label controls whose `Text` properties are bound to the `CategoryID` and `SupplierID` data fields using two-way databinding, as shown below:</span></span>


[!code-aspx[Main](implementing-optimistic-concurrency-cs/samples/sample11.aspx)]

<span data-ttu-id="b23c3-343">Mit diesen Änderungen werden wir jetzt erfolgreich löschen und Bearbeiten von Produktinformationen können!</span><span class="sxs-lookup"><span data-stu-id="b23c3-343">With these changes, we are now able to successfully delete and edit product information!</span></span> <span data-ttu-id="b23c3-344">In Schritt 5 betrachten wir, wie stellen Sie sicher, dass nebenläufigkeitsverstöße erkannt wird, werden wird.</span><span class="sxs-lookup"><span data-stu-id="b23c3-344">In Step 5 we'll look at how to verify that concurrency violations are being detected.</span></span> <span data-ttu-id="b23c3-345">Aber jetzt zu aktualisieren versuchen Sie es einige Minuten dauern, bis, und löschen einige Datensätze, um sicherzustellen, dass die Aktualisierung und Löschen für einen einzelnen Benutzer erwartungsgemäß funktioniert.</span><span class="sxs-lookup"><span data-stu-id="b23c3-345">But for now, take a few minutes to try updating and deleting a few records to ensure that updating and deleting for a single user works as expected.</span></span>

## <a name="step-5-testing-the-optimistic-concurrency-support"></a><span data-ttu-id="b23c3-346">Schritt 5: Testen der vollständigen Parallelität-Unterstützung</span><span class="sxs-lookup"><span data-stu-id="b23c3-346">Step 5: Testing the Optimistic Concurrency Support</span></span>

<span data-ttu-id="b23c3-347">Um sicherzustellen, dass parallelitätsverletzungen erkannten (statt resultierenden Daten Blind überschrieben) werden, müssen wir zwei Browserfenstern auf dieser Seite zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="b23c3-347">In order to verify that concurrency violations are being detected (rather than resulting in data being blindly overwritten), we need to open two browser windows to this page.</span></span> <span data-ttu-id="b23c3-348">Klicken Sie in beiden Browserinstanzen für Chai auf die Schaltfläche "Bearbeiten".</span><span class="sxs-lookup"><span data-stu-id="b23c3-348">In both browser instances, click on the Edit button for Chai.</span></span> <span data-ttu-id="b23c3-349">Klicken Sie dann nur einen Browser, ändern Sie den Namen in "Chai Tee", und klicken Sie auf aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="b23c3-349">Then, in just one of the browsers, change the name to "Chai Tea" and click Update.</span></span> <span data-ttu-id="b23c3-350">Das Update sollte erfolgreich sind und die GridView Datenbankzustands vorab Bearbeitung mit "Chai Tee" als neues Produktname.</span><span class="sxs-lookup"><span data-stu-id="b23c3-350">The update should succeed and return the GridView to its pre-editing state, with "Chai Tea" as the new product name.</span></span>

<span data-ttu-id="b23c3-351">In den anderen Fenster Browserinstanz zeigt jedoch der Produktnamen Textfeld immer noch "Chai".</span><span class="sxs-lookup"><span data-stu-id="b23c3-351">In the other browser window instance, however, the product name TextBox still shows "Chai".</span></span> <span data-ttu-id="b23c3-352">In diesem zweiten Browserfenster aktualisieren, die `UnitPrice` auf `25.00`.</span><span class="sxs-lookup"><span data-stu-id="b23c3-352">In this second browser window, update the `UnitPrice` to `25.00`.</span></span> <span data-ttu-id="b23c3-353">Keine Unterstützung für vollständige Parallelität würde Update in der zweiten Browserinstanz auf den Produktnamen an "Chai", wodurch die von der ersten Browserinstanz vorgenommenen Änderungen überschrieben ändern.</span><span class="sxs-lookup"><span data-stu-id="b23c3-353">Without optimistic concurrency support, clicking update in the second browser instance would change the product name back to "Chai", thereby overwriting the changes made by the first browser instance.</span></span> <span data-ttu-id="b23c3-354">Mit vollständiger Parallelität verwendet, jedoch auf die Schaltfläche "Aktualisieren" in der zweiten Browserinstanz führt zu einem [DBConcurrencyException](https://msdn.microsoft.com/library/system.data.dbconcurrencyexception.aspx).</span><span class="sxs-lookup"><span data-stu-id="b23c3-354">With optimistic concurrency employed, however, clicking the Update button in the second browser instance results in a [DBConcurrencyException](https://msdn.microsoft.com/library/system.data.dbconcurrencyexception.aspx).</span></span>


<span data-ttu-id="b23c3-355">[![Wenn eine Parallelitätsverletzung erkannt wird, wird eine DBConcurrencyException ausgelöst.](implementing-optimistic-concurrency-cs/_static/image48.png)](implementing-optimistic-concurrency-cs/_static/image47.png)</span><span class="sxs-lookup"><span data-stu-id="b23c3-355">[![When a Concurrency Violation is Detected, a DBConcurrencyException is Thrown](implementing-optimistic-concurrency-cs/_static/image48.png)](implementing-optimistic-concurrency-cs/_static/image47.png)</span></span>

<span data-ttu-id="b23c3-356">**Abbildung 17**: Wenn eine Parallelitätsverletzung erkannt wird, eine `DBConcurrencyException` ausgelöst ([klicken Sie hier, um das Bild in voller Größe angezeigt](implementing-optimistic-concurrency-cs/_static/image49.png))</span><span class="sxs-lookup"><span data-stu-id="b23c3-356">**Figure 17**: When a Concurrency Violation is Detected, a `DBConcurrencyException` is Thrown ([Click to view full-size image](implementing-optimistic-concurrency-cs/_static/image49.png))</span></span>


<span data-ttu-id="b23c3-357">Die `DBConcurrencyException` wird nur ausgelöst, wenn der DAL Batch updatemuster genutzt wird.</span><span class="sxs-lookup"><span data-stu-id="b23c3-357">The `DBConcurrencyException` is only thrown when the DAL's batch update pattern is utilized.</span></span> <span data-ttu-id="b23c3-358">Das direkte DB-Muster löst keine Ausnahme aus, lediglich bedeutet dies, dass keine Zeilen betroffen sind.</span><span class="sxs-lookup"><span data-stu-id="b23c3-358">The DB direct pattern does not raise an exception, it merely indicates that no rows were affected.</span></span> <span data-ttu-id="b23c3-359">Um dies zu veranschaulichen, werden beide Browserinstanzen GridView an ihren vorab Bearbeitungszustand zurück.</span><span class="sxs-lookup"><span data-stu-id="b23c3-359">To illustrate this, return both browser instances' GridView to their pre-editing state.</span></span> <span data-ttu-id="b23c3-360">Als Nächstes in der ersten Browserinstanz, klicken Sie auf die Schaltfläche "Bearbeiten" und ändern Sie den Produktnamen aus "Chai Tee" an "Chai" und klicken Sie auf aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="b23c3-360">Next, in the first browser instance, click the Edit button and change the product name from "Chai Tea" back to "Chai" and click Update.</span></span> <span data-ttu-id="b23c3-361">Klicken Sie in der zweiten Browserfenster für Chai auf die Schaltfläche "löschen".</span><span class="sxs-lookup"><span data-stu-id="b23c3-361">In the second browser window, click the Delete button for Chai.</span></span>

<span data-ttu-id="b23c3-362">Beim Klicken auf "löschen" die Seite sendet zurück, die GridView Ruft das ObjectDataSource `Delete()` -Methode und die ObjectDataSource Aufrufe nach unten der `ProductsOptimisticConcurrencyBLL` Klasse `DeleteProduct` Methode weiter und übergibt dabei die ursprünglichen Werte.</span><span class="sxs-lookup"><span data-stu-id="b23c3-362">Upon clicking Delete, the page posts back, the GridView invokes the ObjectDataSource's `Delete()` method, and the ObjectDataSource calls down into the `ProductsOptimisticConcurrencyBLL` class's `DeleteProduct` method, passing along the original values.</span></span> <span data-ttu-id="b23c3-363">Die ursprüngliche `ProductName` Wert, der zweite Browserinstanz "Chai Tee", die mit dem aktuellen übereinstimmt `ProductName` Wert in der Datenbank.</span><span class="sxs-lookup"><span data-stu-id="b23c3-363">The original `ProductName` value for the second browser instance is "Chai Tea", which doesn't match up with the current `ProductName` value in the database.</span></span> <span data-ttu-id="b23c3-364">Aus diesem Grund die `DELETE` Anweisung mit der Datenbank ausgegeben wirkt sich auf 0 (null) Zeilen, da es kein Datensatz in der Datenbank ist, die die `WHERE` Klausel erfüllen.</span><span class="sxs-lookup"><span data-stu-id="b23c3-364">Therefore the `DELETE` statement issued to the database affects zero rows since there's no record in the database that the `WHERE` clause satisfies.</span></span> <span data-ttu-id="b23c3-365">Die `DeleteProduct` -Methode zurückkehrt `false` und das ObjectDataSource-Daten an die GridView gebunden ist.</span><span class="sxs-lookup"><span data-stu-id="b23c3-365">The `DeleteProduct` method returns `false` and the ObjectDataSource's data is rebound to the GridView.</span></span>

<span data-ttu-id="b23c3-366">Aus der Perspektive des Endbenutzers klicken auf die Schaltfläche "löschen" für Chai Tee im zweiten Browserfenster verursacht den Bildschirm, flash und, nach zurückzukommen, das Produkt wird immer noch vorhanden ist, obwohl jetzt als "Chai" (die Änderung des Produktnamens vorgenommen, die vom ersten Browser danach die Instanz).</span><span class="sxs-lookup"><span data-stu-id="b23c3-366">From the end user's perspective, clicking on the Delete button for Chai Tea in the second browser window caused the screen to flash and, upon coming back, the product is still there, although now it's listed as "Chai" (the product name change made by the first browser instance).</span></span> <span data-ttu-id="b23c3-367">Wenn der Benutzer erneut auf die Schaltfläche "löschen" klickt, der Löschvorgang zwar ausgeführt werden, wie die GridView ursprünglichen's `ProductName` Wert ("Chai") sich nun mit dem Wert in der Datenbank übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="b23c3-367">If the user clicks the Delete button again, the Delete will succeed, as the GridView's original `ProductName` value ("Chai") now matches up with the value in the database.</span></span>

<span data-ttu-id="b23c3-368">In beiden Fällen wird die benutzerfreundlichkeit zurückgelegt Ideal ist.</span><span class="sxs-lookup"><span data-stu-id="b23c3-368">In both of these cases, the user experience is far from ideal.</span></span> <span data-ttu-id="b23c3-369">Wir deutlich möchte nicht dem Benutzer anzuzeigen, die wesentlichen Details der `DBConcurrencyException` -Ausnahme aus, wenn der Batch-updatemuster mit.</span><span class="sxs-lookup"><span data-stu-id="b23c3-369">We clearly don't want to show the user the nitty-gritty details of the `DBConcurrencyException` exception when using the batch update pattern.</span></span> <span data-ttu-id="b23c3-370">Und das Verhalten, wenn mit dem direkten DB-Muster ist etwas verwirrend, da der Benutzer ist ein Fehler aufgetreten, aber es keine genaue Angabe der verdeutlichen, warum wurde.</span><span class="sxs-lookup"><span data-stu-id="b23c3-370">And the behavior when using the DB direct pattern is somewhat confusing as the users command failed, but there was no precise indication of why.</span></span>

<span data-ttu-id="b23c3-371">Um diese beiden Probleme zu beheben, können wir Bezeichnung Websteuerelemente auf der Seite, die eine Erläuterung, warum ein Update- oder Delete-Fehler beim Bereitstellen erstellen.</span><span class="sxs-lookup"><span data-stu-id="b23c3-371">To remedy these two issues, we can create Label Web controls on the page that provide an explanation to why an update or delete failed.</span></span> <span data-ttu-id="b23c3-372">Für das Batch-Update-Muster können bestimmen, und zwar unabhängig davon, ob eine `DBConcurrencyException` Ausnahme bei einem nach der Ebene der GridView-Ereignishandler, d. h. der Warnhinweis anzeigen, je nach Bedarf.</span><span class="sxs-lookup"><span data-stu-id="b23c3-372">For the batch update pattern, we can determine whether or not a `DBConcurrencyException` exception occurred in the GridView's post-level event handler, displaying the warning label as needed.</span></span> <span data-ttu-id="b23c3-373">Untersuchen wir für die direkte DB-Methode ist den Rückgabewert der Methode BLL (also `true` , wenn eine Zeile betroffen war, `false` andernfalls) und eine informationsmeldung Bedarf anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="b23c3-373">For the DB direct method, we can examine the return value of the BLL method (which is `true` if one row was affected, `false` otherwise) and display an informational message as needed.</span></span>

## <a name="step-6-adding-informational-messages-and-displaying-them-in-the-face-of-a-concurrency-violation"></a><span data-ttu-id="b23c3-374">Schritt 6: Hinzufügen von Informationsmeldungen und deren Ausführung eine Parallelitätsverletzung Anzeige</span><span class="sxs-lookup"><span data-stu-id="b23c3-374">Step 6: Adding Informational Messages and Displaying Them in the Face of a Concurrency Violation</span></span>

<span data-ttu-id="b23c3-375">Tritt eine parallelitätsverletzung vom Verhalten hängt davon ab, ob der DAL BatchUpdate oder DB-direct-Muster verwendet wurde.</span><span class="sxs-lookup"><span data-stu-id="b23c3-375">When a concurrency violation occurs, the behavior exhibited depends on whether the DAL's batch update or DB direct pattern was used.</span></span> <span data-ttu-id="b23c3-376">Unser Tutorial aus, verwendet beide Muster, mit dem Muster für den Batch-Update aktualisieren als auch die direkte DB-Muster, die zum Löschen von verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="b23c3-376">Our tutorial uses both patterns, with the batch update pattern being used for updating and the DB direct pattern used for deleting.</span></span> <span data-ttu-id="b23c3-377">Um zu beginnen, fügen Sie zwei Label-Websteuerelemente auf unserer Seite, die erklären, dass eine parallelitätsverletzung aufgetreten beim Versuch, löschen oder Aktualisieren von Daten.</span><span class="sxs-lookup"><span data-stu-id="b23c3-377">To get started, let's add two Label Web controls to our page that explain that a concurrency violation occurred when attempting to delete or update data.</span></span> <span data-ttu-id="b23c3-378">Legen Sie des Label-Steuerelements `Visible` und `EnableViewState` Eigenschaften `false`; Dies bewirkt, dass sie auf jeder Seite Besuch ausgeblendet werden, außer für diese bestimmte Seite Where besucht ihre `Visible` -Eigenschaftensatz wird programmgesteuert auf `true`.</span><span class="sxs-lookup"><span data-stu-id="b23c3-378">Set the Label control's `Visible` and `EnableViewState` properties to `false`; this will cause them to be hidden on each page visit except for those particular page visits where their `Visible` property is programmatically set to `true`.</span></span>


[!code-aspx[Main](implementing-optimistic-concurrency-cs/samples/sample12.aspx)]

<span data-ttu-id="b23c3-379">Zusätzlich zu ihren `Visible`, `EnabledViewState`, und `Text` ich haben ebenfalls Festlegen von Eigenschaften, die `CssClass` Eigenschaft, um `Warning`, dies bedeutet, dass die Bezeichnung des in einer Schriftart große, Rot, kursiv, fett angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="b23c3-379">In addition to setting their `Visible`, `EnabledViewState`, and `Text` properties, I've also set the `CssClass` property to `Warning`, which causes the Label's to be displayed in a large, red, italic, bold font.</span></span> <span data-ttu-id="b23c3-380">Dieses CSS `Warning` Klasse definiert und Styles.css hinzugefügt wurde wieder in die *untersuchen die Ereignisse zugeordneten einfügen, aktualisieren und Löschen von* Lernprogramm.</span><span class="sxs-lookup"><span data-stu-id="b23c3-380">This CSS `Warning` class was defined and added to Styles.css back in the *Examining the Events Associated with Inserting, Updating, and Deleting* tutorial.</span></span>

<span data-ttu-id="b23c3-381">Nachdem diese Bezeichnungen hinzugefügt wurde, sollte der Designer in Visual Studio Abbildung 18 ähneln.</span><span class="sxs-lookup"><span data-stu-id="b23c3-381">After adding these Labels, the Designer in Visual Studio should look similar to Figure 18.</span></span>


<span data-ttu-id="b23c3-382">[![Zwei Label-Steuerelemente wurden der Seite "hinzugefügt](implementing-optimistic-concurrency-cs/_static/image51.png)](implementing-optimistic-concurrency-cs/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="b23c3-382">[![Two Label Controls Have Been Added to the Page](implementing-optimistic-concurrency-cs/_static/image51.png)](implementing-optimistic-concurrency-cs/_static/image50.png)</span></span>

<span data-ttu-id="b23c3-383">**Abbildung 18**: zwei Label-Steuerelemente hinzugefügt wurden die Seite ([klicken Sie hier, um das Bild in voller Größe angezeigt](implementing-optimistic-concurrency-cs/_static/image52.png))</span><span class="sxs-lookup"><span data-stu-id="b23c3-383">**Figure 18**: Two Label Controls Have Been Added to the Page ([Click to view full-size image](implementing-optimistic-concurrency-cs/_static/image52.png))</span></span>


<span data-ttu-id="b23c3-384">Mit dieser Bezeichnung Web Kontrollen, wir jetzt können Sie bestimmen, wenn eine parallelitätsverletzung aufgetreten ist, zeigen Sie an dem der entsprechenden Bezeichnung untersuchen `Visible` Eigenschaft kann festgelegt werden, um `true`, die Meldung zu Informationszwecken angezeigt.</span><span class="sxs-lookup"><span data-stu-id="b23c3-384">With these Label Web controls in place, we're ready to examine how to determine when a concurrency violation has occurred, at which point the appropriate Label's `Visible` property can be set to `true`, displaying the informational message.</span></span>

## <a name="handling-concurrency-violations-when-updating"></a><span data-ttu-id="b23c3-385">Behandeln von Parallelität, bei der Aktualisierung</span><span class="sxs-lookup"><span data-stu-id="b23c3-385">Handling Concurrency Violations When Updating</span></span>

<span data-ttu-id="b23c3-386">Sehen wir uns zunächst an, wie parallelitätsverletzungen behandelt wird, wenn der Batch-updatemuster mit.</span><span class="sxs-lookup"><span data-stu-id="b23c3-386">Let's first look at how to handle concurrency violations when using the batch update pattern.</span></span> <span data-ttu-id="b23c3-387">Da solche Verletzungen mit dem Batch Muster Ursache Aktualisieren einer `DBConcurrencyException` Ausnahme ausgelöst wird, müssen wir unsere ASP.NET-Seite, um zu bestimmen, Code hinzufügen, ob ein `DBConcurrencyException` während des Updates ist ein Ausnahme aufgetreten.</span><span class="sxs-lookup"><span data-stu-id="b23c3-387">Since such violations with the batch update pattern cause a `DBConcurrencyException` exception to be thrown, we need to add code to our ASP.NET page to determine whether a `DBConcurrencyException` exception occurred during the update process.</span></span> <span data-ttu-id="b23c3-388">Wenn also wir eine Nachricht an die Benutzer erklären angezeigt werden soll, die ihre Änderungen nicht gespeichert wurden, weil ein anderer Benutzer die gleichen Daten zwischen geändert wurde, beim Bearbeiten des Datensatzes starten und wenn sie die Schaltfläche "Aktualisieren" geklickt wurde.</span><span class="sxs-lookup"><span data-stu-id="b23c3-388">If so, we should display a message to the user explaining that their changes were not saved because another user had modified the same data between when they started editing the record and when they clicked the Update button.</span></span>

<span data-ttu-id="b23c3-389">Wie wir gesehen, in haben der *Behandlung von BLL- und DAL-Ebene Ausnahmen auf einer ASP.NET-Seite* Tutorial, solche Ausnahmen erkannt und in das Websteuerelement Daten nach der Ebene Ereignishandler unterdrückt werden können.</span><span class="sxs-lookup"><span data-stu-id="b23c3-389">As we saw in the *Handling BLL- and DAL-Level Exceptions in an ASP.NET Page* tutorial, such exceptions can be detected and suppressed in the data Web control's post-level event handlers.</span></span> <span data-ttu-id="b23c3-390">Aus diesem Grund müssen so erstellen Sie einen Ereignishandler für der GridView `RowUpdated` Ereignis, das überprüft, wenn eine `DBConcurrencyException` Ausnahme wurde ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="b23c3-390">Therefore, we need to create an event handler for the GridView's `RowUpdated` event that checks if a `DBConcurrencyException` exception has been thrown.</span></span> <span data-ttu-id="b23c3-391">Dieser Ereignishandler ist ein Verweis auf jede Ausnahme, die während des Aktualisierungsvorgangs ausgelöst wurde übergeben, wie im Ereignisprotokoll Ereignishandler folgenden code gezeigt:</span><span class="sxs-lookup"><span data-stu-id="b23c3-391">This event handler is passed a reference to any exception that was raised during the updating process, as shown in the event handler code below:</span></span>


[!code-csharp[Main](implementing-optimistic-concurrency-cs/samples/sample13.cs)]

<span data-ttu-id="b23c3-392">Im face von einem `DBConcurrencyException` Ausnahme dieser Ereignishandler zeigt die `UpdateConflictMessage` Label-Steuerelement und gibt an, dass die Ausnahme verarbeitet wurde.</span><span class="sxs-lookup"><span data-stu-id="b23c3-392">In the face of a `DBConcurrencyException` exception, this event handler displays the `UpdateConflictMessage` Label control and indicates that the exception has been handled.</span></span> <span data-ttu-id="b23c3-393">Mit diesem Code werden tritt eine parallelitätsverletzung beim Aktualisieren eines Datensatzes sind des Benutzers Änderungen verloren, da sie ein anderer Benutzer Änderungen gleichzeitig überschrieben haben, würden.</span><span class="sxs-lookup"><span data-stu-id="b23c3-393">With this code in place, when a concurrency violation occurs when updating a record, the user's changes are lost, since they would have overwritten another user's modifications at the same time.</span></span> <span data-ttu-id="b23c3-394">Insbesondere ist die GridView Datenbankzustands vorab Bearbeitung zurückgegeben und an Daten in der aktuellen Datenbank gebunden.</span><span class="sxs-lookup"><span data-stu-id="b23c3-394">In particular, the GridView is returned to its pre-editing state and bound to the current database data.</span></span> <span data-ttu-id="b23c3-395">Hiermit wird die GridView-Zeile mit der anderen Benutzer geändert wird, aktualisiert die zuvor nicht sichtbar waren.</span><span class="sxs-lookup"><span data-stu-id="b23c3-395">This will update the GridView row with the other user's changes, which were previously not visible.</span></span> <span data-ttu-id="b23c3-396">Darüber hinaus die `UpdateConflictMessage` Label-Steuerelement wird nur Ursache für den Benutzer erläutert.</span><span class="sxs-lookup"><span data-stu-id="b23c3-396">Additionally, the `UpdateConflictMessage` Label control will explain to the user what just happened.</span></span> <span data-ttu-id="b23c3-397">Diese Abfolge von Ereignissen wird in Abbildung 19 beschrieben.</span><span class="sxs-lookup"><span data-stu-id="b23c3-397">This sequence of events is detailed in Figure 19.</span></span>


<span data-ttu-id="b23c3-398">[![Ein Benutzer s werden in die Vorderseite eines eine Parallelitätsverletzung Updates verloren.](implementing-optimistic-concurrency-cs/_static/image54.png)](implementing-optimistic-concurrency-cs/_static/image53.png)</span><span class="sxs-lookup"><span data-stu-id="b23c3-398">[![A User s Updates are Lost in the Face of a Concurrency Violation](implementing-optimistic-concurrency-cs/_static/image54.png)](implementing-optimistic-concurrency-cs/_static/image53.png)</span></span>

<span data-ttu-id="b23c3-399">**Abbildung 19**: ein Benutzer Updates sind verlorene Bestätigungen in die Vorderseite eines eine Parallelitätsverletzung ([klicken Sie hier, um das Bild in voller Größe angezeigt](implementing-optimistic-concurrency-cs/_static/image55.png))</span><span class="sxs-lookup"><span data-stu-id="b23c3-399">**Figure 19**: A User s Updates are Lost in the Face of a Concurrency Violation ([Click to view full-size image](implementing-optimistic-concurrency-cs/_static/image55.png))</span></span>


> [!NOTE]
> <span data-ttu-id="b23c3-400">Alternativ anstatt GridView an den Bearbeitungszustand vorab zurückgegeben, wir werden u. u. GridView im Bearbeitung Zustand durch Festlegen der `KeepInEditMode` Eigenschaft übergebenen `GridViewUpdatedEventArgs` Objekt auf "true".</span><span class="sxs-lookup"><span data-stu-id="b23c3-400">Alternatively, rather than returning the GridView to the pre-editing state, we could leave the GridView in its editing state by setting the `KeepInEditMode` property of the passed-in `GridViewUpdatedEventArgs` object to true.</span></span> <span data-ttu-id="b23c3-401">Wenn Sie diesen Ansatz verwenden, allerdings werden sicher, dass die Daten an die GridView zu binden (durch Aufrufen seiner `DataBind()` Methode), damit die Bearbeitungsoberfläche des anderen Benutzers Werte geladen werden.</span><span class="sxs-lookup"><span data-stu-id="b23c3-401">If you take this approach, however, be certain to rebind the data to the GridView (by invoking its `DataBind()` method) so that the other user's values are loaded into the editing interface.</span></span> <span data-ttu-id="b23c3-402">Der Code zum Download für dieses Lernprogramm wurde diese beiden Zeilen des Codes in der `RowUpdated` Ereignishandler auskommentiert; einfach kommentieren diese Codezeilen GridView haben bleiben im Bearbeitungsmodus nach eine parallelitätsverletzung liegt vor.</span><span class="sxs-lookup"><span data-stu-id="b23c3-402">The code available for download with this tutorial has these two lines of code in the `RowUpdated` event handler commented out; simply uncomment these lines of code to have the GridView remain in edit mode after a concurrency violation.</span></span>


## <a name="responding-to-concurrency-violations-when-deleting"></a><span data-ttu-id="b23c3-403">Reagieren auf Parallelitätsverletzungen, beim Löschen von</span><span class="sxs-lookup"><span data-stu-id="b23c3-403">Responding to Concurrency Violations When Deleting</span></span>

<span data-ttu-id="b23c3-404">Mit dem direkten DB-Muster es ist keine Ausnahme ausgelöst wird, bei dem eine parallelitätsverletzung liegt vor.</span><span class="sxs-lookup"><span data-stu-id="b23c3-404">With the DB direct pattern, there is no exception raised in the face of a concurrency violation.</span></span> <span data-ttu-id="b23c3-405">Stattdessen wirkt sich auf die Database-Anweisung einfach keine Datensätze, wie die WHERE-Klausel nicht mit jedem Datensatz übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="b23c3-405">Instead, the database statement simply affects no records, as the WHERE clause does not match with any record.</span></span> <span data-ttu-id="b23c3-406">Alle Methoden Datenänderung in die BLL erstellt wurden entwickelt, dass sie einen booleschen Wert fest, und zwar unabhängig davon, ob sie genau einen Datensatz beeinflusst zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="b23c3-406">All of the data modification methods created in the BLL have been designed such that they return a Boolean value indicating whether or not they affected precisely one record.</span></span> <span data-ttu-id="b23c3-407">Untersuchen wir daher, um festzustellen, ob eine parallelitätsverletzung aufgetreten ist, wenn Sie einen Datensatz löschen, den Rückgabewert der BLL `DeleteProduct` Methode.</span><span class="sxs-lookup"><span data-stu-id="b23c3-407">Therefore, to determine if a concurrency violation occurred when deleting a record, we can examine the return value of the BLL's `DeleteProduct` method.</span></span>

<span data-ttu-id="b23c3-408">Der Rückgabewert für eine Methode BLL untersucht werden kann, in der ObjectDataSource nach der Servicelevel-Ereignishandler durch den `ReturnValue` Eigenschaft von der `ObjectDataSourceStatusEventArgs` Objekt an den Ereignishandler übergeben.</span><span class="sxs-lookup"><span data-stu-id="b23c3-408">The return value for a BLL method can be examined in the ObjectDataSource's post-level event handlers through the `ReturnValue` property of the `ObjectDataSourceStatusEventArgs` object passed into the event handler.</span></span> <span data-ttu-id="b23c3-409">Da wir bei der Bestimmung des Rückgabewerts von Interesse sind, die die `DeleteProduct` -Methode, müssen wir erstellen einen Ereignishandler für das ObjectDataSource `Deleted` Ereignis.</span><span class="sxs-lookup"><span data-stu-id="b23c3-409">Since we are interested in determining the return value from the `DeleteProduct` method, we need to create an event handler for the ObjectDataSource's `Deleted` event.</span></span> <span data-ttu-id="b23c3-410">Die `ReturnValue` -Eigenschaft ist vom Typ `object` möglich `null` Wenn eine Ausnahme ausgelöst wurde, und die Methode wurde unterbrochen, bevor sie einen Wert zurückgeben kann.</span><span class="sxs-lookup"><span data-stu-id="b23c3-410">The `ReturnValue` property is of type `object` and can be `null` if an exception was raised and the method was interrupted before it could return a value.</span></span> <span data-ttu-id="b23c3-411">Daher wir sollten zuerst sicherstellen, dass die `ReturnValue` Eigenschaft ist nicht `null` und ist ein boolescher Wert.</span><span class="sxs-lookup"><span data-stu-id="b23c3-411">Therefore, we should first ensure that the `ReturnValue` property is not `null` and is a Boolean value.</span></span> <span data-ttu-id="b23c3-412">Diese Überprüfung erfolgreich war, veranschaulichen wir, vorausgesetzt die `DeleteConflictMessage` Steuerelement beschriftet, wenn die `ReturnValue` ist `false`.</span><span class="sxs-lookup"><span data-stu-id="b23c3-412">Assuming this check passes, we show the `DeleteConflictMessage` Label control if the `ReturnValue` is `false`.</span></span> <span data-ttu-id="b23c3-413">Dies kann erfolgen, mit dem folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="b23c3-413">This can be accomplished by using the following code:</span></span>


[!code-csharp[Main](implementing-optimistic-concurrency-cs/samples/sample14.cs)]

<span data-ttu-id="b23c3-414">Bei einer parallelitätsverletzung Delete-Anforderung des Benutzers abgebrochen.</span><span class="sxs-lookup"><span data-stu-id="b23c3-414">In the face of a concurrency violation, the user's delete request is canceled.</span></span> <span data-ttu-id="b23c3-415">Die GridView wird aktualisiert und angezeigt, dass die Änderungen, die für den entsprechenden Datensatz zwischen dem Zeitpunkt den Benutzer aufgetreten geladen, auf der Seite, und wenn er auf die Schaltfläche "löschen" geklickt.</span><span class="sxs-lookup"><span data-stu-id="b23c3-415">The GridView is refreshed, showing the changes that occurred for that record between the time the user loaded the page and when he clicked the Delete button.</span></span> <span data-ttu-id="b23c3-416">Wenn solche eine Verletzung herausstellt, die `DeleteConflictMessage` Bezeichnung angezeigt wird, erläutern, was gerade geschehen ist (siehe Abbildung 20).</span><span class="sxs-lookup"><span data-stu-id="b23c3-416">When such a violation transpires, the `DeleteConflictMessage` Label is shown, explaining what just happened (see Figure 20).</span></span>


<span data-ttu-id="b23c3-417">[![Ein Benutzer s löschen ist bei einer Parallelitätsverletzung abgebrochen.](implementing-optimistic-concurrency-cs/_static/image57.png)](implementing-optimistic-concurrency-cs/_static/image56.png)</span><span class="sxs-lookup"><span data-stu-id="b23c3-417">[![A User s Delete is Canceled in the Face of a Concurrency Violation](implementing-optimistic-concurrency-cs/_static/image57.png)](implementing-optimistic-concurrency-cs/_static/image56.png)</span></span>

<span data-ttu-id="b23c3-418">**Abbildung 20**: ein Benutzer s löschen, bietet Stabilität gegenüber eine Parallelitätsverletzung abgebrochen wird ([klicken Sie hier, um das Bild in voller Größe angezeigt](implementing-optimistic-concurrency-cs/_static/image58.png))</span><span class="sxs-lookup"><span data-stu-id="b23c3-418">**Figure 20**: A User s Delete is Canceled in the Face of a Concurrency Violation ([Click to view full-size image](implementing-optimistic-concurrency-cs/_static/image58.png))</span></span>


## <a name="summary"></a><span data-ttu-id="b23c3-419">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="b23c3-419">Summary</span></span>

<span data-ttu-id="b23c3-420">Verkaufschancen parallelitätsverletzungen vorhanden sind, in jeder Anwendung, die mehrere ermöglicht gleichzeitigen Benutzern, Daten aktualisieren oder löschen.</span><span class="sxs-lookup"><span data-stu-id="b23c3-420">Opportunities for concurrency violations exist in every application that allows multiple, concurrent users to update or delete data.</span></span> <span data-ttu-id="b23c3-421">Wenn solche Verletzungen für, wenn zwei Benutzer gleichzeitig dieselben Daten wem auch immer in den letzten Schreibvorgang "Wins" erhält aktualisieren, des anderen Benutzers überschreiben ändert wird nicht berücksichtigt werden.</span><span class="sxs-lookup"><span data-stu-id="b23c3-421">If such violations are not accounted for, when two users simultaneously update the same data whoever gets in the last write "wins," overwriting the other user's changes changes.</span></span> <span data-ttu-id="b23c3-422">Alternativ können Entwickler entweder Steuerung durch vollständige oder eingeschränkte Parallelität implementieren.</span><span class="sxs-lookup"><span data-stu-id="b23c3-422">Alternatively, developers can implement either optimistic or pessimistic concurrency control.</span></span> <span data-ttu-id="b23c3-423">Steuerung durch vollständige Parallelität wird davon ausgegangen, dass parallelitätsverletzungen wird selten und einfach lässt nicht zu einem Update oder delete-Befehl, die eine parallelitätsverletzung bilden, würden.</span><span class="sxs-lookup"><span data-stu-id="b23c3-423">Optimistic concurrency control assumes that concurrency violations are infrequent and simply disallows an update or delete command that would constitute a concurrency violation.</span></span> <span data-ttu-id="b23c3-424">Steuerung durch eingeschränkte Parallelität wird davon ausgegangen, dass die Parallelität Verstöße werden häufig und update oder delete-Befehl einfach Ablehnung eines bestimmten Benutzers nicht zulässig ist.</span><span class="sxs-lookup"><span data-stu-id="b23c3-424">Pessimistic concurrency control assumes that concurrency violations are frequent and simply rejecting one user's update or delete command is not acceptable.</span></span> <span data-ttu-id="b23c3-425">Mit der Steuerung durch eingeschränkte Parallelität umfasst das Aktualisieren eines Datensatzes, sperren, dadurch, dass alle anderen Benutzer geändert oder der Datensatz gelöscht, während es gesperrt ist.</span><span class="sxs-lookup"><span data-stu-id="b23c3-425">With pessimistic concurrency control, updating a record involves locking it, thereby preventing any other users from modifying or deleting the record while it is locked.</span></span>

<span data-ttu-id="b23c3-426">Das typisierte DataSet im .NET bietet Funktionen für die Unterstützung der Steuerung durch vollständige Parallelität.</span><span class="sxs-lookup"><span data-stu-id="b23c3-426">The Typed DataSet in .NET provides functionality for supporting optimistic concurrency control.</span></span> <span data-ttu-id="b23c3-427">Insbesondere die `UPDATE` und `DELETE` Anweisungen, die mit der Datenbank ausgegeben werden alle Spalten der Tabelle enthalten, dadurch wird sichergestellt, dass die Update- oder Delete nur auftreten, wenn der aktuellen Datensatzdaten, mit der zu sichernden Daten den Benutzer übereinstimmt hatte, wenn Ausführen von ihren Update- oder Delete.</span><span class="sxs-lookup"><span data-stu-id="b23c3-427">In particular, the `UPDATE` and `DELETE` statements issued to the database include all of the table's columns, thereby ensuring that the update or delete will only occur if the record's current data matches with the original data the user had when performing their update or delete.</span></span> <span data-ttu-id="b23c3-428">Sobald die DAL zur Unterstützung der vollständigen Parallelität konfiguriert wurde, müssen die BLL Methoden aktualisiert werden.</span><span class="sxs-lookup"><span data-stu-id="b23c3-428">Once the DAL has been configured to support optimistic concurrency, the BLL methods need to be updated.</span></span> <span data-ttu-id="b23c3-429">Darüber hinaus muss die ASP.NET-Seite, die die BLL, nach unten aufruft werden so konfiguriert, dass das ObjectDataSource ruft die ursprünglichen Werte aus dem Web-Steuerelement ab und sie in der BLL nach unten übergibt.</span><span class="sxs-lookup"><span data-stu-id="b23c3-429">Additionally, the ASP.NET page that calls down into the BLL must be configured such that the ObjectDataSource retrieves the original values from its data Web control and passes them down into the BLL.</span></span>

<span data-ttu-id="b23c3-430">Wie wir in diesem Lernprogramm gesehen haben, beinhaltet die Implementierung der Steuerung durch vollständige Parallelität in eine ASP.NET-Webanwendung Aktualisieren der DAL und BLL und Hinzufügen der Unterstützung der ASP.NET-Seite.</span><span class="sxs-lookup"><span data-stu-id="b23c3-430">As we saw in this tutorial, implementing optimistic concurrency control in an ASP.NET web application involves updating the DAL and BLL and adding support in the ASP.NET page.</span></span> <span data-ttu-id="b23c3-431">Fest, ob dieser zusätzliche Aufwand eine hintergrundprüfung Investition Ihrer Zeit und Aufwand ist, hängt von der Anwendung ab.</span><span class="sxs-lookup"><span data-stu-id="b23c3-431">Whether or not this added work is a wise investment of your time and effort depends on your application.</span></span> <span data-ttu-id="b23c3-432">Wenn Sie selten gleichzeitigen Benutzern, die Daten aktualisieren, oder die Daten, die sie aktualisieren unterscheidet sich von den anderen, ist parallelitätssteuerung kein wichtiger Aspekt.</span><span class="sxs-lookup"><span data-stu-id="b23c3-432">If you infrequently have concurrent users updating data, or the data they are updating is different from one another, then concurrency control is not a key issue.</span></span> <span data-ttu-id="b23c3-433">Wenn allerdings routinemäßig mehrere Benutzer auf Ihrer Website mit denselben Daten arbeiten müssen, können die parallelitätssteuerung verhindern, dass ein Benutzer Update- oder Löschvorgänge unwissentlich Überschreiben einer anderen Person.</span><span class="sxs-lookup"><span data-stu-id="b23c3-433">If, however, you routinely have multiple users on your site working with the same data, concurrency control can help prevent one user's updates or deletes from unwittingly overwriting another's.</span></span>

<span data-ttu-id="b23c3-434">Viel Spaß beim Programmieren!</span><span class="sxs-lookup"><span data-stu-id="b23c3-434">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="b23c3-435">Informationen zum Autor</span><span class="sxs-lookup"><span data-stu-id="b23c3-435">About the Author</span></span>

<span data-ttu-id="b23c3-436">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor von sieben ASP/ASP.NET-Büchern und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), Microsoft Web-Technologien seit 1998 arbeitet.</span><span class="sxs-lookup"><span data-stu-id="b23c3-436">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="b23c3-437">Scott fungiert als ein unabhängiger Berater, Trainer und Writer.</span><span class="sxs-lookup"><span data-stu-id="b23c3-437">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="b23c3-438">Sein neueste Buch wird [ *Sams Schulen selbst ASP.NET 2.0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="b23c3-438">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="b23c3-439">Er die erreicht werden kann, zur [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) oder über seinen Blog die finden Sie unter [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="b23c3-439">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="b23c3-440">[Zurück](customizing-the-data-modification-interface-cs.md)
[Weiter](adding-client-side-confirmation-when-deleting-cs.md)</span><span class="sxs-lookup"><span data-stu-id="b23c3-440">[Previous](customizing-the-data-modification-interface-cs.md)
[Next](adding-client-side-confirmation-when-deleting-cs.md)</span></span>
