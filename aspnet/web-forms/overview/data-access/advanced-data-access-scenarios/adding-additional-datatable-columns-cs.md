---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/adding-additional-datatable-columns-cs
title: "Hinzufügen von zusätzlichen DataTable-Spalten (c#) | Microsoft Docs"
author: rick-anderson
description: "Wenn Sie den TableAdapter-Assistenten zum Erstellen eines typisierten Datasets verwenden, enthält entsprechende DataTable die Spalten, die von der Abfrage Hauptdatenbank zurückgegeben. Aber es..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/18/2007
ms.topic: article
ms.assetid: 615f3361-f21f-4338-8bc1-fce8ae071de9
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/adding-additional-datatable-columns-cs
msc.type: authoredcontent
ms.openlocfilehash: 0b1fe8d2e376065aed8d94b1267910bd1f7e5bd0
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/10/2017
---
<a name="adding-additional-datatable-columns-c"></a><span data-ttu-id="78d63-104">Hinzufügen von zusätzlichen DataTable-Spalten (c#)</span><span class="sxs-lookup"><span data-stu-id="78d63-104">Adding Additional DataTable Columns (C#)</span></span>
====================
<span data-ttu-id="78d63-105">durch [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="78d63-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="78d63-106">[Herunterladen von Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_70_CS.zip) oder [PDF herunterladen](adding-additional-datatable-columns-cs/_static/datatutorial70cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="78d63-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_70_CS.zip) or [Download PDF](adding-additional-datatable-columns-cs/_static/datatutorial70cs1.pdf)</span></span>

> <span data-ttu-id="78d63-107">Wenn Sie den TableAdapter-Assistenten zum Erstellen eines typisierten Datasets verwenden, enthält entsprechende DataTable die Spalten, die von der Abfrage Hauptdatenbank zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="78d63-107">When using the TableAdapter Wizard to create a Typed DataSet, the corresponding DataTable contains the columns returned by the main database query.</span></span> <span data-ttu-id="78d63-108">Aber es gibt Situationen, wenn der DataTable einbinden zusätzliche Spalten muss.</span><span class="sxs-lookup"><span data-stu-id="78d63-108">But there are occasions when the DataTable needs to include additional columns.</span></span> <span data-ttu-id="78d63-109">In diesem Lernprogramm lernen wir an, warum die gespeicherte Prozeduren empfohlen werden, wenn wir zusätzliche DataTable-Spalten benötigen.</span><span class="sxs-lookup"><span data-stu-id="78d63-109">In this tutorial we learn why stored procedures are recommended when we need additional DataTable columns.</span></span>


## <a name="introduction"></a><span data-ttu-id="78d63-110">Einführung</span><span class="sxs-lookup"><span data-stu-id="78d63-110">Introduction</span></span>

<span data-ttu-id="78d63-111">Wenn einen TableAdapter eine typisierte DataSet hinzufügen, wird das entsprechende DataTable-s-Schema durch der Hauptabfrage des TableAdapter s bestimmt.</span><span class="sxs-lookup"><span data-stu-id="78d63-111">When adding a TableAdapter to a Typed DataSet, the corresponding DataTable s schema is determined by the TableAdapter s main query.</span></span> <span data-ttu-id="78d63-112">Wenn die Hauptabfrage Datenfelder gibt z. B. *ein*, *B*, und *C*, DataTable müssen drei entsprechende Spalten, die mit dem Namen *ein*, *B*, und *C*. Neben der Hauptabfrage kann ein TableAdapter zusätzliche Abfragen enthalten, die möglicherweise auch noch eine Teilmenge der Daten basierend auf einige Parameter zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="78d63-112">For example, if the main query returns data fields *A*, *B*, and *C*, the DataTable will have three corresponding columns named *A*, *B*, and *C*. In addition to its main query, a TableAdapter can include additional queries that return, perhaps, a subset of the data based on some parameter.</span></span> <span data-ttu-id="78d63-113">Beispielsweise zusätzlich zu den `ProductsTableAdapter` s Hauptabfrage, die Informationen zu allen Produkten zurückgibt, es enthält auch Methoden wie z. B. `GetProductsByCategoryID(categoryID)` und `GetProductByProductID(productID)`, die bestimmten Produktinformationen auf Grundlage eines angegebenen Parameters zurück.</span><span class="sxs-lookup"><span data-stu-id="78d63-113">For instance, in addition to the `ProductsTableAdapter` s main query, which returns information about all products, it also contains methods like `GetProductsByCategoryID(categoryID)` and `GetProductByProductID(productID)`, which return specific product information based on a supplied parameter.</span></span>

<span data-ttu-id="78d63-114">Das Modell, dass das DataTable-s-Schema die Hauptabfrage des TableAdapter s widerspiegeln funktioniert gut, wenn alle der TableAdapter-s-Methoden die gleiche oder weniger Datenfelder als die in der Hauptabfrage zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="78d63-114">The model of having the DataTable s schema reflect the TableAdapter s main query works well if all of the TableAdapter s methods return the same or fewer data fields than those specified in the main query.</span></span> <span data-ttu-id="78d63-115">Wenn eine Methode des TableAdapter zusätzliche Datenfelder zurückgeben muss, sollten wir das DataTable-s-Schema entsprechend erweitern.</span><span class="sxs-lookup"><span data-stu-id="78d63-115">If a TableAdapter method needs to return additional data fields, then we should expand the DataTable s schema accordingly.</span></span> <span data-ttu-id="78d63-116">In der [Master/Detail, verwenden eine Aufzählung der Master-Datensätze mit Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) Lernprogramm, die wir, eine Methode, um hinzugefügt die `CategoriesTableAdapter` , die zurückgegeben der `CategoryID`, `CategoryName`, und `Description` Datenfelder, die in definierten der Hauptabfrage plus `NumberOfProducts`, eine zusätzliche Datenfelder, die die Anzahl der Produkte jeder Kategorie zugeordnet gemeldet.</span><span class="sxs-lookup"><span data-stu-id="78d63-116">In the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) tutorial we added a method to the `CategoriesTableAdapter` that returned the `CategoryID`, `CategoryName`, and `Description` data fields defined in the main query plus `NumberOfProducts`, an additional data field that reported the number of products associated with each category.</span></span> <span data-ttu-id="78d63-117">Wir manuell eine neue Spalte hinzugefügt der `CategoriesDataTable` zum Erfassen der `NumberOfProducts` Datenfeld der Spalte Wert von dieser neuen Methode.</span><span class="sxs-lookup"><span data-stu-id="78d63-117">We manually added a new column to the `CategoriesDataTable` in order to capture the `NumberOfProducts` data field value from this new method.</span></span>

<span data-ttu-id="78d63-118">Wie in beschrieben die [Hochladen von Dateien](../working-with-binary-files/uploading-files-cs.md) Lernprogramm, großartige muss darauf geachtet werden mit TableAdapters, die Ad-hoc-SQL-Anweisungen verwenden und verfügen über Methoden, deren Datenfelder stimmen die Hauptabfrage nicht genau überein.</span><span class="sxs-lookup"><span data-stu-id="78d63-118">As discussed in the [Uploading Files](../working-with-binary-files/uploading-files-cs.md) tutorial, great care must be taken with TableAdapters that use ad-hoc SQL statements and have methods whose data fields do not precisely match the main query.</span></span> <span data-ttu-id="78d63-119">Wenn der TableAdapter-Konfigurations-Assistent erneut ausgeführt wird, aktualisiert es alle Methoden s TableAdapter, damit ihre Daten Feldliste aus die Hauptabfrage übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="78d63-119">If the TableAdapter Configuration wizard is re-run, it will update all of the TableAdapter s methods so that their data field list matches the main query.</span></span> <span data-ttu-id="78d63-120">Daher werden keine Methoden mit benutzerdefinierten Spaltenlisten kehren Sie zu der Liste der Hauptabfrage s-Spalte und nicht die erwarteten Daten zurück.</span><span class="sxs-lookup"><span data-stu-id="78d63-120">Consequently, any methods with customized column lists will revert to the main query s column list and not return the expected data.</span></span> <span data-ttu-id="78d63-121">Dieses Problem nicht, da bei der Verwendung gespeicherter Prozeduren.</span><span class="sxs-lookup"><span data-stu-id="78d63-121">This issue does not arise when using stored procedures.</span></span>

<span data-ttu-id="78d63-122">In diesem Lernprogramm untersuchen wir an, wie ein DataTable-s-Schema, um weitere Spalten einschließen, zu erweitern.</span><span class="sxs-lookup"><span data-stu-id="78d63-122">In this tutorial we will look at how to extend a DataTable s schema to include additional columns.</span></span> <span data-ttu-id="78d63-123">Aufgrund der unzulänglichen des TableAdapter bei Verwendung von Ad-hoc-SQL-Anweisungen werden wir in diesem Lernprogramm gespeicherte Prozeduren verwenden.</span><span class="sxs-lookup"><span data-stu-id="78d63-123">Due to the brittleness of the TableAdapter when using ad-hoc SQL statements, in this tutorial we will use stored procedures.</span></span> <span data-ttu-id="78d63-124">Finden Sie in der [Erstellen neuer gespeicherter Prozeduren für die typisierte DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) und [vorhandene gespeicherte Prozeduren verwenden, für die typisierte DataSet s TableAdapters](https://data-access/tutorials/using-existing-stored-procedures-for-the-typed-dataset-amp-rsquo-s-tableadapters-cs) Lernprogramme für Weitere Informationen zu Konfigurieren einen TableAdapter um gespeicherte Prozeduren verwenden.</span><span class="sxs-lookup"><span data-stu-id="78d63-124">Refer to the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) and [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](https://data-access/tutorials/using-existing-stored-procedures-for-the-typed-dataset-amp-rsquo-s-tableadapters-cs) tutorials for more information on configuring a TableAdapter to use stored procedures.</span></span>

## <a name="step-1-adding-apricequartilecolumn-to-theproductsdatatable"></a><span data-ttu-id="78d63-125">Schritt 1: Hinzufügen einer`PriceQuartile`Spalte, um die`ProductsDataTable`</span><span class="sxs-lookup"><span data-stu-id="78d63-125">Step 1: Adding a`PriceQuartile`Column to the`ProductsDataTable`</span></span>

<span data-ttu-id="78d63-126">In der *Erstellen neuer gespeicherter Prozeduren für die typisierte DataSet s TableAdapters* Lernprogramm typisiertes DataSet namens erstellten `NorthwindWithSprocs`.</span><span class="sxs-lookup"><span data-stu-id="78d63-126">In the *Creating New Stored Procedures for the Typed DataSet s TableAdapters* tutorial we created a Typed DataSet named `NorthwindWithSprocs`.</span></span> <span data-ttu-id="78d63-127">Dieses DataSet enthält derzeit zwei DataTables: `ProductsDataTable` und `EmployeesDataTable`.</span><span class="sxs-lookup"><span data-stu-id="78d63-127">This DataSet currently contains two DataTables: `ProductsDataTable` and `EmployeesDataTable`.</span></span> <span data-ttu-id="78d63-128">Die `ProductsTableAdapter` hat die folgenden drei Methoden:</span><span class="sxs-lookup"><span data-stu-id="78d63-128">The `ProductsTableAdapter` has the following three methods:</span></span>

- <span data-ttu-id="78d63-129">`GetProducts`-der Hauptabfrage, die zurückgibt, alle Datensätze aus der `Products` Tabelle</span><span class="sxs-lookup"><span data-stu-id="78d63-129">`GetProducts` - the main query, which returns all records from the `Products` table</span></span>
- <span data-ttu-id="78d63-130">`GetProductsByCategoryID(categoryID)`-Gibt alle Produkte mit dem angegebenen *CategoryID*.</span><span class="sxs-lookup"><span data-stu-id="78d63-130">`GetProductsByCategoryID(categoryID)` - returns all products with the specified *categoryID*.</span></span>
- <span data-ttu-id="78d63-131">`GetProductByProductID(productID)`-Gibt das bestimmte Produkt mit dem angegebenen *"ProductID"*.</span><span class="sxs-lookup"><span data-stu-id="78d63-131">`GetProductByProductID(productID)` - returns the particular product with the specified *productID*.</span></span>

<span data-ttu-id="78d63-132">Der Hauptabfrage und zwei zusätzlichen Methoden zurückgeben den gleichen Satz von Datenfeldern, d. h. alle Spalten aus der `Products` Tabelle.</span><span class="sxs-lookup"><span data-stu-id="78d63-132">The main query and the two additional methods all return the same set of data fields, namely all of the columns from the `Products` table.</span></span> <span data-ttu-id="78d63-133">Es gibt keine korrelierten Unterabfragen oder `JOIN` s herausziehen aufeinander bezogene Daten in der `Categories` oder `Suppliers` Tabellen.</span><span class="sxs-lookup"><span data-stu-id="78d63-133">There are no correlated subqueries or `JOIN` s pulling related data from the `Categories` or `Suppliers` tables.</span></span> <span data-ttu-id="78d63-134">Aus diesem Grund die `ProductsDataTable` verfügt über eine entsprechende Spalte für jedes Feld in der `Products` Tabelle.</span><span class="sxs-lookup"><span data-stu-id="78d63-134">Therefore, the `ProductsDataTable` has a corresponding column for each field in the `Products` table.</span></span>

<span data-ttu-id="78d63-135">Für dieses Lernprogramm können s eine Methode zum Hinzufügen der `ProductsTableAdapter` mit dem Namen `GetProductsWithPriceQuartile` aller Produkte zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="78d63-135">For this tutorial, let s add a method to the `ProductsTableAdapter` named `GetProductsWithPriceQuartile` that returns all of the products.</span></span> <span data-ttu-id="78d63-136">Zusätzlich zu den Datenfelder die standardmäßige Product `GetProductsWithPriceQuartile` gehören auch eine `PriceQuartile` Feld "Daten", der angibt, unter welcher Quartil der Produktpreis s fällt.</span><span class="sxs-lookup"><span data-stu-id="78d63-136">In addition to the standard product data fields, `GetProductsWithPriceQuartile` will also include a `PriceQuartile` data field that indicates under which quartile the product s price falls.</span></span> <span data-ttu-id="78d63-137">Beispielsweise müssen die Produkte, deren Preise, in dem die teuersten 25 gelten % eine `PriceQuartile` Wert 1, während die, deren Preis in der unteren 25 fallen % den Wert 4 hat.</span><span class="sxs-lookup"><span data-stu-id="78d63-137">For example, those products whose prices are in the most expensive 25% will have a `PriceQuartile` value of 1, while those whose prices fall in the bottom 25% will have a value of 4.</span></span> <span data-ttu-id="78d63-138">Vor Gedanken machen, wir Erstellen der gespeicherten Prozedur zum Zurückgeben dieser Informationen, wir zuerst müssen jedoch Aktualisieren der `ProductsDataTable` enthalten eine Spalte enthalten die `PriceQuartile` Ergebnisse bei der `GetProductsWithPriceQuartile` Methode wird verwendet.</span><span class="sxs-lookup"><span data-stu-id="78d63-138">Before we worry about creating the stored procedure to return this information, however, we first need to update the `ProductsDataTable` to include a column to hold the `PriceQuartile` results when the `GetProductsWithPriceQuartile` method is used.</span></span>

<span data-ttu-id="78d63-139">Öffnen der `NorthwindWithSprocs` DataSet mit der rechten Maustaste auf die `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="78d63-139">Open the `NorthwindWithSprocs` DataSet and right-click on the `ProductsDataTable`.</span></span> <span data-ttu-id="78d63-140">Wählen Sie hinzufügen aus dem Kontextmenü, und wählen Sie dann die Spalte.</span><span class="sxs-lookup"><span data-stu-id="78d63-140">Choose Add from the context-menu and then pick Column.</span></span>


<span data-ttu-id="78d63-141">[![Fügen Sie eine neue Spalte hinzu, um die ProductsDataTable](adding-additional-datatable-columns-cs/_static/image2.png)](adding-additional-datatable-columns-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="78d63-141">[![Add a New Column to the ProductsDataTable](adding-additional-datatable-columns-cs/_static/image2.png)](adding-additional-datatable-columns-cs/_static/image1.png)</span></span>

<span data-ttu-id="78d63-142">**Abbildung 1**: Hinzufügen einer neuen Spalte, die `ProductsDataTable` ([klicken Sie hier, um das Bild in voller Größe angezeigt](adding-additional-datatable-columns-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="78d63-142">**Figure 1**: Add a New Column to the `ProductsDataTable` ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image3.png))</span></span>


<span data-ttu-id="78d63-143">Dadurch wird eine neue Spalte hinzugefügt, zu der mit dem Namen Column1 vom Typ "DataTable" `System.String`.</span><span class="sxs-lookup"><span data-stu-id="78d63-143">This will add a new column to the DataTable named Column1 of type `System.String`.</span></span> <span data-ttu-id="78d63-144">Wir müssen dieser Spaltenname s PriceQuartile und dessen Typ zu aktualisieren `System.Int32` , da er verwendet wird, eine Zahl zwischen 1 und 4 enthalten.</span><span class="sxs-lookup"><span data-stu-id="78d63-144">We need to update this column s name to PriceQuartile and its type to `System.Int32` since it will be used to hold a number between 1 and 4.</span></span> <span data-ttu-id="78d63-145">Wählen Sie die neu hinzugefügte Spalte der `ProductsDataTable` , und legen Sie im Fenster Eigenschaften die `Name` PriceQuartile Eigenschaft und die `DataType` Eigenschaft `System.Int32`.</span><span class="sxs-lookup"><span data-stu-id="78d63-145">Select the newly-added column in the `ProductsDataTable` and, from the Properties window, set the `Name` property to PriceQuartile and the `DataType` property to `System.Int32`.</span></span>


<span data-ttu-id="78d63-146">[![Festlegen Sie Neuer Spaltenname s und Eigenschaften für Datentypen](adding-additional-datatable-columns-cs/_static/image5.png)](adding-additional-datatable-columns-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="78d63-146">[![Set the New Column s Name and DataType Properties](adding-additional-datatable-columns-cs/_static/image5.png)](adding-additional-datatable-columns-cs/_static/image4.png)</span></span>

<span data-ttu-id="78d63-147">**Abbildung 2**: Legen Sie die neue Spalte s `Name` und `DataType` Eigenschaften ([klicken Sie hier, um das Bild in voller Größe angezeigt](adding-additional-datatable-columns-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="78d63-147">**Figure 2**: Set the New Column s `Name` and `DataType` Properties ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image6.png))</span></span>


<span data-ttu-id="78d63-148">Wie in Abbildung 2 dargestellt, stehen zusätzliche Eigenschaften, die festgelegt werden können, z. B., ob die Werte in der Spalte sein müssen eindeutig sein, wenn die Spalte eine Spalte automatisch inkrementiert wird, ob Datenbank- `NULL` Werte zulässig sind, und so weiter.</span><span class="sxs-lookup"><span data-stu-id="78d63-148">As Figure 2 shows, there are additional properties that can be set, such as whether the values in the column must be unique, if the column is an auto-increment column, whether or not database `NULL` values are allowed, and so on.</span></span> <span data-ttu-id="78d63-149">Lassen Sie diese Werte auf ihre Standardwerte festgelegt.</span><span class="sxs-lookup"><span data-stu-id="78d63-149">Leave these values set to their defaults.</span></span>

## <a name="step-2-creating-thegetproductswithpricequartilemethod"></a><span data-ttu-id="78d63-150">Schritt 2: Erstellen der`GetProductsWithPriceQuartile`Methode</span><span class="sxs-lookup"><span data-stu-id="78d63-150">Step 2: Creating the`GetProductsWithPriceQuartile`Method</span></span>

<span data-ttu-id="78d63-151">Nun, dass die `ProductsDataTable` wurde aktualisiert und enthalten die `PriceQuartile` Spalte wir sind bereit für die Erstellung der `GetProductsWithPriceQuartile` Methode.</span><span class="sxs-lookup"><span data-stu-id="78d63-151">Now that the `ProductsDataTable` has been updated to include the `PriceQuartile` column, we are ready to create the `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="78d63-152">Starten Sie, indem Sie mit der rechten Maustaste auf den TableAdapter und Abfrage hinzufügen aus dem Kontextmenü.</span><span class="sxs-lookup"><span data-stu-id="78d63-152">Start by right-clicking on the TableAdapter and choosing Add Query from the context-menu.</span></span> <span data-ttu-id="78d63-153">Daraufhin wird der TableAdapter-Abfrage-Konfigurations-Assistenten, in der werden uns zuerst gefragt, ob Ad-hoc-SQL-Anweisungen oder einer neuen oder vorhandenen gespeicherten Prozedur verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="78d63-153">This brings up the TableAdapter Query Configuration wizard, which first prompts us as to whether we want to use ad-hoc SQL statements or a new or existing stored procedure.</span></span> <span data-ttu-id="78d63-154">Da wir t Verschlüsselungskennwort noch haben eine gespeicherte Prozedur, die den Preis Quartil Daten zurückgibt, können Sie s des TableAdapter zum Erstellen dieser gespeicherten Prozedur für uns zu ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="78d63-154">Since we don t yet have a stored procedure that returns the price quartile data, let s allow the TableAdapter to create this stored procedure for us.</span></span> <span data-ttu-id="78d63-155">Wählen Sie die Option erstellen neue gespeicherte Prozedur, und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="78d63-155">Select the Create new stored procedure option and click Next.</span></span>


<span data-ttu-id="78d63-156">[![Weisen Sie dem TableAdapter-Assistenten zum Erstellen der gespeicherten Prozedur für uns](adding-additional-datatable-columns-cs/_static/image8.png)](adding-additional-datatable-columns-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="78d63-156">[![Instruct the TableAdapter Wizard to Create the Stored Procedure For Us](adding-additional-datatable-columns-cs/_static/image8.png)](adding-additional-datatable-columns-cs/_static/image7.png)</span></span>

<span data-ttu-id="78d63-157">**Abbildung 3**: Weisen Sie dem TableAdapter-Assistenten zum Erstellen der gespeicherten Prozedur für uns ([klicken Sie hier, um das Bild in voller Größe angezeigt](adding-additional-datatable-columns-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="78d63-157">**Figure 3**: Instruct the TableAdapter Wizard to Create the Stored Procedure For Us ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image9.png))</span></span>


<span data-ttu-id="78d63-158">Im nachfolgenden Bildschirm in Abbildung 4 gezeigt vom Assistenten gefragt uns welche Art von Abfrage hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="78d63-158">In the subsequent screen, shown in Figure 4, the wizard asks us what type of query to add.</span></span> <span data-ttu-id="78d63-159">Da die `GetProductsWithPriceQuartile` Methodenrückgabewert werden alle Spalten und Datensätze aus der `Products` Tabelle, die wählen Sie die Zeilen aus, und klicken Sie auf Weiter zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="78d63-159">Since the `GetProductsWithPriceQuartile` method will return all columns and records from the `Products` table, select the SELECT which returns rows option and click Next.</span></span>


<span data-ttu-id="78d63-160">[![Unsere Abfrage wird eine SELECT-Anweisung, gibt mehrere Zeilen sein.](adding-additional-datatable-columns-cs/_static/image11.png)](adding-additional-datatable-columns-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="78d63-160">[![Our Query will be a SELECT Statement that Returns Multiple Rows](adding-additional-datatable-columns-cs/_static/image11.png)](adding-additional-datatable-columns-cs/_static/image10.png)</span></span>

<span data-ttu-id="78d63-161">**Abbildung 4**: unsere Abfrage eine `SELECT` Anweisung, gibt mehrere Zeilen ([klicken Sie hier, um das Bild in voller Größe angezeigt](adding-additional-datatable-columns-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="78d63-161">**Figure 4**: Our Query will be a `SELECT` Statement that Returns Multiple Rows ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image12.png))</span></span>


<span data-ttu-id="78d63-162">Wir werden als Nächstes aufgefordert, für die `SELECT` Abfrage.</span><span class="sxs-lookup"><span data-stu-id="78d63-162">Next we are prompted for the `SELECT` query.</span></span> <span data-ttu-id="78d63-163">Geben Sie die folgende Abfrage in den Assistenten:</span><span class="sxs-lookup"><span data-stu-id="78d63-163">Enter the following query into the wizard:</span></span>


[!code-sql[Main](adding-additional-datatable-columns-cs/samples/sample1.sql)]

<span data-ttu-id="78d63-164">Die oben dargestellte Abfrage verwendet die SQL Server 2005-s neue [ `NTILE` Funktion](https://msdn.microsoft.com/en-us/library/ms175126.aspx) , die Ergebnisse in vier Gruppen unterteilen, bei dem Gruppen von bestimmt sind, die `UnitPrice` Werte, die in absteigender Reihenfolge sortiert.</span><span class="sxs-lookup"><span data-stu-id="78d63-164">The above query uses SQL Server 2005 s new [`NTILE` function](https://msdn.microsoft.com/en-us/library/ms175126.aspx) to divide the results into four groups where the groups are determined by the `UnitPrice` values sorted in descending order.</span></span>

<span data-ttu-id="78d63-165">Abfrage-Generator weiß leider nicht wie beim Analysieren der `OVER` Schlüsselwort und zeigt einen Fehler beim Analysieren der obigen Abfrage.</span><span class="sxs-lookup"><span data-stu-id="78d63-165">Unfortunately, the Query Builder does not know how to parse the `OVER` keyword and will display an error when parsing the above query.</span></span> <span data-ttu-id="78d63-166">Daher geben Sie die oben dargestellte Abfrage direkt in das Textfeld im Assistenten ohne mit dem Abfrage-Generator ein.</span><span class="sxs-lookup"><span data-stu-id="78d63-166">Therefore, enter the above query directly in the textbox in the wizard without using the Query Builder.</span></span>

> [!NOTE]
> <span data-ttu-id="78d63-167">Weitere Informationen zu NTILE und SQL Server 2005 s andere Rangfolgefunktionen finden Sie unter [aufgelisteten Ergebnisse zurückgeben, mit Microsoft SQL Server 2005](http://www.4guysfromrolla.com/webtech/010406-1.shtml) und die [Rangfolge Funktionen Abschnitt](https://msdn.microsoft.com/en-us/library/ms189798.aspx) aus der [SQL Server 2005-Onlinedokumentation](https://msdn.microsoft.com/en-us/library/ms189798.aspx).</span><span class="sxs-lookup"><span data-stu-id="78d63-167">For more information on NTILE and SQL Server 2005 s other ranking functions, see [Returning Ranked Results with Microsoft SQL Server 2005](http://www.4guysfromrolla.com/webtech/010406-1.shtml) and the [Ranking Functions section](https://msdn.microsoft.com/en-us/library/ms189798.aspx) from the [SQL Server 2005 Books Online](https://msdn.microsoft.com/en-us/library/ms189798.aspx).</span></span>


<span data-ttu-id="78d63-168">Nach der Eingabe der `SELECT` Abfrage und auf Weiter klicken, wird der Assistent stellt uns, geben Sie einen Namen für die gespeicherte Prozedur wird erstellt.</span><span class="sxs-lookup"><span data-stu-id="78d63-168">After entering the `SELECT` query and clicking Next, the wizard asks us to provide a name for the stored procedure it will create.</span></span> <span data-ttu-id="78d63-169">Benennen Sie die neue gespeicherte Prozedur `Products_SelectWithPriceQuartile` , und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="78d63-169">Name the new stored procedure `Products_SelectWithPriceQuartile` and click Next.</span></span>


<span data-ttu-id="78d63-170">[![Name der gespeicherten Prozedur Products_SelectWithPriceQuartile](adding-additional-datatable-columns-cs/_static/image14.png)](adding-additional-datatable-columns-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="78d63-170">[![Name the Stored Procedure Products_SelectWithPriceQuartile](adding-additional-datatable-columns-cs/_static/image14.png)](adding-additional-datatable-columns-cs/_static/image13.png)</span></span>

<span data-ttu-id="78d63-171">**Abbildung 5**: Benennen Sie die gespeicherte Prozedur `Products_SelectWithPriceQuartile` ([klicken Sie hier, um das Bild in voller Größe angezeigt](adding-additional-datatable-columns-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="78d63-171">**Figure 5**: Name the Stored Procedure `Products_SelectWithPriceQuartile` ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image15.png))</span></span>


<span data-ttu-id="78d63-172">Schließlich werden wir nennen Sie die TableAdapter-Methoden aufgefordert.</span><span class="sxs-lookup"><span data-stu-id="78d63-172">Lastly, we are prompted to name the TableAdapter methods.</span></span> <span data-ttu-id="78d63-173">Lassen Sie beide Füllung eine "DataTable", und geben Sie eine DataTable Kontrollkästchen aktiviert und den Namen der Methoden `FillWithPriceQuartile` und `GetProductsWithPriceQuartile`.</span><span class="sxs-lookup"><span data-stu-id="78d63-173">Leave both the Fill a DataTable and Return a DataTable checkboxes checked and name the methods `FillWithPriceQuartile` and `GetProductsWithPriceQuartile`.</span></span>


<span data-ttu-id="78d63-174">[![Namen die TableAdapter-Methoden, und klicken Sie auf Fertig stellen](adding-additional-datatable-columns-cs/_static/image17.png)](adding-additional-datatable-columns-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="78d63-174">[![Name the TableAdapter s Methods and Click Finish](adding-additional-datatable-columns-cs/_static/image17.png)](adding-additional-datatable-columns-cs/_static/image16.png)</span></span>

<span data-ttu-id="78d63-175">**Abbildung 6**: Benennen Sie die s-Methoden des TableAdapter, und klicken Sie auf Fertig stellen ([klicken Sie hier, um das Bild in voller Größe angezeigt](adding-additional-datatable-columns-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="78d63-175">**Figure 6**: Name the TableAdapter s Methods and Click Finish ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image18.png))</span></span>


<span data-ttu-id="78d63-176">Mit der `SELECT` Abfrage angegeben, und die gespeicherte Prozedur und die TableAdapter-Methoden, die mit dem Namen, klicken Sie auf ' Fertig stellen ', um den Assistenten abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="78d63-176">With the `SELECT` query specified and the stored procedure and TableAdapter methods named, click Finish to complete the wizard.</span></span> <span data-ttu-id="78d63-177">An diesem Punkt erhalten Sie möglicherweise eine Warnung oder zwei vom Assistenten darauf hingewiesen werden, die die `OVER` SQL-Konstrukt oder die Anweisung wird nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="78d63-177">At this point you may get a warning or two from the wizard saying that The `OVER` SQL construct or statement is not supported.</span></span> <span data-ttu-id="78d63-178">Diese Warnung können ignoriert werden.</span><span class="sxs-lookup"><span data-stu-id="78d63-178">These warnings can be ignored.</span></span>

<span data-ttu-id="78d63-179">Nach Abschluss des Assistenten für TableAdapter enthalten sollte die `FillWithPriceQuartile` und `GetProductsWithPriceQuartile` Methoden und die Datenbank eine gespeicherte Prozedur namens aufzunehmen `Products_SelectWithPriceQuartile`.</span><span class="sxs-lookup"><span data-stu-id="78d63-179">After completing the wizard, the TableAdapter should include the `FillWithPriceQuartile` and `GetProductsWithPriceQuartile` methods and the database should include a stored procedure named `Products_SelectWithPriceQuartile`.</span></span> <span data-ttu-id="78d63-180">Nehmen Sie einen Moment Zeit, um zu überprüfen, dass die TableAdapter tatsächlich dieser neuen Methode enthält, die gespeicherte Prozedur mit der Datenbank ordnungsgemäß hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="78d63-180">Take a moment to verify that the TableAdapter does indeed contain this new method and that the stored procedure has been correctly added to the database.</span></span> <span data-ttu-id="78d63-181">Wenn die Datenbank wird überprüft, ob die gespeicherte Prozedur versuchen Sie es mit der rechten Maustaste auf den Ordner gespeicherte Prozeduren und "Aktualisieren" nicht angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="78d63-181">When checking the database, if you do not see the stored procedure try right-clicking on the Stored Procedures folder and choosing Refresh.</span></span>


![Stellen Sie sicher, dass eine neue Methode des TableAdapter hinzugefügt wurde](adding-additional-datatable-columns-cs/_static/image19.png)

<span data-ttu-id="78d63-183">**Abbildung 7**: Stellen Sie sicher, dass eine neue Methode des TableAdapter hinzugefügt wurde</span><span class="sxs-lookup"><span data-stu-id="78d63-183">**Figure 7**: Verify that a New Method Has Been Added to the TableAdapter</span></span>


<span data-ttu-id="78d63-184">[![Stellen Sie sicher, dass die Datenbank die Products_SelectWithPriceQuartile enthält gespeicherte Prozedur](adding-additional-datatable-columns-cs/_static/image21.png)](adding-additional-datatable-columns-cs/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="78d63-184">[![Ensure that the Database Contains the Products_SelectWithPriceQuartile Stored Procedure](adding-additional-datatable-columns-cs/_static/image21.png)](adding-additional-datatable-columns-cs/_static/image20.png)</span></span>

<span data-ttu-id="78d63-185">**Abbildung 8**: sicherstellen, dass die Datenbank enthält die `Products_SelectWithPriceQuartile` gespeicherte Prozedur ([klicken Sie hier, um das Bild in voller Größe angezeigt](adding-additional-datatable-columns-cs/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="78d63-185">**Figure 8**: Ensure that the Database Contains the `Products_SelectWithPriceQuartile` Stored Procedure ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image22.png))</span></span>


> [!NOTE]
> <span data-ttu-id="78d63-186">Einer der Vorteile der Verwendung gespeicherter Prozeduren anstelle von Ad-hoc-SQL-Anweisungen ist, dass die gespeicherten Prozeduren Spaltenlisten den TableAdapter-Konfigurations-Assistenten erneut ausführen nicht geändert werden.</span><span class="sxs-lookup"><span data-stu-id="78d63-186">One of the benefits of using stored procedures instead of ad-hoc SQL statements is that re-running the TableAdapter Configuration wizard will not modify the stored procedures column lists.</span></span> <span data-ttu-id="78d63-187">Überprüfen Sie dies können Sie, indem Sie mit der rechten Maustaste auf den TableAdapter, mit der Option konfigurieren aus dem Kontextmenü, um den Assistenten zu starten, und klicken Sie dann auf ' Fertig stellen ', um sie abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="78d63-187">Verify this by right-clicking on the TableAdapter, choosing the Configure option from the context-menu to start the wizard, and then clicking Finish to complete it.</span></span> <span data-ttu-id="78d63-188">Als Nächstes wechseln Sie zu der Datenbank und die Ansicht der `Products_SelectWithPriceQuartile` gespeicherten Prozedur.</span><span class="sxs-lookup"><span data-stu-id="78d63-188">Next, go to the database and view the `Products_SelectWithPriceQuartile` stored procedure.</span></span> <span data-ttu-id="78d63-189">Beachten Sie, dass die Liste der Spalten nicht geändert wurde.</span><span class="sxs-lookup"><span data-stu-id="78d63-189">Note that its column list has not been modified.</span></span> <span data-ttu-id="78d63-190">Hatten wir wurde mithilfe von Ad-hoc-SQL-Anweisungen, die TableAdapter-Konfigurations-Assistenten erneut ausführen würden wurden rückgängig dieser Abfrage s Spaltenliste entsprechend der Hauptabfrage Spaltenliste, wodurch die NTILE-Anweisung aus der Abfrage verwendet werden, indem Sie die `GetProductsWithPriceQuartile` Methode.</span><span class="sxs-lookup"><span data-stu-id="78d63-190">Had we been using ad-hoc SQL statements, re-running the TableAdapter Configuration wizard would have reverted this query s column list to match the main query column list, thereby removing the NTILE statement from the query used by the `GetProductsWithPriceQuartile` method.</span></span>


<span data-ttu-id="78d63-191">Wenn die Datenzugriffsebene s `GetProductsWithPriceQuartile` Methode aufgerufen wird, führt der TableAdapter die `Products_SelectWithPriceQuartile` von gespeicherten Prozeduren und fügt eine Zeile hinzu der `ProductsDataTable` für jeden Datensatz zurückgegebenen.</span><span class="sxs-lookup"><span data-stu-id="78d63-191">When the Data Access Layer s `GetProductsWithPriceQuartile` method is invoked, the TableAdapter executes the `Products_SelectWithPriceQuartile` stored procedure and adds a row to the `ProductsDataTable` for each returned record.</span></span> <span data-ttu-id="78d63-192">Die Datenfelder, die von der gespeicherten Prozedur zurückgegebenen zugeordnet werden die `ProductsDataTable` s-Spalten.</span><span class="sxs-lookup"><span data-stu-id="78d63-192">The data fields returned by the stored procedure are mapped to the `ProductsDataTable` s columns.</span></span> <span data-ttu-id="78d63-193">Da es ist ein `PriceQuartile` Feld "Daten" aus der gespeicherten Prozedur zurückgegeben deren Wert zugewiesen ist die `ProductsDataTable` s `PriceQuartile` Spalte.</span><span class="sxs-lookup"><span data-stu-id="78d63-193">Since there is a `PriceQuartile` data field returned from the stored procedure, its value is assigned to the `ProductsDataTable` s `PriceQuartile` column.</span></span>

<span data-ttu-id="78d63-194">Für die TableAdapter-Methoden, in deren Abfragen keine zurück geben. ein `PriceQuartile` Feld "Daten" der `PriceQuartile` Spaltenwert s ist der Wert von dessen `DefaultValue` Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="78d63-194">For those TableAdapter methods whose queries do not return a `PriceQuartile` data field, the `PriceQuartile` column s value is the value specified by its `DefaultValue` property.</span></span> <span data-ttu-id="78d63-195">Wie in Abbildung 2 gezeigt, wird dieser Wert festgelegt, um `DBNull`, die Standardeinstellung.</span><span class="sxs-lookup"><span data-stu-id="78d63-195">As Figure 2 shows, this value is set to `DBNull`, the default.</span></span> <span data-ttu-id="78d63-196">Wenn Sie einen anderen Standardwert lieber möchten, legen Sie einfach die `DefaultValue` Eigenschaft entsprechend.</span><span class="sxs-lookup"><span data-stu-id="78d63-196">If you would prefer a different default value, simply set the `DefaultValue` property accordingly.</span></span> <span data-ttu-id="78d63-197">Achten Sie darauf, die die `DefaultValue` Wert ist gültig anhand der s `DataType` (d. h. `System.Int32` für die `PriceQuartile` Spalte).</span><span class="sxs-lookup"><span data-stu-id="78d63-197">Just make sure that the `DefaultValue` value is valid given the column s `DataType` (i.e., `System.Int32` for the `PriceQuartile` column).</span></span>

<span data-ttu-id="78d63-198">Zu diesem Zeitpunkt haben wir die notwendigen Schritte ausgeführt, für das Hinzufügen einer zusätzlichen Spalte zu einer "DataTable".</span><span class="sxs-lookup"><span data-stu-id="78d63-198">At this point we have performed the necessary steps for adding an additional column to a DataTable.</span></span> <span data-ttu-id="78d63-199">Um sicherzustellen, dass diese zusätzliche Spalte erwartungsgemäß funktioniert, können Sie s eine ASP.NET-Seite zu erstellen, die jede s Produktname, Preis und Preis Quartil angezeigt.</span><span class="sxs-lookup"><span data-stu-id="78d63-199">To verify that this additional column works as expected, let s create an ASP.NET page that displays each product s name, price, and price quartile.</span></span> <span data-ttu-id="78d63-200">Bevor wir dies tun, allerdings müssen Sie zuerst die Business Logic Layer, um eine Methode enthalten, die die DAL-s-nach unten Aufrufe zu aktualisieren `GetProductsWithPriceQuartile` Methode.</span><span class="sxs-lookup"><span data-stu-id="78d63-200">Before we do that, though, we first need to update the Business Logic Layer to include a method that calls down to the DAL s `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="78d63-201">Wir als Nächstes aktualisieren Sie die BLL in Schritt 3, und erstellen Sie die ASP.NET-Seite in Schritt 4.</span><span class="sxs-lookup"><span data-stu-id="78d63-201">We will update the BLL next, in Step 3, and then create the ASP.NET page in Step 4.</span></span>

## <a name="step-3-augmenting-the-business-logic-layer"></a><span data-ttu-id="78d63-202">Schritt 3: Erweitern der Geschäftslogikebene</span><span class="sxs-lookup"><span data-stu-id="78d63-202">Step 3: Augmenting the Business Logic Layer</span></span>

<span data-ttu-id="78d63-203">Bevor wir die neue verwenden `GetProductsWithPriceQuartile` Methode aus der Präsentationsschicht, sollten wir zuerst eine entsprechende Methode der BLL hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="78d63-203">Before we use the new `GetProductsWithPriceQuartile` method from the Presentation Layer, we should first add a corresponding method to the BLL.</span></span> <span data-ttu-id="78d63-204">Öffnen der `ProductsBLLWithSprocs` Klassendatei, und fügen Sie den folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="78d63-204">Open the `ProductsBLLWithSprocs` class file and add the following code:</span></span>


[!code-csharp[Main](adding-additional-datatable-columns-cs/samples/sample2.cs)]

<span data-ttu-id="78d63-205">Wie die andere Datenabrufmethoden in `ProductsBLLWithSprocs`, `GetProductsWithPriceQuartile` Methode ruft einfach die DAL s entspricht `GetProductsWithPriceQuartile` Methode und die Ergebnisse zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="78d63-205">Like the other data retrieval methods in `ProductsBLLWithSprocs`, the `GetProductsWithPriceQuartile` method simply calls the DAL s corresponding `GetProductsWithPriceQuartile` method and returns its results.</span></span>

## <a name="step-4-displaying-the-price-quartile-information-in-an-aspnet-web-page"></a><span data-ttu-id="78d63-206">Schritt 4: Anzeigen der Quartil Preisinformationen in einer ASP.NET-Webseite</span><span class="sxs-lookup"><span data-stu-id="78d63-206">Step 4: Displaying the Price Quartile Information in an ASP.NET Web Page</span></span>

<span data-ttu-id="78d63-207">Führen Sie durch das Hinzufügen von BLL wir re kann jetzt eine ASP.NET-Seite zu erstellen, die das Quartile Preis für jedes Produkt angezeigt.</span><span class="sxs-lookup"><span data-stu-id="78d63-207">With the BLL addition complete we re ready to create an ASP.NET page that shows the price quartile for each product.</span></span> <span data-ttu-id="78d63-208">Öffnen der `AddingColumns.aspx` auf der Seite der `AdvancedDAL` Ordner, und ziehen Sie eine GridView aus der Toolbox in den Designer, Festlegen seiner `ID` Eigenschaft `Products`.</span><span class="sxs-lookup"><span data-stu-id="78d63-208">Open the `AddingColumns.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="78d63-209">Aus den GridView s smart Tag, binden Sie es auf eine neue ObjectDataSource mit dem Namen `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="78d63-209">From the GridView s smart tag, bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="78d63-210">Konfigurieren der ObjectDataSource verwenden die `ProductsBLLWithSprocs` Klasse s `GetProductsWithPriceQuartile` Methode.</span><span class="sxs-lookup"><span data-stu-id="78d63-210">Configure the ObjectDataSource to use the `ProductsBLLWithSprocs` class s `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="78d63-211">Da dies ein nur-Lese Raster sein wird, legen Sie die Dropdownlisten in der Update-, INSERT-, und Löschen von Registerkarten (keine).</span><span class="sxs-lookup"><span data-stu-id="78d63-211">Since this will be a read-only grid, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) .</span></span>


<span data-ttu-id="78d63-212">[![Konfigurieren der ObjectDataSource zur Verwendung der ProductsBLLWithSprocs-Klasse](adding-additional-datatable-columns-cs/_static/image24.png)](adding-additional-datatable-columns-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="78d63-212">[![Configure the ObjectDataSource to Use the ProductsBLLWithSprocs Class](adding-additional-datatable-columns-cs/_static/image24.png)](adding-additional-datatable-columns-cs/_static/image23.png)</span></span>

<span data-ttu-id="78d63-213">**Abbildung 9**: Konfigurieren der ObjectDataSource verwenden die `ProductsBLLWithSprocs` Klasse ([klicken Sie hier, um das Bild in voller Größe angezeigt](adding-additional-datatable-columns-cs/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="78d63-213">**Figure 9**: Configure the ObjectDataSource to Use the `ProductsBLLWithSprocs` Class ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image25.png))</span></span>


<span data-ttu-id="78d63-214">[![Abrufen von Produktinformationen aus der GetProductsWithPriceQuartile-Methode](adding-additional-datatable-columns-cs/_static/image27.png)](adding-additional-datatable-columns-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="78d63-214">[![Retrieve Product Information from the GetProductsWithPriceQuartile Method](adding-additional-datatable-columns-cs/_static/image27.png)](adding-additional-datatable-columns-cs/_static/image26.png)</span></span>

<span data-ttu-id="78d63-215">**Abbildung 10**: Abrufen von Produktinformationen aus der `GetProductsWithPriceQuartile` Methode ([klicken Sie hier, um das Bild in voller Größe angezeigt](adding-additional-datatable-columns-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="78d63-215">**Figure 10**: Retrieve Product Information from the `GetProductsWithPriceQuartile` Method ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image28.png))</span></span>


<span data-ttu-id="78d63-216">Nach dem Konfigurieren von Datenquellen-Assistenten abschließen, wird Visual Studio automatisch eine BoundField- oder CheckBoxField hinzufügen an die GridView für die einzelnen Datenfelder, die von der Methode zurückgegebenen.</span><span class="sxs-lookup"><span data-stu-id="78d63-216">After completing the Configure Data Source wizard, Visual Studio will automatically add a BoundField or CheckBoxField to the GridView for each of the data fields returned by the method.</span></span> <span data-ttu-id="78d63-217">Eines dieser Datenfelder ist `PriceQuartile`, also in der Spalte, die wir, um hinzugefügt die `ProductsDataTable` in Schritt 1.</span><span class="sxs-lookup"><span data-stu-id="78d63-217">One of these data fields is `PriceQuartile`, which is the column we added to the `ProductsDataTable` in Step 1.</span></span>

<span data-ttu-id="78d63-218">Bearbeiten Sie die GridView s-Felder entfernen alle außer den `ProductName`, `UnitPrice`, und `PriceQuartile` BoundFields.</span><span class="sxs-lookup"><span data-stu-id="78d63-218">Edit the GridView s fields, removing all but the `ProductName`, `UnitPrice`, and `PriceQuartile` BoundFields.</span></span> <span data-ttu-id="78d63-219">Konfigurieren der `UnitPrice` BoundField formatieren dessen Wert als Währung und haben die `UnitPrice` und `PriceQuartile` BoundFields rechts - und zentriert ausgerichtet, bzw.</span><span class="sxs-lookup"><span data-stu-id="78d63-219">Configure the `UnitPrice` BoundField to format its value as a currency and have the `UnitPrice` and `PriceQuartile` BoundFields right- and center-aligned, respectively.</span></span> <span data-ttu-id="78d63-220">Aktualisieren Sie schließlich die verbleibenden BoundFields `HeaderText` Produkt, Preis und Preis Quartil, Eigenschaften bzw.</span><span class="sxs-lookup"><span data-stu-id="78d63-220">Finally, update the remaining BoundFields `HeaderText` properties to Product, Price, and Price Quartile, respectively.</span></span> <span data-ttu-id="78d63-221">Prüfen Sie außerdem das Kontrollkästchen Sortieren aktivieren aus dem GridView-s-Smarttag.</span><span class="sxs-lookup"><span data-stu-id="78d63-221">Also, check the Enable Sorting checkbox from the GridView s smart tag.</span></span>

<span data-ttu-id="78d63-222">Nachdem diese Änderungen sollten GridView und ObjectDataSource s deklarative Markup wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="78d63-222">After these modifications, the GridView and ObjectDataSource s declarative markup should look like the following:</span></span>


[!code-aspx[Main](adding-additional-datatable-columns-cs/samples/sample3.aspx)]

<span data-ttu-id="78d63-223">Abbildung 11 zeigt diese Seite, wenn Sie über einen Browser zugegriffen werden.</span><span class="sxs-lookup"><span data-stu-id="78d63-223">Figure 11 shows this page when visited through a browser.</span></span> <span data-ttu-id="78d63-224">Beachten Sie, dass zunächst die Produkte anhand deren Preis in absteigender Reihenfolge mit den einzelnen Produkten, die eine entsprechende zugewiesen sortiert werden `PriceQuartile` Wert.</span><span class="sxs-lookup"><span data-stu-id="78d63-224">Note that, initially, the products are ordered by their price in descending order with each product assigned an appropriate `PriceQuartile` value.</span></span> <span data-ttu-id="78d63-225">Natürlich können diese Daten nach anderen Kriterien sortiert werden, mit der Preis Quartil Spaltenwert weiterhin reflektieren die Rangfolge Produkt s in Bezug auf den Preis (siehe Abbildung 12).</span><span class="sxs-lookup"><span data-stu-id="78d63-225">Of course this data can be sorted by other criteria with the Price Quartile column value still reflecting the product s ranking with respect to price (see Figure 12).</span></span>


<span data-ttu-id="78d63-226">[![Die Produkte werden nach ihrer Preise sortiert.](adding-additional-datatable-columns-cs/_static/image30.png)](adding-additional-datatable-columns-cs/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="78d63-226">[![The Products are Ordered by their Prices](adding-additional-datatable-columns-cs/_static/image30.png)](adding-additional-datatable-columns-cs/_static/image29.png)</span></span>

<span data-ttu-id="78d63-227">**Abbildung 11**: werden die Produkte nach ihrer Preise sortiert ([klicken Sie hier, um das Bild in voller Größe angezeigt](adding-additional-datatable-columns-cs/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="78d63-227">**Figure 11**: The Products are Ordered by their Prices ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image31.png))</span></span>


<span data-ttu-id="78d63-228">[![Die Produkte werden durch ihre Namen sortiert.](adding-additional-datatable-columns-cs/_static/image33.png)](adding-additional-datatable-columns-cs/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="78d63-228">[![The Products are Ordered by their Names](adding-additional-datatable-columns-cs/_static/image33.png)](adding-additional-datatable-columns-cs/_static/image32.png)</span></span>

<span data-ttu-id="78d63-229">**Abbildung 12**: werden die Produkte nach Namen sortiert ([klicken Sie hier, um das Bild in voller Größe angezeigt](adding-additional-datatable-columns-cs/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="78d63-229">**Figure 12**: The Products are Ordered by their Names ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image34.png))</span></span>


> [!NOTE]
> <span data-ttu-id="78d63-230">Mit wenigen Codezeilen konnte wir GridView ergänzen, damit es gefärbt, Produktzeilen auf Grundlage ihrer `PriceQuartile` Wert.</span><span class="sxs-lookup"><span data-stu-id="78d63-230">With a few lines of code we could augment the GridView so that it colored the product rows based on their `PriceQuartile` value.</span></span> <span data-ttu-id="78d63-231">Wir können diese Produkte in der Quartil hellgrün, die in der zweiten Quartil einer hellen Gelb Farbe usw.</span><span class="sxs-lookup"><span data-stu-id="78d63-231">We might color those products in the first quartile a light green, those in the second quartile a light yellow, and so forth.</span></span> <span data-ttu-id="78d63-232">Ich empfehlen Ihnen, einen Moment Zeit, diese Funktionalität hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="78d63-232">I encourage you to take a moment to add this functionality.</span></span> <span data-ttu-id="78d63-233">Wenn Sie zum Formatieren einer GridView aufzufrischen benötigen, wenden Sie sich an den [benutzerdefinierte Formatierung basierend auf Daten](../custom-formatting/custom-formatting-based-upon-data-cs.md) Lernprogramm.</span><span class="sxs-lookup"><span data-stu-id="78d63-233">If you need a refresher on formatting a GridView, consult the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-cs.md) tutorial.</span></span>


## <a name="an-alternative-approach---creating-another-tableadapter"></a><span data-ttu-id="78d63-234">Ein alternativer Ansatz - erstellen eine andere TableAdapter</span><span class="sxs-lookup"><span data-stu-id="78d63-234">An Alternative Approach - Creating Another TableAdapter</span></span>

<span data-ttu-id="78d63-235">Wie es beim Hinzufügen einer Methode zu einem TableAdapter, die Datenfelder als die zurückgibt durch die Hauptabfrage wie folgt buchstabiert in diesem Lernprogramm gezeigt, können wir die DataTable entsprechende Spalten hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="78d63-235">As we saw in this tutorial, when adding a method to a TableAdapter that returns data fields other than those spelled out by the main query, we can add corresponding columns to the DataTable.</span></span> <span data-ttu-id="78d63-236">Ein derartiger Ansatz, allerdings gut nur, wenn eine kleine Anzahl von Methoden im TableAdapter, die unterschiedliche Datenfelder zurückgeben und diese alternativen Datenfelder nicht aus der Hauptabfrage zu stark variieren.</span><span class="sxs-lookup"><span data-stu-id="78d63-236">Such an approach, however, works well only if there are a small number of methods in the TableAdapter that return different data fields and if those alternate data fields do not vary too much from the main query.</span></span>

<span data-ttu-id="78d63-237">Anstatt DataTable Spalten hinzugefügt haben, können Sie stattdessen eine andere TableAdapter auf das DataSet hinzufügen, die die Methoden aus dem ersten TableAdapter enthält, die unterschiedliche Datenfelder zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="78d63-237">Rather than adding columns to the DataTable, you can instead add another TableAdapter to the DataSet that contains the methods from the first TableAdapter that return different data fields.</span></span> <span data-ttu-id="78d63-238">Für dieses Lernprogramm statt Hinzufügen der `PriceQuartile` Spalte die `ProductsDataTable` (, in dem er dient lediglich durch die `GetProductsWithPriceQuartile` Methode), wir haben einen zusätzlichen TableAdapter konnte auf das DataSet mit dem Namen hinzugefügt `ProductsWithPriceQuartileTableAdapter` , verwendet die `Products_SelectWithPriceQuartile` gespeichert die Prozedur als der Hauptabfrage.</span><span class="sxs-lookup"><span data-stu-id="78d63-238">For this tutorial, rather than add the `PriceQuartile` column to the `ProductsDataTable` (where it is only used by the `GetProductsWithPriceQuartile` method), we could have added an additional TableAdapter to the DataSet named `ProductsWithPriceQuartileTableAdapter` that used the `Products_SelectWithPriceQuartile` stored procedure as its main query.</span></span> <span data-ttu-id="78d63-239">ASP.NET-Seiten, die zum Abrufen von Produktinformationen mit dem Preis Quartil erforderlich ist, verwenden die `ProductsWithPriceQuartileTableAdapter`, während solche, die nicht der Fall war konnte verwenden weiterhin die `ProductsTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="78d63-239">ASP.NET pages that needed to get product information with the price quartile would use the `ProductsWithPriceQuartileTableAdapter`, while those that did not could continue to use the `ProductsTableAdapter`.</span></span>

<span data-ttu-id="78d63-240">Fügen Sie einen neuen TableAdapter hinzu, die DataTables untarnished bleiben und ihre Spalten spiegeln genau die Datenfelder, die von ihren TableAdapter-s-Methoden zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="78d63-240">By adding a new TableAdapter, the DataTables remain untarnished and their columns precisely mirror the data fields returned by their TableAdapter s methods.</span></span> <span data-ttu-id="78d63-241">Allerdings können zusätzliche TableAdapters wiederkehrende Aufgaben und Funktionen einführen.</span><span class="sxs-lookup"><span data-stu-id="78d63-241">However, additional TableAdapters can introduce repetitive tasks and functionality.</span></span> <span data-ttu-id="78d63-242">Z. B., wenn diese ASP.NET-Seiten angezeigten der `PriceQuartile` Spalte auch benötigt einfügen, aktualisieren und delete-Unterstützung, die `ProductsWithPriceQuartileTableAdapter` müssten haben seine `InsertCommand`, `UpdateCommand`, und `DeleteCommand` Eigenschaften ordnungsgemäß konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="78d63-242">For example, if those ASP.NET pages that displayed the `PriceQuartile` column also needed to provide insert, update, and delete support, the `ProductsWithPriceQuartileTableAdapter` would need to have its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties properly configured.</span></span> <span data-ttu-id="78d63-243">Während diese Eigenschaften zu spiegeln, würde die `ProductsTableAdapter` s, diese Konfiguration wird einen zusätzlichen Schritt eingeführt.</span><span class="sxs-lookup"><span data-stu-id="78d63-243">While these properties would mirror the `ProductsTableAdapter` s, this configuration introduces an extra step.</span></span> <span data-ttu-id="78d63-244">Darüber hinaus gibt es sind nun zwei Möglichkeiten zum Aktualisieren, löschen oder Hinzufügen eines Produkts in der Datenbank - über die `ProductsTableAdapter` und `ProductsWithPriceQuartileTableAdapter` Klassen.</span><span class="sxs-lookup"><span data-stu-id="78d63-244">Moreover, there are now two ways to update, delete, or add a product to the database - through the `ProductsTableAdapter` and `ProductsWithPriceQuartileTableAdapter` classes.</span></span>

<span data-ttu-id="78d63-245">Der Download für dieses Lernprogramm umfasst eine `ProductsWithPriceQuartileTableAdapter` -Klasse in der `NorthwindWithSprocs` DataSet, das diese alternative Methode veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="78d63-245">The download for this tutorial includes a `ProductsWithPriceQuartileTableAdapter` class in the `NorthwindWithSprocs` DataSet that illustrates this alternative approach.</span></span>

## <a name="summary"></a><span data-ttu-id="78d63-246">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="78d63-246">Summary</span></span>

<span data-ttu-id="78d63-247">In den meisten Szenarien alle Methoden in einem TableAdapter den gleichen Satz von Datenfelder zurück, aber es vorkommen, dass eine bestimmte Methode oder zwei möglicherweise ein zusätzliches Feld zurückgegeben müssen, werden.</span><span class="sxs-lookup"><span data-stu-id="78d63-247">In most scenarios, all of the methods in a TableAdapter will return the same set of data fields, but there are times when a particular method or two may need to return an additional field.</span></span> <span data-ttu-id="78d63-248">Z. B. in der [Master/Detail, verwenden eine Aufzählung der Master-Datensätze mit Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) Lernprogramm, die wir, eine Methode, um hinzugefügt die `CategoriesTableAdapter` , dass, sondern die Hauptabfrage s Datenfelder, die zurückgegeben eine `NumberOfProducts` Feld, das berichtet die Anzahl der Produkte jeder Kategorie zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="78d63-248">For example, in the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) tutorial we added a method to the `CategoriesTableAdapter` that, in addition to the main query s data fields, returned a `NumberOfProducts` field that reported the number of products associated with each category.</span></span> <span data-ttu-id="78d63-249">In diesem Lernprogramm wird erläutert, Hinzufügen einer Methode in der `ProductsTableAdapter` zurückgegebenen ein `PriceQuartile` Feld zusätzlich zu den Feldern der Hauptabfrage s-Daten.</span><span class="sxs-lookup"><span data-stu-id="78d63-249">In this tutorial we looked at adding a method in the `ProductsTableAdapter` that returned a `PriceQuartile` field in addition to the main query s data fields.</span></span> <span data-ttu-id="78d63-250">Um zusätzliche Daten zu erfassen zurückgegeben Felder von der TableAdapter-s-Methoden, müssen wir die DataTable entsprechende Spalten hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="78d63-250">To capture additional data fields returned by the TableAdapter s methods we need to add corresponding columns to the DataTable.</span></span>

<span data-ttu-id="78d63-251">Wenn Sie zum manuellen Hinzufügen von Spalten zu der "DataTable" Planen, wird empfohlen, dass die TableAdapter gespeicherte Prozeduren verwenden.</span><span class="sxs-lookup"><span data-stu-id="78d63-251">If you plan on manually adding columns to the DataTable, it is recommended that the TableAdapter use stored procedures.</span></span> <span data-ttu-id="78d63-252">Wenn TableAdapter Ad-hoc-SQL-Anweisungen verwendet wird, wird jedes Mal der TableAdapter-Konfigurations-Assistenten alle Methoden ausgeführt die Datenfelder, die von der main-Abfrage zurückgegebenen Daten Feldlisten wiederherstellen.</span><span class="sxs-lookup"><span data-stu-id="78d63-252">If the TableAdapter uses ad-hoc SQL statements, any time the TableAdapter Configuration wizard is run all of the methods data field lists revert to the data fields returned by the main query.</span></span> <span data-ttu-id="78d63-253">Dieses Problem erstreckt sich nicht um gespeicherte Prozeduren, also warum sie empfohlen werden und in diesem Lernprogramm verwendet wurden.</span><span class="sxs-lookup"><span data-stu-id="78d63-253">This problem does not extend to stored procedures, which is why they are recommended and were used in this tutorial.</span></span>

<span data-ttu-id="78d63-254">Viel Spaß beim Programmieren!</span><span class="sxs-lookup"><span data-stu-id="78d63-254">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="78d63-255">Informationen zum Autor</span><span class="sxs-lookup"><span data-stu-id="78d63-255">About the Author</span></span>

<span data-ttu-id="78d63-256">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor von sieben ASP/ASP.NET-Büchern und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), Microsoft Web-Technologien seit 1998 arbeitet.</span><span class="sxs-lookup"><span data-stu-id="78d63-256">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="78d63-257">Scott fungiert als ein unabhängiger Berater, Trainer und Writer.</span><span class="sxs-lookup"><span data-stu-id="78d63-257">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="78d63-258">Sein neueste Buch wird [ *Sams Schulen selbst ASP.NET 2.0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="78d63-258">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="78d63-259">Er die erreicht werden kann, zur [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) oder über seinen Blog die finden Sie unter [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="78d63-259">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="78d63-260">Besonderen Dank an</span><span class="sxs-lookup"><span data-stu-id="78d63-260">Special Thanks To</span></span>

<span data-ttu-id="78d63-261">Diese Reihe von Lernprogrammen wurde durch viele nützliche Bearbeiter überprüft.</span><span class="sxs-lookup"><span data-stu-id="78d63-261">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="78d63-262">Lead Prüfer für dieses Lernprogramm wurden Randy Schmidt, Jacky Goor Bernadette Leigh und Hilton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="78d63-262">Lead reviewers for this tutorial were Randy Schmidt, Jacky Goor, Bernadette Leigh, and Hilton Giesenow.</span></span> <span data-ttu-id="78d63-263">Meine bevorstehende MSDN-Artikel Überprüfen von Interesse?</span><span class="sxs-lookup"><span data-stu-id="78d63-263">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="78d63-264">Wenn dies der Fall ist, löschen Sie mich zeilenweise [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="78d63-264">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="78d63-265">[Zurück](updating-the-tableadapter-to-use-joins-cs.md)
[Weiter](working-with-computed-columns-cs.md)</span><span class="sxs-lookup"><span data-stu-id="78d63-265">[Previous](updating-the-tableadapter-to-use-joins-cs.md)
[Next](working-with-computed-columns-cs.md)</span></span>
