---
uid: identity/overview/getting-started/adding-aspnet-identity-to-an-empty-or-existing-web-forms-project
title: "Hinzufügen von ASP.NET Identity zu einem leeren oder vorhandene Web Forms-Projekt | Microsoft Docs"
author: raquelsa
description: "In diesem Lernprogramm wird gezeigt, wie eine ASP.NET-Anwendung ASP.NET Identity (das neue Mitgliedschaftssystem für ASP.NET) hinzu. Wenn Sie eine neue Web Forms oder MVC erstellen..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 10/23/2013
ms.topic: article
ms.assetid: 1cbc0ed2-5bd6-4b62-8d34-4c193dcd8b25
ms.technology: 
ms.prod: .net-framework
msc.legacyurl: /identity/overview/getting-started/adding-aspnet-identity-to-an-empty-or-existing-web-forms-project
msc.type: authoredcontent
ms.openlocfilehash: 3ab67b93a32106c0b79f9e8d739d47835391edb5
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/24/2018
---
<a name="adding-aspnet-identity-to-an-empty-or-existing-web-forms-project"></a><span data-ttu-id="46dd7-104">Hinzufügen von ASP.NET Identity zu einem leeren oder vorhandene Web Forms-Projekt</span><span class="sxs-lookup"><span data-stu-id="46dd7-104">Adding ASP.NET Identity to an Empty or Existing Web Forms Project</span></span>
====================
<span data-ttu-id="46dd7-105">durch [Raquel Soares De Almeida](https://github.com/raquelsa)</span><span class="sxs-lookup"><span data-stu-id="46dd7-105">by [Raquel Soares De Almeida](https://github.com/raquelsa)</span></span>

> <span data-ttu-id="46dd7-106">Dieses Lernprogramm veranschaulicht das Hinzufügen [ASP.NET Identity](introduction-to-aspnet-identity.md) (das neue Mitgliedschaftssystem für ASP.NET) an eine ASP.NET-Anwendung.</span><span class="sxs-lookup"><span data-stu-id="46dd7-106">This tutorial shows you how to add [ASP.NET Identity](introduction-to-aspnet-identity.md) (the new membership system for ASP.NET) to an ASP.NET application.</span></span>
> 
> <span data-ttu-id="46dd7-107">Wenn Sie ein neues Web Forms- oder MVC-Projekt in Visual Studio-2013 RTM mit einzelnen Konten erstellen, wird Visual Studio alle erforderlichen Pakete installieren und fügen Sie alle erforderlichen Klassen für Sie.</span><span class="sxs-lookup"><span data-stu-id="46dd7-107">When you create a new Web Forms or MVC project in Visual Studio 2013 RTM with Individual Accounts, Visual Studio will install all the required packages and add all necessary classes for you.</span></span> <span data-ttu-id="46dd7-108">In diesem Lernprogramm werden die Schritte zum Hinzufügen von ASP.NET Identity unterstützen das vorhandene Web Forms-Projekt oder ein neues leeres Projekt veranschaulichen.</span><span class="sxs-lookup"><span data-stu-id="46dd7-108">This tutorial will illustrate the steps to add ASP.NET Identity support to your existing Web Forms project or a new empty project.</span></span> <span data-ttu-id="46dd7-109">Ich beschreibt alle NuGet-Pakete, die Sie installieren müssen, und Klassen, mit denen, die Sie hinzufügen müssen.</span><span class="sxs-lookup"><span data-stu-id="46dd7-109">I will outline all the NuGet packages you need to install, and classes you need to add.</span></span> <span data-ttu-id="46dd7-110">Ich werden Beispiel Web Forms besprochen, für neue Benutzer registrieren und Anmelden bei Hervorhebung alle main Eintrag Point-APIs für Benutzer- und Authentifizierung.</span><span class="sxs-lookup"><span data-stu-id="46dd7-110">I will go over sample Web Forms for registering new users and logging in while highlighting all main entry point APIs for user management and authentication.</span></span> <span data-ttu-id="46dd7-111">Dieses Beispiel verwendet die ASP.NET Identity-Standardimplementierung für die Speicherung von SQL die basiert auf Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="46dd7-111">This sample will use the ASP.NET Identity default implementation for SQL data storage which is built on Entity Framework.</span></span> <span data-ttu-id="46dd7-112">Dieses Lernprogramm wird LocalDB für die SQL-Datenbank verwendet.</span><span class="sxs-lookup"><span data-stu-id="46dd7-112">This tutorial, we will use LocalDB for the SQL database.</span></span>
> 
> <span data-ttu-id="46dd7-113">Dieses Lernprogramm wurde von Raquel Soares De Almeida und Rick Anderson geschrieben ( [ @RickAndMSFT ](https://twitter.com/#!/RickAndMSFT) ).</span><span class="sxs-lookup"><span data-stu-id="46dd7-113">This tutorial was written by Raquel Soares De Almeida and Rick Anderson ( [@RickAndMSFT](https://twitter.com/#!/RickAndMSFT) ).</span></span>


## <a name="getting-started-aspnet-identity"></a><span data-ttu-id="46dd7-114">Erste Schritte ASP.NET-Identität</span><span class="sxs-lookup"><span data-stu-id="46dd7-114">Getting Started ASP.NET Identity</span></span>

1. <span data-ttu-id="46dd7-115">Starten, indem Sie installieren und Ausführen von [Visual Studio Express 2013 für Web](https://go.microsoft.com/fwlink/?LinkId=299058) oder [Visual Studio 2013](https://go.microsoft.com/fwlink/?LinkId=306566).</span><span class="sxs-lookup"><span data-stu-id="46dd7-115">Start by installing and running [Visual Studio Express 2013 for Web](https://go.microsoft.com/fwlink/?LinkId=299058) or [Visual Studio 2013](https://go.microsoft.com/fwlink/?LinkId=306566).</span></span>
2. <span data-ttu-id="46dd7-116">Klicken Sie auf **neues Projekt** vom Beginn, oder verwenden Sie das Menü und wählen Sie **Datei**, und klicken Sie dann **neues Projekt**.</span><span class="sxs-lookup"><span data-stu-id="46dd7-116">Click **New Project** from the Start page, or you can use the menu and select **File**, and then **New Project**.</span></span>
3. <span data-ttu-id="46dd7-117">Wählen Sie **Visual C#-i** n den linken Bereich, klicken Sie dann **Web** und wählen Sie dann **ASP.NET-Webanwendung**.</span><span class="sxs-lookup"><span data-stu-id="46dd7-117">Select **Visual C# i** n the left pane, then **Web** and then select **ASP.NET Web Application**.</span></span> <span data-ttu-id="46dd7-118">Namen für das Projekt "WebFormsIdentity", und klicken Sie dann auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="46dd7-118">Name your project "WebFormsIdentity" and then click **OK**.</span></span>   
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image1.png)
4. <span data-ttu-id="46dd7-119">In der **neues ASP.NET-Projekt** wählen Sie im Dialogfeld die **leere** Vorlage.</span><span class="sxs-lookup"><span data-stu-id="46dd7-119">In the **New ASP.NET Project** dialog, select the **Empty** template.</span></span>  
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image2.png)  
  
 <span data-ttu-id="46dd7-120">Beachten Sie, dass die **Authentifizierung ändern** -Schaltfläche deaktiviert ist und keine Unterstützung der Authentifizierung wird in dieser Vorlage bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="46dd7-120">Notice the **Change Authentication** button is disabled and no authentication support is provided in this template.</span></span> <span data-ttu-id="46dd7-121">Die Web Forms, MVC und Web-API-Vorlagen können Sie die authentifizierungsansatz auswählen.</span><span class="sxs-lookup"><span data-stu-id="46dd7-121">The Web Forms, MVC and Web API templates allow you to select the authentication approach.</span></span> <span data-ttu-id="46dd7-122">Weitere Informationen finden Sie unter [Übersicht der Authentifizierung](../../../visual-studio/overview/2013/creating-web-projects-in-visual-studio.md#auth) .</span><span class="sxs-lookup"><span data-stu-id="46dd7-122">For more information, see [Overview of Authentication](../../../visual-studio/overview/2013/creating-web-projects-in-visual-studio.md#auth) .</span></span>

## <a name="adding-identity-packages-to-your-app"></a><span data-ttu-id="46dd7-123">Hinzufügen von Identity-Paketen zu Ihrer App</span><span class="sxs-lookup"><span data-stu-id="46dd7-123">Adding Identity Packages to your App</span></span>

<span data-ttu-id="46dd7-124">Klicken Sie im Projektmappen-Explorer mit der rechten Maustaste des Projekts, und wählen **NuGet-Pakete verwalten**.</span><span class="sxs-lookup"><span data-stu-id="46dd7-124">In Solution Explorer, right-click your project and select **Manage NuGet Packages**.</span></span> <span data-ttu-id="46dd7-125">Geben Sie im Textfeld "Suchen" im Dialogfeld "*Identity.E*".</span><span class="sxs-lookup"><span data-stu-id="46dd7-125">In the search text box dialog, type "*Identity.E*".</span></span> <span data-ttu-id="46dd7-126">Klicken Sie auf installieren, die für dieses Paket.</span><span class="sxs-lookup"><span data-stu-id="46dd7-126">Click install for this package.</span></span>   
  
![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image3.png)  
  
<span data-ttu-id="46dd7-127">Beachten Sie, dass dieses Paket die abhängigkeitspakete installiert wird: EntityFramework und Microsoft ASP.NET Identity Core.</span><span class="sxs-lookup"><span data-stu-id="46dd7-127">Note that this package will install the dependency packages: EntityFramework and Microsoft ASP.NET Identity Core.</span></span>

## <a name="adding-web-forms-to-register-users"></a><span data-ttu-id="46dd7-128">Hinzufügen von WebForms Benutzer registrieren</span><span class="sxs-lookup"><span data-stu-id="46dd7-128">Adding Web Forms to Register Users</span></span>

1. <span data-ttu-id="46dd7-129">In **Projektmappen-Explorer**mit der rechten Maustaste auf das Projekt, und klicken Sie auf **hinzufügen**, und klicken Sie dann **Webformular**.</span><span class="sxs-lookup"><span data-stu-id="46dd7-129">In **Solution Explorer**, right-click your project and click **Add**, and then **Web Form**.</span></span>  
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image4.png)
2. <span data-ttu-id="46dd7-130">In der **Namen für Artikel angeben** Dialogfeld Feld "Name" neue WebForm **registrieren**, und klicken Sie dann auf **OK**</span><span class="sxs-lookup"><span data-stu-id="46dd7-130">In the **Specify Name for Item** dialog box, name the new web form **Register**, and then click **OK**</span></span>
3. <span data-ttu-id="46dd7-131">Ersetzen Sie das Markup in der generierten *Register.aspx* -Datei mit den folgenden Code.</span><span class="sxs-lookup"><span data-stu-id="46dd7-131">Replace the markup in the generated *Register.aspx* file with the code below.</span></span> <span data-ttu-id="46dd7-132">Die codeänderungen werden hervorgehoben.</span><span class="sxs-lookup"><span data-stu-id="46dd7-132">The code changes are highlighted.</span></span>   

    [!code-aspx[Main](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/samples/sample1.aspx?highlight=9,12-40)]

    > [!NOTE]
    > <span data-ttu-id="46dd7-133">Dies ist nur eine vereinfachte Version der *Register.aspx* Datei, die erstellt wird, wenn Sie ein neues ASP.NET Web Forms-Projekt erstellen.</span><span class="sxs-lookup"><span data-stu-id="46dd7-133">This is just a simplified version of the *Register.aspx* file that is created when you create a new ASP.NET Web Forms project.</span></span> <span data-ttu-id="46dd7-134">Das Markup oben Fügt Formularfelder und eine Schaltfläche, um einen neuen Benutzer registrieren.</span><span class="sxs-lookup"><span data-stu-id="46dd7-134">The markup above adds form fields and a button to register a new user.</span></span>
4. <span data-ttu-id="46dd7-135">Öffnen der *Register.aspx.cs* -Datei und Ersetzen Sie den Inhalt der Datei durch den folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="46dd7-135">Open the *Register.aspx.cs* file and replace the contents of the file with the following code:</span></span>

    [!code-csharp[Main](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/samples/sample2.cs)]

    > [!NOTE] 
    > 
    > 1. <span data-ttu-id="46dd7-136">Der obige Code ist eine vereinfachte Version der *Register.aspx.cs* -Datei, die erstellt wird, wenn Sie ein neues ASP.NET Web Forms-Projekt erstellen.</span><span class="sxs-lookup"><span data-stu-id="46dd7-136">The code above is a simplified version of the *Register.aspx.cs* file that is created when you create a new ASP.NET Web Forms project.</span></span>
    > 2. <span data-ttu-id="46dd7-137">Die *IdentityUser* Klasse ist die Standardimplementierung von EntityFramework der *IUser* Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="46dd7-137">The *IdentityUser* class is the default EntityFramework implementation of the *IUser* interface.</span></span> <span data-ttu-id="46dd7-138">*IUser* Schnittstelle ist die minimale Schnittstelle für einen Benutzer auf ASP.NET Identity Core.</span><span class="sxs-lookup"><span data-stu-id="46dd7-138">*IUser* interface is the minimal interface for a user on ASP.NET Identity Core.</span></span>
    > 3. <span data-ttu-id="46dd7-139">Die *UserStore* Klasse ist die standardmäßige EntityFramework Implementierung eines Benutzerspeichers.</span><span class="sxs-lookup"><span data-stu-id="46dd7-139">The *UserStore* class is the default EntityFramework implementation of a user store.</span></span> <span data-ttu-id="46dd7-140">Diese Klasse implementiert die ASP.NET Identity Core minimalen Schnittstellen: *IUserStore*, *IUserLoginStore*, *IUserClaimStore* und *IUserRoleStore* .</span><span class="sxs-lookup"><span data-stu-id="46dd7-140">This class implements the ASP.NET Identity Core's minimal interfaces: *IUserStore*, *IUserLoginStore*, *IUserClaimStore* and *IUserRoleStore*.</span></span>
    > 4. <span data-ttu-id="46dd7-141">Die *UserManager* Klasse stellt benutzerbezogene APIs, die automatisch vorgenommenen Änderungen zu speichern, wird die *UserStore*.</span><span class="sxs-lookup"><span data-stu-id="46dd7-141">The *UserManager* class exposes user related APIs which will automatically save changes to the *UserStore*.</span></span>
    > 5. <span data-ttu-id="46dd7-142">Die *IdentityResult* Klasse stellt das Ergebnis eines identitätsvorgangs dar.</span><span class="sxs-lookup"><span data-stu-id="46dd7-142">The *IdentityResult* class represents the result of an identity operation.</span></span>
5. <span data-ttu-id="46dd7-143">In **Projektmappen-Explorer**mit der rechten Maustaste auf das Projekt, und klicken Sie auf **hinzufügen**, **ASP.NET-Ordner hinzufügen** und dann **App\_Daten**.</span><span class="sxs-lookup"><span data-stu-id="46dd7-143">In **Solution Explorer**, right-click your project and click **Add**, **Add ASP.NET Folder** and then **App\_Data**.</span></span>  
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image5.png)
6. <span data-ttu-id="46dd7-144">Öffnen der *"Web.config"* Datei, und fügen Sie einen Verbindungszeichenfolgeneintrag für die Datenbank, die wir verwenden, um das Speichern von Benutzerinformationen.</span><span class="sxs-lookup"><span data-stu-id="46dd7-144">Open the *Web.config* file and add a connection string entry for the database we will use to store user information.</span></span> <span data-ttu-id="46dd7-145">Die Datenbank wird zur Laufzeit von EntityFramework für die Identity-Entitäten erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="46dd7-145">The database will be created at runtime by EntityFramework for the Identity entities.</span></span> <span data-ttu-id="46dd7-146">Die Verbindungszeichenfolge ähnelt einer für Sie erstellt werden, wenn Sie ein neues Web Forms-Projekt erstellen.</span><span class="sxs-lookup"><span data-stu-id="46dd7-146">The connection string is similar to one created for you when you create a new Web Forms project.</span></span> <span data-ttu-id="46dd7-147">Der hervorgehobene Code zeigt dem Markup hinzugefügt werden soll:</span><span class="sxs-lookup"><span data-stu-id="46dd7-147">The highlighted code shows the markup you should add:</span></span>

    [!code-xml[Main](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/samples/sample3.xml?highlight=11-14)]
    
    > [!NOTE] 
    > <span data-ttu-id="46dd7-148">Ersetzen Sie für Visual Studio 2015 oder höher, `(localdb)\v11.0` mit `(localdb)\MSSQLLocalDB` in der Verbindungszeichenfolge.</span><span class="sxs-lookup"><span data-stu-id="46dd7-148">For Visual Studio 2015 or higher, replace `(localdb)\v11.0` with `(localdb)\MSSQLLocalDB` in your connection string.</span></span>
    
7. <span data-ttu-id="46dd7-149">Klicken Sie mit der rechten Maustaste auf die Datei *Register.aspx* in Ihrem Projekt, und wählen **als Startseite festlegen**.</span><span class="sxs-lookup"><span data-stu-id="46dd7-149">Right click file *Register.aspx* in your project and select **Set as Start Page**.</span></span> <span data-ttu-id="46dd7-150">Drücken Sie STRG + F5 zu erstellen, und führen Sie die Webanwendung.</span><span class="sxs-lookup"><span data-stu-id="46dd7-150">Press Ctrl + F5 to build and run the web application.</span></span> <span data-ttu-id="46dd7-151">Geben Sie einen neuen Benutzernamen und ein Kennwort, und klicken Sie dann auf **registrieren**.</span><span class="sxs-lookup"><span data-stu-id="46dd7-151">Enter a new user name and password and then click on **Register**.</span></span>  
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image6.png)  

    > [!NOTE]
    > <span data-ttu-id="46dd7-152">ASP.NET Identity bietet Unterstützung für die Validierung und in diesem Beispiel können Sie das Standardverhalten für Benutzer und Kennwort überprüfen Validierungssteuerelemente, die von der Identität Hauptpaket stammen.</span><span class="sxs-lookup"><span data-stu-id="46dd7-152">ASP.NET Identity has support for validation and in this sample you can verify the default behavior on User and Password validators that come from the Identity Core package.</span></span> <span data-ttu-id="46dd7-153">Das Standard-Validierungssteuerelement für Benutzer (`UserValidator`) verfügt über eine Eigenschaft `AllowOnlyAlphanumericUserNames` , besitzt Standardwert `true`.</span><span class="sxs-lookup"><span data-stu-id="46dd7-153">The default validator for User (`UserValidator`) has a property `AllowOnlyAlphanumericUserNames` that has default value set to `true`.</span></span> <span data-ttu-id="46dd7-154">Der Standard-Validierungssteuerelement für das Kennwort (`MinimumLengthValidator`) wird sichergestellt, dass dieses Kennwort hat mindestens 6 Zeichen enthalten.</span><span class="sxs-lookup"><span data-stu-id="46dd7-154">The default validator for Password (`MinimumLengthValidator`) ensures that password has at least 6 characters.</span></span> <span data-ttu-id="46dd7-155">Diese Validierungssteuerelemente werden Eigenschaften auf `UserManager` , überschrieben werden, wenn Sie benutzerdefinierte Validierung haben möchten.</span><span class="sxs-lookup"><span data-stu-id="46dd7-155">These validators are properties on `UserManager` that can be overridden if you want to have custom validation,</span></span>

## <a name="verifying-the-localdb-identity-database-and-tables-generated-by-entity-framework"></a><span data-ttu-id="46dd7-156">Überprüfen der Identität der LocalDb-Datenbank und die Tabellen, die vom Entity Framework generierten</span><span class="sxs-lookup"><span data-stu-id="46dd7-156">Verifying the LocalDb Identity Database and Tables Generated by Entity Framework</span></span>

1. <span data-ttu-id="46dd7-157">In der **Ansicht** Menü klicken Sie auf **Server-Explorer**.</span><span class="sxs-lookup"><span data-stu-id="46dd7-157">In the **View** menu, click **Server Explorer**.</span></span>  
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image7.png)
2. <span data-ttu-id="46dd7-158">Erweitern Sie **DefaultConnection (WebFormsIdentity)**, erweitern Sie **Tabellen**, klicken Sie mit der rechten Maustaste auf **AspNetUsers** , und klicken Sie auf **Tabellendaten anzeigen**.</span><span class="sxs-lookup"><span data-stu-id="46dd7-158">Expand **DefaultConnection (WebFormsIdentity)**, expand **Tables**, right click **AspNetUsers** and click **Show Table Data**.</span></span>  
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image8.png)  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image9.png)

## <a name="configuring-the-application-for-owin-authentication"></a><span data-ttu-id="46dd7-159">Konfigurieren der Anwendung für die OWIN-Authentifizierung</span><span class="sxs-lookup"><span data-stu-id="46dd7-159">Configuring the application for OWIN authentication</span></span>

<span data-ttu-id="46dd7-160">Zu diesem Zeitpunkt haben wir Unterstützung für die Erstellung von Benutzern nur hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="46dd7-160">At this point we have only added support for creating users.</span></span> <span data-ttu-id="46dd7-161">Jetzt werden wir zur Veranschaulichung, wie wir die Authentifizierung zur Anmeldung eines Benutzers hinzufügen können.</span><span class="sxs-lookup"><span data-stu-id="46dd7-161">Now, we are going to demonstrate how we can add authentication to login a user.</span></span> <span data-ttu-id="46dd7-162">ASP.NET Identity verwendet Microsoft OWIN-authentifizierungsmiddleware für die Formularauthentifizierung.</span><span class="sxs-lookup"><span data-stu-id="46dd7-162">ASP.NET Identity uses Microsoft OWIN Authentication middleware for forms authentication.</span></span> <span data-ttu-id="46dd7-163">Die OWIN-Cookieauthentifizierung ist ein Cookie und Ansprüche basierend Authentifizierungsmechanismus, der von einem Framework gehostet verwendet werden kann [OWIN](https://msdn.microsoft.com/magazine/dn451439.aspx) oder IIS.</span><span class="sxs-lookup"><span data-stu-id="46dd7-163">The OWIN Cookie Authentication is a cookie and claims based authentication mechanism that can be used by any framework hosted on [OWIN](https://msdn.microsoft.com/magazine/dn451439.aspx) or IIS.</span></span> <span data-ttu-id="46dd7-164">Mit diesem Modell können der gleiche Authentifizierungspaketen für mehrere Frameworks wie ASP.NET MVC und Web Forms verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="46dd7-164">With this model, the same authentication packages can be used across multiple frameworks including ASP.NET MVC and Web Forms.</span></span> <span data-ttu-id="46dd7-165">Weitere Informationen zum Projekt Katana und zum Ausführen von Middleware in einen Host agnostisch finden Sie unter [Einstieg in das Katana-Projekt](https://msdn.microsoft.com/magazine/dn451439.aspx).</span><span class="sxs-lookup"><span data-stu-id="46dd7-165">For more information on project Katana and how to run middleware in a host agnostic see [Getting Started with the Katana Project](https://msdn.microsoft.com/magazine/dn451439.aspx).</span></span>

## <a name="installing-authentication-packages-to-your-application"></a><span data-ttu-id="46dd7-166">Installieren von Authentifizierungspaketen für Ihre Anwendung</span><span class="sxs-lookup"><span data-stu-id="46dd7-166">Installing authentication packages to your application</span></span>

1. <span data-ttu-id="46dd7-167">Klicken Sie im Projektmappen-Explorer mit der rechten Maustaste des Projekts, und wählen **NuGet-Pakete verwalten**.</span><span class="sxs-lookup"><span data-stu-id="46dd7-167">In Solution Explorer, right-click your project and select **Manage NuGet Packages**.</span></span> <span data-ttu-id="46dd7-168">Geben Sie im Textfeld "Suchen" im Dialogfeld "*Identity.Owin*".</span><span class="sxs-lookup"><span data-stu-id="46dd7-168">In the search text box dialog, type "*Identity.Owin*".</span></span> <span data-ttu-id="46dd7-169">Klicken Sie auf installieren, die für dieses Paket.</span><span class="sxs-lookup"><span data-stu-id="46dd7-169">Click install for this package.</span></span>   
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image10.png)
2. <span data-ttu-id="46dd7-170">Suchen nach Paket ***"Microsoft.owin.Host.systemweb"*** und installieren Sie es.</span><span class="sxs-lookup"><span data-stu-id="46dd7-170">Search for package ***Microsoft.Owin.Host.SystemWeb*** and install it.</span></span>   

    > [!NOTE]
    > <span data-ttu-id="46dd7-171">Die **Microsoft.Aspnet.Identity.Owin** Paket enthält eine Reihe von OWIN-Erweiterungsklassen zum Verwalten und Konfigurieren der OWIN-authentifizierungsmiddleware von ASP.NET Identity Core-Pakete verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="46dd7-171">The **Microsoft.Aspnet.Identity.Owin** package contains a set of OWIN extension classes to manage and configure OWIN authentication middleware to be consumed by ASP.NET Identity Core packages.</span></span>  
    > <span data-ttu-id="46dd7-172">Die **"Microsoft.owin.Host.systemweb"** Paket enthält einen OWIN-Server, der OWIN-basierte Anwendungen zur Ausführung unter IIS mithilfe der ASP.NET-Pipeline für die Anforderung aktiviert.</span><span class="sxs-lookup"><span data-stu-id="46dd7-172">The **Microsoft.Owin.Host.SystemWeb** package contains an OWIN server that enables OWIN-based applications to run on IIS using the ASP.NET request pipeline.</span></span> <span data-ttu-id="46dd7-173">Weitere Informationen finden Sie unter [OWIN-Middleware in der IIS-integrierten Pipeline](../../../aspnet/overview/owin-and-katana/owin-middleware-in-the-iis-integrated-pipeline.md).</span><span class="sxs-lookup"><span data-stu-id="46dd7-173">For more information see [OWIN Middleware in the IIS integrated pipeline](../../../aspnet/overview/owin-and-katana/owin-middleware-in-the-iis-integrated-pipeline.md).</span></span>

## <a name="adding-owin-startup-and-authentication-configuration-classes"></a><span data-ttu-id="46dd7-174">Hinzufügen von OWIN-Start und Authentifizierung Konfigurationsklassen</span><span class="sxs-lookup"><span data-stu-id="46dd7-174">Adding OWIN Startup and Authentication Configuration Classes</span></span>

1. <span data-ttu-id="46dd7-175">In **Projektmappen-Explorer**mit der rechten Maustaste auf das Projekt, klicken Sie auf **hinzufügen**, und klicken Sie dann **neues Element hinzufügen**.</span><span class="sxs-lookup"><span data-stu-id="46dd7-175">In **Solution Explorer**, right-click your project, click **Add**, and then **Add New Item**.</span></span> <span data-ttu-id="46dd7-176">Geben Sie im Textfeld "Suchen" im Dialogfeld "*Owin*".</span><span class="sxs-lookup"><span data-stu-id="46dd7-176">In the search text box dialog, type "*owin*".</span></span> <span data-ttu-id="46dd7-177">Benennen Sie die Klasse "*Start*", und klicken Sie auf **hinzufügen**.</span><span class="sxs-lookup"><span data-stu-id="46dd7-177">Name the class "*Startup*" and click **Add**.</span></span>   
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image11.png)
2. <span data-ttu-id="46dd7-178">Fügen Sie in der Datei Startup.cs des hervorgehobenen Codes zum Konfigurieren der OWIN-Cookieauthentifizierung unten ein.</span><span class="sxs-lookup"><span data-stu-id="46dd7-178">In the Startup.cs file, add the highlighted code shown below to configure OWIN cookie authentication.</span></span>

    [!code-csharp[Main](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/samples/sample4.cs?highlight=1,3,15-19)]

    > [!NOTE]
    > <span data-ttu-id="46dd7-179">Diese Klasse enthält die `OwinStartup` Attribut zum Angeben der OWIN-Start-Klasse.</span><span class="sxs-lookup"><span data-stu-id="46dd7-179">This class contains the `OwinStartup` attribute for specifying the OWIN startup class.</span></span> <span data-ttu-id="46dd7-180">Jede OWIN-Anwendung verfügt über eine Autostart-Klasse, in dem Sie Komponenten für die Pipeline der Anwendung angeben.</span><span class="sxs-lookup"><span data-stu-id="46dd7-180">Every OWIN application has a startup class where you specify components for the application pipeline.</span></span> <span data-ttu-id="46dd7-181">Finden Sie unter [OWIN Start Klasse Erkennung](../../../aspnet/overview/owin-and-katana/owin-startup-class-detection.md) für Weitere Informationen zu diesem Modell.</span><span class="sxs-lookup"><span data-stu-id="46dd7-181">See [OWIN Startup Class Detection](../../../aspnet/overview/owin-and-katana/owin-startup-class-detection.md) for more info on this model.</span></span>

## <a name="adding-web-forms-for-registering-and-logging-in-users"></a><span data-ttu-id="46dd7-182">Hinzufügen von WebForms für die Registrierung und Anmeldung von Benutzern</span><span class="sxs-lookup"><span data-stu-id="46dd7-182">Adding Web Forms for Registering and Logging in Users</span></span>

1. <span data-ttu-id="46dd7-183">Öffnen der *Register.cs* Datei, und fügen Sie folgenden Code, der der Benutzer bei der Registrierung ist erfolgreich verläuft.</span><span class="sxs-lookup"><span data-stu-id="46dd7-183">Open the *Register.cs* file and add the following code which will log in the user when registration succeeds.</span></span> <span data-ttu-id="46dd7-184">Im folgenden werden die Änderungen hervorgehoben.</span><span class="sxs-lookup"><span data-stu-id="46dd7-184">The changes are highlighted below.</span></span>

    [!code-csharp[Main](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/samples/sample5.cs)]

    > [!NOTE] 
    > 
    > - <span data-ttu-id="46dd7-185">Da ASP.NET Identity und OWIN Cookieauthentifizierung anspruchsbasierte System sind, erfordert das Framework den app-Entwickler zum Generieren einer ["ClaimsIdentity"](https://msdn.microsoft.com/library/microsoft.identitymodel.claims.claimsidentity.aspx) für den Benutzer.</span><span class="sxs-lookup"><span data-stu-id="46dd7-185">Since ASP.NET Identity and OWIN Cookie Authentication are claims based system, the framework requires the app developer to generate a [ClaimsIdentity](https://msdn.microsoft.com/library/microsoft.identitymodel.claims.claimsidentity.aspx) for the user.</span></span> <span data-ttu-id="46dd7-186">"ClaimsIdentity" hat Informationen über alle Ansprüche für den Benutzer wie z. B. welche Rollen, die der Benutzer angehört.</span><span class="sxs-lookup"><span data-stu-id="46dd7-186">ClaimsIdentity has information about all the claims for the user such as what Roles the user belongs to.</span></span> <span data-ttu-id="46dd7-187">Sie können auch weitere Ansprüche für den Benutzer zu diesem Zeitpunkt hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="46dd7-187">You can also add more claims for the user at this stage.</span></span>
    > - <span data-ttu-id="46dd7-188">Sie können die Benutzer anmelden, mithilfe der AuthenticationManager aus aufrufen und OWIN `SignIn` und in der "ClaimsIdentity" übergeben werden, wie oben gezeigt.</span><span class="sxs-lookup"><span data-stu-id="46dd7-188">You can sign in the user by using the AuthenticationManager from OWIN and calling `SignIn` and passing in the ClaimsIdentity as shown above.</span></span> <span data-ttu-id="46dd7-189">Dieser Code wird der Benutzer anmelden und generieren ebenfalls einen Cookie.</span><span class="sxs-lookup"><span data-stu-id="46dd7-189">This code will sign in the user and generate a cookie as well.</span></span> <span data-ttu-id="46dd7-190">Dieser Aufruf ist analog zu [FormAuthentication.SetAuthCookie](https://msdn.microsoft.com/library/system.web.security.formsauthentication.setauthcookie.aspx) verwendet werden, indem Sie die [FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx) Modul.</span><span class="sxs-lookup"><span data-stu-id="46dd7-190">This call is analogous to [FormAuthentication.SetAuthCookie](https://msdn.microsoft.com/library/system.web.security.formsauthentication.setauthcookie.aspx) used by the [FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx) module.</span></span>
2. <span data-ttu-id="46dd7-191">In **Projektmappen-Explorer**, mit der rechten Maustaste in Ihrem Projekt auf **hinzufügen**, und klicken Sie dann **Webformular**.</span><span class="sxs-lookup"><span data-stu-id="46dd7-191">In **Solution Explorer**, right-click your project click **Add**, and then **Web Form**.</span></span> <span data-ttu-id="46dd7-192">Nennen Sie das Web Form **Anmeldung**.</span><span class="sxs-lookup"><span data-stu-id="46dd7-192">Name the web form **Login**.</span></span>  
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image12.png)
3. <span data-ttu-id="46dd7-193">Ersetzen Sie den Inhalt von der *"Login.aspx"* Datei durch den folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="46dd7-193">Replace the contents of the *Login.aspx* file with the following code:</span></span>  

    [!code-aspx[Main](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/samples/sample6.aspx)]
4. <span data-ttu-id="46dd7-194">Ersetzen Sie den Inhalt von der *Login.aspx.cs* Datei durch Folgendes:</span><span class="sxs-lookup"><span data-stu-id="46dd7-194">Replace the contents of the *Login.aspx.cs* file with the following:</span></span>  

    [!code-csharp[Main](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/samples/sample7.cs)]

    > [!NOTE] 
    > 
    > - <span data-ttu-id="46dd7-195">Die `Page_Load` nun den Status des aktuellen Benutzers gesucht und führt die Aktionen, die basierend auf seiner `Context.User.Identity.IsAuthenticated` Status.</span><span class="sxs-lookup"><span data-stu-id="46dd7-195">The `Page_Load` now checks for the status of current user and takes action based on its `Context.User.Identity.IsAuthenticated` status.</span></span>  
    >     <span data-ttu-id="46dd7-196">**Protokolliert in Benutzername angezeigt** : die Microsoft ASP.NET Identity Framework fügte Erweiterungsmethoden auf [System.Security.Principal.IIdentity](https://msdn.microsoft.com/library/system.security.principal.iidentity.aspx) , mit der Sie zum Abrufen der `UserName` und `UserId` für die angemeldeter Benutzer</span><span class="sxs-lookup"><span data-stu-id="46dd7-196">**Display Logged in User Name** : The Microsoft ASP.NET Identity Framework has added extension methods on [System.Security.Principal.IIdentity](https://msdn.microsoft.com/library/system.security.principal.iidentity.aspx) that allows you to get the `UserName` and `UserId`  for the logged in User.</span></span> <span data-ttu-id="46dd7-197">Diese Erweiterungsmethoden werden definiert, der `Microsoft.AspNet.Identity.Core` Assembly.</span><span class="sxs-lookup"><span data-stu-id="46dd7-197">These extension methods are defined in the `Microsoft.AspNet.Identity.Core` assembly.</span></span> <span data-ttu-id="46dd7-198">Diese Erweiterungsmethoden finden sich die Ersetzung für [HttpContext.User.Identity.Name](https://msdn.microsoft.com/library/system.web.httpcontext.user.aspx) .</span><span class="sxs-lookup"><span data-stu-id="46dd7-198">These extension methods are the replacement for [HttpContext.User.Identity.Name](https://msdn.microsoft.com/library/system.web.httpcontext.user.aspx) .</span></span>
    > - <span data-ttu-id="46dd7-199">SignIn-Methode:</span><span class="sxs-lookup"><span data-stu-id="46dd7-199">SignIn method:</span></span>   
    >     <span data-ttu-id="46dd7-200">`This`-Methode ersetzt die vorherige `CreateUser_Click` Methode in diesem Beispiel und nun meldet sich der Benutzer nach der Benutzer erfolgreich erstellt.</span><span class="sxs-lookup"><span data-stu-id="46dd7-200">`This` method replaces the previous `CreateUser_Click` method in this sample and now signs in the user after successfully creating the user.</span></span>   
    >  <span data-ttu-id="46dd7-201">Microsoft owin-Framework fügte Erweiterungsmethoden auf `System.Web.HttpContext` , mit der Sie zum Abrufen eines Verweises auf ein `IOwinContext`.</span><span class="sxs-lookup"><span data-stu-id="46dd7-201">The Microsoft OWIN Framework has added extension methods on `System.Web.HttpContext` that allows you to get a reference to an `IOwinContext`.</span></span> <span data-ttu-id="46dd7-202">Diese Erweiterungsmethoden werden in definiert `Microsoft.Owin.Host.SystemWeb` Assembly.</span><span class="sxs-lookup"><span data-stu-id="46dd7-202">These extension methods are defined in `Microsoft.Owin.Host.SystemWeb` assembly.</span></span> <span data-ttu-id="46dd7-203">Die `OwinContext` Klasse macht ein `IAuthenticationManager` -Eigenschaft, die authentifizierungsmiddlewarefunktionen, die für die aktuelle Anforderung verfügbar darstellt.</span><span class="sxs-lookup"><span data-stu-id="46dd7-203">The `OwinContext` class exposes an `IAuthenticationManager` property that represents the Authentication middleware functionality available on the current request.</span></span>  
    >  <span data-ttu-id="46dd7-204">Sie können sich Benutzer anmelden, mit der `AuthenticationManager` aus aufrufen und OWIN `SignIn` und übergibt die `ClaimsIdentity` wie oben gezeigt.</span><span class="sxs-lookup"><span data-stu-id="46dd7-204">You can sign in the user by using the `AuthenticationManager` from OWIN and calling `SignIn`  and passing in the `ClaimsIdentity`  as shown above.</span></span>   
    >  <span data-ttu-id="46dd7-205">Da ASP.NET Identity und OWIN Cookieauthentifizierung anspruchsbasiertes System befinden, wird das Framework benötigt die app zum Generieren einer `ClaimsIdentity` für den Benutzer.</span><span class="sxs-lookup"><span data-stu-id="46dd7-205">Because ASP.NET Identity and OWIN Cookie Authentication are claims-based system, the framework requires the app to generate a `ClaimsIdentity` for the user.</span></span>   
    >  <span data-ttu-id="46dd7-206">Die `ClaimsIdentity` enthält Informationen über alle Ansprüche für den Benutzer, wie z. B. welche Rollen, die der Benutzer angehört.</span><span class="sxs-lookup"><span data-stu-id="46dd7-206">The `ClaimsIdentity` has information about all the claims for the user, such as what roles the user belongs to.</span></span> <span data-ttu-id="46dd7-207">Sie können auch weitere Ansprüche für den Benutzer zu diesem Zeitpunkt hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="46dd7-207">You can also add more claims for the user at this stage</span></span>  
    >  <span data-ttu-id="46dd7-208">Dieser Code wird der Benutzer anmelden und generieren ebenfalls einen Cookie.</span><span class="sxs-lookup"><span data-stu-id="46dd7-208">This code will sign in the user and generate a cookie as well.</span></span> <span data-ttu-id="46dd7-209">Dieser Aufruf ist analog zu [FormAuthentication.SetAuthCookie](https://msdn.microsoft.com/library/system.web.security.formsauthentication.setauthcookie.aspx) verwendet werden, indem Sie die [FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx) Modul.</span><span class="sxs-lookup"><span data-stu-id="46dd7-209">This call is analogous to [FormAuthentication.SetAuthCookie](https://msdn.microsoft.com/library/system.web.security.formsauthentication.setauthcookie.aspx) used by the [FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx) module.</span></span>
    > - <span data-ttu-id="46dd7-210">`SignOut`Methode:</span><span class="sxs-lookup"><span data-stu-id="46dd7-210">`SignOut` method:</span></span>   
    >  <span data-ttu-id="46dd7-211">Ruft einen Verweis auf die `AuthenticationManager` aus OWIN und Aufrufe `SignOut`.</span><span class="sxs-lookup"><span data-stu-id="46dd7-211">Gets a reference to the `AuthenticationManager` from OWIN and calls `SignOut`.</span></span> <span data-ttu-id="46dd7-212">Dies ist analog zu [FormsAuthentication.SignOut](https://msdn.microsoft.com/library/system.web.security.formsauthentication.signout.aspx) Methode, mit der die [FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx) Modul.</span><span class="sxs-lookup"><span data-stu-id="46dd7-212">This is analogous to [FormsAuthentication.SignOut](https://msdn.microsoft.com/library/system.web.security.formsauthentication.signout.aspx) method used by the [FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx) module.</span></span>
5. <span data-ttu-id="46dd7-213">Drücken Sie **STRG + F5** erstellen und Ausführen der Anwendung.</span><span class="sxs-lookup"><span data-stu-id="46dd7-213">Press **Ctrl + F5** to build and run the web application.</span></span> <span data-ttu-id="46dd7-214">Geben Sie einen neuen Benutzernamen und ein Kennwort, und klicken Sie dann auf **registrieren**.</span><span class="sxs-lookup"><span data-stu-id="46dd7-214">Enter a new user name and password and then click on **Register**.</span></span>  
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image13.png)  
 <span data-ttu-id="46dd7-215">Hinweis: an diesem Punkt der neue Benutzer erstellt und angemeldet.</span><span class="sxs-lookup"><span data-stu-id="46dd7-215">Note: At this point, the new user is created and logged in.</span></span>
6. <span data-ttu-id="46dd7-216">Klicken Sie auf **Abmelden** Schaltfläche. Sie werden in das Protokoll im Formular umgeleitet werden.</span><span class="sxs-lookup"><span data-stu-id="46dd7-216">Click on **Log out** button.You will be redirected to the Log in form.</span></span>
7. <span data-ttu-id="46dd7-217">Geben Sie ein ungültiger Benutzername oder Kennwort und klicken Sie auf **melden Sie sich** Schaltfläche.</span><span class="sxs-lookup"><span data-stu-id="46dd7-217">Enter an invalid user name or password and Click on **Log in** button.</span></span>   
 <span data-ttu-id="46dd7-218">Die `UserManager.Find` Methode Null und die Fehlermeldung zurück: " *Ungültiger Benutzername oder Kennwort* " wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="46dd7-218">The `UserManager.Find`  method will return null and the error message: " *Invalid user name or password* " will be displayed.</span></span>  
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image14.png)
