---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/customizing-the-datalist-s-editing-interface-vb
title: DataList Anpassen der Benutzeroberfläche (VB) bearbeiten | Microsoft Docs
author: rick-anderson
description: In diesem Lernprogramm werden wir eine umfangreichere Bearbeitungsoberfläche für DataList, eine erstellen, die DropDownLists und ein Kontrollkästchen enthält.
ms.author: aspnetcontent
manager: wpickett
ms.date: 10/30/2006
ms.topic: article
ms.assetid: 718628e2-224c-455f-b33a-a41efd48d5a0
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/customizing-the-datalist-s-editing-interface-vb
msc.type: authoredcontent
ms.openlocfilehash: 7fbdb4687a23604b9f505bbf782d59a8c78e5a02
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/06/2018
ms.locfileid: "30884869"
---
<a name="customizing-the-datalists-editing-interface-vb"></a><span data-ttu-id="309e9-103">Anpassen der DataList Bearbeitung der Benutzeroberfläche (VB)</span><span class="sxs-lookup"><span data-stu-id="309e9-103">Customizing the DataList's Editing Interface (VB)</span></span>
====================
<span data-ttu-id="309e9-104">durch [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="309e9-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="309e9-105">[Beispiel-App herunterladen](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_40_VB.exe) oder [PDF herunterladen](customizing-the-datalist-s-editing-interface-vb/_static/datatutorial40vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="309e9-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_40_VB.exe) or [Download PDF](customizing-the-datalist-s-editing-interface-vb/_static/datatutorial40vb1.pdf)</span></span>

> <span data-ttu-id="309e9-106">In diesem Lernprogramm werden wir eine umfangreichere Bearbeitungsoberfläche für DataList, eine erstellen, die DropDownLists und ein Kontrollkästchen enthält.</span><span class="sxs-lookup"><span data-stu-id="309e9-106">In this tutorial we will create a richer editing interface for the DataList, one that includes DropDownLists and a CheckBox.</span></span>


## <a name="introduction"></a><span data-ttu-id="309e9-107">Einführung</span><span class="sxs-lookup"><span data-stu-id="309e9-107">Introduction</span></span>

<span data-ttu-id="309e9-108">Das Markup und Websteuerelementen in DataList s `EditItemTemplate` definieren die bearbeitbare-Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="309e9-108">The markup and Web controls in the DataList s `EditItemTemplate` define its editable interface.</span></span> <span data-ttu-id="309e9-109">In alle bearbeitbaren DataList Beispiele wir Ve untersucht bisher, die bearbeitbare Schnittstelle verfügt über besteht der TextBox-Websteuerelemente wurde.</span><span class="sxs-lookup"><span data-stu-id="309e9-109">In all of the editable DataList examples we ve examined thus far, the editable interface has been composed of TextBox Web controls.</span></span> <span data-ttu-id="309e9-110">In der [vorherigen Lernprogramm](adding-validation-controls-to-the-datalist-s-editing-interface-vb.md) wir verbessert die Bearbeitungszeit Benutzeroberfläche durch Hinzufügen von Steuerelementen für die Validierung.</span><span class="sxs-lookup"><span data-stu-id="309e9-110">In the [preceding tutorial](adding-validation-controls-to-the-datalist-s-editing-interface-vb.md) we improved the edit-time user experience by adding validation controls.</span></span>

<span data-ttu-id="309e9-111">Die `EditItemTemplate` Einbeziehung Websteuerelemente als das Textfeld ein, z. B. DropDownLists RadioButtonList, verwendete Kalender, weiter erweitert werden kann und so weiter.</span><span class="sxs-lookup"><span data-stu-id="309e9-111">The `EditItemTemplate` can be further expanded to include Web controls other than the TextBox, such as DropDownLists, RadioButtonLists, Calendars, and so on.</span></span> <span data-ttu-id="309e9-112">Wie bei der Textfelder, beim Anpassen der Bearbeitung-Schnittstelle, um andere Websteuerelemente enthalten, verwenden Sie die folgenden Schritte aus:</span><span class="sxs-lookup"><span data-stu-id="309e9-112">As with TextBoxes, when customizing the editing interface to include other Web controls, employ the following steps:</span></span>

1. <span data-ttu-id="309e9-113">Fügen Sie das Web-Steuerelement an die `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="309e9-113">Add the Web control to the `EditItemTemplate`.</span></span>
2. <span data-ttu-id="309e9-114">Verwenden Sie Databinding-Syntax, um die entsprechende Eigenschaft den Wert des entsprechenden Datenfelds zuweisen.</span><span class="sxs-lookup"><span data-stu-id="309e9-114">Use databinding syntax to assign the corresponding data field value to the appropriate property.</span></span>
3. <span data-ttu-id="309e9-115">In der `UpdateCommand` Ereignishandler, d. h. programmgesteuerten Zugriff auf das Web steuern Wert, und übergeben Sie ihn an die entsprechende BLL-Methode.</span><span class="sxs-lookup"><span data-stu-id="309e9-115">In the `UpdateCommand` event handler, programmatically access the Web control value and pass it into the appropriate BLL method.</span></span>

<span data-ttu-id="309e9-116">In diesem Lernprogramm werden wir eine umfangreichere Bearbeitungsoberfläche für DataList, eine erstellen, die DropDownLists und ein Kontrollkästchen enthält.</span><span class="sxs-lookup"><span data-stu-id="309e9-116">In this tutorial we will create a richer editing interface for the DataList, one that includes DropDownLists and a CheckBox.</span></span> <span data-ttu-id="309e9-117">Insbesondere erstellen wir eine DataList, die Produktinformationen enthält, und ermöglicht, s, Produktname, Lieferanten, Kategorie und nicht mehr unterstützte Status aktualisiert werden (siehe Abbildung 1).</span><span class="sxs-lookup"><span data-stu-id="309e9-117">In particular, we'll create a DataList that lists product information and permits the product s name, supplier, category, and discontinued status to be updated (see Figure 1).</span></span>


<span data-ttu-id="309e9-118">[![Die Bearbeitungsoberfläche umfasst ein Textfeld, zwei DropDownLists und ein Kontrollkästchen](customizing-the-datalist-s-editing-interface-vb/_static/image2.png)](customizing-the-datalist-s-editing-interface-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="309e9-118">[![The Editing Interface Includes a TextBox, Two DropDownLists, and a CheckBox](customizing-the-datalist-s-editing-interface-vb/_static/image2.png)](customizing-the-datalist-s-editing-interface-vb/_static/image1.png)</span></span>

<span data-ttu-id="309e9-119">**Abbildung 1**: die Schnittstelle bearbeiten umfasst ein Textfeld, zwei DropDownLists und ein Kontrollkästchen ([klicken Sie hier, um das Bild in voller Größe angezeigt](customizing-the-datalist-s-editing-interface-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="309e9-119">**Figure 1**: The Editing Interface Includes a TextBox, Two DropDownLists, and a CheckBox ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image3.png))</span></span>


## <a name="step-1-displaying-product-information"></a><span data-ttu-id="309e9-120">Schritt 1: Anzeigen von Produktinformationen</span><span class="sxs-lookup"><span data-stu-id="309e9-120">Step 1: Displaying Product Information</span></span>

<span data-ttu-id="309e9-121">Bevor wir die bearbeitbare DataList-s-Schnittstelle erstellen können, müssen wir zunächst die schreibgeschützte Schnittstelle zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="309e9-121">Before we can create the DataList s editable interface, we first need to build the read-only interface.</span></span> <span data-ttu-id="309e9-122">Öffnen Sie zunächst die `CustomizedUI.aspx` Seite aus der `EditDeleteDataList` Ordner und Designer fügen Sie einem DataList auf der Seite festlegen seiner `ID` Eigenschaft, um `Products`.</span><span class="sxs-lookup"><span data-stu-id="309e9-122">Start by opening the `CustomizedUI.aspx` page from the `EditDeleteDataList` folder and, from the Designer, add a DataList to the page, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="309e9-123">Erstellen Sie aus den DataList s smart Tag eine neue ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="309e9-123">From the DataList s smart tag, create a new ObjectDataSource.</span></span> <span data-ttu-id="309e9-124">Nennen Sie diese neue ObjectDataSource `ProductsDataSource` und konfigurieren Sie ihn zum Abrufen von Daten aus der `ProductsBLL` Klasse s `GetProducts` Methode.</span><span class="sxs-lookup"><span data-stu-id="309e9-124">Name this new ObjectDataSource `ProductsDataSource` and configure it to retrieve data from the `ProductsBLL` class s `GetProducts` method.</span></span> <span data-ttu-id="309e9-125">Wie werden mit den vorherigen bearbeitbaren DataList-Lernprogrammen, wir die bearbeitete s Produktinformationen aktualisieren er direkt der Geschäftslogikebene.</span><span class="sxs-lookup"><span data-stu-id="309e9-125">As with the previous editable DataList tutorials, we'll update the edited product s information by going directly to the Business Logic Layer.</span></span> <span data-ttu-id="309e9-126">Entsprechend, legen Sie die Dropdownlisten in der Update-, INSERT-, ein, und Löschen von Registerkarten (keine).</span><span class="sxs-lookup"><span data-stu-id="309e9-126">Accordingly, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None).</span></span>


<span data-ttu-id="309e9-127">[![Legen Sie die Update-, INSERT- und DELETE-Registerkarten Dropdown-Listen zu (keine)](customizing-the-datalist-s-editing-interface-vb/_static/image5.png)](customizing-the-datalist-s-editing-interface-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="309e9-127">[![Set the UPDATE, INSERT, and DELETE Tabs Drop-Down Lists to (None)](customizing-the-datalist-s-editing-interface-vb/_static/image5.png)](customizing-the-datalist-s-editing-interface-vb/_static/image4.png)</span></span>

<span data-ttu-id="309e9-128">**Abbildung 2**: aktualisieren, einfügen und Löschen von Registerkarten Dropdownlisten auf (None) festgelegt ([klicken Sie hier, um das Bild in voller Größe angezeigt](customizing-the-datalist-s-editing-interface-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="309e9-128">**Figure 2**: Set the UPDATE, INSERT, and DELETE Tabs Drop-Down Lists to (None) ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image6.png))</span></span>


<span data-ttu-id="309e9-129">Nach dem Konfigurieren der ObjectDataSource, erstellt Visual Studio einen Standard- `ItemTemplate` für DataList mit den Namen und Wert für die einzelnen Datenfelder zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="309e9-129">After configuring the ObjectDataSource, Visual Studio will create a default `ItemTemplate` for the DataList that lists the name and value for each of the data fields returned.</span></span> <span data-ttu-id="309e9-130">Ändern der `ItemTemplate` so, dass die Vorlage, den Produktnamen in auflistet einer `<h4>` -Elements zusammen mit den Kategorienamen, Lieferantenname, Preis und nicht mehr unterstützte Status.</span><span class="sxs-lookup"><span data-stu-id="309e9-130">Modify the `ItemTemplate` so that the template lists the product name in an `<h4>` element along with the category name, supplier name, price, and discontinued status.</span></span> <span data-ttu-id="309e9-131">Darüber hinaus fügen Sie eine Schaltfläche "Bearbeiten", sicherstellen, dass seine `CommandName` Eigenschaftensatz zu bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="309e9-131">Moreover, add an Edit button, making sure that its `CommandName` property is set to Edit.</span></span> <span data-ttu-id="309e9-132">Das deklarative Markup für meine `ItemTemplate` folgt:</span><span class="sxs-lookup"><span data-stu-id="309e9-132">The declarative markup for my `ItemTemplate` follows:</span></span>


[!code-aspx[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample1.aspx)]

<span data-ttu-id="309e9-133">Angeordnet, dass die oben genannten Markup das Produkt mit einer &lt;h4&gt; Überschrift für den Produktnamen s und eine vierspaltige `<table>` für die verbleibenden Felder.</span><span class="sxs-lookup"><span data-stu-id="309e9-133">The above markup lays out the product information using an &lt;h4&gt; heading for the product s name and a four-column `<table>` for the remaining fields.</span></span> <span data-ttu-id="309e9-134">Die `ProductPropertyLabel` und `ProductPropertyValue` in definierten CSS-Klassen `Styles.css`, haben im vorherigen Lernprogrammen erläutert wurde.</span><span class="sxs-lookup"><span data-stu-id="309e9-134">The `ProductPropertyLabel` and `ProductPropertyValue` CSS classes, defined in `Styles.css`, have been discussed in previous tutorials.</span></span> <span data-ttu-id="309e9-135">Abbildung 3 zeigt unseren Fortschritt, wenn Sie über einen Browser angezeigt.</span><span class="sxs-lookup"><span data-stu-id="309e9-135">Figure 3 shows our progress when viewed through a browser.</span></span>


<span data-ttu-id="309e9-136">[![Der Name, Lieferanten, Kategorie, Status nicht mehr unterstützt und Preis jedes Produkt wird angezeigt.](customizing-the-datalist-s-editing-interface-vb/_static/image8.png)](customizing-the-datalist-s-editing-interface-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="309e9-136">[![The Name, Supplier, Category, Discontinued Status, and Price of Each Product is Displayed](customizing-the-datalist-s-editing-interface-vb/_static/image8.png)](customizing-the-datalist-s-editing-interface-vb/_static/image7.png)</span></span>

<span data-ttu-id="309e9-137">**Abbildung 3**: der Name, Lieferanten, Kategorie, Status nicht mehr unterstützt und Preis jedes Produkt wird angezeigt ([klicken Sie hier, um das Bild in voller Größe angezeigt](customizing-the-datalist-s-editing-interface-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="309e9-137">**Figure 3**: The Name, Supplier, Category, Discontinued Status, and Price of Each Product is Displayed ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image9.png))</span></span>


## <a name="step-2-adding-the-web-controls-to-the-editing-interface"></a><span data-ttu-id="309e9-138">Schritt 2: Hinzufügen der Websteuerelemente, die Bearbeitungsoberfläche</span><span class="sxs-lookup"><span data-stu-id="309e9-138">Step 2: Adding the Web Controls to the Editing Interface</span></span>

<span data-ttu-id="309e9-139">Der erste Schritt beim Erstellen von benutzerdefinierten DataList Bearbeitungsoberfläche der erforderlichen Websteuerelemente hinzugefügt wird die `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="309e9-139">The first step in building the customized DataList editing interface is to add the needed Web controls to the `EditItemTemplate`.</span></span> <span data-ttu-id="309e9-140">Insbesondere benötigen wir eine DropDownList für die Kategorie, eine andere für den Lieferanten und ein Kontrollkästchen für den Status nicht mehr unterstützte.</span><span class="sxs-lookup"><span data-stu-id="309e9-140">In particular, we need a DropDownList for the category, another for the supplier, and a CheckBox for the discontinued state.</span></span> <span data-ttu-id="309e9-141">Seit der Produktpreis s nicht bearbeitet werden, in diesem Beispiel ist, können wir weiterhin die Anzeige mit einem Label-Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="309e9-141">Since the product s price is not editable in this example, we can continue displaying it using a Label Web control.</span></span>

<span data-ttu-id="309e9-142">Um die Bearbeitungsoberfläche anzupassen, klicken Sie auf die Verknüpfung Vorlagen bearbeiten das DataList-s-Smarttag, und wählen Sie die `EditItemTemplate` Option aus der Dropdown-Liste.</span><span class="sxs-lookup"><span data-stu-id="309e9-142">To customize the editing interface, click on the Edit Templates link from the DataList s smart tag and choose the `EditItemTemplate` option from the drop-down list.</span></span> <span data-ttu-id="309e9-143">Hinzufügen eine DropDownList auf die `EditItemTemplate` und legen Sie seine `ID` auf `Categories`.</span><span class="sxs-lookup"><span data-stu-id="309e9-143">Add a DropDownList to the `EditItemTemplate` and set its `ID` to `Categories`.</span></span>


<span data-ttu-id="309e9-144">[![DropDownList für die Kategorien hinzufügen](customizing-the-datalist-s-editing-interface-vb/_static/image11.png)](customizing-the-datalist-s-editing-interface-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="309e9-144">[![Add a DropDownList for the Categories](customizing-the-datalist-s-editing-interface-vb/_static/image11.png)](customizing-the-datalist-s-editing-interface-vb/_static/image10.png)</span></span>

<span data-ttu-id="309e9-145">**Abbildung 4**: hinzufügen eine DropDownList für die Kategorien ([klicken Sie hier, um das Bild in voller Größe angezeigt](customizing-the-datalist-s-editing-interface-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="309e9-145">**Figure 4**: Add a DropDownList for the Categories ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image12.png))</span></span>


<span data-ttu-id="309e9-146">Als Nächstes aus den DropDownList s smart Tag, die Option Datenquelle auswählen und erstellen Sie eine neue ObjectDataSource mit dem Namen `CategoriesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="309e9-146">Next, from the DropDownList s smart tag, select the Choose Data Source option and create a new ObjectDataSource named `CategoriesDataSource`.</span></span> <span data-ttu-id="309e9-147">Konfigurieren Sie diese ObjectDataSource verwenden die `CategoriesBLL` Klasse s `GetCategories()` Methode (siehe Abbildung 5).</span><span class="sxs-lookup"><span data-stu-id="309e9-147">Configure this ObjectDataSource to use the `CategoriesBLL` class s `GetCategories()` method (see Figure 5).</span></span> <span data-ttu-id="309e9-148">Im nächsten Schritt der DropDownList s Datenquellen Konfigurations-Assistenten für die Datenfelder für jeden fordert `ListItem` s `Text` und `Value` Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="309e9-148">Next, the DropDownList s Data Source Configuration Wizard prompts for the data fields to use for each `ListItem` s `Text` and `Value` properties.</span></span> <span data-ttu-id="309e9-149">Haben Sie die Anzeige der DropDownList der `CategoryName` Feld "Daten" und die Verwendung der `CategoryID` als Wert an, wie in Abbildung 6 veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="309e9-149">Have the DropDownList display the `CategoryName` data field and use the `CategoryID` as the value, as shown in Figure 6.</span></span>


<span data-ttu-id="309e9-150">[![Erstellen Sie eine neue, mit dem Namen CategoriesDataSource ObjectDataSource](customizing-the-datalist-s-editing-interface-vb/_static/image14.png)](customizing-the-datalist-s-editing-interface-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="309e9-150">[![Create a New ObjectDataSource Named CategoriesDataSource](customizing-the-datalist-s-editing-interface-vb/_static/image14.png)](customizing-the-datalist-s-editing-interface-vb/_static/image13.png)</span></span>

<span data-ttu-id="309e9-151">**Abbildung 5**: Erstellen einer neuen ObjectDataSource namens `CategoriesDataSource` ([klicken Sie hier, um das Bild in voller Größe angezeigt](customizing-the-datalist-s-editing-interface-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="309e9-151">**Figure 5**: Create a New ObjectDataSource Named `CategoriesDataSource` ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image15.png))</span></span>


<span data-ttu-id="309e9-152">[![Konfigurieren Sie die Anzeige der DropDownList-s und der Wert von Feldern](customizing-the-datalist-s-editing-interface-vb/_static/image17.png)](customizing-the-datalist-s-editing-interface-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="309e9-152">[![Configure the DropDownList s Display and Value Fields](customizing-the-datalist-s-editing-interface-vb/_static/image17.png)](customizing-the-datalist-s-editing-interface-vb/_static/image16.png)</span></span>

<span data-ttu-id="309e9-153">**Abbildung 6**: Konfigurieren der DropDownList s anzeigen und Feldern ([klicken Sie hier, um das Bild in voller Größe angezeigt](customizing-the-datalist-s-editing-interface-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="309e9-153">**Figure 6**: Configure the DropDownList s Display and Value Fields ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image18.png))</span></span>


<span data-ttu-id="309e9-154">Wiederholen Sie diese Abfolge der Schritte zum Erstellen einer DropDownList für die Lieferanten.</span><span class="sxs-lookup"><span data-stu-id="309e9-154">Repeat this series of steps to create a DropDownList for the suppliers.</span></span> <span data-ttu-id="309e9-155">Legen Sie die `ID` für diese DropDownList zum `Suppliers` und nennen Sie die ObjectDataSource `SuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="309e9-155">Set the `ID` for this DropDownList to `Suppliers` and name its ObjectDataSource `SuppliersDataSource`.</span></span>

<span data-ttu-id="309e9-156">Nach dem Hinzufügen der zwei DropDownLists, fügen Sie ein Kontrollkästchen für die nicht mehr unterstützte Status und ein Textfeld für den Namen des Produkts s hinzu.</span><span class="sxs-lookup"><span data-stu-id="309e9-156">After adding the two DropDownLists, add a CheckBox for the discontinued state and a TextBox for the product s name.</span></span> <span data-ttu-id="309e9-157">Legen Sie die `ID` s für die Kontrollkästchen und ein Textfeld `Discontinued` und `ProductName`bzw.</span><span class="sxs-lookup"><span data-stu-id="309e9-157">Set the `ID` s for the CheckBox and TextBox to `Discontinued` and `ProductName`, respectively.</span></span> <span data-ttu-id="309e9-158">Fügen Sie einen RequiredFieldValidator, um sicherzustellen, dass der Benutzer einen Wert für den Produktnamen s bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="309e9-158">Add a RequiredFieldValidator to ensure that the user provides a value for the product s name.</span></span>

<span data-ttu-id="309e9-159">Abschließend fügen Sie die Schaltflächen Aktualisieren und "Abbrechen".</span><span class="sxs-lookup"><span data-stu-id="309e9-159">Lastly, add the Update and Cancel buttons.</span></span> <span data-ttu-id="309e9-160">Denken Sie daran, dass dieser beiden Schaltflächen unbedingt darauf, ihre `CommandName` Eigenschaften werden festgelegt, zu aktualisieren und bzw. "Abbrechen".</span><span class="sxs-lookup"><span data-stu-id="309e9-160">Remember that for these two buttons it is imperative that their `CommandName` properties are set to Update and Cancel, respectively.</span></span>

<span data-ttu-id="309e9-161">Wahlweise können Sie die Bearbeitungsoberfläche jedoch beliebig anordnen.</span><span class="sxs-lookup"><span data-stu-id="309e9-161">Feel free to lay out the editing interface however you like.</span></span> <span data-ttu-id="309e9-162">Ich Ve festgelegt haben, dass der gleiche vierspaltige `<table>` Layout aus der schreibgeschützte Schnittstelle als die folgende deklarative Syntax und Screenshot veranschaulicht:</span><span class="sxs-lookup"><span data-stu-id="309e9-162">I ve opted to use the same four-column `<table>` layout from the read-only interface, as the following declarative syntax and screen shot illustrates:</span></span>


[!code-aspx[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample2.aspx)]


<span data-ttu-id="309e9-163">[![Die Schnittstelle bearbeiten wird angeordnet, wie die Read-Only-Schnittstelle](customizing-the-datalist-s-editing-interface-vb/_static/image20.png)](customizing-the-datalist-s-editing-interface-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="309e9-163">[![The Editing Interface is Laid Out like the Read-Only Interface](customizing-the-datalist-s-editing-interface-vb/_static/image20.png)](customizing-the-datalist-s-editing-interface-vb/_static/image19.png)</span></span>

<span data-ttu-id="309e9-164">**Abbildung 7**: die Bearbeitung-Schnittstelle wird festgelegt, wie die Read-Only-Schnittstelle ([klicken Sie hier, um das Bild in voller Größe angezeigt](customizing-the-datalist-s-editing-interface-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="309e9-164">**Figure 7**: The Editing Interface is Laid Out like the Read-Only Interface ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image21.png))</span></span>


## <a name="step-3-creating-the-editcommand-and-cancelcommand-event-handlers"></a><span data-ttu-id="309e9-165">Schritt 3: Erstellen der EditCommand und CancelCommand-Ereignishandler</span><span class="sxs-lookup"><span data-stu-id="309e9-165">Step 3: Creating the EditCommand and CancelCommand Event Handlers</span></span>

<span data-ttu-id="309e9-166">Derzeit ist keine Databinding-Syntax in der `EditItemTemplate` (mit Ausnahme der `UnitPriceLabel`, die kopiert wurde über wörtlich der `ItemTemplate`).</span><span class="sxs-lookup"><span data-stu-id="309e9-166">Currently, there is no databinding syntax in the `EditItemTemplate` (except for the `UnitPriceLabel`, which was copied over verbatim from the `ItemTemplate`).</span></span> <span data-ttu-id="309e9-167">Diese wird vorübergehend die Databinding-Syntax hinzugefügt, aber erste Let s erstellen die Ereignishandler für das DataList s `EditCommand` und `CancelCommand` Ereignisse.</span><span class="sxs-lookup"><span data-stu-id="309e9-167">We'll add the databinding syntax momentarily, but first let s create the event handlers for the DataList s `EditCommand` and `CancelCommand` events.</span></span> <span data-ttu-id="309e9-168">Bedenken Sie, dass die Zuständigkeit für die `EditCommand` wird der Ereignishandler für das DataList-Element, dessen Schaltfläche "Bearbeiten" geklickt wurde, die Bearbeitungsoberfläche zu rendern, während die `CancelCommand` s Auftrag zurückzugebenden DataList Datenbankzustands vorab Bearbeitung ist.</span><span class="sxs-lookup"><span data-stu-id="309e9-168">Recall that the responsibility of the `EditCommand` event handler is to render the editing interface for the DataList item whose Edit button was clicked, whereas the `CancelCommand` s job is to return the DataList to its pre-editing state.</span></span>

<span data-ttu-id="309e9-169">Erstellen Sie diese zwei Ereignishandler, und bitten Sie, den folgenden Code verwenden:</span><span class="sxs-lookup"><span data-stu-id="309e9-169">Create these two event handlers and have them use the following code:</span></span>


[!code-vb[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample3.vb)]

<span data-ttu-id="309e9-170">Mit diesen zwei Ereignishandler eingerichtet ist, die Sie auf die Schaltfläche "Bearbeiten" zeigt die Benutzeroberfläche für die Bearbeitung, und klicken auf die Schaltfläche "Abbrechen", die nur-Lese-Modus gibt das bearbeitete Element zurück.</span><span class="sxs-lookup"><span data-stu-id="309e9-170">With these two event handlers in place, clicking the Edit button displays the editing interface and clicking the Cancel button returns the edited item to its read-only mode.</span></span> <span data-ttu-id="309e9-171">Abbildung 8 zeigt die DataList, nachdem auf die Schaltfläche "Bearbeiten" für Chef Anton s Gumbo Mix geklickt wurde.</span><span class="sxs-lookup"><span data-stu-id="309e9-171">Figure 8 shows the DataList after the Edit button has been clicked for Chef Anton s Gumbo Mix.</span></span> <span data-ttu-id="309e9-172">Seit wir Ve noch hinzuzufügende jede Databinding-Syntax, die Bearbeitungsoberfläche der `ProductName` Textfeld ist leer, die `Discontinued` Kontrollkästchen deaktiviert, und die ersten Elemente ausgewählt werden, aus der `Categories` und `Suppliers` DropDownLists.</span><span class="sxs-lookup"><span data-stu-id="309e9-172">Since we ve yet to add any databinding syntax to the editing interface, the `ProductName` TextBox is blank, the `Discontinued` CheckBox unchecked, and the first items selected from the `Categories` and `Suppliers` DropDownLists.</span></span>


<span data-ttu-id="309e9-173">[![Durch Klicken auf die Bearbeiten Schaltfläche angezeigt, die Bearbeitungsoberfläche](customizing-the-datalist-s-editing-interface-vb/_static/image23.png)](customizing-the-datalist-s-editing-interface-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="309e9-173">[![Clicking the Edit Button Displays the Editing Interface](customizing-the-datalist-s-editing-interface-vb/_static/image23.png)](customizing-the-datalist-s-editing-interface-vb/_static/image22.png)</span></span>

<span data-ttu-id="309e9-174">**Abbildung 8**: auf die Schaltfläche "Bearbeiten" zeigt die Benutzeroberfläche für die Bearbeitung ([klicken Sie hier, um das Bild in voller Größe angezeigt](customizing-the-datalist-s-editing-interface-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="309e9-174">**Figure 8**: Clicking the Edit Button Displays the Editing Interface ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image24.png))</span></span>


## <a name="step-4-adding-the-databinding-syntax-to-the-editing-interface"></a><span data-ttu-id="309e9-175">Schritt 4: Hinzufügen der DataBinding-Syntax, die Bearbeitungsoberfläche</span><span class="sxs-lookup"><span data-stu-id="309e9-175">Step 4: Adding the DataBinding Syntax to the Editing Interface</span></span>

<span data-ttu-id="309e9-176">Um die Anzeige der aktuellen Werte der Product-s Bearbeitungsoberfläche haben, müssen wir Databinding-Syntax verwenden, um die entsprechenden Web Steuerelementwerte Datenfeldwerte zuweisen.</span><span class="sxs-lookup"><span data-stu-id="309e9-176">To have the editing interface display the current product s values, we need to use databinding syntax to assign the data field values to the appropriate Web control values.</span></span> <span data-ttu-id="309e9-177">Die Databinding-Syntax kann mithilfe des Designers angewendet werden, gehen Sie auf dem Bildschirm Vorlagen bearbeiten und Smarttags steuert die Link-Datenbindungen bearbeiten aus dem Web auswählen.</span><span class="sxs-lookup"><span data-stu-id="309e9-177">The databinding syntax can be applied through the Designer by going to the Edit Templates screen and selecting the Edit DataBindings link from the Web controls smart tags.</span></span> <span data-ttu-id="309e9-178">Alternativ kann die Databinding-Syntax direkt mit deklarativem Markup hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="309e9-178">Alternatively, the databinding syntax can be added directly to the declarative markup.</span></span>

<span data-ttu-id="309e9-179">Zuweisen der `ProductName` Datenfeld der Spalte Wert der `ProductName` Textfeld s `Text` -Eigenschaft, die `CategoryID` und `SupplierID` Datenfeld der Spalte Werte die `Categories` und `Suppliers` DropDownLists `SelectedValue` Eigenschaften, und die `Discontinued` Datenfeld der Spalte Wert der `Discontinued` Kontrollkästchen s `Checked` Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="309e9-179">Assign the `ProductName` data field value to the `ProductName` TextBox s `Text` property, the `CategoryID` and `SupplierID` data field values to the `Categories` and `Suppliers` DropDownLists `SelectedValue` properties, and the `Discontinued` data field value to the `Discontinued` CheckBox s `Checked` property.</span></span> <span data-ttu-id="309e9-180">Rufen Sie nach diesen Änderungen, durch den Designer oder direkt über die deklaratives Markup erneut auf der Seite über einen Browser, und klicken Sie auf die Schaltfläche "Bearbeiten" für Chef Anton s Gumbo Mix.</span><span class="sxs-lookup"><span data-stu-id="309e9-180">After making these changes, either through the Designer or directly through the declarative markup, revisit the page through a browser and click the Edit button for Chef Anton s Gumbo Mix.</span></span> <span data-ttu-id="309e9-181">Wie in Abbildung 9 gezeigt, wurde die Databinding-Syntax die aktuellen Werte in das Textfeld, DropDownLists und Kontrollkästchen hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="309e9-181">As Figure 9 shows, the databinding syntax has added the current values into the TextBox, DropDownLists, and CheckBox.</span></span>


<span data-ttu-id="309e9-182">[![Durch Klicken auf die Bearbeiten Schaltfläche angezeigt, die Bearbeitungsoberfläche](customizing-the-datalist-s-editing-interface-vb/_static/image26.png)](customizing-the-datalist-s-editing-interface-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="309e9-182">[![Clicking the Edit Button Displays the Editing Interface](customizing-the-datalist-s-editing-interface-vb/_static/image26.png)](customizing-the-datalist-s-editing-interface-vb/_static/image25.png)</span></span>

<span data-ttu-id="309e9-183">**Abbildung 9**: auf die Schaltfläche "Bearbeiten" zeigt die Benutzeroberfläche für die Bearbeitung ([klicken Sie hier, um das Bild in voller Größe angezeigt](customizing-the-datalist-s-editing-interface-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="309e9-183">**Figure 9**: Clicking the Edit Button Displays the Editing Interface ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image27.png))</span></span>


## <a name="step-5-saving-the-user-s-changes-in-the-updatecommand-event-handler"></a><span data-ttu-id="309e9-184">Schritt 5: Speichern der Benutzer-s-Änderungen in die UpdateCommand-Ereignishandler</span><span class="sxs-lookup"><span data-stu-id="309e9-184">Step 5: Saving the User s Changes in the UpdateCommand Event Handler</span></span>

<span data-ttu-id="309e9-185">Wenn der Benutzer ein Produkt bearbeitet und klickt auf die Schaltfläche "Aktualisieren" ein Postback erfolgt und die DataList s `UpdateCommand` -Ereignis ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="309e9-185">When the user edits a product and clicks the Update button, a postback occurs and the DataList s `UpdateCommand` event fires.</span></span> <span data-ttu-id="309e9-186">Im Ereignis-Handler müssen, lesen die Werte aus den Websteuerelementen in die `EditItemTemplate` und Schnittstelle mit der BLL, um das Produkt in der Datenbank zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="309e9-186">In the event handler, we need to read the values from the Web controls in the `EditItemTemplate` and interface with the BLL to update the product in the database.</span></span> <span data-ttu-id="309e9-187">Sobald gibt es im vorherigen Lernprogrammen betrachtet die `ProductID` des aktualisierten Produkts Zugriff erfolgt über die `DataKeys` Auflistung.</span><span class="sxs-lookup"><span data-stu-id="309e9-187">As we ve seen in previous tutorials, the `ProductID` of the updated product is accessible through the `DataKeys` collection.</span></span> <span data-ttu-id="309e9-188">Die Felder eingegebenen erfolgt durch Programmgesteuertes Verweisen auf die Web-Steuerelemente, die unter Verwendung `FindControl("controlID")`, wie der folgende Code zeigt:</span><span class="sxs-lookup"><span data-stu-id="309e9-188">The user-entered fields are accessed by programmatically referencing the Web controls using `FindControl("controlID")`, as the following code shows:</span></span>


[!code-vb[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample4.vb)]

<span data-ttu-id="309e9-189">Der Code durch consulting beginnt die `Page.IsValid` Eigenschaft, um sicherzustellen, dass alle Validierungssteuerelemente auf der Seite gültig sind.</span><span class="sxs-lookup"><span data-stu-id="309e9-189">The code starts out by consulting the `Page.IsValid` property to ensure that all the validation controls on the page are valid.</span></span> <span data-ttu-id="309e9-190">Wenn `Page.IsValid` ist `True`, das bearbeitete Produkt s `ProductID` Wert aus der gelesen wird die `DataKeys` Auflistung und die Dateneingabe, in websteuerungselemente der `EditItemTemplate` programmgesteuert auf die verwiesen wird.</span><span class="sxs-lookup"><span data-stu-id="309e9-190">If `Page.IsValid` is `True`, the edited product s `ProductID` value is read from the `DataKeys` collection and the data entry Web controls in the `EditItemTemplate` are programmatically referenced.</span></span> <span data-ttu-id="309e9-191">Als Nächstes werden die Werte aus dieser Web-Steuerelemente in Variablen, die dann in die entsprechenden übergeben werden gelesen `UpdateProduct` überladen.</span><span class="sxs-lookup"><span data-stu-id="309e9-191">Next, the values from these Web controls are read into variables that are then passed into the appropriate `UpdateProduct` overload.</span></span> <span data-ttu-id="309e9-192">Nach dem Aktualisieren der Daten, wird das DataList Datenbankzustands vorab Bearbeitung zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="309e9-192">After updating the data, the DataList is returned to its pre-editing state.</span></span>

> [!NOTE]
> <span data-ttu-id="309e9-193">Ich Ve weggelassen, die Ausnahmebehandlung Logik hinzugefügt, der [Behandlung von BLL- und DAL-Ebene Ausnahmen](handling-bll-and-dal-level-exceptions-vb.md) Lernprogramm, damit der Code und in diesem Beispiel bleibt mit Fokus.</span><span class="sxs-lookup"><span data-stu-id="309e9-193">I ve omitted the exception handling logic added in the [Handling BLL- and DAL-Level Exceptions](handling-bll-and-dal-level-exceptions-vb.md) tutorial in order to keep the code and this example focused.</span></span> <span data-ttu-id="309e9-194">Als Übung fügen Sie nach Abschluss dieses Lernprogramms diese Funktionen hinzu.</span><span class="sxs-lookup"><span data-stu-id="309e9-194">As an exercise, add this functionality after completing this tutorial.</span></span>


## <a name="step-6-handling-null-categoryid-and-supplierid-values"></a><span data-ttu-id="309e9-195">Schritt 6: Behandeln von NULL CategoryID und SupplierID Werte</span><span class="sxs-lookup"><span data-stu-id="309e9-195">Step 6: Handling NULL CategoryID and SupplierID Values</span></span>

<span data-ttu-id="309e9-196">Die Northwind-Datenbank kann für `NULL` Werte für die `Products` Tabelle s `CategoryID` und `SupplierID` Spalten.</span><span class="sxs-lookup"><span data-stu-id="309e9-196">The Northwind database allows for `NULL` values for the `Products` table s `CategoryID` and `SupplierID` columns.</span></span> <span data-ttu-id="309e9-197">Unsere Bearbeitung Schnittstelle verfügt über t jedoch derzeit aufzunehmen `NULL` Werte.</span><span class="sxs-lookup"><span data-stu-id="309e9-197">However, our editing interface doesn t currently accommodate `NULL` values.</span></span> <span data-ttu-id="309e9-198">Wenn Sie versuchen, ein Produkt zu bearbeiten, verfügt ein `NULL` Wert entweder seine `CategoryID` oder `SupplierID` Spalten, wir kommen ein `ArgumentOutOfRangeException` mit einer Fehlermeldung ähnelt: *"Kategorien" hat eine "SelectedValue" ungültig ist, da dies der Fall ist in der Liste der Elemente nicht vorhanden.*</span><span class="sxs-lookup"><span data-stu-id="309e9-198">If we attempt to edit a product that has a `NULL` value for either its `CategoryID` or `SupplierID` columns, we'll get an `ArgumentOutOfRangeException` with an error message similar to: *'Categories' has a SelectedValue which is invalid because it does not exist in the list of items.*</span></span> <span data-ttu-id="309e9-199">Darüber hinaus dort s derzeit keine Möglichkeit, eine Produktkategorie s oder-Lieferanten in Verbindung ändern Wert aus einem nicht-`NULL` -Wert an ein `NULL` eine.</span><span class="sxs-lookup"><span data-stu-id="309e9-199">Also, there s currently no way to change a product s category or supplier value from a non-`NULL` value to a `NULL` one.</span></span>

<span data-ttu-id="309e9-200">Zur Unterstützung `NULL` Werte für die Kategorie und Lieferanten DropDownLists, müssen wir eine zusätzliche hinzufügen `ListItem`.</span><span class="sxs-lookup"><span data-stu-id="309e9-200">To support `NULL` values for the category and supplier DropDownLists, we need to add an additional `ListItem`.</span></span> <span data-ttu-id="309e9-201">Ich Ve (keine) als verwenden möchten die `Text` Wert für diesen `ListItem`, aber Sie können sie etwas anderes (z. B. eine leere Zeichenfolge) ändern, wenn d gewünscht.</span><span class="sxs-lookup"><span data-stu-id="309e9-201">I ve chosen to use (None) as the `Text` value for this `ListItem`, but you can change it to something else (such as an empty string) if you d like.</span></span> <span data-ttu-id="309e9-202">Schließlich müssen, legen Sie die DropDownLists `AppendDataBoundItems` auf `True`; Wenn Sie vergessen, die Kategorien dazu und Lieferanten, die an der DropDownList gebunden, die statisch hinzugefügt überschrieben werden `ListItem`.</span><span class="sxs-lookup"><span data-stu-id="309e9-202">Finally, remember to set the DropDownLists `AppendDataBoundItems` to `True`; if you forget to do so, the categories and suppliers bound to the DropDownList will overwrite the statically-added `ListItem`.</span></span>

<span data-ttu-id="309e9-203">Nach diesen Änderungen, das Markup DropDownLists im DataList s `EditItemTemplate` sollte etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="309e9-203">After making these changes, the DropDownLists markup in the DataList s `EditItemTemplate` should look similar to the following:</span></span>


[!code-aspx[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample5.aspx)]

> [!NOTE]
> <span data-ttu-id="309e9-204">Statische `ListItem` s DropDownList mithilfe des Designers oder direkt über die deklarative Syntax hinzugefügt werden kann.</span><span class="sxs-lookup"><span data-stu-id="309e9-204">Static `ListItem` s can be added to a DropDownList through the Designer or directly through the declarative syntax.</span></span> <span data-ttu-id="309e9-205">Beim Hinzufügen einer DropDownList-Element zur Darstellung einer Datenbank `NULL` Wert, achten Sie darauf, dass Sie zum Hinzufügen der `ListItem` über die deklarative Syntax.</span><span class="sxs-lookup"><span data-stu-id="309e9-205">When adding a DropDownList item to represent a database `NULL` value, be sure to add the `ListItem` through the declarative syntax.</span></span> <span data-ttu-id="309e9-206">Bei Verwendung der `ListItem` Auflistungs-Editor im Designer die generierten deklarative Syntax wird weglassen der `Value` Einstellung ganz, wenn eine leere Zeichenfolge, und Erstellen von deklarativem Markup wie zugewiesen: `<asp:ListItem>(None)</asp:ListItem>`.</span><span class="sxs-lookup"><span data-stu-id="309e9-206">If you use the `ListItem` Collection Editor in the Designer, the generated declarative syntax will omit the `Value` setting altogether when assigned a blank string, creating declarative markup like: `<asp:ListItem>(None)</asp:ListItem>`.</span></span> <span data-ttu-id="309e9-207">Während dies ungefährlich, suchen Sie möglicherweise die fehlende `Value` bewirkt, dass der DropDownList zum Verwenden der `Text` Eigenschaftswert an seiner Stelle.</span><span class="sxs-lookup"><span data-stu-id="309e9-207">While this may look harmless, the missing `Value` causes the DropDownList to use the `Text` property value in its place.</span></span> <span data-ttu-id="309e9-208">Das bedeutet, dass bei dieser `NULL` `ListItem` ist ausgewählt, der Wert (None) versucht, das Daten-Feld "Product" zugewiesen werden soll (`CategoryID` oder `SupplierID`, in diesem Lernprogramm), was zu einer Ausnahme führt.</span><span class="sxs-lookup"><span data-stu-id="309e9-208">That means that if this `NULL` `ListItem` is selected, the value (None) will be attempted to be assigned to the product data field (`CategoryID` or `SupplierID`, in this tutorial), which will result in an exception.</span></span> <span data-ttu-id="309e9-209">Durch das explizite Festlegen `Value=""`, `NULL` Wert zugewiesen wird, das Produkt Datenfeld der Spalte bei der `NULL` `ListItem` ausgewählt ist.</span><span class="sxs-lookup"><span data-stu-id="309e9-209">By explicitly setting `Value=""`, a `NULL` value will be assigned to the product data field when the `NULL` `ListItem` is selected.</span></span>


<span data-ttu-id="309e9-210">Nehmen Sie einen Moment Zeit, um unseren Fortschritt über einen Browser anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="309e9-210">Take a moment to view our progress through a browser.</span></span> <span data-ttu-id="309e9-211">Wenn Sie ein Produkt zu bearbeiten, beachten Sie, dass die `Categories` und `Suppliers` DropDownLists beide haben (keine) die Option am Anfang der DropDownList.</span><span class="sxs-lookup"><span data-stu-id="309e9-211">When editing a product, note that the `Categories` and `Suppliers` DropDownLists both have a (None) option at the start of the DropDownList.</span></span>


<span data-ttu-id="309e9-212">[![Die Kategorien und Lieferanten DropDownLists enthalten Option (None)](customizing-the-datalist-s-editing-interface-vb/_static/image29.png)](customizing-the-datalist-s-editing-interface-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="309e9-212">[![The Categories and Suppliers DropDownLists include a (None) Option](customizing-the-datalist-s-editing-interface-vb/_static/image29.png)](customizing-the-datalist-s-editing-interface-vb/_static/image28.png)</span></span>

<span data-ttu-id="309e9-213">**Abbildung 10**: die `Categories` und `Suppliers` DropDownLists enthalten, Option (None) ([klicken Sie hier, um das Bild in voller Größe angezeigt](customizing-the-datalist-s-editing-interface-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="309e9-213">**Figure 10**: The `Categories` and `Suppliers` DropDownLists include a (None) Option ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image30.png))</span></span>


<span data-ttu-id="309e9-214">Speichern (keine) als Datenbank option `NULL` -Wert, die wir zur zurückkehren müssen die `UpdateCommand` -Ereignishandler.</span><span class="sxs-lookup"><span data-stu-id="309e9-214">To save the (None) option as a database `NULL` value, we need to return to the `UpdateCommand` event handler.</span></span> <span data-ttu-id="309e9-215">Ändern der `categoryIDValue` und `supplierIDValue` Variablen, die NULL-Werte zulassen ganze Zahlen sein, und weisen sie einen Wert außer `Nothing` nur, wenn der DropDownList s `SelectedValue` ist eine leere Zeichenfolge:</span><span class="sxs-lookup"><span data-stu-id="309e9-215">Change the `categoryIDValue` and `supplierIDValue` variables to be nullable integers and assign them a value other than `Nothing` only if the DropDownList s `SelectedValue` is not an empty string:</span></span>


[!code-vb[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample6.vb)]

<span data-ttu-id="309e9-216">Durch diese Änderung Wert `Nothing` übergebenen werden die `UpdateProduct` BLL-Methode, wenn der Benutzer ausgewählt (keine) aus der Dropdown-Listen, die entspricht option eine `NULL` Datenbank-Wert.</span><span class="sxs-lookup"><span data-stu-id="309e9-216">With this change, a value of `Nothing` will be passed into the `UpdateProduct` BLL method if the user selected the (None) option from either of the drop-down lists, which corresponds to a `NULL` database value.</span></span>

## <a name="summary"></a><span data-ttu-id="309e9-217">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="309e9-217">Summary</span></span>

<span data-ttu-id="309e9-218">In diesem Lernprogramm wurde erläutert, wie Sie eine komplexere Bearbeitung DataList-Benutzeroberfläche zu erstellen, die drei verschiedenen Web Eingabesteuerelemente ein Textfeld, zwei DropDownLists und ein Kontrollkästchen zusammen mit Validierungssteuerelemente enthalten.</span><span class="sxs-lookup"><span data-stu-id="309e9-218">In this tutorial we saw how to create a more complex DataList editing interface that included three different input Web controls a TextBox, two DropDownLists, and a CheckBox along with validation controls.</span></span> <span data-ttu-id="309e9-219">Beim Erstellen der Schnittstelle bearbeiten, die Schritte sind unabhängig von den Websteuerelementen verwendet wird: starten, indem Sie das DataList s Websteuerelementen hinzugefügt `EditItemTemplate`; verwenden Databinding-Syntax, um die entsprechenden Datenwerte in der angegebenen Feld mit dem entsprechenden Web zuweisen Steuerelementeigenschaften; und in der `UpdateCommand` Ereignishandler, d. h. programmgesteuerten Zugriff auf die Web-Steuerelemente und ihre entsprechenden Eigenschaften, deren Werte in der BLL übergeben.</span><span class="sxs-lookup"><span data-stu-id="309e9-219">When building the editing interface, the steps are the same regardless of the Web controls being used: start by adding the Web controls to the DataList s `EditItemTemplate`; use databinding syntax to assign the corresponding data field values with the appropriate Web control properties; and, in the `UpdateCommand` event handler, programmatically access the Web controls and their appropriate properties, passing their values into the BLL.</span></span>

<span data-ttu-id="309e9-220">Für die Erstellung einer Bearbeitung Schnittstelle gibt an, ob es s besteht aus nur Textfelder oder eine Auflistung von anderen Websteuerelemente, achten Sie darauf, dass Sie ordnungsgemäß Datenbank behandeln `NULL` Werte.</span><span class="sxs-lookup"><span data-stu-id="309e9-220">When creating an editing interface, whether it s composed of just TextBoxes or a collection of different Web controls, be sure to correctly handle database `NULL` values.</span></span> <span data-ttu-id="309e9-221">Wenn für die Kontoführung `NULL` s, es ist unbedingt erforderlich, dass Sie nicht nur eine vorhandene richtigerweise `NULL` Wert in die Bearbeitungsoberfläche, sondern auch, die Sie bieten eine Möglichkeit zum Markieren eines Wert als `NULL`.</span><span class="sxs-lookup"><span data-stu-id="309e9-221">When accounting for `NULL` s, it is imperative that you not only correctly display an existing `NULL` value in the editing interface, but also that you offer a means for marking a value as `NULL`.</span></span> <span data-ttu-id="309e9-222">Für DropDownLists im DataList-Steuerelementen unterstützt, das in der Regel bedeutet hinzufügen einen statischen `ListItem` , deren `Value` -Eigenschaft explizit auf eine leere Zeichenfolge festgelegt (`Value=""`), und viel Code zum Hinzufügen der `UpdateCommand` -Ereignishandler, um zu bestimmen, und zwar unabhängig davon, ob die `NULL``ListItem` ausgewählt wurde.</span><span class="sxs-lookup"><span data-stu-id="309e9-222">For DropDownLists in DataLists, that typically means adding a static `ListItem` whose `Value` property is explicitly set to an empty string (`Value=""`), and adding a bit of code to the `UpdateCommand` event handler to determine whether or not the `NULL``ListItem` was selected.</span></span>

<span data-ttu-id="309e9-223">Viel Spaß beim Programmieren!</span><span class="sxs-lookup"><span data-stu-id="309e9-223">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="309e9-224">Informationen zum Autor</span><span class="sxs-lookup"><span data-stu-id="309e9-224">About the Author</span></span>

<span data-ttu-id="309e9-225">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor von sieben ASP/ASP.NET-Büchern und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), Microsoft Web-Technologien seit 1998 arbeitet.</span><span class="sxs-lookup"><span data-stu-id="309e9-225">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="309e9-226">Scott fungiert als ein unabhängiger Berater, Trainer und Writer.</span><span class="sxs-lookup"><span data-stu-id="309e9-226">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="309e9-227">Sein neueste Buch wird [ *Sams Schulen selbst ASP.NET 2.0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="309e9-227">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="309e9-228">Er die erreicht werden kann, zur [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) oder über seinen Blog die finden Sie unter [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="309e9-228">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="309e9-229">Besonderen Dank an</span><span class="sxs-lookup"><span data-stu-id="309e9-229">Special Thanks To</span></span>

<span data-ttu-id="309e9-230">Diese Reihe von Lernprogrammen wurde durch viele nützliche Bearbeiter überprüft.</span><span class="sxs-lookup"><span data-stu-id="309e9-230">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="309e9-231">Lead Prüfer für dieses Lernprogramm wurden Dennis Patterson, David Suru und Randy Schmidt.</span><span class="sxs-lookup"><span data-stu-id="309e9-231">Lead reviewers for this tutorial were Dennis Patterson, David Suru, and Randy Schmidt.</span></span> <span data-ttu-id="309e9-232">Meine bevorstehende MSDN-Artikel Überprüfen von Interesse?</span><span class="sxs-lookup"><span data-stu-id="309e9-232">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="309e9-233">Wenn dies der Fall ist, löschen Sie mich zeilenweise [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="309e9-233">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="309e9-234">Vorherige</span><span class="sxs-lookup"><span data-stu-id="309e9-234">Previous</span></span>](adding-validation-controls-to-the-datalist-s-editing-interface-vb.md)
