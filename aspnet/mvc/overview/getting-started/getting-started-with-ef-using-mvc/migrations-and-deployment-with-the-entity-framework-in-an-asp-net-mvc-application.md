---
uid: mvc/overview/getting-started/getting-started-with-ef-using-mvc/migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application
title: Code First-Migrationen und Bereitstellung mit dem Entity Framework in einer ASP.NET MVC-Anwendung | Microsoft Docs
author: tdykstra
description: Die Contoso-University Beispielwebanwendung veranschaulicht, wie ASP.NET MVC 5-Anwendungen, die mit dem Entity Framework 6 Code First und Visual Studio erstellen...
ms.author: aspnetcontent
manager: wpickett
ms.date: 11/07/2014
ms.topic: article
ms.assetid: d4dfc435-bda6-4621-9762-9ba270f8de4e
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/getting-started/getting-started-with-ef-using-mvc/migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application
msc.type: authoredcontent
ms.openlocfilehash: 04d393edca0469df140f06a7d083a48aa8f84b65
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/06/2018
---
<a name="code-first-migrations-and-deployment-with-the-entity-framework-in-an-aspnet-mvc-application"></a><span data-ttu-id="d2d17-103">Code First-Migrationen und Bereitstellung mit dem Entity Framework in einer ASP.NET MVC-Anwendung</span><span class="sxs-lookup"><span data-stu-id="d2d17-103">Code First Migrations and Deployment with the Entity Framework in an ASP.NET MVC Application</span></span>
====================
<span data-ttu-id="d2d17-104">durch [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="d2d17-104">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

<span data-ttu-id="d2d17-105">[Herunterladen des abgeschlossenen Projekts](http://code.msdn.microsoft.com/ASPNET-MVC-Application-b01a9fe8) oder [PDF herunterladen](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20Entity%20Framework%206%20Code%20First%20using%20MVC%205.pdf)</span><span class="sxs-lookup"><span data-stu-id="d2d17-105">[Download Completed Project](http://code.msdn.microsoft.com/ASPNET-MVC-Application-b01a9fe8) or [Download PDF](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20Entity%20Framework%206%20Code%20First%20using%20MVC%205.pdf)</span></span>

> <span data-ttu-id="d2d17-106">Die Contoso-University Beispielwebanwendung veranschaulicht, wie ASP.NET MVC 5-Anwendungen, die mit dem Entity Framework 6 Code First und Visual Studio 2013.</span><span class="sxs-lookup"><span data-stu-id="d2d17-106">The Contoso University sample web application demonstrates how to create ASP.NET MVC 5 applications using the Entity Framework 6 Code First and Visual Studio 2013.</span></span> <span data-ttu-id="d2d17-107">Informationen zu dieser Tutorialreihe finden Sie im [ersten Tutorial der Reihe](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application.md).</span><span class="sxs-lookup"><span data-stu-id="d2d17-107">For information about the tutorial series, see [the first tutorial in the series](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application.md).</span></span>

<span data-ttu-id="d2d17-108">Bisher hat die Anwendung lokal in IIS Express auf dem Entwicklungscomputer ausgeführt wurde.</span><span class="sxs-lookup"><span data-stu-id="d2d17-108">So far the application has been running locally in IIS Express on your development computer.</span></span> <span data-ttu-id="d2d17-109">Um einer realen Anwendung für andere Benutzer über das Internet verfügbar zu machen, müssen Sie es auf einen Webhostinganbieter bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="d2d17-109">To make a real application available for other people to use over the Internet, you have to deploy it to a web hosting provider.</span></span> <span data-ttu-id="d2d17-110">In diesem Lernprogramm stellen Sie die University Contoso-Anwendung in der Cloud in Azure bereit.</span><span class="sxs-lookup"><span data-stu-id="d2d17-110">In this tutorial, you'll deploy the Contoso University application to the cloud in Azure.</span></span>

<span data-ttu-id="d2d17-111">Das Lernprogramm enthält folgende Abschnitte:</span><span class="sxs-lookup"><span data-stu-id="d2d17-111">The tutorial contains the following sections:</span></span>

- <span data-ttu-id="d2d17-112">Code First-Migrationen zu aktivieren.</span><span class="sxs-lookup"><span data-stu-id="d2d17-112">Enable Code First Migrations.</span></span> <span data-ttu-id="d2d17-113">Die Migrationen-Funktion können Sie das Datenmodell zu ändern und die Änderungen für die Produktion bereitstellen, indem Sie das Datenbankschema aktualisieren, ohne Sie zu löschen und Neuerstellen die Datenbank.</span><span class="sxs-lookup"><span data-stu-id="d2d17-113">The Migrations feature enables you to change the data model and deploy your changes to production by updating the database schema without having to drop and re-create the database.</span></span>
- <span data-ttu-id="d2d17-114">In Azure bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="d2d17-114">Deploy to Azure.</span></span> <span data-ttu-id="d2d17-115">Dieser Schritt ist optional; Sie können die verbleibenden Lernprogramme fortsetzen, ohne dass das Projekt bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="d2d17-115">This step is optional; you can continue with the remaining tutorials without having deployed the project.</span></span>

<span data-ttu-id="d2d17-116">Es wird empfohlen, dass Sie einen Prozess für die fortlaufende Integration mit der quellcodeverwaltung für die Bereitstellung verwenden, aber dieses Lernprogramm diesen Themen nicht behandelt.</span><span class="sxs-lookup"><span data-stu-id="d2d17-116">We recommend that you use a continuous integration process with source control for deployment, but this tutorial does not cover those topics.</span></span> <span data-ttu-id="d2d17-117">Weitere Informationen finden Sie unter der [quellcodeverwaltung](xref:aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/source-control) und [fortlaufende Integration](xref:aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/continuous-integration-and-continuous-delivery) Kapiteln der [Building Real-World Cloud Apps with Azure](xref:aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/introduction) e-Book.</span><span class="sxs-lookup"><span data-stu-id="d2d17-117">For more information, see the [source control](xref:aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/source-control) and [continuous integration](xref:aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/continuous-integration-and-continuous-delivery) chapters of the [Building Real-World Cloud Apps with Azure](xref:aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/introduction) e-book.</span></span>

## <a name="enable-code-first-migrations"></a><span data-ttu-id="d2d17-118">Aktivieren Sie die Code First-Migrationen</span><span class="sxs-lookup"><span data-stu-id="d2d17-118">Enable Code First Migrations</span></span>

<span data-ttu-id="d2d17-119">Wenn Sie eine neue Anwendung entwickeln, ändert sich Ihr Datenmodell häufig. Jedes Mal, wenn das Datenmodell geändert wird, ist es nicht mehr synchron mit der Datenbank.</span><span class="sxs-lookup"><span data-stu-id="d2d17-119">When you develop a new application, your data model changes frequently, and each time the model changes, it gets out of sync with the database.</span></span> <span data-ttu-id="d2d17-120">Sie haben das Entity Framework automatisch löschen und Neuerstellen der Datenbank bei jeder Änderung des Datenmodells konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="d2d17-120">You have configured the Entity Framework to automatically drop and re-create the database each time you change the data model.</span></span> <span data-ttu-id="d2d17-121">Wenn Sie hinzufügen, entfernen, Entitätsklassen oder Ändern Ihrer `DbContext` Klasse, das nächste Mal führen Sie die Anwendung es automatisch die vorhandene Datenbank gelöscht wird, ein neues Zertifikat an, die das Modell entspricht und startet ihn mit Testdaten erstellt.</span><span class="sxs-lookup"><span data-stu-id="d2d17-121">When you add, remove, or change entity classes or change your `DbContext` class, the next time you run the application it automatically deletes your existing database, creates a new one that matches the model, and seeds it with test data.</span></span>

<span data-ttu-id="d2d17-122">Diese Methode, bei der die Datenbank mit dem Datenmodell synchron gehalten wird, funktioniert so lange, bis Sie die Anwendung für die Produktion bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="d2d17-122">This method of keeping the database in sync with the data model works well until you deploy the application to production.</span></span> <span data-ttu-id="d2d17-123">Wenn die Anwendung in der produktionsumgebung ausgeführt wird, wird es in der Regel Speichern von Daten, die Sie beibehalten möchten, und nicht alles, was jedes Mal nicht mehr verändert z. B. eine neue Spalte hinzufügen möchten.</span><span class="sxs-lookup"><span data-stu-id="d2d17-123">When the application is running in production, it is usually storing data that you want to keep, and you don't want to lose everything each time you make a change such as adding a new column.</span></span> <span data-ttu-id="d2d17-124">Die [Code First-Migrationen](https://msdn.microsoft.com/data/jj591621) löst dieses Problem durch Code First zum Aktualisieren des Datenbankschemas anstatt durch Löschen und Neuerstellen der Datenbank aktivieren.</span><span class="sxs-lookup"><span data-stu-id="d2d17-124">The [Code First Migrations](https://msdn.microsoft.com/data/jj591621) feature solves this problem by enabling Code First to update the database schema instead of dropping and re-creating the database.</span></span> <span data-ttu-id="d2d17-125">In diesem Lernprogramm stellen Sie die Anwendung, und um für die Vorbereitung der Migration aktivieren.</span><span class="sxs-lookup"><span data-stu-id="d2d17-125">In this tutorial, you'll deploy the application, and to prepare for that you'll enable Migrations.</span></span>

1. <span data-ttu-id="d2d17-126">Deaktivieren Sie den Initialisierer, die Sie zuvor eingerichtet haben auskommentieren oder das Löschen der `contexts` Element, das Sie die Anwendungsdatei "Web.config" hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="d2d17-126">Disable the initializer that you set up earlier by commenting out or deleting the `contexts` element that you added to the application Web.config file.</span></span>

    [!code-xml[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample1.xml?highlight=2,6)]
2. <span data-ttu-id="d2d17-127">Auch in der Anwendung *"Web.config"* file, ändern Sie den Namen der Datenbank in der Verbindungszeichenfolge auf ContosoUniversity2.</span><span class="sxs-lookup"><span data-stu-id="d2d17-127">Also in the application *Web.config* file, change the name of the database in the connection string to ContosoUniversity2.</span></span>

    [!code-xml[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample2.xml?highlight=2)]

    <span data-ttu-id="d2d17-128">Durch diese Änderung wird das Projekt eingerichtet, sodass bei der ersten Migration eine neue Datenbank erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="d2d17-128">This change sets up the project so that the first migration will create a new database.</span></span> <span data-ttu-id="d2d17-129">Ist dies nicht erforderlich, aber Sie werden später angezeigt, daher ist es eine gute Idee bleiben.</span><span class="sxs-lookup"><span data-stu-id="d2d17-129">This isn't required but you'll see later why it's a good idea.</span></span>
3. <span data-ttu-id="d2d17-130">Aus der **Tools** Menü klicken Sie auf **Bibliothekspaket-Manager** und dann **Package Manager Console**.</span><span class="sxs-lookup"><span data-stu-id="d2d17-130">From the **Tools** menu, click **Library Package Manager** and then **Package Manager Console**.</span></span>

    ![Selecting_Package_Manager_Console](https://asp.net/media/4336350/1pm.png)
4. <span data-ttu-id="d2d17-132">Bei der `PM>` Eingabeaufforderung Geben Sie die folgenden Befehle:</span><span class="sxs-lookup"><span data-stu-id="d2d17-132">At the `PM>` prompt enter the following commands:</span></span>

    `enable-migrations`  
    `add-migration InitialCreate`

    ![Enable-Migrations-Befehl](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image1.png)

    <span data-ttu-id="d2d17-134">Die `enable-migrations` Befehl erstellt eine *Migrationen* Ordner im Projekt ContosoUniversity, und es wird in diesem Ordner eine *"Configuration.cs"* -Datei, die Sie bearbeiten können, um Migrationen zu konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="d2d17-134">The `enable-migrations` command creates a *Migrations* folder in the ContosoUniversity project, and it puts in that folder a *Configuration.cs* file that you can edit to configure Migrations.</span></span>

    <span data-ttu-id="d2d17-135">(Wenn Sie die vorherigen Schritte, die Sie zum Ändern des Datenbanknamens weiterleitet übersehen, Migrationen finden Sie die vorhandene Datenbank und automatisch lassen, werden die `add-migration` Befehl.</span><span class="sxs-lookup"><span data-stu-id="d2d17-135">(If you missed the step above that directs you to change the database name, Migrations will find the existing database and automatically do the `add-migration` command.</span></span> <span data-ttu-id="d2d17-136">Das ist in Ordnung, es bedeutet lediglich, dass Sie einen Test des Codes Migrationen ausgeführt werden, bevor Sie die Datenbank bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="d2d17-136">That's OK, it just means you won't run a test of the migrations code before you deploy the database.</span></span> <span data-ttu-id="d2d17-137">Später beim Ausführen der `update-database` Befehl keine Aktion ausgeführt, da die Datenbank bereits vorhanden ist.)</span><span class="sxs-lookup"><span data-stu-id="d2d17-137">Later when you run the `update-database` command nothing will happen because the database will already exist.)</span></span>

    ![Ordner](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image2.png)

    <span data-ttu-id="d2d17-139">Wie bei der Initialisierung-Klasse, die Sie zuvor gesehen haben die `Configuration` Klasse enthält eine `Seed` Methode.</span><span class="sxs-lookup"><span data-stu-id="d2d17-139">Like the initializer class that you saw earlier, the `Configuration` class includes a `Seed` method.</span></span>

    [!code-csharp[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample3.cs)]

    <span data-ttu-id="d2d17-140">Der Zweck der [Ausgangswert](https://msdn.microsoft.com/library/hh829453(v=vs.103).aspx) Methode besteht darin, ermöglichen es Ihnen, einfügen oder aktualisieren Testdaten aus, nach dem Code First erstellt oder die Datenbank aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="d2d17-140">The purpose of the [Seed](https://msdn.microsoft.com/library/hh829453(v=vs.103).aspx) method is to enable you to insert or update test data after Code First creates or updates the database.</span></span> <span data-ttu-id="d2d17-141">Die Methode wird aufgerufen, wenn die Datenbank erstellt wird, und jedes Mal, wenn das Datenbankschema aktualisiert wird, nachdem ein Datenmodell ändern.</span><span class="sxs-lookup"><span data-stu-id="d2d17-141">The method is called when the database is created and every time the database schema is updated after a data model change.</span></span>

### <a name="set-up-the-seed-method"></a><span data-ttu-id="d2d17-142">Einrichten der Seed-Methode</span><span class="sxs-lookup"><span data-stu-id="d2d17-142">Set up the Seed Method</span></span>

<span data-ttu-id="d2d17-143">Wenn der Datenbank für jede Änderung des Dienstdaten-Modell neu erstellen, der Initialisiererklasse verwenden und Löschen von sind `Seed` Methode, um Testdaten, eingefügt werden, da nach jeder Änderung Modell die Datenbank gelöscht wird und die Testdaten verloren gegangen ist.</span><span class="sxs-lookup"><span data-stu-id="d2d17-143">When you are dropping and re-creating the database for every data model change, you use the initializer class's `Seed` method to insert test data, because after every model change the database is dropped and all the test data is lost.</span></span> <span data-ttu-id="d2d17-144">Mit Code First-Migrationen Test Daten, nachdem Änderungen an der Datenbank beibehalten werden, einschließlich also Testdaten in die [Ausgangswert](https://msdn.microsoft.com/library/hh829453(v=vs.103).aspx) Methode ist in der Regel nicht erforderlich.</span><span class="sxs-lookup"><span data-stu-id="d2d17-144">With Code First Migrations, test data is retained after database changes, so including test data in the [Seed](https://msdn.microsoft.com/library/hh829453(v=vs.103).aspx) method is typically not necessary.</span></span> <span data-ttu-id="d2d17-145">Tatsächlich sollen die `Seed` Methode, um Testdaten einzufügen, wenn Sie Migrationen zum Bereitstellen der Datenbank bis hin zur Produktion, verwenden da die `Seed` Methode wird ausgeführt, in der Produktion.</span><span class="sxs-lookup"><span data-stu-id="d2d17-145">In fact, you don't want the `Seed` method to insert test data if you'll be using Migrations to deploy the database to production, because the `Seed` method will run in production.</span></span> <span data-ttu-id="d2d17-146">In diesem Fall sollen die `Seed` aufzurufende Methode fügen Sie in die Datenbank nur die Daten, die Sie benötigen in der Produktion.</span><span class="sxs-lookup"><span data-stu-id="d2d17-146">In that case you want the `Seed` method to insert into the database only the data that you need in production.</span></span> <span data-ttu-id="d2d17-147">Beispielsweise sollten Sie die Datenbank im tatsächlichen Abteilungsnamen enthalten die `Department` Tabelle, wenn die Anwendung in der Produktion zur Verfügung steht.</span><span class="sxs-lookup"><span data-stu-id="d2d17-147">For example, you might want the database to include actual department names in the `Department` table when the application becomes available in production.</span></span>

<span data-ttu-id="d2d17-148">Für dieses Lernprogramm müssen verwenden Sie Migrationen für die Bereitstellung, aber das `Seed` einfügen Methode Testdaten trotzdem um erleichtern es zu sehen, wie die Funktionalität der Anwendung funktioniert, ohne dass manuell eine große Datenmenge eingefügt.</span><span class="sxs-lookup"><span data-stu-id="d2d17-148">For this tutorial, you'll be using Migrations for deployment, but your `Seed` method will insert test data anyway in order to make it easier to see how application functionality works without having to manually insert a lot of data.</span></span>

1. <span data-ttu-id="d2d17-149">Ersetzen Sie den Inhalt von der *"Configuration.cs"* -Datei mit den folgenden Code, der Testdaten in die neue Datenbank geladen werden.</span><span class="sxs-lookup"><span data-stu-id="d2d17-149">Replace the contents of the *Configuration.cs* file with the following code, which will load test data into the new database.</span></span> 

    [!code-csharp[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample4.cs)]

    <span data-ttu-id="d2d17-150">Die [Ausgangswert](https://msdn.microsoft.com/library/hh829453(v=vs.103).aspx) Methode nimmt das Datenbankkontextobjekt als Eingabeparameter und der Code in der Methode verwendet das Objekt, das Hinzufügen neuer Entitäten auf die Datenbank.</span><span class="sxs-lookup"><span data-stu-id="d2d17-150">The [Seed](https://msdn.microsoft.com/library/hh829453(v=vs.103).aspx) method takes the database context object as an input parameter, and the code in the method uses that object to add new entities to the database.</span></span> <span data-ttu-id="d2d17-151">Für jeden Entitätstyp im Code erstellt eine Auflistung von neuen Entitäten, fügt diese an die entsprechende [DbSet](https://msdn.microsoft.com/library/system.data.entity.dbset(v=vs.103).aspx) -Eigenschaft, und klicken Sie dann speichert die Änderungen an der Datenbank.</span><span class="sxs-lookup"><span data-stu-id="d2d17-151">For each entity type, the code creates a collection of new entities, adds them to the appropriate [DbSet](https://msdn.microsoft.com/library/system.data.entity.dbset(v=vs.103).aspx) property, and then saves the changes to the database.</span></span> <span data-ttu-id="d2d17-152">Es ist nicht erforderlich, rufen Sie die [SaveChanges](https://msdn.microsoft.com/library/system.data.entity.dbcontext.savechanges(v=VS.103).aspx) Methode nach jeder Gruppe von Entitäten, wie hier erfolgt, aber auf diese Weise können Sie die Ursache eines Problems zu suchen, wenn eine Ausnahme auftritt, während der Code in die Datenbank geschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="d2d17-152">It isn't necessary to call the [SaveChanges](https://msdn.microsoft.com/library/system.data.entity.dbcontext.savechanges(v=VS.103).aspx) method after each group of entities, as is done here, but doing that helps you locate the source of a problem if an exception occurs while the code is writing to the database.</span></span>

    <span data-ttu-id="d2d17-153">Einige der Anweisungen, das Einfügen von Daten verwendet werden, die [AddOrUpdate](https://msdn.microsoft.com/library/system.data.entity.migrations.idbsetextensions.addorupdate(v=vs.103).aspx) Methode zum Ausführen eines Vorgangs "Upsert".</span><span class="sxs-lookup"><span data-stu-id="d2d17-153">Some of the statements that insert data use the [AddOrUpdate](https://msdn.microsoft.com/library/system.data.entity.migrations.idbsetextensions.addorupdate(v=vs.103).aspx) method to perform an "upsert" operation.</span></span> <span data-ttu-id="d2d17-154">Da die `Seed` Methode wird bei jedem Ausführen der `update-database` Befehl, in der Regel nach jeder Migration Daten können nicht nur eingefügt werden, da die Zeilen, die Sie hinzufügen möchten bereits es nach der ersten Migration entsprechen, die die Datenbank erstellt.</span><span class="sxs-lookup"><span data-stu-id="d2d17-154">Because the `Seed` method runs every time you execute the `update-database` command, typically after each migration, you can't just insert data, because the rows you are trying to add will already be there after the first migration that creates the database.</span></span> <span data-ttu-id="d2d17-155">Der Vorgang "Upsert" wird verhindert, dass Fehler, die eintreten würden, wenn Sie versuchen, fügen Sie eine Zeile, die bereits vorhanden ist, aber es ***überschreibt*** Änderungen an Daten, die Sie möglicherweise beim Testen der Anwendung vorgenommen haben.</span><span class="sxs-lookup"><span data-stu-id="d2d17-155">The "upsert" operation prevents errors that would happen if you try to insert a row that already exists, but it ***overrides*** any changes to data that you may have made while testing the application.</span></span> <span data-ttu-id="d2d17-156">Mit Testdaten in einigen Tabellen nicht empfiehlt, die durchgeführt werden soll: in einigen Fällen beim Ändern von Daten beim Testen soll Ihre Änderungen bleiben nach einer Aktualisierung der Datenbank.</span><span class="sxs-lookup"><span data-stu-id="d2d17-156">With test data in some tables you might not want that to happen: in some cases when you change data while testing you want your changes to remain after database updates.</span></span> <span data-ttu-id="d2d17-157">In diesem Fall einen bedingten Einfügevorgang erstellt werden sollen: Fügen Sie eine Zeile nur dann, wenn er nicht bereits vorhanden.</span><span class="sxs-lookup"><span data-stu-id="d2d17-157">In that case you want to do a conditional insert operation: insert a row only if it doesn't already exist.</span></span> <span data-ttu-id="d2d17-158">Die Seed-Methode verwendet beide Ansätze.</span><span class="sxs-lookup"><span data-stu-id="d2d17-158">The Seed method uses both approaches.</span></span>

    <span data-ttu-id="d2d17-159">Der erste Parameter übergeben wird, um die [AddOrUpdate](https://msdn.microsoft.com/library/system.data.entity.migrations.idbsetextensions.addorupdate(v=vs.103).aspx) Methode gibt die Eigenschaft zu verwenden, um zu überprüfen, ob bereits eine Zeile vorhanden.</span><span class="sxs-lookup"><span data-stu-id="d2d17-159">The first parameter passed to the [AddOrUpdate](https://msdn.microsoft.com/library/system.data.entity.migrations.idbsetextensions.addorupdate(v=vs.103).aspx) method specifies the property to use to check if a row already exists.</span></span> <span data-ttu-id="d2d17-160">Für die Testdaten für Studenten, die Sie bereitstellen, die `LastName` Eigenschaft kann für diesen Zweck verwendet werden, da jeder letzte Name in der Liste eindeutig ist:</span><span class="sxs-lookup"><span data-stu-id="d2d17-160">For the test student data that you are providing, the `LastName` property can be used for this purpose since each last name in the list is unique:</span></span>

    [!code-csharp[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample5.cs)]

    <span data-ttu-id="d2d17-161">Mit diesem Code wird davon ausgegangen, dass die Nachnamen eindeutig sind.</span><span class="sxs-lookup"><span data-stu-id="d2d17-161">This code assumes that last names are unique.</span></span> <span data-ttu-id="d2d17-162">Wenn Sie einen Studenten mit einem doppelten Nachnamen manuell hinzufügen, erhalten Sie die folgende Ausnahme beim nächsten einer Migration durchführen.</span><span class="sxs-lookup"><span data-stu-id="d2d17-162">If you manually add a student with a duplicate last name, you'll get the following exception the next time you perform a migration.</span></span>

    <span data-ttu-id="d2d17-163">Die Sequenz enthält mehr als ein element</span><span class="sxs-lookup"><span data-stu-id="d2d17-163">Sequence contains more than one element</span></span>

    <span data-ttu-id="d2d17-164">Informationen zum Umgang mit redundanten Daten wie z. B. zwei Studenten, die mit dem Namen "Alexander Carson" finden Sie unter [Seeding und Debuggen von Entity Framework (EF) Datenbanken](https://blogs.msdn.com/b/rickandy/archive/2013/02/12/seeding-and-debugging-entity-framework-ef-dbs.aspx) in Rick andersons Blog.</span><span class="sxs-lookup"><span data-stu-id="d2d17-164">For information about how to handle redundant data such as two students named "Alexander Carson", see [Seeding and Debugging Entity Framework (EF) DBs](https://blogs.msdn.com/b/rickandy/archive/2013/02/12/seeding-and-debugging-entity-framework-ef-dbs.aspx) on Rick Anderson's blog.</span></span> <span data-ttu-id="d2d17-165">Weitere Informationen zu den `AddOrUpdate` -Methode finden Sie unter [Achten Sie darauf mit EF 4.3 AddOrUpdate-Methode](http://thedatafarm.com/blog/data-access/take-care-with-ef-4-3-addorupdate-method/) Julie Lerman Blog.</span><span class="sxs-lookup"><span data-stu-id="d2d17-165">For more information about the `AddOrUpdate` method, see [Take care with EF 4.3 AddOrUpdate Method](http://thedatafarm.com/blog/data-access/take-care-with-ef-4-3-addorupdate-method/) on Julie Lerman's blog.</span></span>

    <span data-ttu-id="d2d17-166">Der Code, der erstellt `Enrollment` Entitäten davon ausgegangen, dass die `ID` Wert in den Entitäten in der `students` -Auflistung, auch wenn Sie diese Eigenschaft im Code festgelegt haben nicht, die die Auflistung erstellt.</span><span class="sxs-lookup"><span data-stu-id="d2d17-166">The code that creates `Enrollment` entities assumes you have the `ID` value in the entities in the `students` collection, although you didn't set that property in the code that creates the collection.</span></span>

    [!code-csharp[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample6.cs?highlight=2)]

    <span data-ttu-id="d2d17-167">Können Sie die `ID` hier Eigenschaft da die `ID` Wert wird festgelegt, wenn Sie aufrufen `SaveChanges` für die `students` Auflistung.</span><span class="sxs-lookup"><span data-stu-id="d2d17-167">You can use the `ID` property here because the `ID` value is set when you call `SaveChanges` for the `students` collection.</span></span> <span data-ttu-id="d2d17-168">EF ruft des Primärschlüsselwerts automatisch ab, wenn eine Entität in der Datenbank eingefügt und aktualisiert die `ID` -Eigenschaft der Entität im Arbeitsspeicher.</span><span class="sxs-lookup"><span data-stu-id="d2d17-168">EF automatically gets the primary key value when it inserts an entity into the database, and it updates the `ID` property of the entity in memory.</span></span>

    <span data-ttu-id="d2d17-169">Der Code, der jede fügt `Enrollment` Entität, die die `Enrollments` Entitätssammlung verwendet nicht die `AddOrUpdate` Methode.</span><span class="sxs-lookup"><span data-stu-id="d2d17-169">The code that adds each `Enrollment` entity to the `Enrollments` entity set doesn't use the `AddOrUpdate` method.</span></span> <span data-ttu-id="d2d17-170">Er überprüft, ob eine Entität bereits vorhanden ist, und fügt die Entität aus, wenn er nicht vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="d2d17-170">It checks if an entity already exists and inserts the entity if it doesn't exist.</span></span> <span data-ttu-id="d2d17-171">Dieser Ansatz wird Änderungen beizubehalten, die Sie eine Registrierung Grade mithilfe der Benutzeroberfläche der Anwendung vornehmen.</span><span class="sxs-lookup"><span data-stu-id="d2d17-171">This approach will preserve changes you make to an enrollment grade by using the application UI.</span></span> <span data-ttu-id="d2d17-172">Der Code durchläuft jedes Mitglied der `Enrollment` [Liste](https://msdn.microsoft.com/library/6sh2ey19.aspx) und wenn die Registrierung in der Datenbank nicht gefunden wird, wird die Registrierung mit der Datenbank hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="d2d17-172">The code loops through each member of the `Enrollment`[List](https://msdn.microsoft.com/library/6sh2ey19.aspx) and if the enrollment is not found in the database, it adds the enrollment to the database.</span></span> <span data-ttu-id="d2d17-173">Beim ersten der Datenbank Aktualisierung, wird die Datenbank leer sein, sodass jede Registrierung hinzugefügt wird.</span><span class="sxs-lookup"><span data-stu-id="d2d17-173">The first time you update the database, the database will be empty, so it will add each enrollment.</span></span>

    [!code-csharp[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample7.cs)]
2. <span data-ttu-id="d2d17-174">Erstellen Sie das Projekt.</span><span class="sxs-lookup"><span data-stu-id="d2d17-174">Build the project.</span></span>

### <a name="execute-the-first-migration"></a><span data-ttu-id="d2d17-175">Führen Sie die erste Migration</span><span class="sxs-lookup"><span data-stu-id="d2d17-175">Execute the First Migration</span></span>

<span data-ttu-id="d2d17-176">Wenn Sie ausgeführt haben die `add-migration` Befehl Migrationen generiert den Code, der die Datenbank von Grund auf erstellen würden.</span><span class="sxs-lookup"><span data-stu-id="d2d17-176">When you executed the `add-migration` command, Migrations generated the code that would create the database from scratch.</span></span> <span data-ttu-id="d2d17-177">Dieser Code wird auch in der *Migrationen* Ordner, in der Datei mit dem Namen  *&lt;Zeitstempel&gt;\_InitialCreate.cs*.</span><span class="sxs-lookup"><span data-stu-id="d2d17-177">This code is also in the *Migrations* folder, in the file named *&lt;timestamp&gt;\_InitialCreate.cs*.</span></span> <span data-ttu-id="d2d17-178">Die `Up` Methode der `InitialCreate` Klasse erstellt, die Datenbanktabellen, die die Daten Modell Entitätenmengen, entsprechen und die `Down` Methode löscht sie.</span><span class="sxs-lookup"><span data-stu-id="d2d17-178">The `Up` method of the `InitialCreate` class creates the database tables that correspond to the data model entity sets, and the `Down` method deletes them.</span></span>

[!code-csharp[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample8.cs)]

<span data-ttu-id="d2d17-179">Die Migrationsfunktion ruft die Methode `Up` auf, um die Datenmodelländerungen für eine Migration zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="d2d17-179">Migrations calls the `Up` method to implement the data model changes for a migration.</span></span> <span data-ttu-id="d2d17-180">Wenn Sie einen Befehl eingeben, um ein Rollback für das Update auszuführen, ruft die Migrationsfunktion die Methode `Down` auf.</span><span class="sxs-lookup"><span data-stu-id="d2d17-180">When you enter a command to roll back the update, Migrations calls the `Down` method.</span></span>

<span data-ttu-id="d2d17-181">Dies ist der anfänglichen Migration, die erstellt wurde, wenn Sie eingegeben haben die `add-migration InitialCreate` Befehl.</span><span class="sxs-lookup"><span data-stu-id="d2d17-181">This is the initial migration that was created when you entered the `add-migration InitialCreate` command.</span></span> <span data-ttu-id="d2d17-182">Der Parameter (`InitialCreate` im Beispiel) wird verwendet, für die Datei benennen und kann beliebig sein; Sie wird in der Regel wählen Sie ein Wort oder Ausdruck, die zusammengefasst, was bei der Migration durchgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="d2d17-182">The parameter (`InitialCreate` in the example) is used for the file name and can be whatever you want; you typically choose a word or phrase that summarizes what is being done in the migration.</span></span> <span data-ttu-id="d2d17-183">Sie können z. B. eine spätere Migrationen Namen &quot;AddDepartmentTable&quot;.</span><span class="sxs-lookup"><span data-stu-id="d2d17-183">For example, you might name a later migration &quot;AddDepartmentTable&quot;.</span></span>

<span data-ttu-id="d2d17-184">Wenn Sie die ursprüngliche Migration erstellt haben, als die Datenbank bereits vorhanden war, wird der Code für die Datenbankerstellung zwar generiert, allerdings muss er nicht ausgeführt werden, da die Datenbank bereits dem Datenmodell entspricht.</span><span class="sxs-lookup"><span data-stu-id="d2d17-184">If you created the initial migration when the database already exists, the database creation code is generated but it doesn't have to run because the database already matches the data model.</span></span> <span data-ttu-id="d2d17-185">Wenn Sie die App in einer anderen Umgebung bereitstellen, in der die Datenbank noch nicht vorhanden ist, wird dieser Code ausgeführt, um Ihre Datenbank zu erstellen. Daher sollte dieser zunächst getestet werden.</span><span class="sxs-lookup"><span data-stu-id="d2d17-185">When you deploy the app to another environment where the database doesn't exist yet, this code will run to create your database, so it's a good idea to test it first.</span></span> <span data-ttu-id="d2d17-186">Aus diesem Grund haben Sie den Namen der Datenbank zuvor in der Verbindungszeichenfolge geändert – damit eine Datenbank bei Migrationen von Grund auf neu erstellt werden kann.</span><span class="sxs-lookup"><span data-stu-id="d2d17-186">That's why you changed the name of the database in the connection string earlier -- so that migrations can create a new one from scratch.</span></span>

1. <span data-ttu-id="d2d17-187">In der **Package Manager Console** Fenster, geben Sie den folgenden Befehl aus:</span><span class="sxs-lookup"><span data-stu-id="d2d17-187">In the **Package Manager Console** window, enter the following command:</span></span>

    `update-database`

    ![](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image3.png)

    <span data-ttu-id="d2d17-188">Die `update-database` -Befehl ausgeführt wird die `Up` Methode zum Erstellen der Datenbank aus, und klicken Sie dann es führt die `Seed` Methode zum Auffüllen der Datenbank.</span><span class="sxs-lookup"><span data-stu-id="d2d17-188">The `update-database` command runs the `Up` method to create the database and then it runs the `Seed` method to populate the database.</span></span> <span data-ttu-id="d2d17-189">Dasselbe Verfahren wird automatisch dann in der Produktion ausgeführt, nach der Bereitstellung der Anwendung, wie Sie im folgenden Abschnitt sehen.</span><span class="sxs-lookup"><span data-stu-id="d2d17-189">The same process will run automatically in production after you deploy the application, as you'll see in the following section.</span></span>
2. <span data-ttu-id="d2d17-190">Verwendung **Server-Explorer** auf die Datenbank zu überprüfen, wie Sie im ersten Lernprogramm ausgeführt haben, und führen Sie die Anwendung aus, um sicherzustellen, dass alles noch die gleiche wie zuvor.</span><span class="sxs-lookup"><span data-stu-id="d2d17-190">Use **Server Explorer** to inspect the database as you did in the first tutorial, and run the application to verify that everything still works the same as before.</span></span>

## <a name="deploy-to-azure"></a><span data-ttu-id="d2d17-191">In Azure bereitstellen</span><span class="sxs-lookup"><span data-stu-id="d2d17-191">Deploy to Azure</span></span>

<span data-ttu-id="d2d17-192">Bisher hat die Anwendung lokal in IIS Express auf dem Entwicklungscomputer ausgeführt wurde.</span><span class="sxs-lookup"><span data-stu-id="d2d17-192">So far the application has been running locally in IIS Express on your development computer.</span></span> <span data-ttu-id="d2d17-193">Um ihn für andere Benutzer über das Internet verfügbar machen, müssen Sie es auf einen Webhostinganbieter bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="d2d17-193">To make it available for other people to use over the Internet, you have to deploy it to a web hosting provider.</span></span> <span data-ttu-id="d2d17-194">In diesem Abschnitt des Lernprogramms müssen Sie es in Azure bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="d2d17-194">In this section of the tutorial you'll deploy it to Azure.</span></span> <span data-ttu-id="d2d17-195">In diesem Abschnitt ist optional. Sie können diesen Schritt überspringen und mit dem folgenden Lernprogramm fortgesetzt, oder können Sie die Anweisungen in diesem Abschnitt für einen anderen Hostinganbieter Ihrer Wahl anpassen.</span><span class="sxs-lookup"><span data-stu-id="d2d17-195">This section is optional; you can skip this and continue with the following tutorial, or you can adapt the instructions in this section for a different hosting provider of your choice.</span></span>

### <a name="using-code-first-migrations-to-deploy-the-database"></a><span data-ttu-id="d2d17-196">Mithilfe von Code First-Migrationen zum Bereitstellen der Datenbank</span><span class="sxs-lookup"><span data-stu-id="d2d17-196">Using Code First Migrations to Deploy the Database</span></span>

<span data-ttu-id="d2d17-197">Um die Datenbank bereitzustellen, verwenden Sie Code First-Migrationen.</span><span class="sxs-lookup"><span data-stu-id="d2d17-197">To deploy the database you'll use Code First Migrations.</span></span> <span data-ttu-id="d2d17-198">Wenn Sie das Veröffentlichungsprofil, mit denen Sie Einstellungen erstellen für die Bereitstellung von Visual Studio konfigurieren, wählen Sie ein Kontrollkästchen mit der Bezeichnung **Update Database**.</span><span class="sxs-lookup"><span data-stu-id="d2d17-198">When you create the publish profile that you use to configure settings for deploying from Visual Studio, you'll select a check box labeled **Update Database**.</span></span> <span data-ttu-id="d2d17-199">Diese Einstellung bewirkt, dass der Bereitstellungsprozess so konfigurieren Sie die Anwendung automatisch *"Web.config"* Datei auf dem Zielserver, sodass der Code First verwendet die `MigrateDatabaseToLatestVersion` Initialisiererklasse.</span><span class="sxs-lookup"><span data-stu-id="d2d17-199">This setting causes the deployment process to automatically configure the application *Web.config* file on the destination server so that Code First uses the `MigrateDatabaseToLatestVersion` initializer class.</span></span>

<span data-ttu-id="d2d17-200">Visual Studio keine Reaktion hervor mit der Datenbank während des Bereitstellungsvorgangs während sie das Projekt auf den Zielserver kopiert werden.</span><span class="sxs-lookup"><span data-stu-id="d2d17-200">Visual Studio doesn't do anything with the database during the deployment process while it is copying your project to the destination server.</span></span> <span data-ttu-id="d2d17-201">Wenn Sie die bereitgestellte Anwendung ausführen und greift auf die Datenbank zum ersten Mal nach der Bereitstellung, überprüft Code First, wenn die Datenbank das Datenmodell entspricht.</span><span class="sxs-lookup"><span data-stu-id="d2d17-201">When you run the deployed application and it accesses the database for the first time after deployment, Code First checks if the database matches the data model.</span></span> <span data-ttu-id="d2d17-202">Wenn es ein Konflikt besteht, Code First erstellt automatisch die Datenbank (sofern noch nicht vorhanden) oder das Datenbankschema auf die neueste Version aktualisiert wird, (Wenn eine Datenbank vorhanden ist, aber es stimmt nicht mit das Modell überein).</span><span class="sxs-lookup"><span data-stu-id="d2d17-202">If there's a mismatch, Code First automatically creates the database (if it doesn't exist yet) or updates the database schema to the latest version (if a database exists but doesn't match the model).</span></span> <span data-ttu-id="d2d17-203">Wenn die Anwendung eine Migrationen implementiert `Seed` -Methode, die Methode ausgeführt wird, nachdem die Datenbank erstellt wird, oder das Schema aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="d2d17-203">If the application implements a Migrations `Seed` method, the method runs after the database is created or the schema is updated.</span></span>

<span data-ttu-id="d2d17-204">Migrationen `Seed` Methode fügt Testdaten.</span><span class="sxs-lookup"><span data-stu-id="d2d17-204">Your Migrations `Seed` method inserts test data.</span></span> <span data-ttu-id="d2d17-205">Wenn Sie in einer produktionsumgebung bereitgestellt wurden, müssten Sie ändern die `Seed` Methode, sodass die It nur Daten einfügt, die in der-Datenbank eingefügt werden sollen.</span><span class="sxs-lookup"><span data-stu-id="d2d17-205">If you were deploying to a production environment, you would have to change the `Seed` method so that it only inserts data that you want to be inserted into your production database.</span></span> <span data-ttu-id="d2d17-206">Angenommen, in Ihrem aktuellen Datenmodell empfiehlt real Kurse aber fiktive Studenten in der Entwicklungsdatenbank verfügen.</span><span class="sxs-lookup"><span data-stu-id="d2d17-206">For example, in your current data model you might want to have real courses but fictional students in the development database.</span></span> <span data-ttu-id="d2d17-207">Sie schreiben eine `Seed` Methode zum Laden sowohl in der Entwicklung, und klicken Sie dann die fiktiven Studenten kommentieren Sie vor der Bereitstellung bis hin zur Produktion.</span><span class="sxs-lookup"><span data-stu-id="d2d17-207">You can write a `Seed` method to load both in development, and then comment out the fictional students before you deploy to production.</span></span> <span data-ttu-id="d2d17-208">Oder Sie können Schreiben einer `Seed` Methode, um nur Kurse zu laden, und geben die fiktiven Studenten in der Testdatenbank manuell mithilfe der Benutzeroberfläche der Anwendung.</span><span class="sxs-lookup"><span data-stu-id="d2d17-208">Or you can write a `Seed` method to load only courses, and enter the fictional students in the test database manually by using the application's UI.</span></span>

### <a name="get-an-azure-account"></a><span data-ttu-id="d2d17-209">Ein Azure-Konto abrufen</span><span class="sxs-lookup"><span data-stu-id="d2d17-209">Get an Azure account</span></span>

<span data-ttu-id="d2d17-210">Sie benötigen ein Azure-Konto.</span><span class="sxs-lookup"><span data-stu-id="d2d17-210">You'll need an Azure account.</span></span> <span data-ttu-id="d2d17-211">Wenn Sie nicht bereits vorhanden, aber Sie ein Visual Studio-Abonnement verfügen, können Sie [Vorteile Ihres Abonnements aktivieren](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/).</span><span class="sxs-lookup"><span data-stu-id="d2d17-211">If you don't already have one, but you do have a Visual Studio subscription, you can [activate your subscription benefits](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/).</span></span> <span data-ttu-id="d2d17-212">Andernfalls können Sie in wenigen Minuten ein kostenloses Testkonto erstellen.</span><span class="sxs-lookup"><span data-stu-id="d2d17-212">Otherwise, you can create a free trial account in just a couple of minutes.</span></span> <span data-ttu-id="d2d17-213">Weitere Informationen finden Sie unter [kostenlose Azure-Testversion](https://azure.microsoft.com/free/).</span><span class="sxs-lookup"><span data-stu-id="d2d17-213">For details, see [Azure Free Trial](https://azure.microsoft.com/free/).</span></span>

### <a name="create-a-web-site-and-a-sql-database-in-azure"></a><span data-ttu-id="d2d17-214">Erstellen Sie eine Website und eine SQL-Datenbank in Azure</span><span class="sxs-lookup"><span data-stu-id="d2d17-214">Create a web site and a SQL database in Azure</span></span>

<span data-ttu-id="d2d17-215">Ihre Web-app in Azure wird in einer freigegebenen Hostingumgebung ausgeführt, was bedeutet, dass es auf virtuellen Computern (VMs) ausgeführt wird, die mit anderen Azure-Clients freigegeben werden.</span><span class="sxs-lookup"><span data-stu-id="d2d17-215">Your web app in Azure will run in a shared hosting environment, which means it runs on virtual machines (VMs) that are shared with other Azure clients.</span></span> <span data-ttu-id="d2d17-216">Eine freigegebene Hostingumgebung ist eine kostengünstige Möglichkeit, in der Cloud zu beginnen.</span><span class="sxs-lookup"><span data-stu-id="d2d17-216">A shared hosting environment is a low-cost way to get started in the cloud.</span></span> <span data-ttu-id="d2d17-217">Ihres Webdatenverkehrs zunimmt, kann später die Anwendung skalieren, um die Anforderungen zu erfüllen, indem auf dedizierten virtuellen Computern ausführen.</span><span class="sxs-lookup"><span data-stu-id="d2d17-217">Later, if your web traffic increases, the application can scale to meet the need by running on dedicated VMs.</span></span> <span data-ttu-id="d2d17-218">Weitere Informationen zu Optionen Preise für Azure App Service, lesen Sie die Dokumentation auf [Azure Docs](https://azure.microsoft.com/pricing/details/app-service/)</span><span class="sxs-lookup"><span data-stu-id="d2d17-218">To learn more about Pricing Options for Azure App Service, read the documentation on [Azure Docs](https://azure.microsoft.com/pricing/details/app-service/)</span></span>

<span data-ttu-id="d2d17-219">Sie müssen die Datenbank in Azure SQL-Datenbank bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="d2d17-219">You'll deploy the database to Azure SQL Database.</span></span> <span data-ttu-id="d2d17-220">SQL-Datenbank ist eine cloudbasierte relationale Datenbankdienst, der auf SQL Server-Technologien integriert ist.</span><span class="sxs-lookup"><span data-stu-id="d2d17-220">SQL Database is a cloud-based relational database service that is built on SQL Server technologies.</span></span> <span data-ttu-id="d2d17-221">Tools und Anwendungen, die Arbeit mit SQL Server funktionieren auch mit SQL-Datenbank.</span><span class="sxs-lookup"><span data-stu-id="d2d17-221">Tools and applications that work with SQL Server also work with SQL Database.</span></span>

1. <span data-ttu-id="d2d17-222">In der [Azure-Verwaltungsportal](https://portal.azure.com), klicken Sie auf **neu** klicken Sie in der linken Registerkarte auf **alle** neues Blatt, und klicken Sie auf **Web-App & SQL** in der **Web** Abschnitt und schließlich **erstellen**.</span><span class="sxs-lookup"><span data-stu-id="d2d17-222">In the [Azure Management Portal](https://portal.azure.com), click **New** in the left tab, click **See all** in new blade, and then click **Web App & SQL** in the **Web** Section and finally **Create**.</span></span>

    ![Schaltfläche "Neu" im Verwaltungsportal](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/CreateWeb-Sql.png)

   <span data-ttu-id="d2d17-224">Die **neue Web-App und SQL - erstellen** -Assistent wird geöffnet.</span><span class="sxs-lookup"><span data-stu-id="d2d17-224">The **New Web App & SQL - Create** wizard opens.</span></span>

2. <span data-ttu-id="d2d17-225">Das Blatt, geben Sie eine Zeichenfolge in der **Anwendungsnamen** Feld eindeutige URL für Ihre Anwendung verwenden.</span><span class="sxs-lookup"><span data-stu-id="d2d17-225">In the blade, enter a string in the **App name** box to use as the unique URL for your application.</span></span> <span data-ttu-id="d2d17-226">Die vollständige URL besteht hier plus die Standarddomäne von Azure-App-Dienste Eingabe aus (. azurewebsites.net).</span><span class="sxs-lookup"><span data-stu-id="d2d17-226">The complete URL will consist of what you enter here plus the default domain of Azure App Services (.azurewebsites.net).</span></span> <span data-ttu-id="d2d17-227">Wenn die **Anwendungsnamen** bereits verwendet wird, wird der Assistent benachrichtigt Sie dieses mit einem roten *der app-Name ist nicht verfügbar* Nachricht.</span><span class="sxs-lookup"><span data-stu-id="d2d17-227">If the **App name** is already taken, the Wizard will notify you of this with a red *The app name is not available* message.</span></span> <span data-ttu-id="d2d17-228">Wenn die **Anwendungsnamen** ist verfügbar, Sie erhalten ein grünes Häkchen.</span><span class="sxs-lookup"><span data-stu-id="d2d17-228">If the **App name** is available, you will get a green checkmark.</span></span>

    ![Mit Datenbank-Link im Verwaltungsportal erstellen](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Create-WebApp.png)

3. <span data-ttu-id="d2d17-230">In der **Abonnement** Dropdownliste wählen Sie das Azure-Abonnement in der sollen die **App Service** befinden.</span><span class="sxs-lookup"><span data-stu-id="d2d17-230">In the **Subscription** Dropdown, please choose the Azure Subscription in which you want the **App Service** to reside.</span></span>

4. <span data-ttu-id="d2d17-231">In der **Ressourcengruppe** Textfeld, wählen Sie eine Ressourcengruppe oder einen neuen erstellen.</span><span class="sxs-lookup"><span data-stu-id="d2d17-231">In the **Resource Group** text box, choose a Resource Group or create a new one.</span></span> <span data-ttu-id="d2d17-232">Diese Einstellung gibt an, das Rechenzentrum, in der Website ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="d2d17-232">This setting specifies which data center your web site will run in.</span></span> <span data-ttu-id="d2d17-233">Weitere Informationen zu Ressourcengruppen finden Sie in der Dokumentation auf [Azure Docs](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-overview#resource-groups).</span><span class="sxs-lookup"><span data-stu-id="d2d17-233">For more information about Resource Groups, read the documentation on [Azure Docs](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-overview#resource-groups).</span></span>
5. <span data-ttu-id="d2d17-234">Erstellen Sie ein neues **App Service-Plan** durch Klicken auf die *Abschnitt "App-Dienst"*, **neu erstellen**, und geben Sie **App Service-Plan** (kann denselben Namen wie sein App Service), **Speicherort**, und **Tarif** (es ist eine kostenlose-Option).</span><span class="sxs-lookup"><span data-stu-id="d2d17-234">Create a new **App Service Plan** by clicking the *App Service section*, **Create New**, and fill in **App Service plan** (can be same name as App Service), **Location**, and **Pricing tier** (there is a free option).</span></span>

    ![](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Create-AppService.png)
6. <span data-ttu-id="d2d17-235">Klicken Sie auf die **SQL-Datenbank**, und wählen Sie *neu erstellen* oder eine vorhandene Datenbank auswählen</span><span class="sxs-lookup"><span data-stu-id="d2d17-235">Click the **SQL Database**, and choose *Create New* or select an existing database</span></span>

    ![](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Create-Database.png)

7. <span data-ttu-id="d2d17-236">In der **Namen** Geben Sie einen Namen für Ihre Datenbank.</span><span class="sxs-lookup"><span data-stu-id="d2d17-236">In the **Name** box, enter a name for your database.</span></span>
8. <span data-ttu-id="d2d17-237">Klicken Sie auf die **Zielserver** wählen Sie im **Erstellen eines neuen Servers**.</span><span class="sxs-lookup"><span data-stu-id="d2d17-237">Click the **Target Server** box, select **Create a new server**.</span></span> <span data-ttu-id="d2d17-238">Wenn Sie einen Server zuvor erstellt haben, können Sie Alternativ können Sie diesen Server aus der Liste der verfügbaren Server auswählen.</span><span class="sxs-lookup"><span data-stu-id="d2d17-238">Alternatively, if you previously created a server, you can select that server from list of available servers.</span></span>
9. <span data-ttu-id="d2d17-239">Wählen Sie **Tarif** Abschnitt *frei*.</span><span class="sxs-lookup"><span data-stu-id="d2d17-239">Choose **Pricing tier** section, choose *Free*.</span></span> <span data-ttu-id="d2d17-240">Wenn zusätzliche Ressourcen benötigt werden, kann die Datenbank zu einem beliebigen Zeitpunkt skaliert.</span><span class="sxs-lookup"><span data-stu-id="d2d17-240">If additional resources are needed, the database can be scaled up at any time.</span></span> <span data-ttu-id="d2d17-241">Lesen Sie die Dokumentation weitere auf SQL Azure-Preismodell auf [Azure Docs](https://azure.microsoft.com/pricing/details/sql-database/).</span><span class="sxs-lookup"><span data-stu-id="d2d17-241">To learn more on Azure SQL Pricing, read the documentation on [Azure Docs](https://azure.microsoft.com/pricing/details/sql-database/).</span></span>
10. <span data-ttu-id="d2d17-242">Ändern Sie [Sortierung](https://docs.microsoft.com/sql/relational-databases/collations/collation-and-unicode-support) nach Bedarf.</span><span class="sxs-lookup"><span data-stu-id="d2d17-242">Modify [collation](https://docs.microsoft.com/sql/relational-databases/collations/collation-and-unicode-support) as needed.</span></span>
11. <span data-ttu-id="d2d17-243">Geben Sie einen Administrator **SQL-Administratorbenutzername** und **SQL-Administratorkennwort**.</span><span class="sxs-lookup"><span data-stu-id="d2d17-243">Enter an administrator **SQL Admin Username** and **SQL Admin Password**.</span></span> <span data-ttu-id="d2d17-244">Wenn Sie ausgewählt haben **neue SQL-Datenbankserver**, Sie sind nicht Sie einen vorhandenen Namen und Kennwort hier eingeben, wird Sie einen neuen Namen und ein Kennwort, die Sie jetzt definieren, zur späteren Verwendung beim Zugriff auf die Datenbank eingeben.</span><span class="sxs-lookup"><span data-stu-id="d2d17-244">If you selected **New SQL Database server**, you aren't entering an existing name and password here, you're entering a new name and password that you're defining now to use later when you access the database.</span></span> <span data-ttu-id="d2d17-245">Wenn Sie einen Server ausgewählt haben, den Sie zuvor erstellt haben, müssen Sie Anmeldeinformationen für diesen Server eingeben.</span><span class="sxs-lookup"><span data-stu-id="d2d17-245">If you selected a server that you created previously, you'll enter credentials for that server.</span></span>
12. <span data-ttu-id="d2d17-246">Telemetrie-Erfassung kann für die App Service mithilfe von Application Insights aktiviert werden.</span><span class="sxs-lookup"><span data-stu-id="d2d17-246">Telemetry collection can be enabled for App Service using Application Insights.</span></span> <span data-ttu-id="d2d17-247">Application Insights mit wenig Konfiguration erfasst wertvolle Ereignis, Ausnahme, Abhängigkeits-, Anforderung und Ablaufverfolgungsinformationen.</span><span class="sxs-lookup"><span data-stu-id="d2d17-247">Application Insights with little configuration collects valuable event, exception, dependency, request, and trace information.</span></span> <span data-ttu-id="d2d17-248">Weitere Informationen zu Application Insights Einstieg [Azure Docs](https://azure.microsoft.com/services/application-insights/).</span><span class="sxs-lookup"><span data-stu-id="d2d17-248">To learn more about Application Insights, get started in [Azure Docs](https://azure.microsoft.com/services/application-insights/).</span></span>
13. <span data-ttu-id="d2d17-249">Klicken Sie auf **erstellen** unten auf dem Blatt ", um anzugeben, dass Sie fertig sind.</span><span class="sxs-lookup"><span data-stu-id="d2d17-249">Click **Create** at the bottom of the blade to indicate that you're finished.</span></span>
  
    <span data-ttu-id="d2d17-250">Das Verwaltungsportal auf der Seite "Dashboards" zurückgibt und die **Benachrichtigungen** Blatt am oberen Rand der Seite zeigt an, dass die Website erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="d2d17-250">The Management Portal returns to the Dashboards page, and the **Notifications** blade at the top of the page shows that the site is being created.</span></span> <span data-ttu-id="d2d17-251">Nach einer Weile (in der Regel weniger als eine Minute) wird eine Benachrichtigung, die die Bereitstellung erfolgreich war.</span><span class="sxs-lookup"><span data-stu-id="d2d17-251">After a while (typically less than a minute), there will be a notification that the Deployment succeeded.</span></span> <span data-ttu-id="d2d17-252">In der Navigationsleiste auf der linken Seite der neuen **App Service** wird angezeigt, der *Anwendungsdienste* Abschnitt und der neuen **SQL-Datenbank** wird angezeigt, der *SQL-Datenbanken*  Abschnitt.</span><span class="sxs-lookup"><span data-stu-id="d2d17-252">In the navigation bar at the left, the new **App Service** appears in the *App Services* section and the new **SQL Database** appears in the *SQL Databases* section.</span></span>

### <a name="deploy-the-application-to-azure"></a><span data-ttu-id="d2d17-253">Bereitstellen der Anwendung in Azure</span><span class="sxs-lookup"><span data-stu-id="d2d17-253">Deploy the application to Azure</span></span>

1. <span data-ttu-id="d2d17-254">In Visual Studio mit der Maustaste des Projekts im **Projektmappen-Explorer** , und wählen Sie **veröffentlichen** aus dem Kontextmenü.</span><span class="sxs-lookup"><span data-stu-id="d2d17-254">In Visual Studio, right-click the project in **Solution Explorer** and select **Publish** from the context menu.</span></span>
  
    ![Im Projektkontextmenü veröffentlichen](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image10.png)
2. <span data-ttu-id="d2d17-256">In der **Profil** auf der Registerkarte die **Web veröffentlichen** -Assistenten klicken Sie auf **Microsoft Azure App Service**.</span><span class="sxs-lookup"><span data-stu-id="d2d17-256">In the **Profile** tab of the **Publish Web** wizard, click **Microsoft Azure App Service**.</span></span>
  
    ![Veröffentlichungseinstellungen importieren](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-ChooseTarget.png)
3. <span data-ttu-id="d2d17-258">Wenn Sie zuvor nicht Ihrem Azure-Abonnement in Visual Studio hinzugefügt haben, führen Sie die Schritte auf dem Bildschirm.</span><span class="sxs-lookup"><span data-stu-id="d2d17-258">If you have not previously added your Azure subscription in Visual Studio, perform the steps on the screen.</span></span> <span data-ttu-id="d2d17-259">Diese Schritte aktivieren Visual Studio die Verbindung mit Ihrem Azure-Abonnement so, die die Liste der **Anwendungsdienste** Ihrer Website enthalten.</span><span class="sxs-lookup"><span data-stu-id="d2d17-259">These steps enable Visual Studio to connect to your Azure subscription so that the list of **App Services** will include your web site.</span></span>
 
4. <span data-ttu-id="d2d17-260">Wählen Sie die **Abonnement** Sie das App Service-hinzugefügt haben, klicken Sie dann die **App Service-Plan** Ihren App Service ein Teil ist, Ordner und schließlich die **Anwendungsdienst** selbst gefolgt von **Ok**.</span><span class="sxs-lookup"><span data-stu-id="d2d17-260">Select the **Subscription** you added the App Service to, then the **App Service Plan** folder your App Service is a part of, and finally the **App Service** itself followed by **Ok**.</span></span>

    ![Wählen Sie die App Service](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-AppService.png)
5. <span data-ttu-id="d2d17-262">Nachdem Sie das Profil konfiguriert wurde, die **Verbindung** Registerkarte wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="d2d17-262">After the Profile has been configured, the **Connection** tab will be shown.</span></span> <span data-ttu-id="d2d17-263">Klicken Sie auf **Validate Connection** um sicherzustellen, dass die Einstellungen richtig sind.</span><span class="sxs-lookup"><span data-stu-id="d2d17-263">Click **Validate Connection** to make sure that the settings are correct</span></span>

    ![Überprüfen der Verbindung](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-Connection.png)
6. <span data-ttu-id="d2d17-265">Wenn die Verbindung erfolgreich überprüft wurde, wird ein grünes Häkchen neben gezeigt die **Validate Connection** Schaltfläche.</span><span class="sxs-lookup"><span data-stu-id="d2d17-265">When the connection has been validated, a green check mark is shown next to the **Validate Connection** button.</span></span> <span data-ttu-id="d2d17-266">Klicken Sie auf **Weiter**.</span><span class="sxs-lookup"><span data-stu-id="d2d17-266">Click **Next**.</span></span>
  
    ![Erfolgreich überprüfte Verbindung](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-SettingsValidated.png)
7. <span data-ttu-id="d2d17-268">Öffnen der **Remote Verbindungszeichenfolge** Dropdown-Liste unter **SchoolContext** , und wählen Sie die Verbindungszeichenfolge für die Datenbank, die Sie erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="d2d17-268">Open the **Remote connection string** drop-down list under **SchoolContext** and select the connection string for the database you created.</span></span>
8. <span data-ttu-id="d2d17-269">Wählen Sie **Datenbank aktualisieren**.</span><span class="sxs-lookup"><span data-stu-id="d2d17-269">Select **Update database**.</span></span>

    ![Registerkarte "Einstellungen"](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-Settings.png)

    <span data-ttu-id="d2d17-271">Diese Einstellung bewirkt, dass der Bereitstellungsprozess so konfigurieren Sie die Anwendung automatisch *"Web.config"* Datei auf dem Zielserver, sodass der Code First verwendet die `MigrateDatabaseToLatestVersion` Initialisiererklasse.</span><span class="sxs-lookup"><span data-stu-id="d2d17-271">This setting causes the deployment process to automatically configure the application *Web.config* file on the destination server so that Code First uses the `MigrateDatabaseToLatestVersion` initializer class.</span></span>
9. <span data-ttu-id="d2d17-272">Klicken Sie auf **Weiter**.</span><span class="sxs-lookup"><span data-stu-id="d2d17-272">Click **Next**.</span></span>
10. <span data-ttu-id="d2d17-273">In der **Vorschau** auf **starten Preview**.</span><span class="sxs-lookup"><span data-stu-id="d2d17-273">In the **Preview** tab, click **Start Preview**.</span></span>
  
    ![Schaltfläche "StartPreview" auf der Registerkarte "Vorschau"](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-Preview.png)
  
    <span data-ttu-id="d2d17-275">Die Registerkarte zeigt eine Liste der Dateien, die an den Server kopiert werden.</span><span class="sxs-lookup"><span data-stu-id="d2d17-275">The tab displays a list of the files that will be copied to the server.</span></span> <span data-ttu-id="d2d17-276">Anzeigen der Vorschau ist nicht erforderlich, um die Anwendung zu veröffentlichen, aber es ist eine nützliche Funktion zu berücksichtigen.</span><span class="sxs-lookup"><span data-stu-id="d2d17-276">Displaying the preview isn't required to publish the application but is a useful function to be aware of.</span></span> <span data-ttu-id="d2d17-277">In diesem Fall müssen Sie mit der Liste der Dateien keine Wirkung, die angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="d2d17-277">In this case, you don't need to do anything with the list of files that is displayed.</span></span> <span data-ttu-id="d2d17-278">Das nächste Mal mit das Sie diese Anwendung bereitstellen, werden in dieser Liste nur die Dateien, die geändert wurden.</span><span class="sxs-lookup"><span data-stu-id="d2d17-278">The next time you deploy this application, only the files that have changed will be in this list.</span></span>
    <span data-ttu-id="d2d17-279">![Dateiausgabe StartPreview](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-PreviewLoaded.png)</span><span class="sxs-lookup"><span data-stu-id="d2d17-279">![StartPreview file output](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-PreviewLoaded.png)</span></span>

11. <span data-ttu-id="d2d17-280">Klicken Sie auf **Veröffentlichen**.</span><span class="sxs-lookup"><span data-stu-id="d2d17-280">Click **Publish**.</span></span>
    <span data-ttu-id="d2d17-281">Visual Studio startet den Prozess der die Dateien auf dem Azure-Server kopieren.</span><span class="sxs-lookup"><span data-stu-id="d2d17-281">Visual Studio begins the process of copying the files to the Azure server.</span></span>
12. <span data-ttu-id="d2d17-282">Die **Ausgabe** Fenster zeigt, welche Bereitstellungsaktionen ausgeführt wurden, und gibt erfolgreichen Abschluss der Bereitstellung.</span><span class="sxs-lookup"><span data-stu-id="d2d17-282">The **Output** window shows what deployment actions were taken and reports successful completion of the deployment.</span></span>
  
    ![Fenster "Ausgabe" erfolgreich berichtsbereitstellung](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-BuildOutput.png)
13. <span data-ttu-id="d2d17-284">Nach der erfolgreichen Bereitstellung wird der Standardbrowser automatisch an die URL der bereitgestellten-Website geöffnet.</span><span class="sxs-lookup"><span data-stu-id="d2d17-284">Upon successful deployment, the default browser automatically opens to the URL of the deployed web site.</span></span>
    <span data-ttu-id="d2d17-285">Die Anwendung, die Sie erstellt haben, wird jetzt in der Cloud ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="d2d17-285">The application you created is now running in the cloud.</span></span> 
  
    ![Students_index_page_with_paging](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-Site.png)

<span data-ttu-id="d2d17-287">Zu diesem Zeitpunkt Ihrer *SchoolContext* Datenbank wurde in der Azure SQL-Datenbank erstellt, da Sie ausgewählte **führen Sie Code First-Migrationen (wird beim Anwendungsstart ausgeführt)**.</span><span class="sxs-lookup"><span data-stu-id="d2d17-287">At this point your *SchoolContext* database has been created in the Azure SQL Database because you selected **Execute Code First Migrations (runs on app start)**.</span></span> <span data-ttu-id="d2d17-288">Die *"Web.config"* -Datei in die bereitgestellte Website geändert wurde, damit die [MigrateDatabaseToLatestVersion](https://msdn.microsoft.com/library/hh829476(v=vs.103).aspx) Initialisierer ausgeführt wird, zum ersten Mal Code liest oder schreibt Daten in der Datenbank (die aufgetreten sind Wenn Sie aktiviert das **Studenten** Registerkarte "):</span><span class="sxs-lookup"><span data-stu-id="d2d17-288">The *Web.config* file in the deployed web site has been changed so that the [MigrateDatabaseToLatestVersion](https://msdn.microsoft.com/library/hh829476(v=vs.103).aspx) initializer runs the first time your code reads or writes data in the database (which happened when you selected the **Students** tab):</span></span>

![](https://asp.net/media/4367421/mig.png)

<span data-ttu-id="d2d17-289">Der Bereitstellungsprozess erstellt auch eine neue Verbindungszeichenfolge *(SchoolContext\_DatabasePublish*) für die Code First-Migrationen zum Aktualisieren des Datenbankschemas und das seeding der Datenbank verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="d2d17-289">The deployment process also created a new connection string *(SchoolContext\_DatabasePublish*) for Code First Migrations to use for updating the database schema and seeding the database.</span></span>

![Database_Publish-Verbindungszeichenfolge](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image26.png)

<span data-ttu-id="d2d17-291">Sie finden die bereitgestellte Version der Datei "Web.config" auf dem lokalen Computer in *ContosoUniversity\obj\Release\Package\PackageTmp\Web.config*. Sie erreichen die bereitgestellte *"Web.config"* Datei selbst unter Verwendung von FTP.</span><span class="sxs-lookup"><span data-stu-id="d2d17-291">You can find the deployed version of the Web.config file on your own computer in *ContosoUniversity\obj\Release\Package\PackageTmp\Web.config*. You can access the deployed *Web.config* file itself by using FTP.</span></span> <span data-ttu-id="d2d17-292">Anweisungen hierzu finden Sie unter [ASP.NET Web-Bereitstellung mit Visual Studio: Bereitstellen eines Updates Code](xref:web-forms/overview/deployment/visual-studio-web-deployment/deploying-a-code-update).</span><span class="sxs-lookup"><span data-stu-id="d2d17-292">For instructions, see [ASP.NET Web Deployment using Visual Studio: Deploying a Code Update](xref:web-forms/overview/deployment/visual-studio-web-deployment/deploying-a-code-update).</span></span> <span data-ttu-id="d2d17-293">Befolgen Sie die Anweisungen, die beginnen mit "um ein FTP-Tool verwenden zu können, benötigen Sie drei Dinge: der FTP-URL, den Benutzernamen und das Kennwort."</span><span class="sxs-lookup"><span data-stu-id="d2d17-293">Follow the instructions that start with "To use an FTP tool, you need three things: the FTP URL, the user name, and the password."</span></span>

> [!NOTE]
> <span data-ttu-id="d2d17-294">Die Web-app implementieren nicht Sicherheit, damit Personen die URL findet die Daten ändern kann.</span><span class="sxs-lookup"><span data-stu-id="d2d17-294">The web app doesn't implement security, so anyone who finds the URL can change the data.</span></span> <span data-ttu-id="d2d17-295">Informationen zum Sichern der Website finden Sie unter [eine sichere ASP.NET MVC-app mit Mitgliedschaft, OAuth und SQL-Datenbank in Azure bereitstellen](https://docs.microsoft.com/aspnet/core/security/authorization/secure-data).</span><span class="sxs-lookup"><span data-stu-id="d2d17-295">For instructions on how to secure the web site, see [Deploy a Secure ASP.NET MVC app with Membership, OAuth, and SQL Database to Azure](https://docs.microsoft.com/aspnet/core/security/authorization/secure-data).</span></span> <span data-ttu-id="d2d17-296">Sie können verhindern, dass andere Personen mithilfe der Website mit dem Azure-Verwaltungsportal oder **Server-Explorer** in Visual Studio zum Beenden der Website.</span><span class="sxs-lookup"><span data-stu-id="d2d17-296">You can prevent other people from using the site by using the Azure Management Portal or **Server Explorer** in Visual Studio to stop the site.</span></span>


![](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Stop-Service.png)

## <a name="advanced-migrations-scenarios"></a><span data-ttu-id="d2d17-297">Erweiterte Migrationsszenarien</span><span class="sxs-lookup"><span data-stu-id="d2d17-297">Advanced Migrations Scenarios</span></span>

<span data-ttu-id="d2d17-298">Wenn Sie eine Datenbank durch Ausführen von Migrationen automatisch, wie in diesem Lernprogramm gezeigt bereitstellen und Sie die Bereitstellung für eine Website, die auf mehreren Servern ausgeführt wird, konnte mehreren Servern, die versuchen, gleichzeitig Migrationen auszuführen abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="d2d17-298">If you deploy a database by running migrations automatically as shown in this tutorial, and you are deploying to a web site that runs on multiple servers, you could get multiple servers trying to run migrations at the same time.</span></span> <span data-ttu-id="d2d17-299">Migrationen sind atomar, sodass zwei Server versuchen, die zur selben Migration auszuführen, eine funktionieren und die andere fehl schlägt (vorausgesetzt, dass zwei Mal die Vorgänge erfolgen können).</span><span class="sxs-lookup"><span data-stu-id="d2d17-299">Migrations are atomic, so if two servers try to run the same migration, one will succeed and the other will fail (assuming the operations can't be done twice).</span></span> <span data-ttu-id="d2d17-300">In diesem Szenario ggf. diese Probleme zu vermeiden. können Sie Migrationen manuell aufrufen und richten Ihren eigenen Code, sodass es nur einmal ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="d2d17-300">In that scenario if you want to avoid those issues, you can call migrations manually and set up your own code so that it only happens once.</span></span> <span data-ttu-id="d2d17-301">Weitere Informationen finden Sie unter [ausführen und Skripts Migrationen aus Code](http://romiller.com/2012/02/09/running-scripting-migrations-from-code/) Rowan Miller Blog und [Migrate.exe](https://msdn.microsoft.com/data/jj618307) (für Migrationen wird über die Befehlszeile ausgeführt) auf MSDN.</span><span class="sxs-lookup"><span data-stu-id="d2d17-301">For more information, see [Running and Scripting Migrations from Code](http://romiller.com/2012/02/09/running-scripting-migrations-from-code/) on Rowan Miller's blog and [Migrate.exe](https://msdn.microsoft.com/data/jj618307) (for executing migrations from the command line) on MSDN.</span></span>

<span data-ttu-id="d2d17-302">Informationen zu anderen Migrationsszenarien finden Sie unter [Migrationen Screencast Reihe](https://blogs.msdn.com/b/adonet/archive/2014/03/12/migrations-screencast-series.aspx).</span><span class="sxs-lookup"><span data-stu-id="d2d17-302">For information about other migrations scenarios, see [Migrations Screencast Series](https://blogs.msdn.com/b/adonet/archive/2014/03/12/migrations-screencast-series.aspx).</span></span>

## <a name="code-first-initializers"></a><span data-ttu-id="d2d17-303">Erste Initialisierer Code</span><span class="sxs-lookup"><span data-stu-id="d2d17-303">Code First Initializers</span></span>

<span data-ttu-id="d2d17-304">Im Abschnitt Bereitstellung Sie gesehen haben die [MigrateDatabaseToLatestVersion](https://msdn.microsoft.com/library/hh829476(v=vs.103).aspx) Initialisierer verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="d2d17-304">In the deployment section you saw the [MigrateDatabaseToLatestVersion](https://msdn.microsoft.com/library/hh829476(v=vs.103).aspx) initializer being used.</span></span> <span data-ttu-id="d2d17-305">Code enthält zunächst auch andere Initialisierer, einschließlich [CreateDatabaseIfNotExists](https://msdn.microsoft.com/library/gg679221(v=vs.103).aspx) (Standard), [DropCreateDatabaseIfModelChanges](https://msdn.microsoft.com/library/gg679604(v=VS.103).aspx) (die Sie zuvor verwendet haben) und [ DropCreateDatabaseAlways](https://msdn.microsoft.com/library/gg679506(v=VS.103).aspx).</span><span class="sxs-lookup"><span data-stu-id="d2d17-305">Code First also provides other initializers, including [CreateDatabaseIfNotExists](https://msdn.microsoft.com/library/gg679221(v=vs.103).aspx) (the default), [DropCreateDatabaseIfModelChanges](https://msdn.microsoft.com/library/gg679604(v=VS.103).aspx) (which you used earlier) and [DropCreateDatabaseAlways](https://msdn.microsoft.com/library/gg679506(v=VS.103).aspx).</span></span> <span data-ttu-id="d2d17-306">Die `DropCreateAlways` Initialisierer kann nützlich zum Einrichten von Bedingungen für die Komponententests werden.</span><span class="sxs-lookup"><span data-stu-id="d2d17-306">The `DropCreateAlways` initializer can be useful for setting up conditions for unit tests.</span></span> <span data-ttu-id="d2d17-307">Sie können auch eigene Initialisierer schreiben, und Sie können einen Initialisierer explizit aufrufen, wenn Sie nicht warten, bis die Anwendung liest aus oder in die Datenbank geschrieben werden sollen.</span><span class="sxs-lookup"><span data-stu-id="d2d17-307">You can also write your own initializers, and you can call an initializer explicitly if you don't want to wait until the application reads from or writes to the database.</span></span> <span data-ttu-id="d2d17-308">Zu dem Zeitpunkt, die in diesem Lernprogramm im November 2013 geschrieben wird können Sie nur die Initialisierer der Create "und" DropCreate verwenden, bevor Sie Migrationen aktivieren.</span><span class="sxs-lookup"><span data-stu-id="d2d17-308">At the time this tutorial is being written in November, 2013, you can only use the Create and DropCreate initializers before you enable migrations.</span></span> <span data-ttu-id="d2d17-309">Das Entity Framework-Team arbeitet an machen diese Initialisierer mit Migrationen auch verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="d2d17-309">The Entity Framework team is working on making these initializers usable with migrations as well.</span></span>

<span data-ttu-id="d2d17-310">Weitere Informationen zu den Initialisierer, finden Sie unter [Grundlegendes zu Datenbank-Initialisierer in Entity Framework Code First](http://www.codeguru.com/csharp/article.php/c19999/Understanding-Database-Initializers-in-Entity-Framework-Code-First.htm) und Kapitel 6 des Buchs [Entity Framework-Programmierung: Code First](http://shop.oreilly.com/product/0636920022220.do) von Julie Lerman und Rowan Miller.</span><span class="sxs-lookup"><span data-stu-id="d2d17-310">For more information about initializers, see [Understanding Database Initializers in Entity Framework Code First](http://www.codeguru.com/csharp/article.php/c19999/Understanding-Database-Initializers-in-Entity-Framework-Code-First.htm) and chapter 6 of the book [Programming Entity Framework: Code First](http://shop.oreilly.com/product/0636920022220.do) by Julie Lerman and Rowan Miller.</span></span>

## <a name="summary"></a><span data-ttu-id="d2d17-311">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="d2d17-311">Summary</span></span>

<span data-ttu-id="d2d17-312">In diesem Lernprogramm haben Sie gesehen, wie Migrationen zu aktivieren und die Anwendung bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="d2d17-312">In this tutorial you've seen how to enable migrations and deploy the application.</span></span> <span data-ttu-id="d2d17-313">In den nächsten Lernprogrammen beginnen Sie erweiterte Themen ansehen, erweitern Sie das Datenmodell.</span><span class="sxs-lookup"><span data-stu-id="d2d17-313">In the next tutorial you'll begin looking at more advanced topics by expanding the data model.</span></span>

<span data-ttu-id="d2d17-314">Lassen Sie Sie Feedback auf wie in diesem Lernprogramm mögen und was wir weiter verbessern können.</span><span class="sxs-lookup"><span data-stu-id="d2d17-314">Please leave feedback on how you liked this tutorial and what we could improve.</span></span> <span data-ttu-id="d2d17-315">Sie können auch neue Themen am anfordern [Me wie mit Code anzeigen](http://aspnet.uservoice.com/forums/228522-show-me-how-with-code).</span><span class="sxs-lookup"><span data-stu-id="d2d17-315">You can also request new topics at [Show Me How With Code](http://aspnet.uservoice.com/forums/228522-show-me-how-with-code).</span></span>

<span data-ttu-id="d2d17-316">Links zu anderen Entity Framework-Ressourcen finden Sie im [ASP.NET Data Access - Ressourcen empfohlen](xref:whitepapers/aspnet-data-access-content-map).</span><span class="sxs-lookup"><span data-stu-id="d2d17-316">Links to other Entity Framework resources can be found in [ASP.NET Data Access - Recommended Resources](xref:whitepapers/aspnet-data-access-content-map).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="d2d17-317">[Zurück](xref:mvc/overview/getting-started/getting-started-with-ef-using-mvc/connection-resiliency-and-command-interception-with-the-entity-framework-in-an-asp-net-mvc-application)
> [Weiter](xref:mvc/overview/getting-started/getting-started-with-ef-using-mvc/creating-a-more-complex-data-model-for-an-asp-net-mvc-application)</span><span class="sxs-lookup"><span data-stu-id="d2d17-317">[Previous](xref:mvc/overview/getting-started/getting-started-with-ef-using-mvc/connection-resiliency-and-command-interception-with-the-entity-framework-in-an-asp-net-mvc-application)
[Next](xref:mvc/overview/getting-started/getting-started-with-ef-using-mvc/creating-a-more-complex-data-model-for-an-asp-net-mvc-application)</span></span>
