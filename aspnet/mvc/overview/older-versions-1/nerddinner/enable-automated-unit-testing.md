---
uid: mvc/overview/older-versions-1/nerddinner/enable-automated-unit-testing
title: Automatisierte Komponententests | Microsoft Docs
author: microsoft
description: "Schritt 12 zeigt, wie eine Suite von automatisierte Komponententests entwickeln, überprüfen, ob unsere NerdDinner-Funktionalität und die geben uns des vertrauen Änderungen..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/27/2010
ms.topic: article
ms.assetid: a19ff2ce-3f7e-4358-9a51-a1403da9c63e
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/older-versions-1/nerddinner/enable-automated-unit-testing
msc.type: authoredcontent
ms.openlocfilehash: 1a4258054d90b2d5bcc06a63fb6f3b4673a4837d
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/10/2017
---
<a name="enable-automated-unit-testing"></a><span data-ttu-id="54c10-103">Aktivieren Sie automatisierte Komponententests</span><span class="sxs-lookup"><span data-stu-id="54c10-103">Enable Automated Unit Testing</span></span>
====================
<span data-ttu-id="54c10-104">durch [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="54c10-104">by [Microsoft](https://github.com/microsoft)</span></span>

[<span data-ttu-id="54c10-105">PDF herunterladen</span><span class="sxs-lookup"><span data-stu-id="54c10-105">Download PDF</span></span>](http://aspnetmvcbook.s3.amazonaws.com/aspnetmvc-nerdinner_v1.pdf)

> <span data-ttu-id="54c10-106">Dies ist Schritt 12 mit einer kostenlosen ["NerdDinner" Anwendung Lernprogramm](introducing-the-nerddinner-tutorial.md) , die Durchläufe-durch die Schritte zum Erstellen einer kleinen, aber abgeschlossen haben, Webanwendung, die mithilfe von ASP.NET MVC-1.</span><span class="sxs-lookup"><span data-stu-id="54c10-106">This is step 12 of a free ["NerdDinner" application tutorial](introducing-the-nerddinner-tutorial.md) that walks-through how to build a small, but complete, web application using ASP.NET MVC 1.</span></span>
> 
> <span data-ttu-id="54c10-107">Schritt 12 zeigt, wie eine Suite von automatisierte Komponententests entwickeln, zu überprüfen, ob unsere NerdDinner-Funktionalität und die geben uns der Gewissheit, Änderungen und Verbesserungen für die Anwendung in der Zukunft zu vereinfachen.</span><span class="sxs-lookup"><span data-stu-id="54c10-107">Step 12 shows how to develop a suite of automated unit tests that verify our NerdDinner functionality, and which will give us the confidence to make changes and improvements to the application in the future.</span></span>
> 
> <span data-ttu-id="54c10-108">Bei Verwendung von ASP.NET MVC 3 empfehlen wir führen Sie die [erste Schritte mit MVC 3](../../older-versions/getting-started-with-aspnet-mvc3/cs/intro-to-aspnet-mvc-3.md) oder [MVC Music Store](../../older-versions/mvc-music-store/mvc-music-store-part-1.md) Lernprogramme.</span><span class="sxs-lookup"><span data-stu-id="54c10-108">If you are using ASP.NET MVC 3, we recommend you follow the [Getting Started With MVC 3](../../older-versions/getting-started-with-aspnet-mvc3/cs/intro-to-aspnet-mvc-3.md) or [MVC Music Store](../../older-versions/mvc-music-store/mvc-music-store-part-1.md) tutorials.</span></span>


## <a name="nerddinner-step-12-unit-testing"></a><span data-ttu-id="54c10-109">NerdDinner Schritt 12: UnitTests</span><span class="sxs-lookup"><span data-stu-id="54c10-109">NerdDinner Step 12: Unit Testing</span></span>

<span data-ttu-id="54c10-110">Wir entwickeln eine Suite von automatisierte Komponententests zu überprüfen, ob unsere NerdDinner-Funktionalität und die geben uns der Gewissheit, Änderungen und Verbesserungen für die Anwendung in der Zukunft zu vereinfachen.</span><span class="sxs-lookup"><span data-stu-id="54c10-110">Let's develop a suite of automated unit tests that verify our NerdDinner functionality, and which will give us the confidence to make changes and improvements to the application in the future.</span></span>

### <a name="why-unit-test"></a><span data-ttu-id="54c10-111">Warum Komponententest?</span><span class="sxs-lookup"><span data-stu-id="54c10-111">Why Unit Test?</span></span>

<span data-ttu-id="54c10-112">Auf dem Laufwerk, in die Arbeit einer Morgen müssen Sie einen plötzlichen Flash von Inspiration zu einer Anwendung, auf dem Sie arbeiten.</span><span class="sxs-lookup"><span data-stu-id="54c10-112">On the drive into work one morning you have a sudden flash of inspiration about an application you are working on.</span></span> <span data-ttu-id="54c10-113">Sie können eine Änderung, die Sie implementieren können, die die Anwendung erheblich verbessern wird.</span><span class="sxs-lookup"><span data-stu-id="54c10-113">You realize there is a change you can implement that will make the application dramatically better.</span></span> <span data-ttu-id="54c10-114">Es kann sein, ein refactoring, die der Code bereinigt, fügt ein neues Feature oder einen Fehler behebt.</span><span class="sxs-lookup"><span data-stu-id="54c10-114">It might be a refactoring that cleans up the code, adds a new feature, or fixes a bug.</span></span>

<span data-ttu-id="54c10-115">Ist die Frage, die Sie confronts, wenn Sie bei Ihrem Computer ankommen – "beschreibt die sichere dieser Verbesserung vornehmen?"</span><span class="sxs-lookup"><span data-stu-id="54c10-115">The question that confronts you when you arrive at your computer is – "how safe is it to make this improvement?"</span></span> <span data-ttu-id="54c10-116">Was geschieht, wenn der Änderung aufweist Nebeneffekte oder unterbrochen etwas?</span><span class="sxs-lookup"><span data-stu-id="54c10-116">What if making the change has side effects or breaks something?</span></span> <span data-ttu-id="54c10-117">Die Änderung kann einfach sein und dauern nur einige Minuten, bis zu implementieren, führt aber was geschieht, wenn Stunden manuell in allen Anwendungsszenarien zu testen?</span><span class="sxs-lookup"><span data-stu-id="54c10-117">The change might be simple and only take a few minutes to implement, but what if it takes hours to manually test out all of the application scenarios?</span></span> <span data-ttu-id="54c10-118">Was geschieht, wenn Sie vergessen, ein Szenario behandelt, und eine fehlerhafte Anwendung wechselt in die Produktion?</span><span class="sxs-lookup"><span data-stu-id="54c10-118">What if you forget to cover a scenario and a broken application goes into production?</span></span> <span data-ttu-id="54c10-119">Ist dieser Verbesserung sollte alle Aufwand wirklich vornehmen?</span><span class="sxs-lookup"><span data-stu-id="54c10-119">Is making this improvement really worth all the effort?</span></span>

<span data-ttu-id="54c10-120">Automatisierte Komponententests ermöglichen Sicherheitsnetz, die Ihnen ermöglicht, Ihre Anwendungen kontinuierlich verbessern und vermeiden, wird von der Code, dem Sie arbeiten.</span><span class="sxs-lookup"><span data-stu-id="54c10-120">Automated unit tests can provide a safety net that enables you to continually enhance your applications, and avoid being afraid of the code you are working on.</span></span> <span data-ttu-id="54c10-121">Auf diese Weise müssen von automatisierten Tests, die schnell zu, dass die Funktionalität ermöglicht es Ihnen überprüfen, code mit vertrauen –, und geben Sie Sie Sie andernfalls nicht vertraut sind haben möglicherweise Verbesserungen vorzunehmen.</span><span class="sxs-lookup"><span data-stu-id="54c10-121">Having automated tests that quickly verify functionality enables you to code with confidence – and empower you to make improvements you might otherwise not have felt comfortable doing.</span></span> <span data-ttu-id="54c10-122">Außerdem unterstützen Sie die Lösungen sind besser verwaltbar zu erstellen und haben eine Lebensdauer - Investitionen zu einer wesentlich höheren zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="54c10-122">They also help create solutions that are more maintainable and have a longer lifetime - which leads to a much higher return on investment.</span></span>

<span data-ttu-id="54c10-123">Das ASP.NET MVC-Framework vereinfacht das einfache und natürliche Unit Test Anwendungsfunktionen.</span><span class="sxs-lookup"><span data-stu-id="54c10-123">The ASP.NET MVC Framework makes it easy and natural to unit test application functionality.</span></span> <span data-ttu-id="54c10-124">Außerdem können einen Test Driven Development (TDD)-Workflow, der je Test-First-Entwicklung ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="54c10-124">It also enables a Test Driven Development (TDD) workflow that enables test-first based development.</span></span>

### <a name="nerddinnertests-project"></a><span data-ttu-id="54c10-125">NerdDinner.Tests-Projekt</span><span class="sxs-lookup"><span data-stu-id="54c10-125">NerdDinner.Tests Project</span></span>

<span data-ttu-id="54c10-126">Wenn wir unsere NerdDinner Anwendung am Anfang dieses Lernprogramms erstellt haben, wurden wir aufgefordert, ein Dialogfeld gefragt, ob wir, erstellen Sie ein Komponententestprojekt zusammen mit dem Anwendungsprojekt zu wechseln möchten:</span><span class="sxs-lookup"><span data-stu-id="54c10-126">When we created our NerdDinner application at the beginning of this tutorial, we were prompted with a dialog asking whether we wanted to create a unit test project to go along with the application project:</span></span>

![](enable-automated-unit-testing/_static/image1.png)

<span data-ttu-id="54c10-127">Wir beibehalten der "Ja, Komponententestprojekt erstellen" Optionsfeld aktiviert – resultierte in einem Projekt auf "NerdDinner.Tests" unserer Projektmappe hinzugefügt wird:</span><span class="sxs-lookup"><span data-stu-id="54c10-127">We kept the "Yes, create a unit test project" radio button selected – which resulted in a "NerdDinner.Tests" project being added to our solution:</span></span>

![](enable-automated-unit-testing/_static/image2.png)

<span data-ttu-id="54c10-128">Das NerdDinner.Tests-Projekt verweist auf die NerdDinner Anwendung Projektassembly und ermöglicht es, fügen Sie einfach automatisierte Tests hinzu, durch die die Funktionalität der Anwendung überprüft.</span><span class="sxs-lookup"><span data-stu-id="54c10-128">The NerdDinner.Tests project references the NerdDinner application project assembly, and enables us to easily add automated tests to it that verify the application functionality.</span></span>

### <a name="creating-unit-tests-for-our-dinner-model-class"></a><span data-ttu-id="54c10-129">Erstellen von Komponententests für unsere Dinner Skriptobjektmodell-Klasse</span><span class="sxs-lookup"><span data-stu-id="54c10-129">Creating Unit Tests for our Dinner Model Class</span></span>

<span data-ttu-id="54c10-130">Fügen Sie einige Tests zu unserem NerdDinner.Tests-Projekt, das Überprüfen von der Dinner-Klasse, wenn wir unsere Modellebene erstellt erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="54c10-130">Let's add some tests to our NerdDinner.Tests project that verify the Dinner class we created when we built our model layer.</span></span>

<span data-ttu-id="54c10-131">Wir beginnen, erstellen Sie einen neuen Ordner in unserem Testprojekt mit der Bezeichnung "Modelle", in dem wir unsere Tests Modell bezogene platzieren müssen.</span><span class="sxs-lookup"><span data-stu-id="54c10-131">We'll start by creating a new folder within our test project called "Models" where we'll place our model-related tests.</span></span> <span data-ttu-id="54c10-132">Wir mit der rechten Maustaste auf den Ordner und wählen Sie dann die **Add -&gt;neuen Test** Menübefehl.</span><span class="sxs-lookup"><span data-stu-id="54c10-132">We'll then right-click on the folder and choose the **Add-&gt;New Test** menu command.</span></span> <span data-ttu-id="54c10-133">Hierdurch wird das Dialogfeld "Neuen Test hinzufügen" angezeigt.</span><span class="sxs-lookup"><span data-stu-id="54c10-133">This will bring up the "Add New Test" dialog.</span></span>

<span data-ttu-id="54c10-134">Wählen wir zum Erstellen eines "Komponententests", und nennen Sie sie "DinnerTest.cs":</span><span class="sxs-lookup"><span data-stu-id="54c10-134">We'll choose to create a "Unit Test" and name it "DinnerTest.cs":</span></span>

![](enable-automated-unit-testing/_static/image3.png)

<span data-ttu-id="54c10-135">Beim Klicken auf die Schaltfläche "ok" Visual Studio hinzufügen (eine DinnerTest.cs-Datei zum Projekt und öffnen):</span><span class="sxs-lookup"><span data-stu-id="54c10-135">When we click the "ok" button Visual Studio will add (and open) a DinnerTest.cs file to the project:</span></span>

![](enable-automated-unit-testing/_static/image4.png)

<span data-ttu-id="54c10-136">Die Visual Studio Unit Test Standardvorlage verfügt über eine Reihe von Code mit Codebausteinen, darin, die ich etwas unübersichtlichen finden.</span><span class="sxs-lookup"><span data-stu-id="54c10-136">The default Visual Studio unit test template has a bunch of boiler-plate code within it that I find a little messy.</span></span> <span data-ttu-id="54c10-137">Wir bereinigen sie einfach den folgenden Code enthält:</span><span class="sxs-lookup"><span data-stu-id="54c10-137">Let's clean it up to just contain the code below:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample1.cs)]

<span data-ttu-id="54c10-138">[TestClass]-Attribut auf die DinnerTest-Klasse, die oben genannten identifiziert sie als eine Klasse, die Tests, als auch optionale testinitialisierung und Beendigungscode enthalten soll.</span><span class="sxs-lookup"><span data-stu-id="54c10-138">The [TestClass] attribute on the DinnerTest class above identifies it as a class that will contain tests, as well as optional test initialization and teardown code.</span></span> <span data-ttu-id="54c10-139">Wir können Tests darin definieren, durch das Hinzufügen von öffentlichen Methoden, die einem [TestMethod]-Attribut verfügen.</span><span class="sxs-lookup"><span data-stu-id="54c10-139">We can define tests within it by adding public methods that have a [TestMethod] attribute on them.</span></span>

<span data-ttu-id="54c10-140">Im folgenden sind die erste von zwei Tests, die wir hinzufügen, die unsere Dinner-Klasse ausführen.</span><span class="sxs-lookup"><span data-stu-id="54c10-140">Below are the first of two tests we'll add that exercise our Dinner class.</span></span> <span data-ttu-id="54c10-141">Der erste Test überprüft, dass unsere Dinner ungültig ist, wenn eine neue Dinner erstellt wird, ohne alle Eigenschaften richtig festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="54c10-141">The first test verifies that our Dinner is invalid if a new Dinner is created without all properties being set correctly.</span></span> <span data-ttu-id="54c10-142">Der zweite Test stellt sicher, dass unsere Dinner gültig ist, wenn eine Dinner alle Eigenschaften, die durch gültige Werte festgelegt wurden:</span><span class="sxs-lookup"><span data-stu-id="54c10-142">The second test verifies that our Dinner is valid when a Dinner has all properties set with valid values:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample2.cs)]

<span data-ttu-id="54c10-143">Sie werden über bemerken, dass unsere Testnamen sehr explizite (und etwas verbose) werden.</span><span class="sxs-lookup"><span data-stu-id="54c10-143">You'll notice above that our test names are very explicit (and somewhat verbose).</span></span> <span data-ttu-id="54c10-144">Wir sind dabei, da wir möglicherweise erschöpft, Hunderten oder Tausenden von kleinen Tests erstellen, und wir können Sie schnell feststellen, die Absicht und das Verhalten der einzelnen von ihnen (insbesondere, wenn es über eine Liste von Fehlern in einem Test Runner suchen) zu erleichtern möchten.</span><span class="sxs-lookup"><span data-stu-id="54c10-144">We are doing this because we might end up creating hundreds or thousands of small tests, and we want to make it easy to quickly determine the intent and behavior of each of them (especially when we are looking through a list of failures in a test runner).</span></span> <span data-ttu-id="54c10-145">Nach der die Funktionalität, die sie testen möchten, sollten die Testnamen benannt werden.</span><span class="sxs-lookup"><span data-stu-id="54c10-145">The test names should be named after the functionality they are testing.</span></span> <span data-ttu-id="54c10-146">Oben verwenden wir ein "Nomen\_sollten\_Verb" Benennungsmuster.</span><span class="sxs-lookup"><span data-stu-id="54c10-146">Above we are using a "Noun\_Should\_Verb" naming pattern.</span></span>

<span data-ttu-id="54c10-147">Wir werden die Tests mit dem Muster – das steht für "Arrange, Act, Assert" testen "AAA" strukturieren:</span><span class="sxs-lookup"><span data-stu-id="54c10-147">We are structuring the tests using the "AAA" testing pattern – which stands for "Arrange, Act, Assert":</span></span>

- <span data-ttu-id="54c10-148">Angeordnet werden: Die Einheit, die zu testenden Setup</span><span class="sxs-lookup"><span data-stu-id="54c10-148">Arrange: Setup the unit being tested</span></span>
- <span data-ttu-id="54c10-149">ACT: Führen Sie die Einheit unter dem Test, und erfassen Sie der Ergebnisse</span><span class="sxs-lookup"><span data-stu-id="54c10-149">Act: Exercise the unit under test and capture results</span></span>
- <span data-ttu-id="54c10-150">Assert-: Überprüfen Sie, ob das Verhalten</span><span class="sxs-lookup"><span data-stu-id="54c10-150">Assert: Verify the behavior</span></span>

<span data-ttu-id="54c10-151">Beim Schreiben von wir führen zu viele Tests zu vermeiden, dass die einzelnen Tests werden soll.</span><span class="sxs-lookup"><span data-stu-id="54c10-151">When we write tests we want to avoid having the individual tests do too much.</span></span> <span data-ttu-id="54c10-152">Jeder Test sollten stattdessen nur ein einzelnes Konzept überprüfen (die wesentlich zum Ermitteln der Ursache von Ausführungsfehlern erleichtern).</span><span class="sxs-lookup"><span data-stu-id="54c10-152">Instead each test should verify only a single concept (which will make it much easier to pinpoint the cause of failures).</span></span> <span data-ttu-id="54c10-153">Als Richtschnur besteht darin zu versuchen und nur eine einzelne assert-Anweisung für jeden Test.</span><span class="sxs-lookup"><span data-stu-id="54c10-153">A good guideline is to try and only have a single assert statement for each test.</span></span> <span data-ttu-id="54c10-154">Wenn Sie mehr als eine assert-Anweisung in einer Testmethode haben, stellen Sie sicher, dass sie alle verwendet werden, um dasselbe Konzept zu testen.</span><span class="sxs-lookup"><span data-stu-id="54c10-154">If you have more than one assert statement in a test method, make sure they are all being used to test the same concept.</span></span> <span data-ttu-id="54c10-155">Stellen Sie im Zweifelsfall einen anderen Test.</span><span class="sxs-lookup"><span data-stu-id="54c10-155">When in doubt, make another test.</span></span>

### <a name="running-tests"></a><span data-ttu-id="54c10-156">Tests werden ausgeführt</span><span class="sxs-lookup"><span data-stu-id="54c10-156">Running Tests</span></span>

<span data-ttu-id="54c10-157">Visual Studio 2008 Professional (oder höhere Edition) enthält einen integrierten Test Runner, der zum Ausführen von Visual Studio-Komponententest-Projekten in der IDE verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="54c10-157">Visual Studio 2008 Professional (and higher editions) includes a built-in test runner that can be used to run Visual Studio Unit Test projects within the IDE.</span></span> <span data-ttu-id="54c10-158">Wählen wir die **Test -&gt;ausführen -&gt;alle Tests in der Projektmappe** Menü Befehlsklasse (oder Typ STRG R, A) um alle unsere Komponententests ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="54c10-158">We can select the **Test-&gt;Run-&gt;All Tests in Solution** menu command (or type Ctrl R, A) to run all of our unit tests.</span></span> <span data-ttu-id="54c10-159">Alternativ können wir unsere Cursor innerhalb einer bestimmten Klasse oder Test Testmethode positionieren und Verwenden der **Test -&gt;ausführen -&gt;Tests im aktuellen Kontext** Menübefehl (oder Typ STRG R, T), um eine Teilmenge der Komponententests auszuführen.</span><span class="sxs-lookup"><span data-stu-id="54c10-159">Or alternatively we can position our cursor within a specific test class or test method and use the **Test-&gt;Run-&gt;Tests in Current Context** menu command (or type Ctrl R, T) to run a subset of the unit tests.</span></span>

<span data-ttu-id="54c10-160">Wir unsere Cursor innerhalb der Klasse DinnerTest positionieren aus, und geben Sie "STRG R, T" zum Ausführen der beiden Tests, die soeben definiert.</span><span class="sxs-lookup"><span data-stu-id="54c10-160">Let's position our cursor within the DinnerTest class and type "Ctrl R, T" to run the two tests we just defined.</span></span> <span data-ttu-id="54c10-161">Wenn wir dies ein Fenster "Testergebnisse" durchführen, werden in Visual Studio angezeigt, und wir sehen die Ergebnisse der unsere darin aufgeführten Testlauf:</span><span class="sxs-lookup"><span data-stu-id="54c10-161">When we do this a "Test Results" window will appear within Visual Studio and we'll see the results of our test run listed within it:</span></span>

![](enable-automated-unit-testing/_static/image5.png)

<span data-ttu-id="54c10-162">*Hinweis: Die Testergebnisse (Fenster) im Vergleich wird die Klassennamen-Spalte nicht standardmäßig angezeigt. Sie können diese hinzufügen, indem Sie mit der rechten Maustaste im Fenster Testergebnisse und verwenden den Menübefehl Spalten hinzufügen/entfernen.*</span><span class="sxs-lookup"><span data-stu-id="54c10-162">*Note: The VS test results window does not show the Class Name column by default. You can add this by right-clicking within the Test Results window and using the Add/Remove Columns menu command.*</span></span>

<span data-ttu-id="54c10-163">Unsere zwei Tests hat nur einen Bruchteil einer Sekunde ausgeführt – und Sie können ausführliche Informationen finden Sie beide übergeben.</span><span class="sxs-lookup"><span data-stu-id="54c10-163">Our two tests took only a fraction of a second to run – and as you can see they both passed.</span></span> <span data-ttu-id="54c10-164">Wir können jetzt fahren Sie und erweitern diese, indem Sie zusätzliche Tests, die spezielle Regel Überprüfungen überprüfen sowie zwei Hilfsmethoden - IsUserHost() und IsUserRegisterd() –, die wir, die Klasse Dinner hinzugefügt abdecken zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="54c10-164">We can now go on and augment them by creating additional tests that verify specific rule validations, as well as cover the two helper methods - IsUserHost() and IsUserRegisterd() – that we added to the Dinner class.</span></span> <span data-ttu-id="54c10-165">Müssen alle diese Tests vorhanden, für die Klasse Dinner wird wesentlich einfacher und sicherer zu neuen Geschäftsregeln und Überprüfungen in Zukunft hinzufügen erleichtern.</span><span class="sxs-lookup"><span data-stu-id="54c10-165">Having all these tests in place for the Dinner class will make it much easier and safer to add new business rules and validations to it in the future.</span></span> <span data-ttu-id="54c10-166">Wir können unsere neue Regellogik Dinner hinzufügen und überprüfen dann innerhalb von Sekunden, dass sie unseren vorherigen Logik Funktionalität beeinträchtigt wurde nicht.</span><span class="sxs-lookup"><span data-stu-id="54c10-166">We can add our new rule logic to Dinner, and then within seconds verify that it hasn't broken any of our previous logic functionality.</span></span>

<span data-ttu-id="54c10-167">Beachten Sie, wie unter Verwendung eines Namens beschreibenden Text ganz einfach schnell herausfinden, welche Tests überprüft werden.</span><span class="sxs-lookup"><span data-stu-id="54c10-167">Notice how using a descriptive test name makes it easy to quickly understand what each test is verifying.</span></span> <span data-ttu-id="54c10-168">Ich empfiehlt sich die **Tools –&gt;Optionen** Menübefehl, öffnen den Test Tools –&gt;Konfigurationsbildschirm für die Ausführung zu testen und überprüfen "durch Doppelklicken auf eine fehlerhafte oder nicht eindeutig Komponententestergebnis angezeigt. Zeitpunkt des Fehlers im Test"das Kontrollkästchen.</span><span class="sxs-lookup"><span data-stu-id="54c10-168">I recommend using the **Tools-&gt;Options** menu command, opening the Test Tools-&gt;Test Execution configuration screen, and checking the "Double-clicking a failed or inconclusive unit test result displays the point of failure in the test" checkbox.</span></span> <span data-ttu-id="54c10-169">Dadurch können Sie doppelklicken auf einen Fehler in die Testergebnisse (Fenster), und springen sofort auf den Assertionsfehler.</span><span class="sxs-lookup"><span data-stu-id="54c10-169">This will allow you to double-click on a failure in the test results window and jump immediately to the assert failure.</span></span>

### <a name="creating-dinnerscontroller-unit-tests"></a><span data-ttu-id="54c10-170">Erstellen von Komponententests DinnersController</span><span class="sxs-lookup"><span data-stu-id="54c10-170">Creating DinnersController Unit Tests</span></span>

<span data-ttu-id="54c10-171">Jetzt erstellen wir einige Komponententests, die unsere DinnersController-Funktionalität zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="54c10-171">Let's now create some unit tests that verify our DinnersController functionality.</span></span> <span data-ttu-id="54c10-172">Wir starten, indem Sie mit der rechten Maustaste auf den Ordner "Controller" in unserem Test-Projekt und wählen Sie dann die **Add -&gt;neuen Test** Menübefehl.</span><span class="sxs-lookup"><span data-stu-id="54c10-172">We'll start by right-clicking on the "Controllers" folder within our Test project and then choose the **Add-&gt;New Test** menu command.</span></span> <span data-ttu-id="54c10-173">Wir erstellen eine "Komponententests" und nennen Sie sie "DinnersControllerTest.cs".</span><span class="sxs-lookup"><span data-stu-id="54c10-173">We'll create a "Unit Test" and name it "DinnersControllerTest.cs".</span></span>

<span data-ttu-id="54c10-174">Wir erstellen zwei Testmethoden, die die Aktionsmethode Details() auf die DinnersController zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="54c10-174">We'll create two test methods that verify the Details() action method on the DinnersController.</span></span> <span data-ttu-id="54c10-175">Die erste überprüft, dass eine Sicht zurückgegeben wird, wenn eine vorhandene Dinner angefordert wird.</span><span class="sxs-lookup"><span data-stu-id="54c10-175">The first will verify that a View is returned when an existing Dinner is requested.</span></span> <span data-ttu-id="54c10-176">Die zweite überprüft, dass eine Ansicht "NotFound" zurückgegeben wird, wenn eine nicht existierende Dinner angefordert wird:</span><span class="sxs-lookup"><span data-stu-id="54c10-176">The second will verify that a "NotFound" view is returned when a non-existent Dinner is requested:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample3.cs)]

<span data-ttu-id="54c10-177">Der obige Code kompiliert bereinigt.</span><span class="sxs-lookup"><span data-stu-id="54c10-177">The above code compiles clean.</span></span> <span data-ttu-id="54c10-178">Wenn wir die Tests ausgeführt haben, fehlschlagen, beide:</span><span class="sxs-lookup"><span data-stu-id="54c10-178">When we run the tests, though, they both fail:</span></span>

![](enable-automated-unit-testing/_static/image6.png)

<span data-ttu-id="54c10-179">Wenn Sie die Fehlermeldungen betrachten, sehen wir, dass die Ursache der Tests fehlgeschlagen war, da unsere DinnersRepository-Klasse mit einer Datenbank herstellen konnte.</span><span class="sxs-lookup"><span data-stu-id="54c10-179">If we look at the error messages, we'll see that the reason the tests failed was because our DinnersRepository class was unable to connect to a database.</span></span> <span data-ttu-id="54c10-180">Unsere NerdDinner-Anwendung verwendet eine Verbindungszeichenfolge in einer lokalen SQL Server Express-Datei die unter der \App lebt\_Datenverzeichnis NerdDinner-Anwendungsprojekt.</span><span class="sxs-lookup"><span data-stu-id="54c10-180">Our NerdDinner application is using a connection-string to a local SQL Server Express file which lives under the \App\_Data directory of the NerdDinner application project.</span></span> <span data-ttu-id="54c10-181">Da unser NerdDinner.Tests Projekt kompiliert und anschließend das Anwendungsprojekt in einem anderen Verzeichnis ausgeführt, ist der relative Pfad unsere Verbindungszeichenfolge falsch.</span><span class="sxs-lookup"><span data-stu-id="54c10-181">Because our NerdDinner.Tests project compiles and runs in a different directory then the application project, the relative path location of our connection-string is incorrect.</span></span>

<span data-ttu-id="54c10-182">Wir *konnte* beheben Sie dies durch Kopieren von SQL Express-Datenbankdatei in unserem Test-Projekt, und fügen Sie eine Verbindungszeichenfolge entsprechenden Test hinzu, in der Datei "App.config" unsere Testprojekt.</span><span class="sxs-lookup"><span data-stu-id="54c10-182">We *could* fix this by copying the SQL Express database file to our test project, and then add an appropriate test connection-string to it in the App.config of our test project.</span></span> <span data-ttu-id="54c10-183">Dies würde der obigen Tests "Blockierung aufgehoben" und Ausführen von abrufen.</span><span class="sxs-lookup"><span data-stu-id="54c10-183">This would get the above tests unblocked and running.</span></span>

<span data-ttu-id="54c10-184">Komponententests für Code unter Verwendung einer realen Datenbank bringt jedoch mit eine Reihe von Herausforderungen.</span><span class="sxs-lookup"><span data-stu-id="54c10-184">Unit testing code using a real database, though, brings with it a number of challenges.</span></span> <span data-ttu-id="54c10-185">Dies gilt insbesondere in folgenden Fällen:</span><span class="sxs-lookup"><span data-stu-id="54c10-185">Specifically:</span></span>

- <span data-ttu-id="54c10-186">Er verlangsamt erheblich die Ausführungszeit der Komponententests.</span><span class="sxs-lookup"><span data-stu-id="54c10-186">It significantly slows down the execution time of unit tests.</span></span> <span data-ttu-id="54c10-187">Je länger dauert die Ausführung von Tests, desto weniger wahrscheinlich werden Sie sie häufig ausführen.</span><span class="sxs-lookup"><span data-stu-id="54c10-187">The longer it takes to run tests, the less likely you are to execute them frequently.</span></span> <span data-ttu-id="54c10-188">Im Idealfall werden die Komponententests in der Lage, die in Sekunden – ausgeführt werden und etwas, das Sie als natürliche Weise als Kompilieren des Projekts werden soll.</span><span class="sxs-lookup"><span data-stu-id="54c10-188">Ideally you want your unit tests to be able to be run in seconds – and have it be something you do as naturally as compiling the project.</span></span>
- <span data-ttu-id="54c10-189">Es wird die Logik Setup- und Bereinigungsskripts in Tests komplizierter.</span><span class="sxs-lookup"><span data-stu-id="54c10-189">It complicates the setup and cleanup logic within tests.</span></span> <span data-ttu-id="54c10-190">Jeder Komponententest isoliert und unabhängig von anderen (mit keine nachteiligen Auswirkungen haben oder Abhängigkeiten) werden soll.</span><span class="sxs-lookup"><span data-stu-id="54c10-190">You want each unit test to be isolated and independent of others (with no side effects or dependencies).</span></span> <span data-ttu-id="54c10-191">Bei der Arbeit in einer realen Datenbank müssen Sie beachten, des Status werden und es zwischen Tests zurücksetzen.</span><span class="sxs-lookup"><span data-stu-id="54c10-191">When working against a real database you have to be mindful of state and reset it between tests.</span></span>

<span data-ttu-id="54c10-192">Sehen wir uns ein Entwurfsmuster namens "Abhängigkeitsinjektion", die helfen uns diese Probleme umgehen, und vermeiden Sie eine echte Datenbank mit unseren Tests verwendet werden müssen.</span><span class="sxs-lookup"><span data-stu-id="54c10-192">Let's look at a design pattern called "dependency injection" that can help us work around these issues and avoid the need to use a real database with our tests.</span></span>

### <a name="dependency-injection"></a><span data-ttu-id="54c10-193">Abhängigkeitsinjektion</span><span class="sxs-lookup"><span data-stu-id="54c10-193">Dependency Injection</span></span>

<span data-ttu-id="54c10-194">Zurzeit ist DinnersController eng "der Klasse DinnerRepository verbunden".</span><span class="sxs-lookup"><span data-stu-id="54c10-194">Right now DinnersController is tightly "coupled" to the DinnerRepository class.</span></span> <span data-ttu-id="54c10-195">"Verbinden" verweist auf eine Situation, in dem eine Klasse explizit in einer anderen Klasse benötigt, um arbeiten:</span><span class="sxs-lookup"><span data-stu-id="54c10-195">"Coupling" refers to a situation where a class explicitly relies on another class in order to work:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample4.cs)]

<span data-ttu-id="54c10-196">Da die Klasse DinnerRepository Zugriff auf eine Datenbank erforderlich ist, weist die eng verkoppelten Abhängigkeit DinnersController-Klasse DinnerRepository Schluss müssen uns eine Datenbank damit DinnersController Aktionsmethoden getestet werden müssen.</span><span class="sxs-lookup"><span data-stu-id="54c10-196">Because the DinnerRepository class requires access to a database, the tightly coupled dependency the DinnersController class has on the DinnerRepository ends up requiring us to have a database in order for the DinnersController action methods to be tested.</span></span>

<span data-ttu-id="54c10-197">Wir können dieses-Versionsdaten Entwurfsmuster "Abhängigkeitsinjektion" – also einen Ansatz, in Abhängigkeiten (z. B. Repositoryklassen, die den Datenzugriff zu ermöglichen) nicht mehr implizit innerhalb von Klassen erstellt werden, die diese verwenden.</span><span class="sxs-lookup"><span data-stu-id="54c10-197">We can get around this by employing a design pattern called "dependency injection" – which is an approach where dependencies (like repository classes that provide data access) are no longer implicitly created within classes that use them.</span></span> <span data-ttu-id="54c10-198">Stattdessen Abhängigkeiten können explizit übergeben werden, die Klasse, die sie verwendet Konstruktorargumenten verwenden.</span><span class="sxs-lookup"><span data-stu-id="54c10-198">Instead, dependencies can be explicitly passed to the class that uses them using constructor arguments.</span></span> <span data-ttu-id="54c10-199">Wenn die Abhängigkeiten über Schnittstellen definiert sind, haben wir klicken Sie dann die Flexibilität, "gefälschte" Abhängigkeit Implementierungen für Testszenarien Einheit zu übergeben.</span><span class="sxs-lookup"><span data-stu-id="54c10-199">If the dependencies are defined using interfaces, we then have the flexibility to pass in "fake" dependency implementations for unit test scenarios.</span></span> <span data-ttu-id="54c10-200">Dies ermöglicht es, zu der Abhängigkeit von Test-spezifische Implementierungen zu erstellen, die eigentlich keinen Zugriff auf eine Datenbank erfordern.</span><span class="sxs-lookup"><span data-stu-id="54c10-200">This enables us to create test-specific dependency implementations that do not actually require access to a database.</span></span>

<span data-ttu-id="54c10-201">Um dies in Aktion zu sehen, implementieren wir Abhängigkeitsinjektion mit unserem DinnersController ein.</span><span class="sxs-lookup"><span data-stu-id="54c10-201">To see this in action, let's implement dependency injection with our DinnersController.</span></span>

#### <a name="extracting-an-idinnerrepository-interface"></a><span data-ttu-id="54c10-202">Extrahieren einer Schnittstelle IDinnerRepository</span><span class="sxs-lookup"><span data-stu-id="54c10-202">Extracting an IDinnerRepository interface</span></span>

<span data-ttu-id="54c10-203">Der erste Schritt werden Sie eine neue IDinnerRepository-Benutzeroberfläche zu erstellen, die den Vertrag Repository kapselt benötigten unserer Domänencontroller zum Abrufen und Aktualisieren von Abendessen.</span><span class="sxs-lookup"><span data-stu-id="54c10-203">Our first step will be to create a new IDinnerRepository interface that encapsulates the repository contract our controllers require to retrieve and update Dinners.</span></span>

<span data-ttu-id="54c10-204">Wir können diese Schnittstellenvertrag manuell definieren, indem Sie mit der rechten Maustaste auf den Ordner \Models, und klicken Sie dann die **Add -&gt;neues Element** Menübefehl und erstellen eine neue Schnittstelle namens IDinnerRepository.cs.</span><span class="sxs-lookup"><span data-stu-id="54c10-204">We can define this interface contract manually by right-clicking on the \Models folder, and then choosing the **Add-&gt;New Item** menu command and creating a new interface named IDinnerRepository.cs.</span></span>

<span data-ttu-id="54c10-205">Alternativ können wir verwenden die Extrahierung Tools erstellt in Visual Studio Professional (oder höhere Edition) auf automatisch Umgestaltung und erstellen Sie eine Schnittstelle für uns aus der vorhandenen DinnerRepository-Klasse.</span><span class="sxs-lookup"><span data-stu-id="54c10-205">Alternatively we can use the refactoring tools built-into Visual Studio Professional (and higher editions) to automatically extract and create an interface for us from our existing DinnerRepository class.</span></span> <span data-ttu-id="54c10-206">Um diese Schnittstelle, die mithilfe von VS zu extrahieren, einfach positionieren Sie den Cursor in die Text-Editor für die DinnerRepository-Klasse, und klicken Sie dann mit der rechten Maustaste und wählen Sie die **Umgestalten -&gt;Schnittstelle extrahieren** Menübefehl:</span><span class="sxs-lookup"><span data-stu-id="54c10-206">To extract this interface using VS, simply position the cursor in the text editor on the DinnerRepository class, and then right-click and choose the **Refactor-&gt;Extract Interface** menu command:</span></span>

![](enable-automated-unit-testing/_static/image7.png)

<span data-ttu-id="54c10-207">Das Dialogfeld "Schnittstelle extrahieren" starten wird und uns für den Namen der Schnittstelle zum Erstellen auffordern.</span><span class="sxs-lookup"><span data-stu-id="54c10-207">This will launch the "Extract Interface" dialog and prompt us for the name of the interface to create.</span></span> <span data-ttu-id="54c10-208">Es wird standardmäßig IDinnerRepository, und wählen Sie automatisch alle öffentliche Methoden in der vorhandenen DinnerRepository-Klasse, die Schnittstelle hinzu:</span><span class="sxs-lookup"><span data-stu-id="54c10-208">It will default to IDinnerRepository and automatically select all public methods on the existing DinnerRepository class to add to the interface:</span></span>

![](enable-automated-unit-testing/_static/image8.png)

<span data-ttu-id="54c10-209">Wenn wir auf die Schaltfläche "ok" klicken, wird Visual Studio eine neue IDinnerRepository Schnittstelle unsere Anwendung hinzugefügt:</span><span class="sxs-lookup"><span data-stu-id="54c10-209">When we click the "ok" button, Visual Studio will add a new IDinnerRepository interface to our application:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample5.cs)]

<span data-ttu-id="54c10-210">Und unsere vorhandene DinnerRepository-Klasse wird aktualisiert, damit sie die Schnittstelle implementiert:</span><span class="sxs-lookup"><span data-stu-id="54c10-210">And our existing DinnerRepository class will be updated so that it implements the interface:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample6.cs)]

#### <a name="updating-dinnerscontroller-to-support-constructor-injection"></a><span data-ttu-id="54c10-211">Aktualisieren von DinnersController Konstruktoreinfügung unterstützen</span><span class="sxs-lookup"><span data-stu-id="54c10-211">Updating DinnersController to support constructor injection</span></span>

<span data-ttu-id="54c10-212">Wir werden die DinnersController-Klasse, um die neue Oberfläche verwenden jetzt aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="54c10-212">We'll now update the DinnersController class to use the new interface.</span></span>

<span data-ttu-id="54c10-213">Derzeit ist DinnersController hartcodiert, dass das Feld "DinnerRepository" immer eine DinnerRepository-Klasse ist:</span><span class="sxs-lookup"><span data-stu-id="54c10-213">Currently DinnersController is hard-coded such that its "dinnerRepository" field is always a DinnerRepository class:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample7.cs)]

<span data-ttu-id="54c10-214">Wir müssen es ändern, damit das Feld "DinnerRepository" des Typs statt DinnerRepository IDinnerRepository ist.</span><span class="sxs-lookup"><span data-stu-id="54c10-214">We'll change it so that the "dinnerRepository" field is of type IDinnerRepository instead of DinnerRepository.</span></span> <span data-ttu-id="54c10-215">Wir fügen Sie dann zwei öffentliche DinnersController Konstruktoren.</span><span class="sxs-lookup"><span data-stu-id="54c10-215">We'll then add two public DinnersController constructors.</span></span> <span data-ttu-id="54c10-216">Einer der Konstruktoren kann eine IDinnerRepository als Argument übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="54c10-216">One of the constructors allows an IDinnerRepository to be passed as an argument.</span></span> <span data-ttu-id="54c10-217">Die andere ist ein Standardkonstruktor, der unsere vorhandene DinnerRepository-Implementierung verwendet:</span><span class="sxs-lookup"><span data-stu-id="54c10-217">The other is a default constructor that uses our existing DinnerRepository implementation:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample8.cs)]

<span data-ttu-id="54c10-218">Da ASP.NET-MVC standardmäßig unter Verwendung von Standardkonstruktoren Controllerklassen erstellt, unsere DinnersController zur Laufzeit die DinnerRepository-Klasse verwenden weiterhin auf Daten zugreift.</span><span class="sxs-lookup"><span data-stu-id="54c10-218">Because ASP.NET MVC by default creates controller classes using default constructors, our DinnersController at runtime will continue to use the DinnerRepository class to perform data access.</span></span>

<span data-ttu-id="54c10-219">Wir haben unsere Komponententests, aber jetzt aktualisieren, um eine "gefälschte" Dinner Repository-Implementierung, die mit dem Parameter-Konstruktor übergeben.</span><span class="sxs-lookup"><span data-stu-id="54c10-219">We can now update our unit tests, though, to pass in a "fake" dinner repository implementation using the parameter constructor.</span></span> <span data-ttu-id="54c10-220">Dieses Repository "gefälschte" Dinner benötigen Sie Zugriff auf eine echte Datenbank keine und stattdessen Beispiel zu in-Memory-Daten.</span><span class="sxs-lookup"><span data-stu-id="54c10-220">This "fake" dinner repository will not require access to a real database, and instead will use in-memory sample data.</span></span>

#### <a name="creating-the-fakedinnerrepository-class"></a><span data-ttu-id="54c10-221">Erstellen der FakeDinnerRepository-Klasse</span><span class="sxs-lookup"><span data-stu-id="54c10-221">Creating the FakeDinnerRepository class</span></span>

<span data-ttu-id="54c10-222">Wir erstellen eine FakeDinnerRepository-Klasse.</span><span class="sxs-lookup"><span data-stu-id="54c10-222">Let's create a FakeDinnerRepository class.</span></span>

<span data-ttu-id="54c10-223">Wir beginnen mit dem Erstellen eines Verzeichnisses "Fakes" in unseren NerdDinner.Tests-Projekt und klicken Sie dann eine neue FakeDinnerRepository-Klasse hinzugefügt (mit der rechten Maustaste auf den Ordner, und wählen Sie **Add -&gt;neue Klasse**):</span><span class="sxs-lookup"><span data-stu-id="54c10-223">We'll begin by creating a "Fakes" directory within our NerdDinner.Tests project and then add a new FakeDinnerRepository class to it (right-click on the folder and choose **Add-&gt;New Class**):</span></span>

![](enable-automated-unit-testing/_static/image9.png)

<span data-ttu-id="54c10-224">Wir werden den Code aktualisieren, sodass die FakeDinnerRepository-Klasse die IDinnerRepository-Schnittstelle implementiert.</span><span class="sxs-lookup"><span data-stu-id="54c10-224">We'll update the code so that the FakeDinnerRepository class implements the IDinnerRepository interface.</span></span> <span data-ttu-id="54c10-225">Wir können dann mit der rechten Maustaste darauf und wählen Sie den Kontextmenübefehl "Schnittstelle implementieren IDinnerRepository":</span><span class="sxs-lookup"><span data-stu-id="54c10-225">We can then right-click on it and choose the "Implement interface IDinnerRepository" context menu command:</span></span>

![](enable-automated-unit-testing/_static/image10.png)

<span data-ttu-id="54c10-226">Dies bewirkt, dass Visual Studio, um unsere FakeDinnerRepository-Klasse mit standardimplementierungen "stub-" automatisch auf alle IDinnerRepository Schnittstelle Mitglieder hinzuzufügen:</span><span class="sxs-lookup"><span data-stu-id="54c10-226">This will cause Visual Studio to automatically add all of the IDinnerRepository interface members to our FakeDinnerRepository class with default "stub out" implementations:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample9.cs)]

<span data-ttu-id="54c10-227">Wir aktualisieren Sie dann die FakeDinnerRepository-Implementierung, die nicht in einer in-Memory-Liste funktionieren&lt;Dinner&gt; Auflistung als Konstruktorargument übergeben:</span><span class="sxs-lookup"><span data-stu-id="54c10-227">We can then update the FakeDinnerRepository implementation to work off of an in-memory List&lt;Dinner&gt; collection passed to it as a constructor argument:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample10.cs)]

<span data-ttu-id="54c10-228">Wir haben jetzt eine gefälschte IDinnerRepository-Implementierung, die eine Datenbank ist nicht erforderlich, und stattdessen deaktiviert eine in-Memory-Liste von Dinner Objekten arbeiten kann.</span><span class="sxs-lookup"><span data-stu-id="54c10-228">We now have a fake IDinnerRepository implementation that does not require a database, and can instead work off an in-memory list of Dinner objects.</span></span>

#### <a name="using-the-fakedinnerrepository-with-unit-tests"></a><span data-ttu-id="54c10-229">Verwenden die FakeDinnerRepository mit Komponententests</span><span class="sxs-lookup"><span data-stu-id="54c10-229">Using the FakeDinnerRepository with Unit Tests</span></span>

<span data-ttu-id="54c10-230">Wir zurück an die DinnersController-Komponententests, die zuvor aufgrund die Datenbank nicht verfügbar war.</span><span class="sxs-lookup"><span data-stu-id="54c10-230">Let's return to the DinnersController unit tests that failed earlier because the database wasn't available.</span></span> <span data-ttu-id="54c10-231">Wir können die Testmethoden aus, um eine FakeDinnerRepository mit Beispieldaten in-Memory-Dinner, die mithilfe des folgenden Codes DinnersController aufgefüllt verwenden aktualisieren:</span><span class="sxs-lookup"><span data-stu-id="54c10-231">We can update the test methods to use a FakeDinnerRepository populated with sample in-memory Dinner data to the DinnersController using the code below:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample11.cs)]

<span data-ttu-id="54c10-232">Und nun bei Ausführung dieser Tests beide übergeben:</span><span class="sxs-lookup"><span data-stu-id="54c10-232">And now when we run these tests they both pass:</span></span>

![](enable-automated-unit-testing/_static/image11.png)

<span data-ttu-id="54c10-233">Beste daran, sie nehmen nur einen Bruchteil einer Sekunde ausgeführt und erfordern keine komplizierte Setup/Bereinigungslogik.</span><span class="sxs-lookup"><span data-stu-id="54c10-233">Best of all, they take only a fraction of a second to run, and do not require any complicated setup/cleanup logic.</span></span> <span data-ttu-id="54c10-234">Wir können jetzt alle unsere DinnersController-Methodencode für die Aktion (einschließlich auflisten, Details, paging erstellen, aktualisieren und löschen) bei Komponententest ohne jemals mit einer realen Datenbank herzustellen.</span><span class="sxs-lookup"><span data-stu-id="54c10-234">We can now unit test all of our DinnersController action method code (including listing, paging, details, create, update and delete) without ever needing to connect to a real database.</span></span>

| <span data-ttu-id="54c10-235">**Seite Thema: Dependency Injection Frameworks**</span><span class="sxs-lookup"><span data-stu-id="54c10-235">**Side Topic: Dependency Injection Frameworks**</span></span> |
| --- |
| <span data-ttu-id="54c10-236">Ausführen manueller abhängigkeiteneinschleusung (wie wir oben) funktioniert, aber wird schwieriger zu verwalten als die Anzahl der Abhängigkeiten, und erhöht die Komponenten in einer Anwendung.</span><span class="sxs-lookup"><span data-stu-id="54c10-236">Performing manual dependency injection (like we are above) works fine, but does become harder to maintain as the number of dependencies and components in an application increases.</span></span> <span data-ttu-id="54c10-237">Mehrere Dependency Injection Frameworks vorhanden für .NET, die größere Flexibilität bei der Verwaltung von Abhängigkeit helfen können.</span><span class="sxs-lookup"><span data-stu-id="54c10-237">Several dependency injection frameworks exist for .NET that can help provide even more dependency management flexibility.</span></span> <span data-ttu-id="54c10-238">Diese Frameworks, auch bezeichnet "Inversion of Control" (IoC) Container, bieten Mechanismen, die ein höheres Maß an Unterstützung für die Konfiguration für angeben und das Übergeben von Abhängigkeiten für Objekte zur Laufzeit (mit am häufigsten Konstruktoreinfügung aktivieren ).</span><span class="sxs-lookup"><span data-stu-id="54c10-238">These frameworks, also sometimes called "Inversion of Control" (IoC) containers, provide mechanisms that enable an additional level of configuration support for specifying and passing dependencies to objects at runtime (most often using constructor injection).</span></span> <span data-ttu-id="54c10-239">Einige der gängigeren OSS-Abhängigkeitsinjektion / IOC-Frameworks in .NET include: AutoFac, Ninject Spring.NET, StructureMap und Windsor.</span><span class="sxs-lookup"><span data-stu-id="54c10-239">Some of the more popular OSS Dependency Injection / IOC frameworks in .NET include: AutoFac, Ninject, Spring.NET, StructureMap, and Windsor.</span></span> <span data-ttu-id="54c10-240">ASP.NET MVC macht-Erweiterbarkeits-APIs, mit denen Entwickler zur Teilnahme an der Auflösung und Instanziierung von Controllern und wodurch Abhängigkeitsinjektion / IoC-Frameworks ordnungsgemäß innerhalb dieses Prozesses integriert werden.</span><span class="sxs-lookup"><span data-stu-id="54c10-240">ASP.NET MVC exposes extensibility APIs that enable developers to participate in the resolution and instantiation of controllers, and which enables Dependency Injection / IoC frameworks to be cleanly integrated within this process.</span></span> <span data-ttu-id="54c10-241">Mithilfe eines DI/IOC würde auch aktivieren wir unsere DinnersController – den Standardkonstruktor aufheben dadurch die Kopplung zwischen ihm und dem DinnerRepositorys vollständig entfernt wird, würde.</span><span class="sxs-lookup"><span data-stu-id="54c10-241">Using a DI/IOC framework would also enable us to remove the default constructor from our DinnersController – which would completely remove the coupling between it and the DinnerRepositorys.</span></span> <span data-ttu-id="54c10-242">Wir nicht verwenden eine Abhängigkeitsinjektion / IOC-Framework mit unserer NerdDinner-Anwendung.</span><span class="sxs-lookup"><span data-stu-id="54c10-242">We won't be using a dependency injection / IOC framework with our NerdDinner application.</span></span> <span data-ttu-id="54c10-243">Aber es ist etwas, das wir für die Zukunft gehen konnte die NerdDinner Codebasis und Funktionen vergrößert wurde.</span><span class="sxs-lookup"><span data-stu-id="54c10-243">But it is something we could consider for the future if the NerdDinner code-base and capabilities grew.</span></span> |

### <a name="creating-edit-action-unit-tests"></a><span data-ttu-id="54c10-244">Erstellen von Komponententests für Bearbeiten-Aktion</span><span class="sxs-lookup"><span data-stu-id="54c10-244">Creating Edit Action Unit Tests</span></span>

<span data-ttu-id="54c10-245">Jetzt erstellen wir einige Komponententests, die die Funktionalität Bearbeiten von der DinnersController zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="54c10-245">Let's now create some unit tests that verify the Edit functionality of the DinnersController.</span></span> <span data-ttu-id="54c10-246">Wir beginnen mit Testen der HTTP-GET-Version des unserer Aktion bearbeiten:</span><span class="sxs-lookup"><span data-stu-id="54c10-246">We'll start by testing the HTTP-GET version of our Edit action:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample12.cs)]

<span data-ttu-id="54c10-247">Wir erstellen ein Tests, das überprüft, ob eine Sicht, die Sicherung von einem DinnerFormViewModel-Objekt zurück, wenn Sie eine gültige Dinner angefordert wird gerendert wird:</span><span class="sxs-lookup"><span data-stu-id="54c10-247">We'll create a test that verifies that a View backed by a DinnerFormViewModel object is rendered back when a valid dinner is requested:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample13.cs)]

<span data-ttu-id="54c10-248">Wenn wir den Test ausführen, aber fest wir, dass es schlägt fehl, weil eine null-Verweisausnahme auftreten ausgelöst wird, wenn die Edit-Methode der User.Identity.Name-Eigenschaft der Dinner.IsHostedBy() Überprüfung zugreift.</span><span class="sxs-lookup"><span data-stu-id="54c10-248">When we run the test, though, we'll find that it fails because a null reference exception is thrown when the Edit method accesses the User.Identity.Name property to perform the Dinner.IsHostedBy() check.</span></span>

<span data-ttu-id="54c10-249">Das Benutzerobjekt, auf die Basisklasse für Controller kapselt Informationen über den angemeldeten Benutzer und wird von ASP.NET MVC aufgefüllt, wenn sie den Controller zur Laufzeit erstellt.</span><span class="sxs-lookup"><span data-stu-id="54c10-249">The User object on the Controller base class encapsulates details about the logged-in user, and is populated by ASP.NET MVC when it creates the controller at runtime.</span></span> <span data-ttu-id="54c10-250">Da wir die DinnersController außerhalb einer Web-Server-Umgebung testen die, das Benutzerobjekt ist nicht festgelegt (also die Nullverweis Ausnahme).</span><span class="sxs-lookup"><span data-stu-id="54c10-250">Because we are testing the DinnersController outside of a web-server environment, the User object isn't set (hence the null reference exception).</span></span>

### <a name="mocking-the-useridentityname-property"></a><span data-ttu-id="54c10-251">Simulieren der User.Identity.Name-Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="54c10-251">Mocking the User.Identity.Name property</span></span>

<span data-ttu-id="54c10-252">Mockframeworks stellen testen vereinfachen durch Aktivieren von uns falsche Versionen der abhängigen Objekte dynamisch zu erstellen, die unsere Tests unterstützen.</span><span class="sxs-lookup"><span data-stu-id="54c10-252">Mocking frameworks make testing easier by enabling us to dynamically create fake versions of dependent objects that support our tests.</span></span> <span data-ttu-id="54c10-253">Wir können z. B. ein pseudoframework in unserem Test wurde Aktion Bearbeiten verwenden, um ein Benutzerobjekt dynamisch zu erstellen, die unsere DinnersController verwenden können, einen Benutzernamen für die simulierten nachgeschlagen werden.</span><span class="sxs-lookup"><span data-stu-id="54c10-253">For example, we can use a mocking framework in our Edit action test to dynamically create a User object that our DinnersController can use to lookup a simulated username.</span></span> <span data-ttu-id="54c10-254">Dadurch wird vermieden, dass einen null-Verweis ausgelöst wird, wenn wir unsere Tests ausführen.</span><span class="sxs-lookup"><span data-stu-id="54c10-254">This will avoid a null reference from being thrown when we run our test.</span></span>

<span data-ttu-id="54c10-255">Es gibt viele .NET pseudoframeworks, die mit ASP.NET MVC verwendet werden kann (Sie können eine Liste von ihnen hier finden Sie unter: [http://www.mockframeworks.com/](http://www.mockframeworks.com/)).</span><span class="sxs-lookup"><span data-stu-id="54c10-255">There are many .NET mocking frameworks that can be used with ASP.NET MVC (you can see a list of them here: [http://www.mockframeworks.com/](http://www.mockframeworks.com/)).</span></span> <span data-ttu-id="54c10-256">Zum Testen unserer NerdDinner-Anwendung verwenden wir eine open Source-Framework namens "Moq" imitieren, die heruntergeladen werden kann kostenlos von [http://www.mockframeworks.com/moq](http://www.mockframeworks.com/moq).</span><span class="sxs-lookup"><span data-stu-id="54c10-256">For testing our NerdDinner application we'll use an open source mocking framework called "Moq", which can be downloaded for free from [http://www.mockframeworks.com/moq](http://www.mockframeworks.com/moq).</span></span>

<span data-ttu-id="54c10-257">Nachdem das Download abgeschlossen ist, fügen einen Verweis in unserem NerdDinner.Tests-Projekt auf die Assembly Moq.dll wir:</span><span class="sxs-lookup"><span data-stu-id="54c10-257">Once downloaded, we'll add a reference in our NerdDinner.Tests project to the Moq.dll assembly:</span></span>

![](enable-automated-unit-testing/_static/image12.png)

<span data-ttu-id="54c10-258">Diese wird dann eine Hilfsmethode "CreateDinnersControllerAs(username)" zu unserem Testklasse hinzugefügt, die die User.Identity.Name-Eigenschaft für die Instanz DinnersController "mocks" nimmt einen Benutzernamen als Parameter an, und die:</span><span class="sxs-lookup"><span data-stu-id="54c10-258">We'll then add a "CreateDinnersControllerAs(username)" helper method to our test class that takes a username as a parameter, and which then "mocks" the User.Identity.Name property on the DinnersController instance:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample14.cs)]

<span data-ttu-id="54c10-259">Wir sind höher Moq verwenden, um ein Mock-Objekt zu erstellen, die ein Objekt ControllerContext fakes (das ist, was zu Controllerklassen Common Language Runtime-Objekte, z. B. Benutzer, Anforderung, Antwort und Sitzung verfügbar zu machen ASP.NET-MVC übergibt).</span><span class="sxs-lookup"><span data-stu-id="54c10-259">Above we are using Moq to create a Mock object that fakes a ControllerContext object (which is what ASP.NET MVC passes to Controller classes to expose runtime objects like User, Request, Response, and Session).</span></span> <span data-ttu-id="54c10-260">Wir sind Aufrufen der Methode "SetupGet" für das Mock, um anzugeben, dass die Eigenschaft HttpContext.User.Identity.Name ControllerContext Username-Zeichenfolge zurückgeben soll, wenn, die es an die Hilfsmethode übergeben.</span><span class="sxs-lookup"><span data-stu-id="54c10-260">We are calling the "SetupGet" method on the Mock to indicate that the HttpContext.User.Identity.Name property on ControllerContext should return the username string we passed to the helper method.</span></span>

<span data-ttu-id="54c10-261">Wir können eine beliebige Anzahl von ControllerContext Eigenschaften und Methoden modellieren.</span><span class="sxs-lookup"><span data-stu-id="54c10-261">We can mock any number of ControllerContext properties and methods.</span></span> <span data-ttu-id="54c10-262">Um dies zu veranschaulichen habe ich auch hinzugefügt SetupGet() aufrufen für die Request.IsAuthenticated-Eigenschaft (die nicht tatsächlich benötigt für die folgenden – Tests jedoch; dadurch kann der veranschaulichen, wie Sie Anforderungseigenschaften modellieren können).</span><span class="sxs-lookup"><span data-stu-id="54c10-262">To illustrate this I've also added a SetupGet() call for the Request.IsAuthenticated property (which isn't actually needed for the tests below – but which helps illustrate how you can mock Request properties).</span></span> <span data-ttu-id="54c10-263">Wenn wir fertig sind fügen wir der DinnersController unsere Hilfsmethode gibt eine Instanz des ControllerContext Mock zuweisen.</span><span class="sxs-lookup"><span data-stu-id="54c10-263">When we are done we assign an instance of the ControllerContext mock to the DinnersController our helper method returns.</span></span>

<span data-ttu-id="54c10-264">Jetzt können Sie Komponententests schreiben, mit denen diese Hilfsmethode um bearbeiten Szenarien im Zusammenhang mit anderen Benutzern zu testen:</span><span class="sxs-lookup"><span data-stu-id="54c10-264">We can now write unit tests that use this helper method to test Edit scenarios involving different users:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample15.cs)]

<span data-ttu-id="54c10-265">Und bei Ausführung der Tests jetzt übertragen:</span><span class="sxs-lookup"><span data-stu-id="54c10-265">And now when we run the tests they pass:</span></span>

![](enable-automated-unit-testing/_static/image13.png)

### <a name="testing-updatemodel-scenarios"></a><span data-ttu-id="54c10-266">Testszenarien UpdateModel()</span><span class="sxs-lookup"><span data-stu-id="54c10-266">Testing UpdateModel() scenarios</span></span>

<span data-ttu-id="54c10-267">Wir haben Tests erstellt, die die HTTP-GET-Version der Aktion bearbeiten abdecken.</span><span class="sxs-lookup"><span data-stu-id="54c10-267">We've created tests that cover the HTTP-GET version of the Edit action.</span></span> <span data-ttu-id="54c10-268">Jetzt erstellen wir einige Tests, die die HTTP-POST-Version der Aktion bearbeiten zu überprüfen:</span><span class="sxs-lookup"><span data-stu-id="54c10-268">Let's now create some tests that verify the HTTP-POST version of the Edit action:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample16.cs)]

<span data-ttu-id="54c10-269">Interessante neue Testszenario für uns zur Unterstützung bei dieser Aktionsmethode ist die Verwendung der UpdateModel() Hilfsmethode für die Controller-Basisklasse.</span><span class="sxs-lookup"><span data-stu-id="54c10-269">The interesting new testing scenario for us to support with this action method is its usage of the UpdateModel() helper method on the Controller base class.</span></span> <span data-ttu-id="54c10-270">Wir werden diese Hilfsmethode verwenden, um die Formular-Post-Werte an unsere Dinner Objektinstanz zu binden.</span><span class="sxs-lookup"><span data-stu-id="54c10-270">We are using this helper method to bind form-post values to our Dinner object instance.</span></span>

<span data-ttu-id="54c10-271">Im folgenden sind zwei Tests, die zeigt, wie wir die Werte für die UpdateModel() Hilfsmethode mit Formular bereitstellen können.</span><span class="sxs-lookup"><span data-stu-id="54c10-271">Below are two tests that demonstrates how we can supply form posted values for the UpdateModel() helper method to use.</span></span> <span data-ttu-id="54c10-272">Wir dazu erstellen und Auffüllen eines Objekts FormCollection und klicken Sie dann die Eigenschaft "ValueProvider" auf dem Controller zuweisen.</span><span class="sxs-lookup"><span data-stu-id="54c10-272">We'll do this by creating and populating a FormCollection object, and then assign it to the "ValueProvider" property on the Controller.</span></span>

<span data-ttu-id="54c10-273">Der erste Test überprüft, dass nach einer erfolgreichen Speichern Browser an die Aktion Details umgeleitet wird.</span><span class="sxs-lookup"><span data-stu-id="54c10-273">The first test verifies that on a successful save the browser is redirected to the details action.</span></span> <span data-ttu-id="54c10-274">Der zweite Test stellt sicher, dass die Aktion die Bearbeitungsansicht erneut mit einer Fehlermeldung gleichzusetzen, wenn ungültige Eingabe zurückgesendet wird.</span><span class="sxs-lookup"><span data-stu-id="54c10-274">The second test verifies that when invalid input is posted the action redisplays the edit view again with an error message.</span></span>


[!code-csharp[Main](enable-automated-unit-testing/samples/sample17.cs)]

### <a name="testing-wrap-up"></a><span data-ttu-id="54c10-275">Testen der Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="54c10-275">Testing Wrap-Up</span></span>

<span data-ttu-id="54c10-276">Wir haben die Core-Konzepte, die zum Testen Controllerklassen Einheit behandelt.</span><span class="sxs-lookup"><span data-stu-id="54c10-276">We've covered the core concepts involved in unit testing controller classes.</span></span> <span data-ttu-id="54c10-277">Wir können diese Techniken verwenden, auf einfache Weise Hunderte von einfacher Tests erstellen, die das Verhalten der Anwendung überprüft.</span><span class="sxs-lookup"><span data-stu-id="54c10-277">We can use these techniques to easily create hundreds of simple tests that verify the behavior of our application.</span></span>

<span data-ttu-id="54c10-278">Da unsere Controller und Modell Tests eine reale Datenbank nicht erforderlich sind, sind sie sehr schnell und einfach ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="54c10-278">Because our controller and model tests do not require a real database, they are extremely fast and easy to run.</span></span> <span data-ttu-id="54c10-279">Es wird möglich, führen Sie Hunderte von automatisierten Tests in Sekunden, und sofort abrufen Rückmeldung über etwas unterbrochen, ob eine Änderung, die wird wurde vorgenommen.</span><span class="sxs-lookup"><span data-stu-id="54c10-279">We'll be able to execute hundreds of automated tests in seconds, and immediately get feedback as to whether a change we made broke something.</span></span> <span data-ttu-id="54c10-280">Dies hilft uns das Vertrauen kontinuierlich zu verbessern, Umgestaltung und verfeinern die Anwendung bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="54c10-280">This will help provide us the confidence to continually improve, refactor, and refine our application.</span></span>

<span data-ttu-id="54c10-281">Wir betroffenen Tests als im letzten Thema in diesem Kapitel – aber nicht, da die Testphase etwas ist sollten Sie am Ende einen Entwicklungsprozess tun!</span><span class="sxs-lookup"><span data-stu-id="54c10-281">We covered testing as the last topic in this chapter – but not because testing is something you should do at the end of a development process!</span></span> <span data-ttu-id="54c10-282">Im Gegensatz dazu, sollten Sie die automatisierten Tests im Entwicklungsprozess so früh wie möglich schreiben.</span><span class="sxs-lookup"><span data-stu-id="54c10-282">On the contrary, you should write automated tests as early as possible in your development process.</span></span> <span data-ttu-id="54c10-283">Dadurch kann daher Sie unmittelbar Feedback erhalten, wie Sie entwickeln, können Sie Ihre Anwendung verwendungsfallbeispielen sorgfältig überlegen, und führt Sie zum Entwerfen Ihrer Anwendung mit die fehlerfreie überlagern, und beachten Sie hierzu.</span><span class="sxs-lookup"><span data-stu-id="54c10-283">Doing so enables you to get immediate feedback as you develop, helps you think thoughtfully about your application's use case scenarios, and guides you to design your application with clean layering and coupling in mind.</span></span>

<span data-ttu-id="54c10-284">Eine der folgenden Kapitel im Buch besprechen (Test Driven Development, TDD), und wie für die Verwendung mit ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="54c10-284">A later chapter in the book will discuss Test Driven Development (TDD), and how to use it with ASP.NET MVC.</span></span> <span data-ttu-id="54c10-285">Testgesteuerte Entwicklung ist eine iterative Programmierstil, Schreiben Sie zuerst die Tests, die daraus resultierende Code erfüllen.</span><span class="sxs-lookup"><span data-stu-id="54c10-285">TDD is an iterative coding practice where you first write the tests that your resulting code will satisfy.</span></span> <span data-ttu-id="54c10-286">Mit TDD beginnen Sie jede Funktion, durch das Erstellen eines Tests, das die Funktionalität überprüft, die Sie implementieren.</span><span class="sxs-lookup"><span data-stu-id="54c10-286">With TDD you begin each feature by creating a test that verifies the functionality you are about to implement.</span></span> <span data-ttu-id="54c10-287">Schreiben der Einheit Test zuerst wird sichergestellt, dass Sie verstehen, die Funktion und wie es funktionieren soll.</span><span class="sxs-lookup"><span data-stu-id="54c10-287">Writing the unit test first helps ensure that you clearly understand the feature and how it is supposed to work.</span></span> <span data-ttu-id="54c10-288">Nur, nachdem der Test geschrieben (und Sie sichergestellt haben, dass ein Fehler auftritt) führen Sie dann implementieren Sie die aktuelle Funktionalität, die überprüft, der Test ob.</span><span class="sxs-lookup"><span data-stu-id="54c10-288">Only after the test is written (and you have verified that it fails) do you then implement the actual functionality the test verifies.</span></span> <span data-ttu-id="54c10-289">Da Sie bereits Zeit darum geht, die Verwendung Groß-/Kleinschreibung wie das Feature funktionieren soll Ausgaben, müssen Sie ein besseres Verständnis der Anforderungen und wie am besten zu ihrer Implementierung.</span><span class="sxs-lookup"><span data-stu-id="54c10-289">Because you've already spent time thinking about the use case of how the feature is supposed to work, you will have a better understanding of the requirements and how best to implement them.</span></span> <span data-ttu-id="54c10-290">Wenn Sie mit der Implementierung abgeschlossen haben, können Sie den Test – erneut ausführen und Abrufen von unmittelbares Feedback im Vergleich zu, gibt an, ob die Funktion ordnungsgemäß funktioniert.</span><span class="sxs-lookup"><span data-stu-id="54c10-290">When you are done with the implementation you can re-run the test – and get immediate feedback as to whether the feature works correctly.</span></span> <span data-ttu-id="54c10-291">TDD mehr in Kapitel 10 beschrieben.</span><span class="sxs-lookup"><span data-stu-id="54c10-291">We'll cover TDD more in Chapter 10.</span></span>

### <a name="next-step"></a><span data-ttu-id="54c10-292">Nächster Schritt</span><span class="sxs-lookup"><span data-stu-id="54c10-292">Next Step</span></span>

<span data-ttu-id="54c10-293">Einige endgültigen eingebunden Kommentare.</span><span class="sxs-lookup"><span data-stu-id="54c10-293">Some final wrap up comments.</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="54c10-294">[Zurück](use-ajax-to-implement-mapping-scenarios.md)
[Weiter](nerddinner-wrap-up.md)</span><span class="sxs-lookup"><span data-stu-id="54c10-294">[Previous](use-ajax-to-implement-mapping-scenarios.md)
[Next](nerddinner-wrap-up.md)</span></span>
